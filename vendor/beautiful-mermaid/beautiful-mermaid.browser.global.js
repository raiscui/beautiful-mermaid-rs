var beautifulMermaid=(function(exports){'use strict';var Pr=Object.create;var tn=Object.defineProperty;var Dr=Object.getOwnPropertyDescriptor;var Rr=Object.getOwnPropertyNames;var Or=Object.getPrototypeOf,Nr=Object.prototype.hasOwnProperty;var oe=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var Gr=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Br=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Rr(e))!Nr.call(t,o)&&o!==r&&tn(t,o,{get:()=>e[o],enumerable:!(n=Dr(e,o))||n.enumerable});return t};var $e=(t,e,r)=>(r=t!=null?Pr(Or(t)):{},Br(tn(r,"default",{value:t,enumerable:true}),t));var we=Gr((Qn,He)=>{(function(t){if(typeof Qn=="object"&&typeof He<"u")He.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else {var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.dagre=t();}})(function(){return (function(){function n(o,i,c){function s(u,h){if(!i[u]){if(!o[u]){var a=typeof oe=="function"&&oe;if(!h&&a)return a(u,true);if(l)return l(u,true);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var m=i[u]={exports:{}};o[u][0].call(m.exports,function(x){var g=o[u][1][x];return s(g||x)},m,m.exports,n,o,i,c);}return i[u].exports}for(var l=typeof oe=="function"&&oe,f=0;f<c.length;f++)s(c[f]);return s}return n})()({1:[function(n,o,i){o.exports={graphlib:n("@dagrejs/graphlib"),layout:n("./lib/layout"),debug:n("./lib/debug"),util:{time:n("./lib/util").time,notime:n("./lib/util").notime},version:n("./lib/version")};},{"./lib/debug":6,"./lib/layout":8,"./lib/util":27,"./lib/version":28,"@dagrejs/graphlib":29}],2:[function(n,o,i){let c=n("./greedy-fas"),s=n("./util").uniqueId;o.exports={run:l,undo:u};function l(h){(h.graph().acyclicer==="greedy"?c(h,d(h)):f(h)).forEach(m=>{let x=h.edge(m);h.removeEdge(m),x.forwardName=m.name,x.reversed=true,h.setEdge(m.w,m.v,x,s("rev"));});function d(m){return x=>m.edge(x).weight}}function f(h){let a=[],d={},m={};function x(g){Object.hasOwn(m,g)||(m[g]=true,d[g]=true,h.outEdges(g).forEach(p=>{Object.hasOwn(d,p.w)?a.push(p):x(p.w);}),delete d[g]);}return h.nodes().forEach(x),a}function u(h){h.edges().forEach(a=>{let d=h.edge(a);if(d.reversed){h.removeEdge(a);let m=d.forwardName;delete d.reversed,delete d.forwardName,h.setEdge(a.w,a.v,d,m);}});}},{"./greedy-fas":7,"./util":27}],3:[function(n,o,i){let c=n("./util");o.exports=s;function s(f){function u(h){let a=f.children(h),d=f.node(h);if(a.length&&a.forEach(u),Object.hasOwn(d,"minRank")){d.borderLeft=[],d.borderRight=[];for(let m=d.minRank,x=d.maxRank+1;m<x;++m)l(f,"borderLeft","_bl",h,d,m),l(f,"borderRight","_br",h,d,m);}}f.children().forEach(u);}function l(f,u,h,a,d,m){let x={width:0,height:0,rank:m,borderType:u},g=d[u][m-1],p=c.addDummyNode(f,"border",x,h);d[u][m]=p,f.setParent(p,a),g&&f.setEdge(g,p,{weight:1});}},{"./util":27}],4:[function(n,o,i){o.exports={adjust:c,undo:s};function c(m){let x=m.graph().rankdir.toLowerCase();(x==="lr"||x==="rl")&&l(m);}function s(m){let x=m.graph().rankdir.toLowerCase();(x==="bt"||x==="rl")&&u(m),(x==="lr"||x==="rl")&&(a(m),l(m));}function l(m){m.nodes().forEach(x=>f(m.node(x))),m.edges().forEach(x=>f(m.edge(x)));}function f(m){let x=m.width;m.width=m.height,m.height=x;}function u(m){m.nodes().forEach(x=>h(m.node(x))),m.edges().forEach(x=>{let g=m.edge(x);g.points.forEach(h),Object.hasOwn(g,"y")&&h(g);});}function h(m){m.y=-m.y;}function a(m){m.nodes().forEach(x=>d(m.node(x))),m.edges().forEach(x=>{let g=m.edge(x);g.points.forEach(d),Object.hasOwn(g,"x")&&d(g);});}function d(m){let x=m.x;m.x=m.y,m.y=x;}},{}],5:[function(n,o,i){class c{constructor(){let u={};u._next=u._prev=u,this._sentinel=u;}dequeue(){let u=this._sentinel,h=u._prev;if(h!==u)return s(h),h}enqueue(u){let h=this._sentinel;u._prev&&u._next&&s(u),u._next=h._next,h._next._prev=u,h._next=u,u._prev=h;}toString(){let u=[],h=this._sentinel,a=h._prev;for(;a!==h;)u.push(JSON.stringify(a,l)),a=a._prev;return "["+u.join(", ")+"]"}}function s(f){f._prev._next=f._next,f._next._prev=f._prev,delete f._next,delete f._prev;}function l(f,u){if(f!=="_next"&&f!=="_prev")return u}o.exports=c;},{}],6:[function(n,o,i){let c=n("./util"),s=n("@dagrejs/graphlib").Graph;o.exports={debugOrdering:l};function l(f){let u=c.buildLayerMatrix(f),h=new s({compound:true,multigraph:true}).setGraph({});return f.nodes().forEach(a=>{h.setNode(a,{label:a}),h.setParent(a,"layer"+f.node(a).rank);}),f.edges().forEach(a=>h.setEdge(a.v,a.w,{},a.name)),u.forEach((a,d)=>{let m="layer"+d;h.setNode(m,{rank:"same"}),a.reduce((x,g)=>(h.setEdge(x,g,{style:"invis"}),g));}),h}},{"./util":27,"@dagrejs/graphlib":29}],7:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("./data/list");o.exports=f;let l=()=>1;function f(x,g){if(x.nodeCount()<=1)return [];let p=a(x,g||l);return u(p.graph,p.buckets,p.zeroIdx).flatMap(C=>x.outEdges(C.v,C.w))}function u(x,g,p){let y=[],C=g[g.length-1],_=g[0],R;for(;x.nodeCount();){for(;R=_.dequeue();)h(x,g,p,R);for(;R=C.dequeue();)h(x,g,p,R);if(x.nodeCount()){for(let w=g.length-2;w>0;--w)if(R=g[w].dequeue(),R){y=y.concat(h(x,g,p,R,true));break}}}return y}function h(x,g,p,y,C){let _=C?[]:void 0;return x.inEdges(y.v).forEach(R=>{let w=x.edge(R),S=x.node(R.v);C&&_.push({v:R.v,w:R.w}),S.out-=w,d(g,p,S);}),x.outEdges(y.v).forEach(R=>{let w=x.edge(R),S=R.w,k=x.node(S);k.in-=w,d(g,p,k);}),x.removeNode(y.v),_}function a(x,g){let p=new c,y=0,C=0;x.nodes().forEach(w=>{p.setNode(w,{v:w,in:0,out:0});}),x.edges().forEach(w=>{let S=p.edge(w.v,w.w)||0,k=g(w),I=S+k;p.setEdge(w.v,w.w,I),C=Math.max(C,p.node(w.v).out+=k),y=Math.max(y,p.node(w.w).in+=k);});let _=m(C+y+3).map(()=>new s),R=y+1;return p.nodes().forEach(w=>{d(_,R,p.node(w));}),{graph:p,buckets:_,zeroIdx:R}}function d(x,g,p){p.out?p.in?x[p.out-p.in+g].enqueue(p):x[x.length-1].enqueue(p):x[0].enqueue(p);}function m(x){let g=[];for(let p=0;p<x;p++)g.push(p);return g}},{"./data/list":5,"@dagrejs/graphlib":29}],8:[function(n,o,i){let c=n("./acyclic"),s=n("./normalize"),l=n("./rank"),f=n("./util").normalizeRanks,u=n("./parent-dummy-chains"),h=n("./util").removeEmptyRanks,a=n("./nesting-graph"),d=n("./add-border-segments"),m=n("./coordinate-system"),x=n("./order"),g=n("./position"),p=n("./util"),y=n("@dagrejs/graphlib").Graph;o.exports=C;function C(b,M){let D=M&&M.debugTiming?p.time:p.notime;D("layout",()=>{let Y=D("  buildLayoutGraph",()=>$(b));D("  runLayout",()=>_(Y,D,M)),D("  updateInputGraph",()=>R(b,Y));});}function _(b,M,D){M("    makeSpaceForEdgeLabels",()=>N(b)),M("    removeSelfEdges",()=>F(b)),M("    acyclic",()=>c.run(b)),M("    nestingGraph.run",()=>a.run(b)),M("    rank",()=>l(p.asNonCompoundGraph(b))),M("    injectEdgeLabelProxies",()=>A(b)),M("    removeEmptyRanks",()=>h(b)),M("    nestingGraph.cleanup",()=>a.cleanup(b)),M("    normalizeRanks",()=>f(b)),M("    assignRankMinMax",()=>G(b)),M("    removeEdgeLabelProxies",()=>v(b)),M("    normalize.run",()=>s.run(b)),M("    parentDummyChains",()=>u(b)),M("    addBorderSegments",()=>d(b)),M("    order",()=>x(b,D)),M("    insertSelfEdges",()=>H(b)),M("    adjustCoordinateSystem",()=>m.adjust(b)),M("    position",()=>g(b)),M("    positionSelfEdges",()=>V(b)),M("    removeBorderNodes",()=>T(b)),M("    normalize.undo",()=>s.undo(b)),M("    fixupEdgeLabelCoords",()=>E(b)),M("    undoCoordinateSystem",()=>m.undo(b)),M("    translateGraph",()=>j(b)),M("    assignNodeIntersects",()=>W(b)),M("    reversePoints",()=>P(b)),M("    acyclic.undo",()=>c.undo(b));}function R(b,M){b.nodes().forEach(D=>{let Y=b.node(D),K=M.node(D);Y&&(Y.x=K.x,Y.y=K.y,Y.rank=K.rank,M.children(D).length&&(Y.width=K.width,Y.height=K.height));}),b.edges().forEach(D=>{let Y=b.edge(D),K=M.edge(D);Y.points=K.points,Object.hasOwn(K,"x")&&(Y.x=K.x,Y.y=K.y);}),b.graph().width=M.graph().width,b.graph().height=M.graph().height;}let w=["nodesep","edgesep","ranksep","marginx","marginy"],S={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},k=["acyclicer","ranker","rankdir","align"],I=["width","height","rank"],L={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],X={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},U=["labelpos"];function $(b){let M=new y({multigraph:true,compound:true}),D=B(b.graph());return M.setGraph(Object.assign({},S,z(D,w),p.pick(D,k))),b.nodes().forEach(Y=>{let K=B(b.node(Y)),J=z(K,I);Object.keys(L).forEach(Z=>{J[Z]===void 0&&(J[Z]=L[Z]);}),M.setNode(Y,J),M.setParent(Y,b.parent(Y));}),b.edges().forEach(Y=>{let K=B(b.edge(Y));M.setEdge(Y,Object.assign({},X,z(K,O),p.pick(K,U)));}),M}function N(b){let M=b.graph();M.ranksep/=2,b.edges().forEach(D=>{let Y=b.edge(D);Y.minlen*=2,Y.labelpos.toLowerCase()!=="c"&&(M.rankdir==="TB"||M.rankdir==="BT"?Y.width+=Y.labeloffset:Y.height+=Y.labeloffset);});}function A(b){b.edges().forEach(M=>{let D=b.edge(M);if(D.width&&D.height){let Y=b.node(M.v),J={rank:(b.node(M.w).rank-Y.rank)/2+Y.rank,e:M};p.addDummyNode(b,"edge-proxy",J,"_ep");}});}function G(b){let M=0;b.nodes().forEach(D=>{let Y=b.node(D);Y.borderTop&&(Y.minRank=b.node(Y.borderTop).rank,Y.maxRank=b.node(Y.borderBottom).rank,M=Math.max(M,Y.maxRank));}),b.graph().maxRank=M;}function v(b){b.nodes().forEach(M=>{let D=b.node(M);D.dummy==="edge-proxy"&&(b.edge(D.e).labelRank=D.rank,b.removeNode(M));});}function j(b){let M=Number.POSITIVE_INFINITY,D=0,Y=Number.POSITIVE_INFINITY,K=0,J=b.graph(),Z=J.marginx||0,st=J.marginy||0;function mt(xt){let pt=xt.x,re=xt.y,Ze=xt.width,Qe=xt.height;M=Math.min(M,pt-Ze/2),D=Math.max(D,pt+Ze/2),Y=Math.min(Y,re-Qe/2),K=Math.max(K,re+Qe/2);}b.nodes().forEach(xt=>mt(b.node(xt))),b.edges().forEach(xt=>{let pt=b.edge(xt);Object.hasOwn(pt,"x")&&mt(pt);}),M-=Z,Y-=st,b.nodes().forEach(xt=>{let pt=b.node(xt);pt.x-=M,pt.y-=Y;}),b.edges().forEach(xt=>{let pt=b.edge(xt);pt.points.forEach(re=>{re.x-=M,re.y-=Y;}),Object.hasOwn(pt,"x")&&(pt.x-=M),Object.hasOwn(pt,"y")&&(pt.y-=Y);}),J.width=D-M+Z,J.height=K-Y+st;}function W(b){b.edges().forEach(M=>{let D=b.edge(M),Y=b.node(M.v),K=b.node(M.w),J,Z;D.points?(J=D.points[0],Z=D.points[D.points.length-1]):(D.points=[],J=K,Z=Y),D.points.unshift(p.intersectRect(Y,J)),D.points.push(p.intersectRect(K,Z));});}function E(b){b.edges().forEach(M=>{let D=b.edge(M);if(Object.hasOwn(D,"x"))switch((D.labelpos==="l"||D.labelpos==="r")&&(D.width-=D.labeloffset),D.labelpos){case "l":D.x-=D.width/2+D.labeloffset;break;case "r":D.x+=D.width/2+D.labeloffset;break}});}function P(b){b.edges().forEach(M=>{let D=b.edge(M);D.reversed&&D.points.reverse();});}function T(b){b.nodes().forEach(M=>{if(b.children(M).length){let D=b.node(M),Y=b.node(D.borderTop),K=b.node(D.borderBottom),J=b.node(D.borderLeft[D.borderLeft.length-1]),Z=b.node(D.borderRight[D.borderRight.length-1]);D.width=Math.abs(Z.x-J.x),D.height=Math.abs(K.y-Y.y),D.x=J.x+D.width/2,D.y=Y.y+D.height/2;}}),b.nodes().forEach(M=>{b.node(M).dummy==="border"&&b.removeNode(M);});}function F(b){b.edges().forEach(M=>{if(M.v===M.w){var D=b.node(M.v);D.selfEdges||(D.selfEdges=[]),D.selfEdges.push({e:M,label:b.edge(M)}),b.removeEdge(M);}});}function H(b){var M=p.buildLayerMatrix(b);M.forEach(D=>{var Y=0;D.forEach((K,J)=>{var Z=b.node(K);Z.order=J+Y,(Z.selfEdges||[]).forEach(st=>{p.addDummyNode(b,"selfedge",{width:st.label.width,height:st.label.height,rank:Z.rank,order:J+ ++Y,e:st.e,label:st.label},"_se");}),delete Z.selfEdges;});});}function V(b){b.nodes().forEach(M=>{var D=b.node(M);if(D.dummy==="selfedge"){var Y=b.node(D.e.v),K=Y.x+Y.width/2,J=Y.y,Z=D.x-K,st=Y.height/2;b.setEdge(D.e,D.label),b.removeNode(M),D.label.points=[{x:K+2*Z/3,y:J-st},{x:K+5*Z/6,y:J-st},{x:K+Z,y:J},{x:K+5*Z/6,y:J+st},{x:K+2*Z/3,y:J+st}],D.label.x=D.x,D.label.y=D.y;}});}function z(b,M){return p.mapValues(p.pick(b,M),Number)}function B(b){var M={};return b&&Object.entries(b).forEach(([D,Y])=>{typeof D=="string"&&(D=D.toLowerCase()),M[D]=Y;}),M}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./nesting-graph":9,"./normalize":10,"./order":15,"./parent-dummy-chains":20,"./position":22,"./rank":24,"./util":27,"@dagrejs/graphlib":29}],9:[function(n,o,i){let c=n("./util");o.exports={run:s,cleanup:h};function s(a){let d=c.addDummyNode(a,"root",{},"_root"),m=f(a),x=Object.values(m),g=c.applyWithChunking(Math.max,x)-1,p=2*g+1;a.graph().nestingRoot=d,a.edges().forEach(C=>a.edge(C).minlen*=p);let y=u(a)+1;a.children().forEach(C=>l(a,d,p,y,g,m,C)),a.graph().nodeRankFactor=p;}function l(a,d,m,x,g,p,y){let C=a.children(y);if(!C.length){y!==d&&a.setEdge(d,y,{weight:0,minlen:m});return}let _=c.addBorderNode(a,"_bt"),R=c.addBorderNode(a,"_bb"),w=a.node(y);a.setParent(_,y),w.borderTop=_,a.setParent(R,y),w.borderBottom=R,C.forEach(S=>{l(a,d,m,x,g,p,S);let k=a.node(S),I=k.borderTop?k.borderTop:S,L=k.borderBottom?k.borderBottom:S,O=k.borderTop?x:2*x,X=I!==L?1:g-p[y]+1;a.setEdge(_,I,{weight:O,minlen:X,nestingEdge:true}),a.setEdge(L,R,{weight:O,minlen:X,nestingEdge:true});}),a.parent(y)||a.setEdge(d,_,{weight:0,minlen:g+p[y]});}function f(a){var d={};function m(x,g){var p=a.children(x);p&&p.length&&p.forEach(y=>m(y,g+1)),d[x]=g;}return a.children().forEach(x=>m(x,1)),d}function u(a){return a.edges().reduce((d,m)=>d+a.edge(m).weight,0)}function h(a){var d=a.graph();a.removeNode(d.nestingRoot),delete d.nestingRoot,a.edges().forEach(m=>{var x=a.edge(m);x.nestingEdge&&a.removeEdge(m);});}},{"./util":27}],10:[function(n,o,i){let c=n("./util");o.exports={run:s,undo:f};function s(u){u.graph().dummyChains=[],u.edges().forEach(h=>l(u,h));}function l(u,h){let a=h.v,d=u.node(a).rank,m=h.w,x=u.node(m).rank,g=h.name,p=u.edge(h),y=p.labelRank;if(x===d+1)return;u.removeEdge(h);let C,_,R;for(R=0,++d;d<x;++R,++d)p.points=[],_={width:0,height:0,edgeLabel:p,edgeObj:h,rank:d},C=c.addDummyNode(u,"edge",_,"_d"),d===y&&(_.width=p.width,_.height=p.height,_.dummy="edge-label",_.labelpos=p.labelpos),u.setEdge(a,C,{weight:p.weight},g),R===0&&u.graph().dummyChains.push(C),a=C;u.setEdge(a,m,{weight:p.weight},g);}function f(u){u.graph().dummyChains.forEach(h=>{let a=u.node(h),d=a.edgeLabel,m;for(u.setEdge(a.edgeObj,d);a.dummy;)m=u.successors(h)[0],u.removeNode(h),d.points.push({x:a.x,y:a.y}),a.dummy==="edge-label"&&(d.x=a.x,d.y=a.y,d.width=a.width,d.height=a.height),h=m,a=u.node(h);});}},{"./util":27}],11:[function(n,o,i){o.exports=c;function c(s,l,f){let u={},h;f.forEach(a=>{let d=s.parent(a),m,x;for(;d;){if(m=s.parent(d),m?(x=u[m],u[m]=d):(x=h,h=d),x&&x!==d){l.setEdge(x,d);return}d=m;}});}},{}],12:[function(n,o,i){o.exports=c;function c(s,l=[]){return l.map(f=>{let u=s.inEdges(f);if(u.length){let h=u.reduce((a,d)=>{let m=s.edge(d),x=s.node(d.v);return {sum:a.sum+m.weight*x.order,weight:a.weight+m.weight}},{sum:0,weight:0});return {v:f,barycenter:h.sum/h.weight,weight:h.weight}}else return {v:f}})}},{}],13:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("../util");o.exports=l;function l(u,h,a,d){d||(d=u.nodes());let m=f(u),x=new c({compound:true}).setGraph({root:m}).setDefaultNodeLabel(g=>u.node(g));return d.forEach(g=>{let p=u.node(g),y=u.parent(g);(p.rank===h||p.minRank<=h&&h<=p.maxRank)&&(x.setNode(g),x.setParent(g,y||m),u[a](g).forEach(C=>{let _=C.v===g?C.w:C.v,R=x.edge(_,g),w=R!==void 0?R.weight:0;x.setEdge(_,g,{weight:u.edge(C).weight+w});}),Object.hasOwn(p,"minRank")&&x.setNode(g,{borderLeft:p.borderLeft[h],borderRight:p.borderRight[h]}));}),x}function f(u){for(var h;u.hasNode(h=s.uniqueId("_root")););return h}},{"../util":27,"@dagrejs/graphlib":29}],14:[function(n,o,i){let c=n("../util").zipObject;o.exports=s;function s(f,u){let h=0;for(let a=1;a<u.length;++a)h+=l(f,u[a-1],u[a]);return h}function l(f,u,h){let a=c(h,h.map((y,C)=>C)),d=u.flatMap(y=>f.outEdges(y).map(C=>({pos:a[C.w],weight:f.edge(C).weight})).sort((C,_)=>C.pos-_.pos)),m=1;for(;m<h.length;)m<<=1;let x=2*m-1;m-=1;let g=new Array(x).fill(0),p=0;return d.forEach(y=>{let C=y.pos+m;g[C]+=y.weight;let _=0;for(;C>0;)C%2&&(_+=g[C+1]),C=C-1>>1,g[C]+=y.weight;p+=y.weight*_;}),p}},{"../util":27}],15:[function(n,o,i){let c=n("./init-order"),s=n("./cross-count"),l=n("./sort-subgraph"),f=n("./build-layer-graph"),u=n("./add-subgraph-constraints"),h=n("@dagrejs/graphlib").Graph,a=n("../util");o.exports=d;function d(p,y){if(y&&typeof y.customOrder=="function"){y.customOrder(p,d);return}let C=a.maxRank(p),_=m(p,a.range(1,C+1),"inEdges"),R=m(p,a.range(C-1,-1,-1),"outEdges"),w=c(p);if(g(p,w),y&&y.disableOptimalOrderHeuristic)return;let S=Number.POSITIVE_INFINITY,k;for(let I=0,L=0;L<4;++I,++L){x(I%2?_:R,I%4>=2),w=a.buildLayerMatrix(p);let O=s(p,w);O<S&&(L=0,k=Object.assign({},w),S=O);}g(p,k);}function m(p,y,C){let _=new Map,R=(w,S)=>{_.has(w)||_.set(w,[]),_.get(w).push(S);};for(let w of p.nodes()){let S=p.node(w);if(typeof S.rank=="number"&&R(S.rank,w),typeof S.minRank=="number"&&typeof S.maxRank=="number")for(let k=S.minRank;k<=S.maxRank;k++)k!==S.rank&&R(k,w);}return y.map(function(w){return f(p,w,C,_.get(w)||[])})}function x(p,y){let C=new h;p.forEach(function(_){let R=_.graph().root,w=l(_,R,C,y);w.vs.forEach((S,k)=>_.node(S).order=k),u(_,C,w.vs);});}function g(p,y){Object.values(y).forEach(C=>C.forEach((_,R)=>p.node(_).order=R));}},{"../util":27,"./add-subgraph-constraints":11,"./build-layer-graph":13,"./cross-count":14,"./init-order":16,"./sort-subgraph":18,"@dagrejs/graphlib":29}],16:[function(n,o,i){let c=n("../util");o.exports=s;function s(l){let f={},u=l.nodes().filter(g=>!l.children(g).length),h=u.map(g=>l.node(g).rank),a=c.applyWithChunking(Math.max,h),d=c.range(a+1).map(()=>[]);function m(g){if(f[g])return;f[g]=true;let p=l.node(g);d[p.rank].push(g),l.successors(g).forEach(m);}return u.sort((g,p)=>l.node(g).rank-l.node(p).rank).forEach(m),d}},{"../util":27}],17:[function(n,o,i){let c=n("../util");o.exports=s;function s(u,h){let a={};u.forEach((m,x)=>{let g=a[m.v]={indegree:0,in:[],out:[],vs:[m.v],i:x};m.barycenter!==void 0&&(g.barycenter=m.barycenter,g.weight=m.weight);}),h.edges().forEach(m=>{let x=a[m.v],g=a[m.w];x!==void 0&&g!==void 0&&(g.indegree++,x.out.push(a[m.w]));});let d=Object.values(a).filter(m=>!m.indegree);return l(d)}function l(u){let h=[];function a(m){return x=>{x.merged||(x.barycenter===void 0||m.barycenter===void 0||x.barycenter>=m.barycenter)&&f(m,x);}}function d(m){return x=>{x.in.push(m),--x.indegree===0&&u.push(x);}}for(;u.length;){let m=u.pop();h.push(m),m.in.reverse().forEach(a(m)),m.out.forEach(d(m));}return h.filter(m=>!m.merged).map(m=>c.pick(m,["vs","i","barycenter","weight"]))}function f(u,h){let a=0,d=0;u.weight&&(a+=u.barycenter*u.weight,d+=u.weight),h.weight&&(a+=h.barycenter*h.weight,d+=h.weight),u.vs=h.vs.concat(u.vs),u.barycenter=a/d,u.weight=d,u.i=Math.min(h.i,u.i),h.merged=true;}},{"../util":27}],18:[function(n,o,i){let c=n("./barycenter"),s=n("./resolve-conflicts"),l=n("./sort");o.exports=f;function f(a,d,m,x){let g=a.children(d),p=a.node(d),y=p?p.borderLeft:void 0,C=p?p.borderRight:void 0,_={};y&&(g=g.filter(k=>k!==y&&k!==C));let R=c(a,g);R.forEach(k=>{if(a.children(k.v).length){let I=f(a,k.v,m,x);_[k.v]=I,Object.hasOwn(I,"barycenter")&&h(k,I);}});let w=s(R,m);u(w,_);let S=l(w,x);if(y&&(S.vs=[y,S.vs,C].flat(true),a.predecessors(y).length)){let k=a.node(a.predecessors(y)[0]),I=a.node(a.predecessors(C)[0]);Object.hasOwn(S,"barycenter")||(S.barycenter=0,S.weight=0),S.barycenter=(S.barycenter*S.weight+k.order+I.order)/(S.weight+2),S.weight+=2;}return S}function u(a,d){a.forEach(m=>{m.vs=m.vs.flatMap(x=>d[x]?d[x].vs:x);});}function h(a,d){a.barycenter!==void 0?(a.barycenter=(a.barycenter*a.weight+d.barycenter*d.weight)/(a.weight+d.weight),a.weight+=d.weight):(a.barycenter=d.barycenter,a.weight=d.weight);}},{"./barycenter":12,"./resolve-conflicts":17,"./sort":19}],19:[function(n,o,i){let c=n("../util");o.exports=s;function s(u,h){let a=c.partition(u,_=>Object.hasOwn(_,"barycenter")),d=a.lhs,m=a.rhs.sort((_,R)=>R.i-_.i),x=[],g=0,p=0,y=0;d.sort(f(!!h)),y=l(x,m,y),d.forEach(_=>{y+=_.vs.length,x.push(_.vs),g+=_.barycenter*_.weight,p+=_.weight,y=l(x,m,y);});let C={vs:x.flat(true)};return p&&(C.barycenter=g/p,C.weight=p),C}function l(u,h,a){let d;for(;h.length&&(d=h[h.length-1]).i<=a;)h.pop(),u.push(d.vs),a++;return a}function f(u){return (h,a)=>h.barycenter<a.barycenter?-1:h.barycenter>a.barycenter?1:u?a.i-h.i:h.i-a.i}},{"../util":27}],20:[function(n,o,i){o.exports=c;function c(f){let u=l(f);f.graph().dummyChains.forEach(h=>{let a=f.node(h),d=a.edgeObj,m=s(f,u,d.v,d.w),x=m.path,g=m.lca,p=0,y=x[p],C=true;for(;h!==d.w;){if(a=f.node(h),C){for(;(y=x[p])!==g&&f.node(y).maxRank<a.rank;)p++;y===g&&(C=false);}if(!C){for(;p<x.length-1&&f.node(y=x[p+1]).minRank<=a.rank;)p++;y=x[p];}f.setParent(h,y),h=f.successors(h)[0];}});}function s(f,u,h,a){let d=[],m=[],x=Math.min(u[h].low,u[a].low),g=Math.max(u[h].lim,u[a].lim),p,y;p=h;do p=f.parent(p),d.push(p);while(p&&(u[p].low>x||g>u[p].lim));for(y=p,p=a;(p=f.parent(p))!==y;)m.push(p);return {path:d.concat(m.reverse()),lca:y}}function l(f){let u={},h=0;function a(d){let m=h;f.children(d).forEach(a),u[d]={low:m,lim:h++};}return f.children().forEach(a),u}},{}],21:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("../util");o.exports={positionX:C,findType1Conflicts:l,findType2Conflicts:f,addConflict:h,hasConflict:a,verticalAlignment:d,horizontalCompaction:m,alignCoordinates:p,findSmallestWidthAlignment:g,balance:y};function l(w,S){let k={};function I(L,O){let X=0,U=0,$=L.length,N=O[O.length-1];return O.forEach((A,G)=>{let v=u(w,A),j=v?w.node(v).order:$;(v||A===N)&&(O.slice(U,G+1).forEach(W=>{w.predecessors(W).forEach(E=>{let P=w.node(E),T=P.order;(T<X||j<T)&&!(P.dummy&&w.node(W).dummy)&&h(k,E,W);});}),U=G+1,X=j);}),O}return S.length&&S.reduce(I),k}function f(w,S){let k={};function I(O,X,U,$,N){let A;s.range(X,U).forEach(G=>{A=O[G],w.node(A).dummy&&w.predecessors(A).forEach(v=>{let j=w.node(v);j.dummy&&(j.order<$||j.order>N)&&h(k,v,A);});});}function L(O,X){let U=-1,$,N=0;return X.forEach((A,G)=>{if(w.node(A).dummy==="border"){let v=w.predecessors(A);v.length&&($=w.node(v[0]).order,I(X,N,G,U,$),N=G,U=$);}I(X,N,X.length,$,O.length);}),X}return S.length&&S.reduce(L),k}function u(w,S){if(w.node(S).dummy)return w.predecessors(S).find(k=>w.node(k).dummy)}function h(w,S,k){if(S>k){let L=S;S=k,k=L;}let I=w[S];I||(w[S]=I={}),I[k]=true;}function a(w,S,k){if(S>k){let I=S;S=k,k=I;}return !!w[S]&&Object.hasOwn(w[S],k)}function d(w,S,k,I){let L={},O={},X={};return S.forEach(U=>{U.forEach(($,N)=>{L[$]=$,O[$]=$,X[$]=N;});}),S.forEach(U=>{let $=-1;U.forEach(N=>{let A=I(N);if(A.length){A=A.sort((v,j)=>X[v]-X[j]);let G=(A.length-1)/2;for(let v=Math.floor(G),j=Math.ceil(G);v<=j;++v){let W=A[v];O[N]===N&&$<X[W]&&!a(k,N,W)&&(O[W]=N,O[N]=L[N]=L[W],$=X[W]);}}});}),{root:L,align:O}}function m(w,S,k,I,L){let O={},X=x(w,S,k,L),U=L?"borderLeft":"borderRight";function $(G,v){let j=X.nodes(),W=j.pop(),E={};for(;W;)E[W]?G(W):(E[W]=true,j.push(W),j=j.concat(v(W))),W=j.pop();}function N(G){O[G]=X.inEdges(G).reduce((v,j)=>Math.max(v,O[j.v]+X.edge(j)),0);}function A(G){let v=X.outEdges(G).reduce((W,E)=>Math.min(W,O[E.w]-X.edge(E)),Number.POSITIVE_INFINITY),j=w.node(G);v!==Number.POSITIVE_INFINITY&&j.borderType!==U&&(O[G]=Math.max(O[G],v));}return $(N,X.predecessors.bind(X)),$(A,X.successors.bind(X)),Object.keys(I).forEach(G=>O[G]=O[k[G]]),O}function x(w,S,k,I){let L=new c,O=w.graph(),X=_(O.nodesep,O.edgesep,I);return S.forEach(U=>{let $;U.forEach(N=>{let A=k[N];if(L.setNode(A),$){var G=k[$],v=L.edge(G,A);L.setEdge(G,A,Math.max(X(w,N,$),v||0));}$=N;});}),L}function g(w,S){return Object.values(S).reduce((k,I)=>{let L=Number.NEGATIVE_INFINITY,O=Number.POSITIVE_INFINITY;Object.entries(I).forEach(([U,$])=>{let N=R(w,U)/2;L=Math.max($+N,L),O=Math.min($-N,O);});let X=L-O;return X<k[0]&&(k=[X,I]),k},[Number.POSITIVE_INFINITY,null])[1]}function p(w,S){let k=Object.values(S),I=s.applyWithChunking(Math.min,k),L=s.applyWithChunking(Math.max,k);["u","d"].forEach(O=>{["l","r"].forEach(X=>{let U=O+X,$=w[U];if($===S)return;let N=Object.values($),A=I-s.applyWithChunking(Math.min,N);X!=="l"&&(A=L-s.applyWithChunking(Math.max,N)),A&&(w[U]=s.mapValues($,G=>G+A));});});}function y(w,S){return s.mapValues(w.ul,(k,I)=>{if(S)return w[S.toLowerCase()][I];{let L=Object.values(w).map(O=>O[I]).sort((O,X)=>O-X);return (L[1]+L[2])/2}})}function C(w){let S=s.buildLayerMatrix(w),k=Object.assign(l(w,S),f(w,S)),I={},L;["u","d"].forEach(X=>{L=X==="u"?S:Object.values(S).reverse(),["l","r"].forEach(U=>{U==="r"&&(L=L.map(G=>Object.values(G).reverse()));let $=(X==="u"?w.predecessors:w.successors).bind(w),N=d(w,L,k,$),A=m(w,L,N.root,N.align,U==="r");U==="r"&&(A=s.mapValues(A,G=>-G)),I[X+U]=A;});});let O=g(w,I);return p(I,O),y(I,w.graph().align)}function _(w,S,k){return (I,L,O)=>{let X=I.node(L),U=I.node(O),$=0,N;if($+=X.width/2,Object.hasOwn(X,"labelpos"))switch(X.labelpos.toLowerCase()){case "l":N=-X.width/2;break;case "r":N=X.width/2;break}if(N&&($+=k?N:-N),N=0,$+=(X.dummy?S:w)/2,$+=(U.dummy?S:w)/2,$+=U.width/2,Object.hasOwn(U,"labelpos"))switch(U.labelpos.toLowerCase()){case "l":N=U.width/2;break;case "r":N=-U.width/2;break}return N&&($+=k?N:-N),N=0,$}}function R(w,S){return w.node(S).width}},{"../util":27,"@dagrejs/graphlib":29}],22:[function(n,o,i){let c=n("../util"),s=n("./bk").positionX;o.exports=l;function l(u){u=c.asNonCompoundGraph(u),f(u),Object.entries(s(u)).forEach(([h,a])=>u.node(h).x=a);}function f(u){let h=c.buildLayerMatrix(u),a=u.graph().ranksep,d=0;h.forEach(m=>{let x=m.reduce((g,p)=>{let y=u.node(p).height;return g>y?g:y},0);m.forEach(g=>u.node(g).y=d+x/2),d+=x+a;});}},{"../util":27,"./bk":21}],23:[function(n,o,i){var c=n("@dagrejs/graphlib").Graph,s=n("./util").slack;o.exports=l;function l(a){var d=new c({directed:false}),m=a.nodes()[0],x=a.nodeCount();d.setNode(m,{});for(var g,p;f(d,a)<x;)g=u(d,a),p=d.hasNode(g.v)?s(a,g):-s(a,g),h(d,a,p);return d}function f(a,d){function m(x){d.nodeEdges(x).forEach(g=>{var p=g.v,y=x===p?g.w:p;!a.hasNode(y)&&!s(d,g)&&(a.setNode(y,{}),a.setEdge(x,y,{}),m(y));});}return a.nodes().forEach(m),a.nodeCount()}function u(a,d){return d.edges().reduce((x,g)=>{let p=Number.POSITIVE_INFINITY;return a.hasNode(g.v)!==a.hasNode(g.w)&&(p=s(d,g)),p<x[0]?[p,g]:x},[Number.POSITIVE_INFINITY,null])[1]}function h(a,d,m){a.nodes().forEach(x=>d.node(x).rank+=m);}},{"./util":26,"@dagrejs/graphlib":29}],24:[function(n,o,i){var c=n("./util"),s=c.longestPath,l=n("./feasible-tree"),f=n("./network-simplex");o.exports=u;function u(m){var x=m.graph().ranker;if(x instanceof Function)return x(m);switch(m.graph().ranker){case "network-simplex":d(m);break;case "tight-tree":a(m);break;case "longest-path":h(m);break;case "none":break;default:d(m);}}var h=s;function a(m){s(m),l(m);}function d(m){f(m);}},{"./feasible-tree":23,"./network-simplex":25,"./util":26}],25:[function(n,o,i){var c=n("./feasible-tree"),s=n("./util").slack,l=n("./util").longestPath,f=n("@dagrejs/graphlib").alg.preorder,u=n("@dagrejs/graphlib").alg.postorder,h=n("../util").simplify;o.exports=a,a.initLowLimValues=g,a.initCutValues=d,a.calcCutValue=x,a.leaveEdge=y,a.enterEdge=C,a.exchangeEdges=_;function a(k){k=h(k),l(k);var I=c(k);g(I),d(I,k);for(var L,O;L=y(I);)O=C(I,k,L),_(I,k,L,O);}function d(k,I){var L=u(k,k.nodes());L=L.slice(0,L.length-1),L.forEach(O=>m(k,I,O));}function m(k,I,L){var O=k.node(L),X=O.parent;k.edge(L,X).cutvalue=x(k,I,L);}function x(k,I,L){var O=k.node(L),X=O.parent,U=true,$=I.edge(L,X),N=0;return $||(U=false,$=I.edge(X,L)),N=$.weight,I.nodeEdges(L).forEach(A=>{var G=A.v===L,v=G?A.w:A.v;if(v!==X){var j=G===U,W=I.edge(A).weight;if(N+=j?W:-W,w(k,L,v)){var E=k.edge(L,v).cutvalue;N+=j?-E:E;}}}),N}function g(k,I){arguments.length<2&&(I=k.nodes()[0]),p(k,{},1,I);}function p(k,I,L,O,X){var U=L,$=k.node(O);return I[O]=true,k.neighbors(O).forEach(N=>{Object.hasOwn(I,N)||(L=p(k,I,L,N,O));}),$.low=U,$.lim=L++,X?$.parent=X:delete $.parent,L}function y(k){return k.edges().find(I=>k.edge(I).cutvalue<0)}function C(k,I,L){var O=L.v,X=L.w;I.hasEdge(O,X)||(O=L.w,X=L.v);var U=k.node(O),$=k.node(X),N=U,A=false;U.lim>$.lim&&(N=$,A=true);var G=I.edges().filter(v=>A===S(k,k.node(v.v),N)&&A!==S(k,k.node(v.w),N));return G.reduce((v,j)=>s(I,j)<s(I,v)?j:v)}function _(k,I,L,O){var X=L.v,U=L.w;k.removeEdge(X,U),k.setEdge(O.v,O.w,{}),g(k),d(k,I),R(k,I);}function R(k,I){var L=k.nodes().find(X=>!I.node(X).parent),O=f(k,L);O=O.slice(1),O.forEach(X=>{var U=k.node(X).parent,$=I.edge(X,U),N=false;$||($=I.edge(U,X),N=true),I.node(X).rank=I.node(U).rank+(N?$.minlen:-$.minlen);});}function w(k,I,L){return k.hasEdge(I,L)}function S(k,I,L){return L.low<=I.lim&&I.lim<=L.lim}},{"../util":27,"./feasible-tree":23,"./util":26,"@dagrejs/graphlib":29}],26:[function(n,o,i){let{applyWithChunking:c}=n("../util");o.exports={longestPath:s,slack:l};function s(f){var u={};function h(a){var d=f.node(a);if(Object.hasOwn(u,a))return d.rank;u[a]=true;let m=f.outEdges(a).map(g=>g==null?Number.POSITIVE_INFINITY:h(g.w)-f.edge(g).minlen);var x=c(Math.min,m);return x===Number.POSITIVE_INFINITY&&(x=0),d.rank=x}f.sources().forEach(h);}function l(f,u){return f.node(u.w).rank-f.node(u.v).rank-f.edge(u).minlen}},{"../util":27}],27:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph;o.exports={addBorderNode:g,addDummyNode:s,applyWithChunking:C,asNonCompoundGraph:f,buildLayerMatrix:d,intersectRect:a,mapValues:X,maxRank:_,normalizeRanks:m,notime:S,partition:R,pick:O,predecessorWeights:h,range:L,removeEmptyRanks:x,simplify:l,successorWeights:u,time:w,uniqueId:I,zipObject:U};function s($,N,A,G){for(var v=G;$.hasNode(v);)v=I(G);return A.dummy=N,$.setNode(v,A),v}function l($){let N=new c().setGraph($.graph());return $.nodes().forEach(A=>N.setNode(A,$.node(A))),$.edges().forEach(A=>{let G=N.edge(A.v,A.w)||{weight:0,minlen:1},v=$.edge(A);N.setEdge(A.v,A.w,{weight:G.weight+v.weight,minlen:Math.max(G.minlen,v.minlen)});}),N}function f($){let N=new c({multigraph:$.isMultigraph()}).setGraph($.graph());return $.nodes().forEach(A=>{$.children(A).length||N.setNode(A,$.node(A));}),$.edges().forEach(A=>{N.setEdge(A,$.edge(A));}),N}function u($){let N=$.nodes().map(A=>{let G={};return $.outEdges(A).forEach(v=>{G[v.w]=(G[v.w]||0)+$.edge(v).weight;}),G});return U($.nodes(),N)}function h($){let N=$.nodes().map(A=>{let G={};return $.inEdges(A).forEach(v=>{G[v.v]=(G[v.v]||0)+$.edge(v).weight;}),G});return U($.nodes(),N)}function a($,N){let A=$.x,G=$.y,v=N.x-A,j=N.y-G,W=$.width/2,E=$.height/2;if(!v&&!j)throw new Error("Not possible to find intersection inside of the rectangle");let P,T;return Math.abs(j)*W>Math.abs(v)*E?(j<0&&(E=-E),P=E*v/j,T=E):(v<0&&(W=-W),P=W,T=W*j/v),{x:A+P,y:G+T}}function d($){let N=L(_($)+1).map(()=>[]);return $.nodes().forEach(A=>{let G=$.node(A),v=G.rank;v!==void 0&&(N[v][G.order]=A);}),N}function m($){let N=$.nodes().map(G=>{let v=$.node(G).rank;return v===void 0?Number.MAX_VALUE:v}),A=C(Math.min,N);$.nodes().forEach(G=>{let v=$.node(G);Object.hasOwn(v,"rank")&&(v.rank-=A);});}function x($){let N=$.nodes().map(W=>$.node(W).rank),A=C(Math.min,N),G=[];$.nodes().forEach(W=>{let E=$.node(W).rank-A;G[E]||(G[E]=[]),G[E].push(W);});let v=0,j=$.graph().nodeRankFactor;Array.from(G).forEach((W,E)=>{W===void 0&&E%j!==0?--v:W!==void 0&&v&&W.forEach(P=>$.node(P).rank+=v);});}function g($,N,A,G){let v={width:0,height:0};return arguments.length>=4&&(v.rank=A,v.order=G),s($,"border",v,N)}function p($,N=y){let A=[];for(let G=0;G<$.length;G+=N){let v=$.slice(G,G+N);A.push(v);}return A}let y=65535;function C($,N){if(N.length>y){let A=p(N);return $.apply(null,A.map(G=>$.apply(null,G)))}else return $.apply(null,N)}function _($){let A=$.nodes().map(G=>{let v=$.node(G).rank;return v===void 0?Number.MIN_VALUE:v});return C(Math.max,A)}function R($,N){let A={lhs:[],rhs:[]};return $.forEach(G=>{N(G)?A.lhs.push(G):A.rhs.push(G);}),A}function w($,N){let A=Date.now();try{return N()}finally{console.log($+" time: "+(Date.now()-A)+"ms");}}function S($,N){return N()}let k=0;function I($){var N=++k;return $+(""+N)}function L($,N,A=1){N==null&&(N=$,$=0);let G=j=>j<N;A<0&&(G=j=>N<j);let v=[];for(let j=$;G(j);j+=A)v.push(j);return v}function O($,N){let A={};for(let G of N)$[G]!==void 0&&(A[G]=$[G]);return A}function X($,N){let A=N;return typeof N=="string"&&(A=G=>G[N]),Object.entries($).reduce((G,[v,j])=>(G[v]=A(j,v),G),{})}function U($,N){return $.reduce((A,G,v)=>(A[G]=N[v],A),{})}},{"@dagrejs/graphlib":29}],28:[function(n,o,i){o.exports="1.1.8";},{}],29:[function(n,o,i){var c=n("./lib");o.exports={Graph:c.Graph,json:n("./lib/json"),alg:n("./lib/alg"),version:c.version};},{"./lib":45,"./lib/alg":36,"./lib/json":46}],30:[function(n,o,i){o.exports=c;function c(s){var l={},f=[],u;function h(a){Object.hasOwn(l,a)||(l[a]=true,u.push(a),s.successors(a).forEach(h),s.predecessors(a).forEach(h));}return s.nodes().forEach(function(a){u=[],h(a),u.length&&f.push(u);}),f}},{}],31:[function(n,o,i){o.exports=c;function c(u,h,a){Array.isArray(h)||(h=[h]);var d=u.isDirected()?p=>u.successors(p):p=>u.neighbors(p),m=a==="post"?s:l,x=[],g={};return h.forEach(p=>{if(!u.hasNode(p))throw new Error("Graph does not have node: "+p);m(p,d,g,x);}),x}function s(u,h,a,d){for(var m=[[u,false]];m.length>0;){var x=m.pop();x[1]?d.push(x[0]):Object.hasOwn(a,x[0])||(a[x[0]]=true,m.push([x[0],true]),f(h(x[0]),g=>m.push([g,false])));}}function l(u,h,a,d){for(var m=[u];m.length>0;){var x=m.pop();Object.hasOwn(a,x)||(a[x]=true,d.push(x),f(h(x),g=>m.push(g)));}}function f(u,h){for(var a=u.length;a--;)h(u[a],a,u);return u}},{}],32:[function(n,o,i){var c=n("./dijkstra");o.exports=s;function s(l,f,u){return l.nodes().reduce(function(h,a){return h[a]=c(l,a,f,u),h},{})}},{"./dijkstra":33}],33:[function(n,o,i){var c=n("../data/priority-queue");o.exports=l;var s=()=>1;function l(u,h,a,d){return f(u,String(h),a||s,d||function(m){return u.outEdges(m)})}function f(u,h,a,d){var m={},x=new c,g,p,y=function(C){var _=C.v!==g?C.v:C.w,R=m[_],w=a(C),S=p.distance+w;if(w<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+C+" Weight: "+w);S<R.distance&&(R.distance=S,R.predecessor=g,x.decrease(_,S));};for(u.nodes().forEach(function(C){var _=C===h?0:Number.POSITIVE_INFINITY;m[C]={distance:_},x.add(C,_);});x.size()>0&&(g=x.removeMin(),p=m[g],p.distance!==Number.POSITIVE_INFINITY);)d(g).forEach(y);return m}},{"../data/priority-queue":43}],34:[function(n,o,i){var c=n("./tarjan");o.exports=s;function s(l){return c(l).filter(function(f){return f.length>1||f.length===1&&l.hasEdge(f[0],f[0])})}},{"./tarjan":41}],35:[function(n,o,i){o.exports=s;var c=()=>1;function s(f,u,h){return l(f,u||c,h||function(a){return f.outEdges(a)})}function l(f,u,h){var a={},d=f.nodes();return d.forEach(function(m){a[m]={},a[m][m]={distance:0},d.forEach(function(x){m!==x&&(a[m][x]={distance:Number.POSITIVE_INFINITY});}),h(m).forEach(function(x){var g=x.v===m?x.w:x.v,p=u(x);a[m][g]={distance:p,predecessor:m};});}),d.forEach(function(m){var x=a[m];d.forEach(function(g){var p=a[g];d.forEach(function(y){var C=p[m],_=x[y],R=p[y],w=C.distance+_.distance;w<R.distance&&(R.distance=w,R.predecessor=_.predecessor);});});}),a}},{}],36:[function(n,o,i){o.exports={components:n("./components"),dijkstra:n("./dijkstra"),dijkstraAll:n("./dijkstra-all"),findCycles:n("./find-cycles"),floydWarshall:n("./floyd-warshall"),isAcyclic:n("./is-acyclic"),postorder:n("./postorder"),preorder:n("./preorder"),prim:n("./prim"),tarjan:n("./tarjan"),topsort:n("./topsort")};},{"./components":30,"./dijkstra":33,"./dijkstra-all":32,"./find-cycles":34,"./floyd-warshall":35,"./is-acyclic":37,"./postorder":38,"./preorder":39,"./prim":40,"./tarjan":41,"./topsort":42}],37:[function(n,o,i){var c=n("./topsort");o.exports=s;function s(l){try{c(l);}catch(f){if(f instanceof c.CycleException)return  false;throw f}return  true}},{"./topsort":42}],38:[function(n,o,i){var c=n("./dfs");o.exports=s;function s(l,f){return c(l,f,"post")}},{"./dfs":31}],39:[function(n,o,i){var c=n("./dfs");o.exports=s;function s(l,f){return c(l,f,"pre")}},{"./dfs":31}],40:[function(n,o,i){var c=n("../graph"),s=n("../data/priority-queue");o.exports=l;function l(f,u){var h=new c,a={},d=new s,m;function x(p){var y=p.v===m?p.w:p.v,C=d.priority(y);if(C!==void 0){var _=u(p);_<C&&(a[y]=m,d.decrease(y,_));}}if(f.nodeCount()===0)return h;f.nodes().forEach(function(p){d.add(p,Number.POSITIVE_INFINITY),h.setNode(p);}),d.decrease(f.nodes()[0],0);for(var g=false;d.size()>0;){if(m=d.removeMin(),Object.hasOwn(a,m))h.setEdge(m,a[m]);else {if(g)throw new Error("Input graph is not connected: "+f);g=true;}f.nodeEdges(m).forEach(x);}return h}},{"../data/priority-queue":43,"../graph":44}],41:[function(n,o,i){o.exports=c;function c(s){var l=0,f=[],u={},h=[];function a(d){var m=u[d]={onStack:true,lowlink:l,index:l++};if(f.push(d),s.successors(d).forEach(function(p){Object.hasOwn(u,p)?u[p].onStack&&(m.lowlink=Math.min(m.lowlink,u[p].index)):(a(p),m.lowlink=Math.min(m.lowlink,u[p].lowlink));}),m.lowlink===m.index){var x=[],g;do g=f.pop(),u[g].onStack=false,x.push(g);while(d!==g);h.push(x);}}return s.nodes().forEach(function(d){Object.hasOwn(u,d)||a(d);}),h}},{}],42:[function(n,o,i){function c(l){var f={},u={},h=[];function a(d){if(Object.hasOwn(u,d))throw new s;Object.hasOwn(f,d)||(u[d]=true,f[d]=true,l.predecessors(d).forEach(a),delete u[d],h.push(d));}if(l.sinks().forEach(a),Object.keys(f).length!==l.nodeCount())throw new s;return h}class s extends Error{constructor(){super(...arguments);}}o.exports=c,c.CycleException=s;},{}],43:[function(n,o,i){class c{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(l){return l.key})}has(l){return Object.hasOwn(this._keyIndices,l)}priority(l){var f=this._keyIndices[l];if(f!==void 0)return this._arr[f].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(l,f){var u=this._keyIndices;if(l=String(l),!Object.hasOwn(u,l)){var h=this._arr,a=h.length;return u[l]=a,h.push({key:l,priority:f}),this._decrease(a),true}return  false}removeMin(){this._swap(0,this._arr.length-1);var l=this._arr.pop();return delete this._keyIndices[l.key],this._heapify(0),l.key}decrease(l,f){var u=this._keyIndices[l];if(f>this._arr[u].priority)throw new Error("New priority is greater than current priority. Key: "+l+" Old: "+this._arr[u].priority+" New: "+f);this._arr[u].priority=f,this._decrease(u);}_heapify(l){var f=this._arr,u=2*l,h=u+1,a=l;u<f.length&&(a=f[u].priority<f[a].priority?u:a,h<f.length&&(a=f[h].priority<f[a].priority?h:a),a!==l&&(this._swap(l,a),this._heapify(a)));}_decrease(l){for(var f=this._arr,u=f[l].priority,h;l!==0&&(h=l>>1,!(f[h].priority<u));)this._swap(l,h),l=h;}_swap(l,f){var u=this._arr,h=this._keyIndices,a=u[l],d=u[f];u[l]=d,u[f]=a,h[d.key]=l,h[a.key]=f;}}o.exports=c;},{}],44:[function(n,o,i){var c="\0",s="\0",l="";class f{_isDirected=true;_isMultigraph=false;_isCompound=false;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(g){g&&(this._isDirected=Object.hasOwn(g,"directed")?g.directed:true,this._isMultigraph=Object.hasOwn(g,"multigraph")?g.multigraph:false,this._isCompound=Object.hasOwn(g,"compound")?g.compound:false),this._isCompound&&(this._parent={},this._children={},this._children[s]={});}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(g){return this._label=g,this}graph(){return this._label}setDefaultNodeLabel(g){return this._defaultNodeLabelFn=g,typeof g!="function"&&(this._defaultNodeLabelFn=()=>g),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var g=this;return this.nodes().filter(p=>Object.keys(g._in[p]).length===0)}sinks(){var g=this;return this.nodes().filter(p=>Object.keys(g._out[p]).length===0)}setNodes(g,p){var y=arguments,C=this;return g.forEach(function(_){y.length>1?C.setNode(_,p):C.setNode(_);}),this}setNode(g,p){return Object.hasOwn(this._nodes,g)?(arguments.length>1&&(this._nodes[g]=p),this):(this._nodes[g]=arguments.length>1?p:this._defaultNodeLabelFn(g),this._isCompound&&(this._parent[g]=s,this._children[g]={},this._children[s][g]=true),this._in[g]={},this._preds[g]={},this._out[g]={},this._sucs[g]={},++this._nodeCount,this)}node(g){return this._nodes[g]}hasNode(g){return Object.hasOwn(this._nodes,g)}removeNode(g){var p=this;if(Object.hasOwn(this._nodes,g)){var y=C=>p.removeEdge(p._edgeObjs[C]);delete this._nodes[g],this._isCompound&&(this._removeFromParentsChildList(g),delete this._parent[g],this.children(g).forEach(function(C){p.setParent(C);}),delete this._children[g]),Object.keys(this._in[g]).forEach(y),delete this._in[g],delete this._preds[g],Object.keys(this._out[g]).forEach(y),delete this._out[g],delete this._sucs[g],--this._nodeCount;}return this}setParent(g,p){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(p===void 0)p=s;else {p+="";for(var y=p;y!==void 0;y=this.parent(y))if(y===g)throw new Error("Setting "+p+" as parent of "+g+" would create a cycle");this.setNode(p);}return this.setNode(g),this._removeFromParentsChildList(g),this._parent[g]=p,this._children[p][g]=true,this}_removeFromParentsChildList(g){delete this._children[this._parent[g]][g];}parent(g){if(this._isCompound){var p=this._parent[g];if(p!==s)return p}}children(g=s){if(this._isCompound){var p=this._children[g];if(p)return Object.keys(p)}else {if(g===s)return this.nodes();if(this.hasNode(g))return []}}predecessors(g){var p=this._preds[g];if(p)return Object.keys(p)}successors(g){var p=this._sucs[g];if(p)return Object.keys(p)}neighbors(g){var p=this.predecessors(g);if(p){let C=new Set(p);for(var y of this.successors(g))C.add(y);return Array.from(C.values())}}isLeaf(g){var p;return this.isDirected()?p=this.successors(g):p=this.neighbors(g),p.length===0}filterNodes(g){var p=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});p.setGraph(this.graph());var y=this;Object.entries(this._nodes).forEach(function([R,w]){g(R)&&p.setNode(R,w);}),Object.values(this._edgeObjs).forEach(function(R){p.hasNode(R.v)&&p.hasNode(R.w)&&p.setEdge(R,y.edge(R));});var C={};function _(R){var w=y.parent(R);return w===void 0||p.hasNode(w)?(C[R]=w,w):w in C?C[w]:_(w)}return this._isCompound&&p.nodes().forEach(R=>p.setParent(R,_(R))),p}setDefaultEdgeLabel(g){return this._defaultEdgeLabelFn=g,typeof g!="function"&&(this._defaultEdgeLabelFn=()=>g),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(g,p){var y=this,C=arguments;return g.reduce(function(_,R){return C.length>1?y.setEdge(_,R,p):y.setEdge(_,R),R}),this}setEdge(){var g,p,y,C,_=false,R=arguments[0];typeof R=="object"&&R!==null&&"v"in R?(g=R.v,p=R.w,y=R.name,arguments.length===2&&(C=arguments[1],_=true)):(g=R,p=arguments[1],y=arguments[3],arguments.length>2&&(C=arguments[2],_=true)),g=""+g,p=""+p,y!==void 0&&(y=""+y);var w=a(this._isDirected,g,p,y);if(Object.hasOwn(this._edgeLabels,w))return _&&(this._edgeLabels[w]=C),this;if(y!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(g),this.setNode(p),this._edgeLabels[w]=_?C:this._defaultEdgeLabelFn(g,p,y);var S=d(this._isDirected,g,p,y);return g=S.v,p=S.w,Object.freeze(S),this._edgeObjs[w]=S,u(this._preds[p],g),u(this._sucs[g],p),this._in[p][w]=S,this._out[g][w]=S,this._edgeCount++,this}edge(g,p,y){var C=arguments.length===1?m(this._isDirected,arguments[0]):a(this._isDirected,g,p,y);return this._edgeLabels[C]}edgeAsObj(){let g=this.edge(...arguments);return typeof g!="object"?{label:g}:g}hasEdge(g,p,y){var C=arguments.length===1?m(this._isDirected,arguments[0]):a(this._isDirected,g,p,y);return Object.hasOwn(this._edgeLabels,C)}removeEdge(g,p,y){var C=arguments.length===1?m(this._isDirected,arguments[0]):a(this._isDirected,g,p,y),_=this._edgeObjs[C];return _&&(g=_.v,p=_.w,delete this._edgeLabels[C],delete this._edgeObjs[C],h(this._preds[p],g),h(this._sucs[g],p),delete this._in[p][C],delete this._out[g][C],this._edgeCount--),this}inEdges(g,p){var y=this._in[g];if(y){var C=Object.values(y);return p?C.filter(_=>_.v===p):C}}outEdges(g,p){var y=this._out[g];if(y){var C=Object.values(y);return p?C.filter(_=>_.w===p):C}}nodeEdges(g,p){var y=this.inEdges(g,p);if(y)return y.concat(this.outEdges(g,p))}}function u(x,g){x[g]?x[g]++:x[g]=1;}function h(x,g){--x[g]||delete x[g];}function a(x,g,p,y){var C=""+g,_=""+p;if(!x&&C>_){var R=C;C=_,_=R;}return C+l+_+l+(y===void 0?c:y)}function d(x,g,p,y){var C=""+g,_=""+p;if(!x&&C>_){var R=C;C=_,_=R;}var w={v:C,w:_};return y&&(w.name=y),w}function m(x,g){return a(x,g.v,g.w,g.name)}o.exports=f;},{}],45:[function(n,o,i){o.exports={Graph:n("./graph"),version:n("./version")};},{"./graph":44,"./version":47}],46:[function(n,o,i){var c=n("./graph");o.exports={write:s,read:u};function s(h){var a={options:{directed:h.isDirected(),multigraph:h.isMultigraph(),compound:h.isCompound()},nodes:l(h),edges:f(h)};return h.graph()!==void 0&&(a.value=structuredClone(h.graph())),a}function l(h){return h.nodes().map(function(a){var d=h.node(a),m=h.parent(a),x={v:a};return d!==void 0&&(x.value=d),m!==void 0&&(x.parent=m),x})}function f(h){return h.edges().map(function(a){var d=h.edge(a),m={v:a.v,w:a.w};return a.name!==void 0&&(m.name=a.name),d!==void 0&&(m.value=d),m})}function u(h){var a=new c(h.options).setGraph(h.value);return h.nodes.forEach(function(d){a.setNode(d.v,d.value),d.parent&&a.setParent(d.v,d.parent);}),h.edges.forEach(function(d){a.setEdge({v:d.v,w:d.w,name:d.name},d.value);}),a}},{"./graph":44}],47:[function(n,o,i){o.exports="2.2.4";},{}]},{},[1])(1)});});var Wt={bg:"#FFFFFF",fg:"#27272A"},$t={textSec:60,textMuted:40,textFaint:25,line:30,arrow:50,nodeFill:3,nodeStroke:20,groupHeader:5,innerStroke:12,keyBadge:10},Ee={"zinc-light":{bg:"#FFFFFF",fg:"#27272A"},"zinc-dark":{bg:"#18181B",fg:"#FAFAFA"},"tokyo-night":{bg:"#1a1b26",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-storm":{bg:"#24283b",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-light":{bg:"#d5d6db",fg:"#343b58",line:"#34548a",accent:"#34548a",muted:"#9699a3"},"catppuccin-mocha":{bg:"#1e1e2e",fg:"#cdd6f4",line:"#585b70",accent:"#cba6f7",muted:"#6c7086"},"catppuccin-latte":{bg:"#eff1f5",fg:"#4c4f69",line:"#9ca0b0",accent:"#8839ef",muted:"#9ca0b0"},nord:{bg:"#2e3440",fg:"#d8dee9",line:"#4c566a",accent:"#88c0d0",muted:"#616e88"},"nord-light":{bg:"#eceff4",fg:"#2e3440",line:"#aab1c0",accent:"#5e81ac",muted:"#7b88a1"},dracula:{bg:"#282a36",fg:"#f8f8f2",line:"#6272a4",accent:"#bd93f9",muted:"#6272a4"},"github-light":{bg:"#ffffff",fg:"#1f2328",line:"#d1d9e0",accent:"#0969da",muted:"#59636e"},"github-dark":{bg:"#0d1117",fg:"#e6edf3",line:"#3d444d",accent:"#4493f8",muted:"#9198a1"},"solarized-light":{bg:"#fdf6e3",fg:"#657b83",line:"#93a1a1",accent:"#268bd2",muted:"#93a1a1"},"solarized-dark":{bg:"#002b36",fg:"#839496",line:"#586e75",accent:"#268bd2",muted:"#586e75"},"one-dark":{bg:"#282c34",fg:"#abb2bf",line:"#4b5263",accent:"#c678dd",muted:"#5c6370"}};function Ae(t){let e=t.colors??{},r=t.type==="dark",n=o=>t.tokenColors?.find(i=>Array.isArray(i.scope)?i.scope.includes(o):i.scope===o)?.settings?.foreground;return {bg:e["editor.background"]??(r?"#1e1e1e":"#ffffff"),fg:e["editor.foreground"]??(r?"#d4d4d4":"#333333"),line:e["editorLineNumber.foreground"]??void 0,accent:e.focusBorder??n("keyword")??void 0,muted:n("comment")??e["editorLineNumber.foreground"]??void 0,surface:e["editor.selectionBackground"]??void 0,border:e["editorWidget.border"]??void 0}}function Pt(t,e){let r=[`@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(t)}:wght@400;500;600;700&amp;display=swap');`,...e?["@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');"]:[]],n=`
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${$t.textSec}%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${$t.textMuted}%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) ${$t.textFaint}%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) ${$t.line}%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${$t.arrow}%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${$t.nodeFill}%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${$t.nodeStroke}%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) ${$t.groupHeader}%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) ${$t.innerStroke}%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) ${$t.keyBadge}%, var(--bg));`;return ["<style>",`  ${r.join(`
  `)}`,`  text { font-family: '${t}', system-ui, sans-serif; }`,...e?["  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }"]:[],`  svg {${n}`,"  }","</style>"].join(`
`)}function Dt(t,e,r,n){let o=[`--bg:${r.bg}`,`--fg:${r.fg}`,r.line?`--line:${r.line}`:"",r.accent?`--accent:${r.accent}`:"",r.muted?`--muted:${r.muted}`:"",r.surface?`--surface:${r.surface}`:"",r.border?`--border:${r.border}`:""].filter(Boolean).join(";");return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${e}" width="${t}" height="${e}" style="${o}${n?"":";background:var(--bg)"}">`}function se(t){let e=t.split(/[\n;]/).map(n=>n.trim()).filter(n=>n.length>0&&!n.startsWith("%%"));if(e.length===0)throw new Error("Empty mermaid diagram");let r=e[0];return /^stateDiagram(-v2)?\s*$/i.test(r)?Fr(e):Xr(e)}function Xr(t){let e=t[0].match(/^(?:graph|flowchart)\s+(TD|TB|LR|BT|RL)\s*$/i);if(!e)throw new Error(`Invalid mermaid header: "${t[0]}". Expected "graph TD", "flowchart LR", "stateDiagram-v2", etc.`);let n={direction:e[1].toUpperCase(),nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},o=[];for(let i=1;i<t.length;i++){let c=t[i],s=c.match(/^classDef\s+(\w+)\s+(.+)$/);if(s){let a=s[1],d=s[2],m=nn(d);n.classDefs.set(a,m);continue}let l=c.match(/^class\s+([^\s]+)\s+(\w+)$/);if(l){let a=l[1].split(",").map(m=>m.trim()),d=l[2];for(let m of a)n.classAssignments.set(m,d);continue}let f=c.match(/^style\s+([^\s]+)\s+(.+)$/);if(f){let a=f[1].split(",").map(m=>m.trim()),d=nn(f[2]);for(let m of a)n.nodeStyles.set(m,{...n.nodeStyles.get(m),...d});continue}let u=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(u&&o.length>0){o[o.length-1].direction=u[1].toUpperCase();continue}let h=c.match(/^subgraph\s+(.+)$/);if(h){let a=h[1].trim(),d=a.match(/^([\p{L}\p{N}_-]+)\s*\[(.+)\]$/u),m,x;d?(m=d[1],x=d[2]):(x=a,m=a.replace(/\s+/g,"_").replace(/[^\p{L}\p{N}_]/gu,""));let g={id:m,label:x,nodeIds:[],children:[]};o.push(g);continue}if(c==="end"){let a=o.pop();a&&(o.length>0?o[o.length-1].children.push(a):n.subgraphs.push(a));continue}jr(c,n,o);}return n}function Fr(t){let e={direction:"TD",nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},r=[],n=0,o=0;for(let i=1;i<t.length;i++){let c=t[i],s=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(s){r.length>0?r[r.length-1].direction=s[1].toUpperCase():e.direction=s[1].toUpperCase();continue}let l=c.match(/^state\s+(?:"([^"]+)"\s+as\s+)?([\p{L}\p{N}_-]+)\s*\{$/u);if(l){let a=l[1]??l[2],m={id:l[2],label:a,nodeIds:[],children:[]};r.push(m);continue}if(c==="}"){let a=r.pop();a&&(r.length>0?r[r.length-1].children.push(a):e.subgraphs.push(a));continue}let f=c.match(/^state\s+"([^"]+)"\s+as\s+([\p{L}\p{N}_-]+)\s*$/u);if(f){let a=f[1],d=f[2];ie(e,r,{id:d,label:a,shape:"rounded"});continue}let u=c.match(/^(\[\*\]|[\p{L}\p{N}_-]+)\s*(-->)\s*(\[\*\]|[\p{L}\p{N}_-]+)(?:\s*:\s*(.+))?$/u);if(u){let a=u[1],d=u[3],m=u[4]?.trim()||void 0;a==="[*]"?(n++,a=`_start${n>1?n:""}`,ie(e,r,{id:a,label:"",shape:"state-start"})):en(e,r,a),d==="[*]"?(o++,d=`_end${o>1?o:""}`,ie(e,r,{id:d,label:"",shape:"state-end"})):en(e,r,d),e.edges.push({source:a,target:d,label:m,style:"solid",hasArrowStart:false,hasArrowEnd:true});continue}let h=c.match(/^([\p{L}\p{N}_-]+)\s*:\s*(.+)$/u);if(h){let a=h[1],d=h[2].trim();ie(e,r,{id:a,label:d,shape:"rounded"});continue}}return e}function ie(t,e,r){if(!t.nodes.has(r.id)&&t.nodes.set(r.id,r),e.length>0){let o=e[e.length-1];o.nodeIds.includes(r.id)||o.nodeIds.push(r.id);}}function en(t,e,r){if(!t.nodes.has(r))ie(t,e,{id:r,label:r,shape:"rounded"});else if(e.length>0){let n=e[e.length-1];n.nodeIds.includes(r)||n.nodeIds.push(r);}}function nn(t){let e={};for(let r of t.split(",")){let n=r.indexOf(":");if(n>0){let o=r.slice(0,n).trim(),i=r.slice(n+1).trim();o&&i&&(e[o]=i);}}return e}var an=/^(<)?(-->|-.->|==>|---|-\.-|===)(?:\|([^|]*)\|)?/,Yr=[{regex:/^([\p{L}\p{N}_-]+)\(\(\((.+?)\)\)\)/u,shape:"doublecircle"},{regex:/^([\p{L}\p{N}_-]+)\(\[(.+?)\]\)/u,shape:"stadium"},{regex:/^([\p{L}\p{N}_-]+)\(\((.+?)\)\)/u,shape:"circle"},{regex:/^([\p{L}\p{N}_-]+)\[\[(.+?)\]\]/u,shape:"subroutine"},{regex:/^([\p{L}\p{N}_-]+)\[\((.+?)\)\]/u,shape:"cylinder"},{regex:/^([\p{L}\p{N}_-]+)\[\/(.+?)\\\]/u,shape:"trapezoid"},{regex:/^([\p{L}\p{N}_-]+)\[\\(.+?)\/\]/u,shape:"trapezoid-alt"},{regex:/^([\p{L}\p{N}_-]+)>(.+?)\]/u,shape:"asymmetric"},{regex:/^([\p{L}\p{N}_-]+)\{\{(.+?)\}\}/u,shape:"hexagon"},{regex:/^([\p{L}\p{N}_-]+)\[(.+?)\]/u,shape:"rectangle"},{regex:/^([\p{L}\p{N}_-]+)\((.+?)\)/u,shape:"rounded"},{regex:/^([\p{L}\p{N}_-]+)\{(.+?)\}/u,shape:"diamond"}],cn=/^([\p{L}\p{N}_-]+)/u,Wr=/^:::([\w][\w-]*)/;function Hr(t){let e=t.trim();return e.length>=2&&e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1).replaceAll('\\"','"'):t}function jr(t,e,r){let n=t.trim(),o=rn(n,e,r);if(!o||o.ids.length===0)return;n=o.remaining.trim();let i=o.ids;for(;n.length>0;){let c=n.match(an);if(!c)break;let s=!!c[1],l=c[2],f=c[3]?.trim()||void 0;n=n.slice(c[0].length).trim();let u=zr(l),h=l.endsWith(">"),a=rn(n,e,r);if(!a||a.ids.length===0)break;n=a.remaining.trim();for(let d of i)for(let m of a.ids)e.edges.push({source:d,target:m,label:f,style:u,hasArrowStart:s,hasArrowEnd:h});i=a.ids;}}function rn(t,e,r){let n=on(t,e,r);if(!n)return null;let o=[n.id],i=n.remaining.trim();for(;i.startsWith("&");){i=i.slice(1).trim();let c=on(i,e,r);if(!c)break;o.push(c.id),i=c.remaining.trim();}return {ids:o,remaining:i}}function on(t,e,r){let n=null,o=t;for(let{regex:c,shape:s}of Yr){let l=t.match(c);if(l){n=l[1];let f=Hr(l[2]);sn(e,r,{id:n,label:f,shape:s}),o=t.slice(l[0].length);break}}if(n===null){let c=t.match(cn);if(c){let s=c[1],l=Ur(t,s.length);n=t.slice(0,l),e.nodes.has(n)?ln(r,n):sn(e,r,{id:n,label:n,shape:"rectangle"}),o=t.slice(l);}}if(n===null)return null;let i=o.match(Wr);return i&&(e.classAssignments.set(n,i[1]),o=o.slice(i[0].length)),{id:n,remaining:o}}function Ur(t,e){for(let r=e;r>=1;r--){let n=t.slice(r),o=n.match(an);if(!o)continue;let i=n.slice(o[0].length).trimStart();if(i.length!==0&&cn.test(i))return r}for(let r=e;r>=1;r--){let n=t.slice(r);if(n.length===0)return r;let o=n[0];if(/\s/.test(o)||o==="&"||n.startsWith(":::"))return r}return Math.max(1,e)}function sn(t,e,r){!t.nodes.has(r.id)&&t.nodes.set(r.id,r),ln(e,r.id);}function ln(t,e){if(t.length>0){let r=t[t.length-1];r.nodeIds.includes(e)||r.nodeIds.push(e);}}function zr(t){return t==="-.->"||t==="-.-"?"dotted":t==="==>"||t==="==="?"thick":"solid"}var ot={x:1,y:0},tt={x:1,y:2},it={x:0,y:1},et={x:2,y:1},bt={x:2,y:0},gt={x:0,y:0},wt={x:2,y:2},yt={x:0,y:2},Ht={x:1,y:1};function Nt(t,e){return t.x===e.x&&t.y===e.y}function _e(t,e){return t.x===e.x&&t.y===e.y}function Gt(t,e){return {x:t.x+e.x,y:t.y+e.y}}function Le(t){return `${t.x},${t.y}`}var dn={name:"",styles:{}};function Vr(t){return t>=768&&t<=879||t>=6832&&t<=6911||t>=7616&&t<=7679||t>=8400&&t<=8447||t>=65056&&t<=65071}function qr(t){return t>=4352&&t<=4447||t>=11904&&t<=42191||t>=44032&&t<=55203||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65135||t>=65280&&t<=65376||t>=65504&&t<=65510||t>=127744&&t<=129791||t>=129280&&t<=129535}function jt(t){let e=t.codePointAt(0);return e==null||e===0||e<32||e>=127&&e<160||Vr(e)?0:qr(e)?2:1}function at(t){let e=0;for(let r of t)e+=jt(r);return e}function ae(t,e){if(e<=0)return "";let r=0,n="";for(let o of t){let i=jt(o);if(r+i>e)break;n+=o,r+=i;}return n}function ut(t,e){let r=[];for(let n=0;n<=t;n++){let o=[];for(let i=0;i<=e;i++)o.push(" ");r.push(o);}return r}function Bt(t){let[e,r]=Ct(t);return ut(e,r)}function Ct(t){return [t.length-1,(t[0]?.length??1)-1]}function Ut(t,e,r){let[n,o]=Ct(t),i=Math.max(e,n),c=Math.max(r,o),s=ut(i,c);for(let l=0;l<s.length;l++)for(let f=0;f<s[0].length;f++)l<t.length&&f<t[0].length&&(s[l][f]=t[l][f]);return t.length=0,t.push(...s),t}var Kr=new Set(["\u2500","\u2502","\u250C","\u2510","\u2514","\u2518","\u251C","\u2524","\u252C","\u2534","\u253C","\u2574","\u2575","\u2576","\u2577"]);function un(t){return Kr.has(t)}var Jr={"\u2500":{"\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u2534"},"\u2502":{"\u2500":"\u253C","\u250C":"\u251C","\u2510":"\u2524","\u2514":"\u251C","\u2518":"\u2524","\u251C":"\u251C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u253C"},"\u250C":{"\u2500":"\u252C","\u2502":"\u251C","\u2510":"\u252C","\u2514":"\u251C","\u2518":"\u253C","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u253C"},"\u2510":{"\u2500":"\u252C","\u2502":"\u2524","\u250C":"\u252C","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u252C","\u2534":"\u253C"},"\u2514":{"\u2500":"\u2534","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2518":"\u2534","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u2534"},"\u2518":{"\u2500":"\u2534","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u2534","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u2534"},"\u251C":{"\u2500":"\u253C","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2514":"\u251C","\u2518":"\u253C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u2524":{"\u2500":"\u253C","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u252C":{"\u2500":"\u252C","\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u253C","\u2518":"\u253C","\u251C":"\u253C","\u2524":"\u253C","\u2534":"\u253C"},"\u2534":{"\u2500":"\u2534","\u2502":"\u253C","\u250C":"\u253C","\u2510":"\u253C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u253C"}};function Zr(t,e){return Jr[t]?.[e]??t}function Et(t,e,r,...n){let[o,i]=Ct(t);for(let s of n){let[l,f]=Ct(s);o=Math.max(o,l+e.x),i=Math.max(i,f+e.y);}let c=ut(o,i);for(let s=0;s<=o;s++)for(let l=0;l<=i;l++)s<t.length&&l<t[0].length&&(c[s][l]=t[s][l]);for(let s of n)for(let l=0;l<s.length;l++)for(let f=0;f<s[0].length;f++){let u=s[l][f];if(u!==" "){let h=l+e.x,a=f+e.y,d=c[h][a];!r&&un(u)&&un(d)?c[h][a]=Zr(d,u):c[h][a]=u;}}return c}function Qr(t){return t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u2524"||t==="\u2510"||t==="\u2518"}function to(t){return t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u250C"||t==="\u2514"}function eo(t){return t==="\u2502"||t==="\u253C"||t==="\u251C"||t==="\u2524"||t==="\u2534"||t==="\u2514"||t==="\u2518"}function no(t){return t==="\u2502"||t==="\u253C"||t==="\u251C"||t==="\u2524"||t==="\u252C"||t==="\u250C"||t==="\u2510"}function fn(t){let[e,r]=Ct(t);for(let n=0;n<=e;n++)for(let o=0;o<=r;o++){if(t[n][o]!=="\u253C")continue;let i=n>0?t[n-1][o]:" ",c=n<e?t[n+1][o]:" ",s=o>0?t[n][o-1]:" ",l=o<r?t[n][o+1]:" ",f=(to(i)?1:0)+(Qr(c)?1:0),u=(no(s)?1:0)+(eo(l)?1:0);t[n][o]=u>f?"\u2502":"\u2500";}}function At(t){let[e,r]=Ct(t),n=[];for(let o=0;o<=r;o++){let i="";for(let c=0;c<=e;c++){let s=t[c][o];i+=s,jt(s)===2&&(c+=1);}n.push(i);}return n.join(`
`)}var ro={"\u25B2":"\u25BC","\u25BC":"\u25B2","\u25E4":"\u25E3","\u25E3":"\u25E4","\u25E5":"\u25E2","\u25E2":"\u25E5","^":"v",v:"^","\u250C":"\u2514","\u2514":"\u250C","\u2510":"\u2518","\u2518":"\u2510","\u252C":"\u2534","\u2534":"\u252C","\u2575":"\u2577","\u2577":"\u2575"};function hn(t){for(let e of t)e.reverse();for(let e of t)for(let r=0;r<e.length;r++){let n=ro[e[r]];n&&(e[r]=n);}return t}function ht(t,e,r){Ut(t,e.x+at(r),e.y);let n=e.x;for(let o of r)t[n][e.y]=o,n+=jt(o);}function mn(t,e,r){let n=0,o=0;for(let i of e.values())n+=i;for(let i of r.values())o+=i;Ut(t,n-1,o-1);}function pn(t,e){let r=new Map,n=0;for(let[s,l]of t.nodes){let f={name:s,displayLabel:l.label,index:n,gridCoord:null,drawingCoord:null,drawing:null,drawn:false,styleClassName:"",styleClass:dn};r.set(s,f),n++;}let o=[...r.values()],i=[];for(let s of t.edges){let l=r.get(s.source),f=r.get(s.target);!l||!f||i.push({from:l,to:f,text:s.label??"",path:[],labelLine:[],startDir:{x:0,y:0},endDir:{x:0,y:0}});}let c=[];for(let s of t.subgraphs)gn(s,null,r,c);oo(t.subgraphs,c,r);for(let[s,l]of t.classAssignments){let f=r.get(s),u=t.classDefs.get(l);f&&u&&(f.styleClassName=l,f.styleClass={name:l,styles:u});}return {nodes:o,edges:i,canvas:ut(0,0),grid:new Map,columnWidth:new Map,rowHeight:new Map,subgraphs:c,config:e,offsetX:0,offsetY:0}}function gn(t,e,r,n){let o={name:t.label,nodes:[],parent:e,children:[],minX:0,minY:0,maxX:0,maxY:0};for(let i of t.nodeIds){let c=r.get(i);c&&o.nodes.push(c);}n.push(o);for(let i of t.children){let c=gn(i,o,r,n);o.children.push(c);for(let s of c.nodes)o.nodes.includes(s)||o.nodes.push(s);}return o}function oo(t,e,r,n){let o=new Map;so(t,e,o);let i=new Map;function c(s){let l=o.get(s);if(l){for(let f of s.children)c(f);for(let f of s.nodeIds)i.has(f)||i.set(f,l);}}for(let s of t)c(s);for(let s of e)s.nodes=s.nodes.filter(l=>{let f;for(let[h,a]of r)if(a===l){f=h;break}if(!f)return  false;let u=i.get(f);return u?io(s,u):true});}function io(t,e){let r=e;for(;r!==null;){if(r===t)return  true;r=r.parent;}return  false}function so(t,e,r){let n=[];function o(i){for(let c of i)n.push(c),o(c.children);}o(t);for(let i=0;i<n.length&&i<e.length;i++)r.set(n[i],e[i]);}var Ie=class{idxs=[];priorities=[];costs=[];poppedIdx=-1;poppedPriority=0;poppedCost=0;get length(){return this.idxs.length}clear(){this.idxs.length=0,this.priorities.length=0,this.costs.length=0,this.poppedIdx=-1,this.poppedPriority=0,this.poppedCost=0;}push(e,r,n){this.idxs.push(e),this.priorities.push(r),this.costs.push(n),this.bubbleUp(this.idxs.length-1);}pop(){if(this.idxs.length===0)return  false;this.poppedIdx=this.idxs[0],this.poppedPriority=this.priorities[0],this.poppedCost=this.costs[0];let e=this.idxs.pop(),r=this.priorities.pop(),n=this.costs.pop();return this.idxs.length>0&&(this.idxs[0]=e,this.priorities[0]=r,this.costs[0]=n,this.sinkDown(0)),true}bubbleUp(e){for(;e>0;){let r=e-1>>1;if(this.priorities[e]<this.priorities[r])[this.idxs[e],this.idxs[r]]=[this.idxs[r],this.idxs[e]],[this.priorities[e],this.priorities[r]]=[this.priorities[r],this.priorities[e]],[this.costs[e],this.costs[r]]=[this.costs[r],this.costs[e]],e=r;else break}}sinkDown(e){let r=this.idxs.length;for(;;){let n=e,o=2*e+1,i=2*e+2;if(o<r&&this.priorities[o]<this.priorities[n]&&(n=o),i<r&&this.priorities[i]<this.priorities[n]&&(n=i),n!==e)[this.idxs[e],this.idxs[n]]=[this.idxs[n],this.idxs[e]],[this.priorities[e],this.priorities[n]]=[this.priorities[n],this.priorities[e]],[this.costs[e],this.costs[n]]=[this.costs[n],this.costs[e]],e=n;else break}}};function xn(t,e){let r=t*e;return {stride:t,height:e,blocked:new Uint8Array(r),stamp:0,costStamp:new Uint32Array(r),costSoFar:new Float64Array(r),cameFrom:new Int32Array(r),heap:new Ie}}function _t(t,e){return e.x+e.y*t}function bn(t,e){let r=e/t|0;return {x:e-r*t,y:r}}function Jt(t,e){if(t.length<=2)return t.length;let r=0,n=t[1]-t[0];for(let o=2;o<t.length;o++){let i=t[o]-t[o-1];i!==n&&(r++,n=i);}return 2+r}function yn(t,e){if(t.length<=2)return t;let r=[t[0]],n=t[1]-t[0];for(let o=2;o<t.length;o++){let i=t[o]-t[o-1];i!==n&&(r.push(t[o-1]),n=i);}return r.push(t[t.length-1]),r}function wn(t,e,r,n){let o=globalThis.__bm_getPath;if(typeof o=="function")return o(t.stride,e,r,n.maxX,n.maxY,t.blocked);let{stride:i}=t,c=n.maxX,s=n.maxY;if(c<0||s<0)return null;let l=r/i|0,f=r-l*i;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let u=t.stamp;for(t.heap.clear(),t.costStamp[e]=u,t.costSoFar[e]=0,t.cameFrom[e]=-1,t.heap.push(e,0,0);t.heap.pop();){let h=t.heap.poppedIdx,a=t.heap.poppedCost;if(t.costStamp[h]!==u||a!==t.costSoFar[h])continue;if(h===r){let g=[],p=h;for(;p!==-1;)g.push(p),p=t.cameFrom[p];return g.reverse(),g}let d=t.costSoFar[h],m=h/i|0,x=h-m*i;if(x<c){let g=h+1;if(!t.blocked[g]||g===r){let p=d+1;if(t.costStamp[g]!==u||p<t.costSoFar[g]){t.costStamp[g]=u,t.costSoFar[g]=p,t.cameFrom[g]=h;let y=x+1>=f?x+1-f:f-(x+1),C=m>=l?m-l:l-m,_=y===0||C===0?y+C:y+C+1;t.heap.push(g,p+_,p);}}}if(x>0){let g=h-1;if(!t.blocked[g]||g===r){let p=d+1;if(t.costStamp[g]!==u||p<t.costSoFar[g]){t.costStamp[g]=u,t.costSoFar[g]=p,t.cameFrom[g]=h;let y=x-1>=f?x-1-f:f-(x-1),C=m>=l?m-l:l-m,_=y===0||C===0?y+C:y+C+1;t.heap.push(g,p+_,p);}}}if(m<s){let g=h+i;if(!t.blocked[g]||g===r){let p=d+1;if(t.costStamp[g]!==u||p<t.costSoFar[g]){t.costStamp[g]=u,t.costSoFar[g]=p,t.cameFrom[g]=h;let y=x>=f?x-f:f-x,C=m+1>=l?m+1-l:l-(m+1),_=y===0||C===0?y+C:y+C+1;t.heap.push(g,p+_,p);}}}if(m>0){let g=h-i;if(!t.blocked[g]||g===r){let p=d+1;if(t.costStamp[g]!==u||p<t.costSoFar[g]){t.costStamp[g]=u,t.costSoFar[g]=p,t.cameFrom[g]=h;let y=x>=f?x-f:f-x,C=m-1>=l?m-1-l:l-(m-1),_=y===0||C===0?y+C:y+C+1;t.heap.push(g,p+_,p);}}}}return null}var zt=1,Vt=2,qt=4,Kt=8;function Cn(t,e,r,n,o){let i=globalThis.__bm_getPathStrict;if(typeof i=="function")return i(t.stride,e,r,n.maxX,n.maxY,t.blocked,o);let c=t.stride,s=n.maxX,l=n.maxY;if(s<0||l<0)return null;let f=r/c|0,u=r-f*c;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let h=t.stamp,a=t.heap,d=t.blocked,m=t.costStamp,x=t.costSoFar,g=t.cameFrom;a.clear(),m[e]=h,x[e]=0,g[e]=-1,a.push(e,0,0);let p=o.usedPoints,y=o.segmentUsage,C=y.segmentUsed,_=y.usedAsMiddle,R=y.startSource,w=y.startSourceMulti,S=y.endTarget,k=y.endTargetMulti,I=o.routeFromIdx,L=o.routeToIdx,O=o.edgeFromId,X=o.edgeToId,U=zt|Vt,$=qt|Kt;for(;a.pop();){let N=a.poppedIdx,A=a.poppedCost;if(m[N]!==h||A!==x[N])continue;if(N===r){let W=[],E=N;for(;E!==-1;)W.push(E),E=g[E];return W.reverse(),W}let G=x[N],v=N/c|0,j=N-v*c;if(j<s){let W=N+1;if(!d[W]||W===r){let E=true;if(p){let P=p[N];if(P!==0){let T=P|Vt;(T&U)===U&&(T&$)===$&&(E=false);}if(E){let T=p[W];if(T!==0){let F=T|zt;(F&U)===U&&(F&$)===$&&(E=false);}}}if(E){let P=N*2;if(C[P]&&(E=false,!_[P])){let T=N===I,F=W===L,H=R[P],V=S[P],z=w[P]!==0,B=k[P]!==0;T&&F?E=!z&&(H===0||H===O)&&(!B&&(V===0||V===X)):T?E=!B&&V===0&&!z&&H===O:F&&(E=!z&&H===0&&!B&&V===X);}}if(E){let P=G+1;if(m[W]!==h||P<x[W]){m[W]=h,x[W]=P,g[W]=N;let T=j+1,F=T>=u?T-u:u-T,H=v>=f?v-f:f-v,V=F===0||H===0?F+H:F+H+1;a.push(W,P+V,P);}}}}if(j>0){let W=N-1;if(!d[W]||W===r){let E=true;if(p){let P=p[N];if(P!==0){let T=P|zt;(T&U)===U&&(T&$)===$&&(E=false);}if(E){let T=p[W];if(T!==0){let F=T|Vt;(F&U)===U&&(F&$)===$&&(E=false);}}}if(E){let P=W*2;if(C[P]&&(E=false,!_[P])){let T=N===I,F=W===L,H=R[P],V=S[P],z=w[P]!==0,B=k[P]!==0;T&&F?E=!z&&(H===0||H===O)&&(!B&&(V===0||V===X)):T?E=!B&&V===0&&!z&&H===O:F&&(E=!z&&H===0&&!B&&V===X);}}if(E){let P=G+1;if(m[W]!==h||P<x[W]){m[W]=h,x[W]=P,g[W]=N;let T=j-1,F=T>=u?T-u:u-T,H=v>=f?v-f:f-v,V=F===0||H===0?F+H:F+H+1;a.push(W,P+V,P);}}}}if(v<l){let W=N+c;if(!d[W]||W===r){let E=true;if(p){let P=p[N];if(P!==0){let T=P|Kt;(T&U)===U&&(T&$)===$&&(E=false);}if(E){let T=p[W];if(T!==0){let F=T|qt;(F&U)===U&&(F&$)===$&&(E=false);}}}if(E){let P=N*2+1;if(C[P]&&(E=false,!_[P])){let T=N===I,F=W===L,H=R[P],V=S[P],z=w[P]!==0,B=k[P]!==0;T&&F?E=!z&&(H===0||H===O)&&(!B&&(V===0||V===X)):T?E=!B&&V===0&&!z&&H===O:F&&(E=!z&&H===0&&!B&&V===X);}}if(E){let P=G+1;if(m[W]!==h||P<x[W]){m[W]=h,x[W]=P,g[W]=N;let T=v+1,F=j>=u?j-u:u-j,H=T>=f?T-f:f-T,V=F===0||H===0?F+H:F+H+1;a.push(W,P+V,P);}}}}if(v>0){let W=N-c;if(!d[W]||W===r){let E=true;if(p){let P=p[N];if(P!==0){let T=P|qt;(T&U)===U&&(T&$)===$&&(E=false);}if(E){let T=p[W];if(T!==0){let F=T|Kt;(F&U)===U&&(F&$)===$&&(E=false);}}}if(E){let P=W*2+1;if(C[P]&&(E=false,!_[P])){let T=N===I,F=W===L,H=R[P],V=S[P],z=w[P]!==0,B=k[P]!==0;T&&F?E=!z&&(H===0||H===O)&&(!B&&(V===0||V===X)):T?E=!B&&V===0&&!z&&H===O:F&&(E=!z&&H===0&&!B&&V===X);}}if(E){let P=G+1;if(m[W]!==h||P<x[W]){m[W]=h,x[W]=P,g[W]=N;let T=v-1,F=j>=u?j-u:u-j,H=T>=f?T-f:f-T,V=F===0||H===0?F+H:F+H+1;a.push(W,P+V,P);}}}}}return null}var ao=1;function vn(t,e,r,n,o){let i=globalThis.__bm_getPathRelaxed;if(typeof i=="function")return i(t.stride,e,r,n.maxX,n.maxY,t.blocked,o);let c=t.stride,s=n.maxX,l=n.maxY;if(s<0||l<0)return null;let f=r/c|0,u=r-f*c;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let h=t.stamp,a=t.heap,d=t.blocked,m=t.costStamp,x=t.costSoFar,g=t.cameFrom;a.clear(),m[e]=h,x[e]=0,g[e]=-1,a.push(e,0,0);let p=o.usedPoints,y=o.segmentUsage,C=y.segmentUsed,_=y.usedAsMiddle,R=y.startSource,w=y.startSourceMulti,S=y.endTarget,k=y.endTargetMulti,I=o.routeFromIdx,L=o.routeToIdx,O=o.edgeFromId,X=o.edgeToId,U=o.relaxedAllowEndSegmentReuse===true,$=zt|Vt,N=qt|Kt;function A(v,j){if(v===0)return 0;let W=v|j;return (W&$)===$&&(W&N)===N?ao:0}function G(v,j,W){if(!C[v])return  true;if(_[v]||W&&!U)return  false;let E=R[v],P=S[v],T=w[v]!==0,F=k[v]!==0;return j&&W?!T&&(E===0||E===O)&&(!F&&(P===0||P===X)):j?!F&&P===0&&!T&&E===O:W?!T&&E===0&&!F&&P===X:false}for(;a.pop();){let v=a.poppedIdx,j=a.poppedCost;if(m[v]!==h||j!==x[v])continue;if(v===r){let T=[],F=v;for(;F!==-1;)T.push(F),F=g[F];return T.reverse(),{path:T,cost:x[v]}}let W=x[v],E=v/c|0,P=v-E*c;if(P<s){let T=v+1;if(!d[T]||T===r){let F=0;p&&(F+=A(p[v],Vt),F+=A(p[T],zt));let H=v*2;if(G(H,v===I,T===L)){let V=W+1+F;if(m[T]!==h||V<x[T]){m[T]=h,x[T]=V,g[T]=v;let z=P+1,B=z>=u?z-u:u-z,b=E>=f?E-f:f-E,M=B===0||b===0?B+b:B+b+1;a.push(T,V+M,V);}}}}if(P>0){let T=v-1;if(!d[T]||T===r){let F=0;p&&(F+=A(p[v],zt),F+=A(p[T],Vt));let H=T*2;if(G(H,v===I,T===L)){let V=W+1+F;if(m[T]!==h||V<x[T]){m[T]=h,x[T]=V,g[T]=v;let z=P-1,B=z>=u?z-u:u-z,b=E>=f?E-f:f-E,M=B===0||b===0?B+b:B+b+1;a.push(T,V+M,V);}}}}if(E<l){let T=v+c;if(!d[T]||T===r){let F=0;p&&(F+=A(p[v],Kt),F+=A(p[T],qt));let H=v*2+1;if(G(H,v===I,T===L)){let V=W+1+F;if(m[T]!==h||V<x[T]){m[T]=h,x[T]=V,g[T]=v;let z=E+1,B=P>=u?P-u:u-P,b=z>=f?z-f:f-z,M=B===0||b===0?B+b:B+b+1;a.push(T,V+M,V);}}}}if(E>0){let T=v-c;if(!d[T]||T===r){let F=0;p&&(F+=A(p[v],qt),F+=A(p[T],Kt));let H=T*2+1;if(G(H,v===I,T===L)){let V=W+1+F;if(m[T]!==h||V<x[T]){m[T]=h,x[T]=V,g[T]=v;let z=E-1,B=P>=u?P-u:u-P,b=z>=f?z-f:f-z,M=B===0||b===0?B+b:B+b+1;a.push(T,V+M,V);}}}}}return null}function Te(t){if(t.length<=2)return t;let e=new Set,r=t[0],n=t[1];for(let o=2;o<t.length;o++){let i=t[o],c=n.x-r.x,s=n.y-r.y,l=i.x-n.x,f=i.y-n.y;c===l&&s===f&&e.add(o-1),r=n,n=i;}return t.filter((o,i)=>!e.has(i))}var Lt=[12,24,48],kt=[12,24,48,96,192,384],Ne=kt[kt.length-1];function fe(t){return t===ot?tt:t===tt?ot:t===it?et:t===et?it:t===bt?yt:t===gt?wt:t===wt?gt:t===yt?bt:Ht}function q(t,e){return t.x===e.x&&t.y===e.y}function vt(t,e){return t.x===e.x?t.y<e.y?tt:ot:t.y===e.y?t.x<e.x?et:it:t.x<e.x?t.y<e.y?wt:bt:t.y<e.y?yt:gt}function co(t){return t==="LR"?[et,tt,tt,et]:[tt,et,et,tt]}function lo(t,e){if(t.from===t.to)return co(e);let r=vt(t.from.gridCoord,t.to.gridCoord),n,o,i,c,s=e==="LR"?q(r,it)||q(r,gt)||q(r,yt):q(r,ot)||q(r,gt)||q(r,bt);return q(r,wt)?e==="LR"?(n=tt,o=it,i=et,c=ot):(n=et,o=ot,i=tt,c=it):q(r,bt)?e==="LR"?(n=ot,o=it,i=et,c=tt):(n=et,o=tt,i=ot,c=it):q(r,yt)?e==="LR"?(n=tt,o=tt,i=it,c=ot):(n=it,o=ot,i=tt,c=et):q(r,gt)?e==="LR"?(n=tt,o=tt,i=it,c=tt):(n=et,o=et,i=ot,c=et):s?e==="LR"&&q(r,it)?(n=tt,o=tt,i=it,c=et):e==="TD"&&q(r,ot)?(n=et,o=et,i=ot,c=tt):(n=r,o=fe(r),i=r,c=fe(r)):(n=r,o=fe(r),i=r,c=fe(r)),[n,o,i,c]}function En(t){let e=t*2;return {segmentUsed:new Uint8Array(e),usedAsMiddle:new Uint8Array(e),startSource:new Uint32Array(e),startSourceMulti:new Uint8Array(e),endTarget:new Uint32Array(e),endTargetMulti:new Uint8Array(e),usedCount:0}}var Pe=1,De=2,Re=4,Oe=8;function An(t,e){let r=e-t,n=r===1||r===-1;return (t<e?t:e)*2+(n?0:1)}function Sn(t,e,r){if(r.length<2)return;let n=e.from.index+1,o=e.to.index+1;for(let i=1;i<r.length;i++){let c=r[i-1],s=r[i],l=An(c,s),f=i===1,u=i===r.length-1;if(t.segmentUsed[l]||(t.segmentUsed[l]=1,t.usedCount++),f){let h=t.startSource[l];h===0?t.startSource[l]=n:h!==n&&(t.startSourceMulti[l]=1);}if(u){let h=t.endTarget[l];h===0?t.endTarget[l]=o:h!==o&&(t.endTargetMulti[l]=1);}!f&&!u&&(t.usedAsMiddle[l]=1);}}function _n(t,e,r){let n=e-t;return n===1?{fromBit:De,toBit:Pe}:n===-1?{fromBit:Pe,toBit:De}:n===r?{fromBit:Oe,toBit:Re}:n===-r?{fromBit:Re,toBit:Oe}:null}function kn(t,e,r){if(r.length<2)return;let n=e.stride;for(let o=1;o<r.length;o++){let i=r[o-1],c=r[o],s=_n(i,c,n);s&&(e.blocked[i]||(t[i]=t[i]|s.fromBit),e.blocked[c]||(t[c]=t[c]|s.toBit));}}function Mn(t,e){let r=t|e,n=(r&Pe)!==0&&(r&De)!==0,o=(r&Re)!==0&&(r&Oe)!==0;return n&&o}function uo(t,e,r,n){if(!e)return  true;let o=_n(r,n,t.stride);if(!o)return  true;if(!t.blocked[r]){let i=e[r];if(i!==0&&Mn(i,o.fromBit))return  false}if(!t.blocked[n]){let i=e[n];if(i!==0&&Mn(i,o.toBit))return  false}return  true}function fo(t,e,r,n,o,i,c,s){if(t.usedAsMiddle[s])return  false;let l=i===n,f=c===o,u=t.startSource[s],h=t.endTarget[s],a=t.startSourceMulti[s]!==0,d=t.endTargetMulti[s]!==0;return l&&f?!a&&(u===0||u===e)&&(!d&&(h===0||h===r)):l?!d&&h===0&&!a&&u===e:f?!a&&u===0&&!d&&h===r:false}function Ln(t,e,r,n,o,i,c){let s=e.from===e.to,l=t.config.routing,[f,u,h,a]=lo(e,t.config.graphDirection);function d(B){let b=[];for(let M of B)b.some(D=>q(D,M))||b.push(M);return b}function m(B,b){let M=[];for(let D of B)for(let Y of b){let K=Gt(e.from.gridCoord,D),J=Gt(e.to.gridCoord,Y);Nt(K,J)||M.push({startDir:D,endDir:Y,routeFrom:K,routeTo:J,routeFromIdx:_t(r.stride,K),routeToIdx:_t(r.stride,J)});}return M}function x(B){return q(B,ot)||q(B,tt)||q(B,it)||q(B,et)?0:l==="relaxed"?10:100}function g(B){return B.x===0||B.y===0?200:0}let p=6;function y(B,b){if(l!=="relaxed"||!t.portUsage)return 0;let M=b.x+b.y*3,D=B.index*9+M;return (t.portUsage[D]??0)*p}function C(B,b){return Jt(b,r.stride)+x(B.startDir)+x(B.endDir)+g(B.routeFrom)+g(B.routeTo)}function _(B,b){return b.cost+Jt(b.path,r.stride)+x(B.startDir)+x(B.endDir)+g(B.routeFrom)+g(B.routeTo)+y(e.from,B.startDir)+y(e.to,B.endDir)}let R=[];{let B=Gt(e.from.gridCoord,f),b=Gt(e.to.gridCoord,u);Nt(B,b)||R.push({startDir:f,endDir:u,routeFrom:B,routeTo:b,routeFromIdx:_t(r.stride,B),routeToIdx:_t(r.stride,b)});}if(!q(f,h)||!q(u,a)){let B=Gt(e.from.gridCoord,h),b=Gt(e.to.gridCoord,a);Nt(B,b)||R.push({startDir:h,endDir:a,routeFrom:B,routeTo:b,routeFromIdx:_t(r.stride,B),routeToIdx:_t(r.stride,b)});}function w(B){return q(B,ot)?{x:0,y:-1}:q(B,tt)?{x:0,y:1}:q(B,it)?{x:-1,y:0}:q(B,et)?{x:1,y:0}:null}function S(B,b){let M=B[B.length-1];if(M.x===b.x){let D=b.y>M.y?1:-1;for(let Y=M.y+D;Y!==b.y+D;Y+=D)B.push({x:M.x,y:Y});return}if(M.y===b.y){let D=b.x>M.x?1:-1;for(let Y=M.x+D;Y!==b.x+D;Y+=D)B.push({x:Y,y:M.y});return}throw new Error(`appendStraightLine expects straight line, got from=(${M.x},${M.y}) to=(${b.x},${b.y})`)}function k(B,b){if(b.length<4)return  false;let M=[];for(let D=0;D<b.length;D++){let Y=b[D];if(Y.x<0||Y.y<0||Y.x>=r.stride||Y.y>=r.height||(M.push(_t(r.stride,Y)),!(Nt(Y,B.routeFrom)||Nt(Y,B.routeTo))&&r.blocked[M[M.length-1]]))return  false}for(let D=1;D<M.length;D++){let Y=M[D-1],K=M[D];if(!uo(r,c,Y,K))return  false;if(i){let J=An(Y,K);if(i.segmentUsed[J]&&!fo(i,e.from.index+1,e.to.index+1,B.routeFromIdx,B.routeToIdx,Y,K,J))return  false}}return  true}function I(B,b){let M=w(B.startDir),D=w(B.endDir);if(!M||!D||b<1)return null;let Y={x:B.routeFrom.x+M.x*b,y:B.routeFrom.y+M.y*b},K={x:B.routeTo.x+D.x*b,y:B.routeTo.y+D.y*b},J=[{x:Y.x,y:K.y},{x:K.x,y:Y.y}];for(let Z of J){let st=[B.routeFrom];S(st,Y),S(st,Z),S(st,K),S(st,B.routeTo);let mt=st.filter((xt,pt)=>pt===0||!Nt(xt,st[pt-1]));if(k(B,mt)&&Te(mt).length>=4)return mt}return null}if(s){let B=R.length>0?R:N;for(let b of B)for(let M=1;M<=12;M++){let D=I(b,M);if(!D)continue;e.startDir=b.startDir,e.endDir=b.endDir,e.path=Te(D);let Y=D.map(K=>_t(r.stride,K));if(i&&Sn(i,e,Y),c&&kn(c,r,Y),l==="relaxed"&&t.portUsage){let K=e.startDir.x+e.startDir.y*3,J=e.endDir.x+e.endDir.y*3;t.portUsage[e.from.index*9+K]=(t.portUsage[e.from.index*9+K]??0)+1,t.portUsage[e.to.index*9+J]=(t.portUsage[e.to.index*9+J]??0)+1;}return}}let L=d([u,a]),O=l==="relaxed"&&t.config.useAscii,X=[bt,gt,wt,yt],U=d([f,h,et,it,tt,ot,...O?[bt,gt,wt,yt]:[]]),$=d([u,a,et,it,tt,ot,...O?[bt,gt,wt,yt]:[]]),N=m(U,L),A=m(U,$),G=d([...U,...X]),v=d([...$,...X]),j=m(U,v),W=m(G,v);function E(B){return {maxX:Math.min(r.stride-1,n+B),maxY:Math.min(r.height-1,o+B)}}function P(B,b=kt){for(let M of b){let D=E(M),Y=null;for(let K of B){let J=wn(r,K.routeFromIdx,K.routeToIdx,D);if(!J||s&&Jt(J,r.stride)<4)continue;let Z=C(K,J);(!Y||Z<Y.cost)&&(Y={candidate:K,pathIdx:J,cost:Z});}if(Y)return Y}return null}function T(B,b){if(!i||i.usedCount===0)return null;let M={segmentUsage:i,usedPoints:c,routeFromIdx:0,routeToIdx:0,edgeFromId:e.from.index+1,edgeToId:e.to.index+1};for(let D of b){let Y=E(D),K=null;for(let J of B){M.routeFromIdx=J.routeFromIdx,M.routeToIdx=J.routeToIdx;let Z=Cn(r,J.routeFromIdx,J.routeToIdx,Y,M);if(!Z||s&&Jt(Z,r.stride)<4)continue;let st=C(J,Z);(!K||st<K.cost)&&(K={candidate:J,pathIdx:Z,cost:st});}if(K)return K}return null}function F(B,b,M){if(!i)return null;let D={segmentUsage:i,usedPoints:c,routeFromIdx:0,routeToIdx:0,edgeFromId:e.from.index+1,edgeToId:e.to.index+1,relaxedAllowEndSegmentReuse:M};for(let Y of b){let K=E(Y),J=null;for(let Z of B){D.routeFromIdx=Z.routeFromIdx,D.routeToIdx=Z.routeToIdx;let st=vn(r,Z.routeFromIdx,Z.routeToIdx,K,D);if(!st||s&&Jt(st.path,r.stride)<4)continue;let mt=_(Z,st);(!J||mt<J.cost)&&(J={candidate:Z,pathIdx:st.path,cost:mt});}if(J)return J}return null}let H=null;if(l==="relaxed"){let B=function(b){let M=F(R,Lt,b)??F(N,Lt,b)??F(A,Lt,b);return M=M??F(R,kt,b)??F(N,kt,b)??F(A,kt,b),M};if(H=B(false)??B(true),!H){let b=function(M){let D=F(j,Lt,M)??F(W,Lt,M);return D=D??F(j,kt,M)??F(W,kt,M),D};H=b(false)??b(true);}}else !i||i.usedCount===0?H=P(R,Lt):(H=T(R,Lt)??T(N,Lt)??T(A,Lt),H=H??T(R,kt)??T(N,kt),H=H??T(A,kt));if(!H){e.startDir=f,e.endDir=u,e.path=[];return}if(e.startDir=H.candidate.startDir,e.endDir=H.candidate.endDir,e.path=yn(H.pathIdx,r.stride).map(B=>bn(r.stride,B)),i&&Sn(i,e,H.pathIdx),c&&kn(c,r,H.pathIdx),l==="relaxed"&&t.portUsage){let B=e.startDir.x+e.startDir.y*3,b=e.endDir.x+e.endDir.y*3;t.portUsage[e.from.index*9+B]=(t.portUsage[e.from.index*9+B]??0)+1,t.portUsage[e.to.index*9+b]=(t.portUsage[e.to.index*9+b]??0)+1;}}function In(t,e){if(e.text.length===0||e.path.length<2)return;let r=at(e.text),n=yo(t),o=xo(t),i=e.path[0],c=null,s=[i,e.path[1]],l=0,f=false,u=null,h=-1;for(let y=1;y<e.path.length;y++){let C=e.path[y],_=[i,C],R=ho(t,_);f||(R>=r?(s=_,f=true):R>l&&(l=R,s=_));let w=Tn(t,_,e.text),S=w?n.some(I=>bo(I,w)):false,k=w?o.some(I=>go(w,I)):false;if(!S&&!k&&(R>h&&(h=R,u=_),R>=r)){c=_;break}i=C;}c===null&&(c=u??s);let a=Math.min(c[0].x,c[1].x),d=Math.max(c[0].x,c[1].x),x=a+Math.floor((d-a)/2);if(t.config.routing==="relaxed"&&!t.config.useAscii){let y=new Set;for(let C of t.nodes)C.gridCoord&&(y.add(C.gridCoord.x),y.add(C.gridCoord.x+1),y.add(C.gridCoord.x+2));if(y.has(x)){let C=d-a;for(let _=1;_<=C;_++){let R=x-_;if(R>=a&&R<=d&&!y.has(R)){x=R;break}let w=x+_;if(w>=a&&w<=d&&!y.has(w)){x=w;break}}}}let p=t.columnWidth.get(x)??0;t.columnWidth.set(x,Math.max(p,r+2)),e.labelLine=[c[0],c[1]];}function ho(t,e){let r=0,n=Math.min(e[0].x,e[1].x),o=Math.max(e[0].x,e[1].x);for(let i=n;i<=o;i++)r+=t.columnWidth.get(i)??0;return r}function $n(t,e){let r=t.offsetX;for(let c=0;c<e.x;c++)r+=t.columnWidth.get(c)??0;let n=t.offsetY;for(let c=0;c<e.y;c++)n+=t.rowHeight.get(c)??0;let o=t.columnWidth.get(e.x)??0,i=t.rowHeight.get(e.y)??0;return {x:r+Math.floor(o/2),y:n+Math.floor(i/2)}}function mo(t,e){let r=t.offsetX;for(let o=0;o<e.x;o++)r+=t.columnWidth.get(o)??0;let n=t.offsetY;for(let o=0;o<e.y;o++)n+=t.rowHeight.get(o)??0;return {x:r,y:n}}function po(t,e){if(!e.gridCoord)return null;let r=e.gridCoord,n=0;for(let c=0;c<2;c++)n+=t.columnWidth.get(r.x+c)??0;let o=0;for(let c=0;c<2;c++)o+=t.rowHeight.get(r.y+c)??0;let i=mo(t,r);return {minX:i.x,minY:i.y,maxX:i.x+n,maxY:i.y+o}}function go(t,e){return t.y<e.minY||t.y>e.maxY?false:!(t.endX<e.minX||e.maxX<t.startX)}function xo(t){let e=[];for(let r of t.nodes){let n=po(t,r);n&&e.push(n);}return e}function Tn(t,e,r){let n=at(r);if(n<=0)return null;let o=$n(t,e[0]),i=$n(t,e[1]),c=Math.min(o.x,i.x),s=Math.max(o.x,i.x),l=Math.min(o.y,i.y),f=Math.max(o.y,i.y),u=c+Math.floor((s-c)/2),h=l+Math.floor((f-l)/2),a=u-Math.floor(n/2);return {y:h,startX:a,endX:a+n-1}}function bo(t,e){return t.y!==e.y?false:!(t.endX<e.startX||e.endX<t.startX)}function yo(t){let e=[];for(let r of t.edges){if(r.text.length===0||r.labelLine.length<2)continue;let n=Tn(t,[r.labelLine[0],r.labelLine[1]],r.text);n&&e.push(n);}return e}function Mt(t,e,r){let n=0;if(t.columnStartX&&r.x>=0&&r.x<t.columnStartX.length)n=t.columnStartX[r.x]??0;else for(let h=0;h<r.x;h++)n+=t.columnWidth.get(h)??0;let o=0;if(t.rowStartY&&r.y>=0&&r.y<t.rowStartY.length)o=t.rowStartY[r.y]??0;else for(let h=0;h<r.y;h++)o+=t.rowHeight.get(h)??0;let i=t.columnWidth.get(r.x)??0,c=t.rowHeight.get(r.y)??0,s=Math.floor(i/2),l=Math.floor(c/2),f=e.from.gridCoord;if(f){let h=f.x+1,a=f.y+1;e.startPortOffsetX!=null&&r.x===h&&(s=e.startPortOffsetX),e.startPortOffsetY!=null&&r.y===a&&(l=e.startPortOffsetY);}let u=e.to.gridCoord;if(u){let h=u.x+1,a=u.y+1;e.endPortOffsetX!=null&&r.x===h&&(s=e.endPortOffsetX),e.endPortOffsetY!=null&&r.y===a&&(l=e.endPortOffsetY);}return s<0&&(s=0),l<0&&(l=0),i>0&&s>i-1&&(s=i-1),c>0&&l>c-1&&(l=c-1),{x:n+s+t.offsetX,y:o+l+t.offsetY}}function wo(t,e,r){return r.map(n=>Mt(t,e,n))}function Rn(t,e){let r=t.gridCoord,n=e.config.useAscii,o=0;for(let d=0;d<2;d++)o+=e.columnWidth.get(r.x+d)??0;let i=0;for(let d=0;d<2;d++)i+=e.rowHeight.get(r.y+d)??0;let c={x:0,y:0},s={x:o,y:i},l=ut(Math.max(c.x,s.x),Math.max(c.y,s.y));if(n){for(let d=c.x+1;d<s.x;d++)l[d][c.y]="-";for(let d=c.x+1;d<s.x;d++)l[d][s.y]="-";for(let d=c.y+1;d<s.y;d++)l[c.x][d]="|";for(let d=c.y+1;d<s.y;d++)l[s.x][d]="|";l[c.x][c.y]="+",l[s.x][c.y]="+",l[c.x][s.y]="+",l[s.x][s.y]="+";}else {for(let d=c.x+1;d<s.x;d++)l[d][c.y]="\u2500";for(let d=c.x+1;d<s.x;d++)l[d][s.y]="\u2500";for(let d=c.y+1;d<s.y;d++)l[c.x][d]="\u2502";for(let d=c.y+1;d<s.y;d++)l[s.x][d]="\u2502";l[c.x][c.y]="\u250C",l[s.x][c.y]="\u2510",l[c.x][s.y]="\u2514",l[s.x][s.y]="\u2518";}let f=t.displayLabel,u=c.y+Math.floor(i/2),h=at(f),a=c.x+Math.floor(o/2)-Math.ceil(h/2)+1;return ht(l,{x:a,y:u},f),l}function he(t,e,r=1){let n=0;for(let C of t)for(let _ of C)n=Math.max(n,at(_));let i=n+2*r+2,c=0;for(let C of t)c+=Math.max(C.length,1);let s=t.length-1,l=c+s+2,f=e?"-":"\u2500",u=e?"|":"\u2502",h=e?"+":"\u250C",a=e?"+":"\u2510",d=e?"+":"\u2514",m=e?"+":"\u2518",x=e?"+":"\u251C",g=e?"+":"\u2524",p=ut(i-1,l-1);p[0][0]=h;for(let C=1;C<i-1;C++)p[C][0]=f;p[i-1][0]=a,p[0][l-1]=d;for(let C=1;C<i-1;C++)p[C][l-1]=f;p[i-1][l-1]=m;for(let C=1;C<l-1;C++)p[0][C]=u,p[i-1][C]=u;let y=1;for(let C=0;C<t.length;C++){let _=t[C],R=_.length>0?_:[""];for(let w of R){let S=1+r;ht(p,{x:S,y},w),y++;}if(C<t.length-1){p[0][y]=x;for(let w=1;w<i-1;w++)p[w][y]=f;p[i-1][y]=g,y++;}}return p}function Co(t,e,r,n,o,i){let c=vt(e,r),s=[],l=i?"-":"\u2500",f=i?"|":"\u2502",u=i?"\\":"\u2572",h=i?"/":"\u2571";if(q(c,ot))for(let a=e.y-n;a>=r.y-o;a--)s.push({x:e.x,y:a}),t[e.x][a]=f;else if(q(c,tt))for(let a=e.y+n;a<=r.y+o;a++)s.push({x:e.x,y:a}),t[e.x][a]=f;else if(q(c,it))for(let a=e.x-n;a>=r.x-o;a--)s.push({x:a,y:e.y}),t[a][e.y]=l;else if(q(c,et))for(let a=e.x+n;a<=r.x+o;a++)s.push({x:a,y:e.y}),t[a][e.y]=l;else if(q(c,gt))for(let a=e.x,d=e.y-n;a>=r.x-o&&d>=r.y-o;a--,d--)s.push({x:a,y:d}),t[a][d]=u;else if(q(c,bt))for(let a=e.x,d=e.y-n;a<=r.x+o&&d>=r.y-o;a++,d--)s.push({x:a,y:d}),t[a][d]=h;else if(q(c,yt))for(let a=e.x,d=e.y+n;a>=r.x-o&&d<=r.y+o;a--,d++)s.push({x:a,y:d}),t[a][d]=h;else if(q(c,wt))for(let a=e.x,d=e.y+n;a<=r.x+o&&d<=r.y+o;a++,d++)s.push({x:a,y:d}),t[a][d]=u;return s}function vo(t,e){if(e.path.length<2){let f=Bt(t.canvas);return [f,f,f,f,f]}let r=Nn(t,e),[n,o,i]=So(t,e,e.path),c=ko(t,e.path,o[0]),s=Mo(t,o[o.length-1],i[i.length-1]),l=$o(t,e,e.path);return [n,c,s,l,r]}function On(t,e){let r=[],n=new Set;function o(s){let l=`${s.x},${s.y}`;n.has(l)||(n.add(l),r.push(s));}if(e.path.length<2)return r;t.config.useAscii||o(Mt(t,e,e.path[0]));let i=1,c=-1;for(let s=1;s<e.path.length;s++){let l=e.path[s-1],f=e.path[s],u=Mt(t,e,l),h=Mt(t,e,f);if(_e(u,h))continue;let a=vt(l,f);if(q(a,ot))for(let d=u.y-i;d>=h.y-c;d--)o({x:u.x,y:d});else if(q(a,tt))for(let d=u.y+i;d<=h.y+c;d++)o({x:u.x,y:d});else if(q(a,it))for(let d=u.x-i;d>=h.x-c;d--)o({x:d,y:u.y});else if(q(a,et))for(let d=u.x+i;d<=h.x+c;d++)o({x:d,y:u.y});else if(q(a,gt))for(let d=u.x,m=u.y-i;d>=h.x-c&&m>=h.y-c;d--,m--)o({x:d,y:m});else if(q(a,bt))for(let d=u.x,m=u.y-i;d<=h.x+c&&m>=h.y-c;d++,m--)o({x:d,y:m});else if(q(a,yt))for(let d=u.x,m=u.y+i;d>=h.x-c&&m<=h.y+c;d--,m++)o({x:d,y:m});else if(q(a,wt))for(let d=u.x,m=u.y+i;d<=h.x+c&&m<=h.y+c;d++,m++)o({x:d,y:m});if(s<e.path.length-1){let d=vt(f,e.path[s+1]);!q(a,d)&&!q(a,Ht)&&!q(d,Ht)&&o(Mt(t,e,f));}}{let s=e.path[e.path.length-1],l=e.path[e.path.length-2],f=vt(l,s),u=Mt(t,e,s);q(f,ot)?o({x:u.x,y:u.y+1}):q(f,tt)?o({x:u.x,y:u.y-1}):q(f,it)?o({x:u.x+1,y:u.y}):q(f,et)&&o({x:u.x-1,y:u.y});}return r}function So(t,e,r){let n=Bt(t.canvas),o=r[0],i=[],c=[];for(let s=1;s<r.length;s++){let l=r[s],f=Mt(t,e,o),u=Mt(t,e,l);if(_e(f,u)){o=l;continue}let h=vt(o,l),a=Co(n,f,u,1,-1,t.config.useAscii);a.length===0&&a.push(f),i.push(a),c.push(h),o=l;}return [n,i,c]}function ko(t,e,r){let n=Bt(t.canvas);if(t.config.useAscii)return n;let o=r[0],i=vt(e[0],e[1]);return q(i,ot)?n[o.x][o.y+1]="\u2534":q(i,tt)?n[o.x][o.y-1]="\u252C":q(i,it)?n[o.x+1][o.y]="\u2524":q(i,et)&&(n[o.x-1][o.y]="\u251C"),n}function Mo(t,e,r){let n=Bt(t.canvas);if(e.length===0)return n;let o=e[0],i=e[e.length-1],c=vt(o,i);(e.length===1||q(c,Ht))&&(c=r);let s;return t.config.useAscii?q(c,ot)?s="^":q(c,tt)?s="v":q(c,it)?s="<":q(c,et)?s=">":q(r,ot)?s="^":q(r,tt)?s="v":q(r,it)?s="<":q(r,et)?s=">":s="*":q(c,ot)?s="\u25B2":q(c,tt)?s="\u25BC":q(c,it)?s="\u25C4":q(c,et)?s="\u25BA":q(c,bt)?s="\u25E5":q(c,gt)?s="\u25E4":q(c,wt)?s="\u25E2":q(c,yt)?s="\u25E3":q(r,ot)?s="\u25B2":q(r,tt)?s="\u25BC":q(r,it)?s="\u25C4":q(r,et)?s="\u25BA":q(r,bt)?s="\u25E5":q(r,gt)?s="\u25E4":q(r,wt)?s="\u25E2":q(r,yt)?s="\u25E3":s="\u25CF",n[i.x][i.y]=s,n}function $o(t,e,r){let n=Bt(t.canvas);for(let o=1;o<r.length-1;o++){let i=r[o],c=Mt(t,e,i),s=vt(r[o-1],i),l=vt(i,r[o+1]),f;t.config.useAscii?f="+":q(s,et)&&q(l,tt)||q(s,ot)&&q(l,it)?f="\u2510":q(s,et)&&q(l,ot)||q(s,tt)&&q(l,it)?f="\u2518":q(s,it)&&q(l,tt)||q(s,ot)&&q(l,et)?f="\u250C":q(s,it)&&q(l,ot)||q(s,tt)&&q(l,et)?f="\u2514":f="+",n[c.x][c.y]=f;}return n}function Nn(t,e,r){let n=Bt(t.canvas);if(e.text.length===0)return n;let o=wo(t,e,e.labelLine),i=[],c=Ro(t,e);c&&i.push(c);let s=Oo(t,e);return s&&i.push(s),Do(n,o,e.text,i,r,t.config.useAscii),n}function Eo(t){return t==="\u25B2"||t==="\u25BC"||t==="\u25C4"||t==="\u25BA"||t==="\u25E5"||t==="\u25E4"||t==="\u25E2"||t==="\u25E3"||t==="\u25CF"}function Ao(t){return t==="^"||t==="v"||t==="<"||t===">"||t==="*"}function _o(t){return t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2574"||t==="\u2575"||t==="\u2576"||t==="\u2577"}function Lo(t){return t==="+"}function Ge(t,e){return e?t==="|"||t==="+":t==="\u2502"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2577"||t==="\u2575"}function Be(t,e){return e?t==="-"||t==="+":t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2574"||t==="\u2576"}function Io(t,e,r,n){let[o,i]=Ct(t);if(e<0||r<0||e>o||r>i)return  false;let c=t[e][r],s=e>0?t[e-1][r]:" ",l=e<o?t[e+1][r]:" ",f=r>0?t[e][r-1]:" ",u=r<i?t[e][r+1]:" ",h=Ge(f,n)&&Ge(u,n),a=Be(s,n)&&Be(l,n);return !!((c===" "||Be(c,n))&&h||(c===" "||Ge(c,n))&&a)}function To(t,e,r,n){let[o,i]=Ct(t);if(e<0||r<0||e>o||r>i)return  false;let c=t[e][r];if(n){if(Ao(c)||Lo(c))return  true}else if(Eo(c)||_o(c))return  true;return !!Io(t,e,r,n)}function Pn(t,e,r,n){for(let o of n)if(o.y===t&&o.x>=e&&o.x<=r)return  true;return  false}function Po(t,e,r,n,o){for(let i=r;i<=n;i++)if(To(t,i,e,o))return  true;return  false}function Dn(t){let{desiredStartX:e,minStartX:r,maxStartX:n,isValid:o}=t;if(o(e))return e;let i=Math.max(0,n-r);for(let c=1;c<=i;c++){let s=e-c;if(s>=r&&o(s))return s;let l=e+c;if(l<=n&&o(l))return l}return e}function Do(t,e,r,n=[],o,i=false){if(e.length<2)return;let c=Math.min(e[0].x,e[1].x),s=Math.max(e[0].x,e[1].x),l=Math.min(e[0].y,e[1].y),f=Math.max(e[0].y,e[1].y),u=c+Math.floor((s-c)/2),h=l+Math.floor((f-l)/2),a=at(r),d=u-Math.floor(a/2);if(o){let[x]=Ct(o),g=0,p=Math.max(g,x-a+1),y=e[0].y===e[1].y,C=c,_=s-a+1,R=y&&_>=C?Math.max(g,C):g,w=y&&_>=C?Math.min(p,_):p;w>=R&&(d<R&&(d=R),d>w&&(d=w),d=Dn({desiredStartX:d,minStartX:R,maxStartX:w,isValid:S=>{let k=S+a-1;return !(Pn(h,S,k,n)||Po(o,h,S,k,i))}})),ht(t,{x:d,y:h},r);return}if(e[0].y===e[1].y){let x=c,g=s-a+1;if(g>=x){d<x&&(d=x),d>g&&(d=g);for(let p of n){if(p.y!==h)continue;let y=d+a-1;if(!(p.x>=d&&p.x<=y))continue;let _=p.x-a,R=p.x+1,w=[];_>=x&&_<=g&&w.push(_),R>=x&&R<=g&&w.push(R),w.length!==0&&(w.sort((S,k)=>Math.abs(S-d)-Math.abs(k-d)),d=w[0]);}d=Dn({desiredStartX:d,minStartX:x,maxStartX:g,isValid:p=>{let y=p+a-1;return !Pn(h,p,y,n)}});}}ht(t,{x:d,y:h},r);}function Ro(t,e){if(e.path.length<2)return null;let r=e.path[e.path.length-1],n=e.path[e.path.length-2],o=vt(n,r),i=Mt(t,e,r);return q(o,ot)?{x:i.x,y:i.y+1}:q(o,tt)?{x:i.x,y:i.y-1}:q(o,it)?{x:i.x+1,y:i.y}:q(o,et)?{x:i.x-1,y:i.y}:null}function Oo(t,e){return e.path.length<2?null:Mt(t,e,e.path[0])}function No(t,e){let r=t.maxX-t.minX,n=t.maxY-t.minY;if(r<=0||n<=0)return ut(0,0);let o={x:0,y:0},i={x:r,y:n},c=ut(r,n);if(e.config.useAscii){for(let s=o.x+1;s<i.x;s++)c[s][o.y]="-";for(let s=o.x+1;s<i.x;s++)c[s][i.y]="-";for(let s=o.y+1;s<i.y;s++)c[o.x][s]="|";for(let s=o.y+1;s<i.y;s++)c[i.x][s]="|";c[o.x][o.y]="+",c[i.x][o.y]="+",c[o.x][i.y]="+",c[i.x][i.y]="+";}else {for(let s=o.x+1;s<i.x;s++)c[s][o.y]="\u2500";for(let s=o.x+1;s<i.x;s++)c[s][i.y]="\u2500";for(let s=o.y+1;s<i.y;s++)c[o.x][s]="\u2502";for(let s=o.y+1;s<i.y;s++)c[i.x][s]="\u2502";c[o.x][o.y]="\u250C",c[i.x][o.y]="\u2510",c[o.x][i.y]="\u2514",c[i.x][i.y]="\u2518";}return c}function Go(t,e){let r=t.maxX-t.minX,n=t.maxY-t.minY;if(r<=0||n<=0)return [ut(0,0),{x:0,y:0}];let o=ut(r,n),i=1,c=Math.floor(r/2)-Math.floor(at(t.name)/2);return c<1&&(c=1),ht(o,{x:c,y:i},t.name),[o,{x:t.minX,y:t.minY}]}function Bo(t){function e(n){return n.parent===null?0:1+e(n.parent)}let r=[...t];return r.sort((n,o)=>e(n)-e(o)),r}function Gn(t){let e=t.config.useAscii,r=Bo(t.subgraphs);for(let u of r){let h=No(u,t),a={x:u.minX,y:u.minY};t.canvas=Et(t.canvas,a,e,h);}for(let u of t.nodes)!u.drawn&&u.drawingCoord&&u.drawing&&(t.canvas=Et(t.canvas,u.drawingCoord,e,u.drawing),u.drawn=true);let n=[],o=[],i=[],c=[];for(let u of t.edges){let[h,a,d,m,x]=vo(t,u);n.push(h),o.push(m),i.push(d),c.push(a);}let s={x:0,y:0};t.canvas=Et(t.canvas,s,e,...n),t.canvas=Et(t.canvas,s,e,...o),t.canvas=Et(t.canvas,s,e,...i),t.canvas=Et(t.canvas,s,e,...c);let l=[],f=t.canvas;for(let u of t.edges)l.push(Nn(t,u,f));t.canvas=Et(t.canvas,s,e,...l);for(let u of t.subgraphs){if(u.nodes.length===0)continue;let[h,a]=Go(u);t.canvas=Et(t.canvas,a,e,h);}return t.canvas}function Xo(t,e,r){let n=e,o=0;if(t.columnStartX&&n.x>=0&&n.x<t.columnStartX.length)o=t.columnStartX[n.x]??0;else for(let l=0;l<n.x;l++)o+=t.columnWidth.get(l)??0;let i=0;if(t.rowStartY&&n.y>=0&&n.y<t.rowStartY.length)i=t.rowStartY[n.y]??0;else for(let l=0;l<n.y;l++)i+=t.rowHeight.get(l)??0;let c=t.columnWidth.get(n.x)??0,s=t.rowHeight.get(n.y)??0;return {x:o+Math.floor(c/2)+t.offsetX,y:i+Math.floor(s/2)+t.offsetY}}function Zt(t,e,r){if(t.grid.has(Le(r)))return t.config.graphDirection==="LR"?Zt(t,e,{x:r.x,y:r.y+4}):Zt(t,e,{x:r.x+4,y:r.y});for(let n=0;n<3;n++)for(let o=0;o<3;o++){let i={x:r.x+n,y:r.y+o};t.grid.set(Le(i),e);}return e.gridCoord=r,r}function Fo(t,e){let r=e.gridCoord,n=t.config.boxBorderPadding,o=[1,2*n+at(e.displayLabel),1],i=[1,1+2*n,1];for(let c=0;c<o.length;c++){let s=r.x+c,l=t.columnWidth.get(s)??0;t.columnWidth.set(s,Math.max(l,o[c]));}for(let c=0;c<i.length;c++){let s=r.y+c,l=t.rowHeight.get(s)??0;t.rowHeight.set(s,Math.max(l,i[c]));}if(r.x>0){let c=t.columnWidth.get(r.x-1)??0;t.columnWidth.set(r.x-1,Math.max(c,t.config.paddingX));}if(r.y>0){let c=t.config.paddingY;Wo(t,e)&&(c+=4);let s=t.rowHeight.get(r.y-1)??0;t.rowHeight.set(r.y-1,Math.max(s,c));}}function Yo(t,e){if(e.length===0)return;function r(o){t.columnWidth.has(o.x)||t.columnWidth.set(o.x,Math.floor(t.config.paddingX/2)),t.rowHeight.has(o.y)||t.rowHeight.set(o.y,Math.floor(t.config.paddingY/2));}let n=e[0];r(n);for(let o=1;o<e.length;o++){let i=e[o];if(n.x===i.x){let c=i.y>n.y?1:-1;for(let s=n.y;s!==i.y;s+=c)r({x:n.x,y:s}),r({x:n.x,y:s+c});}else if(n.y===i.y){let c=i.x>n.x?1:-1;for(let s=n.x;s!==i.x;s+=c)r({x:s,y:n.y}),r({x:s+c,y:n.y});}else r(i);n=i;}}function me(t,e){return t.subgraphs.some(r=>r.nodes.includes(e))}function Xe(t,e){for(let r of t.subgraphs)if(r.nodes.includes(e))return r;return null}function Wo(t,e){let r=Xe(t,e);if(!r)return  false;let n=false;for(let o of t.edges)if(o.to===e&&Xe(t,o.from)!==r){n=true;break}if(!n)return  false;for(let o of r.nodes){if(o===e||!o.gridCoord)continue;let i=false;for(let c of t.edges)if(c.to===o&&Xe(t,c.from)!==r){i=true;break}if(i&&o.gridCoord.y<e.gridCoord.y)return  false}return  true}function Bn(t,e){if(e.nodes.length===0)return;let r=1e6,n=1e6,o=-1e6,i=-1e6;for(let l of e.children)Bn(t,l),l.nodes.length>0&&(r=Math.min(r,l.minX),n=Math.min(n,l.minY),o=Math.max(o,l.maxX),i=Math.max(i,l.maxY));for(let l of e.nodes){if(!l.drawingCoord||!l.drawing)continue;let f=l.drawingCoord.x,u=l.drawingCoord.y,h=f+l.drawing.length-1,a=u+l.drawing[0].length-1;r=Math.min(r,f),n=Math.min(n,u),o=Math.max(o,h),i=Math.max(i,a);}let c=2,s=2;e.minX=r-c,e.minY=n-c-s,e.maxX=o+c,e.maxY=i+c;}function Ho(t){let r=t.subgraphs.filter(n=>n.parent===null&&n.nodes.length>0);for(let n=0;n<r.length;n++)for(let o=n+1;o<r.length;o++){let i=r[n],c=r[o];i.minX<c.maxX&&i.maxX>c.minX&&(i.maxY>=c.minY-1&&i.minY<c.minY?c.minY=i.maxY+1+1:c.maxY>=i.minY-1&&c.minY<i.minY&&(i.minY=c.maxY+1+1)),i.minY<c.maxY&&i.maxY>c.minY&&(i.maxX>=c.minX-1&&i.minX<c.minX?c.minX=i.maxX+1+1:c.maxX>=i.minX-1&&c.minX<i.minX&&(i.minX=c.maxX+1+1));}}function jo(t){for(let e of t.subgraphs)Bn(t,e);Ho(t);}function Uo(t){if(t.subgraphs.length===0)return;let e=0,r=0;for(let i of t.subgraphs)e=Math.min(e,i.minX),r=Math.min(r,i.minY);let n=-e,o=-r;if(!(n===0&&o===0)){t.offsetX=n,t.offsetY=o;for(let i of t.subgraphs)i.minX+=n,i.minY+=o,i.maxX+=n,i.maxY+=o;for(let i of t.nodes)i.drawingCoord&&(i.drawingCoord.x+=n,i.drawingCoord.y+=o);}}function Xn(t){let e=[0,1,2,3,4];for(let r of e)if(zo(t),qo(t,r))return}function zo(t){t.grid=new Map,t.columnWidth=new Map,t.rowHeight=new Map,t.canvas=ut(0,0),t.offsetX=0,t.offsetY=0,t.columnStartX=void 0,t.rowStartY=void 0,t.portUsage=t.config.routing==="relaxed"?new Uint16Array(t.nodes.length*9):void 0;for(let e of t.nodes)e.gridCoord=null,e.drawingCoord=null,e.drawing=null,e.drawn=false;for(let e of t.edges)e.path=[],e.labelLine=[],e.startDir={x:0,y:0},e.endDir={x:0,y:0},e.startPortOffsetX=void 0,e.startPortOffsetY=void 0,e.endPortOffsetX=void 0,e.endPortOffsetY=void 0;for(let e of t.subgraphs)e.minX=0,e.minY=0,e.maxX=0,e.maxY=0;}function Vo(t){let e=0;for(let s of t.columnWidth.keys())e=Math.max(e,s);let r=0;for(let s of t.rowHeight.keys())r=Math.max(r,s);let n=new Int32Array(e+2),o=0;for(let s=0;s<n.length;s++)n[s]=o,o+=t.columnWidth.get(s)??0;let i=new Int32Array(r+2),c=0;for(let s=0;s<i.length;s++)i[s]=c,c+=t.rowHeight.get(s)??0;t.columnStartX=n,t.rowStartY=i;}function qo(t,e){let r=t.config.graphDirection,n=new Array(100).fill(0),o=[];if(t.config.routing==="strict"){let S=new Set;for(let k of t.nodes){S.has(k.name)||o.push(k),S.add(k.name);for(let I of Fe(t,k))S.add(I.name);}}else {let S=new Set;for(let k of t.edges)S.add(k.to.name);o=t.nodes.filter(k=>!S.has(k.name)),o.length===0&&t.nodes.length>0&&(o=[t.nodes[0]]);}let i=false,c=false;for(let S of o)me(t,S)?Fe(t,S).length>0&&(c=true):i=true;let s=r==="LR"&&i&&c,l,f=[];s?(l=o.filter(S=>!me(t,S)),f=o.filter(S=>me(t,S))):l=o;for(let S of l){let k=r==="LR"?{x:0+e,y:n[0]+e}:{x:n[0]+e,y:0+e};Zt(t,t.nodes[S.index],k),n[0]=n[0]+4;}if(s&&f.length>0)for(let k of f){let I=r==="LR"?{x:4+e,y:n[4]+e}:{x:n[4]+e,y:4+e};Zt(t,t.nodes[k.index],I),n[4]=n[4]+4;}let u=true;for(;u;){u=false;for(let L of t.nodes){let O=L.gridCoord;if(!O)continue;let U=(r==="LR"?O.x-e:O.y-e)+4,$=n[U]??0;for(let N of Fe(t,L)){if(N.gridCoord!==null)continue;let A=r==="LR"?{x:U+e,y:$+e}:{x:$+e,y:U+e};Zt(t,t.nodes[N.index],A),n[U]=$+4,$=n[U],u=true;}}if(u)continue;let S=t.nodes.find(L=>L.gridCoord===null);if(!S)break;let k=s&&me(t,S)?4:0,I=r==="LR"?{x:k+e,y:n[k]+e}:{x:n[k]+e,y:k+e};Zt(t,t.nodes[S.index],I),n[k]=n[k]+4,u=true;}if(t.nodes.some(S=>S.gridCoord===null))return  false;let h=0,a=0;for(let S of t.nodes)S.gridCoord&&(h=Math.max(h,S.gridCoord.x+2),a=Math.max(a,S.gridCoord.y+2));let d=h+Ne+1,m=a+Ne+1,x=xn(d,m);for(let S of t.nodes)if(S.gridCoord)for(let k=0;k<3;k++)for(let I=0;I<3;I++){let L=S.gridCoord.x+k,O=S.gridCoord.y+I;x.blocked[L+O*d]=1;}let g=En(x.blocked.length),p=new Uint8Array(x.blocked.length);for(let S of t.nodes)Fo(t,S);for(let S of t.edges)Ln(t,S,x,h,a,g,p),Yo(t,S.path);if(t.edges.some(S=>S.path.length<2))return  false;if(!t.config.useAscii&&t.config.routing==="relaxed"){let S=function(L){return L.x===1&&L.y===0?"up":L.x===1&&L.y===2?"down":L.x===0&&L.y===1?"left":L.x===2&&L.y===1?"right":null},k=function(L,O){if(L<=0)return [];if(O<=0)return [];if(L===1)return [Math.floor(O/2)];let X=[];for(let U=0;U<L;U++)X.push(Math.floor(U*(O-1)/(L-1)));return X};let I=t.nodes.map(()=>({up:[],down:[],left:[],right:[]}));for(let L=0;L<t.edges.length;L++){let O=t.edges[L];if(O.path.length<2)continue;let X=S(O.startDir),U=S(O.endDir);if(X){let $=O.to.gridCoord,N=X==="left"||X==="right"?$?.y??0:$?.x??0;I[O.from.index][X].push({edge:O,kind:"start",otherSort:N,edgeOrder:L});}if(U){let $=O.from.gridCoord,N=U==="left"||U==="right"?$?.y??0:$?.x??0;I[O.to.index][U].push({edge:O,kind:"end",otherSort:N,edgeOrder:L});}}for(let L of t.nodes){if(!L.gridCoord)continue;let O=I[L.index],X=t.config.boxBorderPadding,U=2*X+at(L.displayLabel),$=1+2*X,N=Math.max(U,O.up.length,O.down.length),A=Math.max($,O.left.length,O.right.length),G=L.gridCoord.x+1,v=L.gridCoord.y+1,j=t.columnWidth.get(G)??0;N>j&&t.columnWidth.set(G,N);let W=t.rowHeight.get(v)??0;A>W&&t.rowHeight.set(v,A);}for(let L of t.nodes){let A=function(G,v){if(G.length===0)return;G.sort((E,P)=>E.otherSort-P.otherSort||E.edgeOrder-P.edgeOrder);let j=v==="left"||v==="right"?N:$,W=k(G.length,j);for(let E=0;E<G.length;E++){let P=G[E],T=W[E];v==="left"||v==="right"?P.kind==="start"?P.edge.startPortOffsetY=T:P.edge.endPortOffsetY=T:P.kind==="start"?P.edge.startPortOffsetX=T:P.edge.endPortOffsetX=T;}};if(!L.gridCoord)continue;let O=I[L.index],X=L.gridCoord.x+1,U=L.gridCoord.y+1,$=t.columnWidth.get(X)??0,N=t.rowHeight.get(U)??0;A(O.left,"left"),A(O.right,"right"),A(O.up,"up"),A(O.down,"down");}}for(let S of t.edges)In(t,S);Vo(t);for(let S of t.nodes)S.drawingCoord=Xo(t,S.gridCoord),S.drawing=Rn(S,t);return mn(t.canvas,t.columnWidth,t.rowHeight),jo(t),Uo(t),true}function Ko(t,e){return t.edges.filter(r=>r.from.name===e.name)}function Fe(t,e){return Ko(t,e).map(r=>r.to)}function pe(t){let e={actors:[],messages:[],blocks:[],notes:[]},r=new Set,n=[];for(let o=1;o<t.length;o++){let i=t[o],c=i.match(/^(participant|actor)\s+(\S+?)(?:\s+as\s+(.+))?$/);if(c){let a=c[1],d=c[2],m=c[3]?.trim()??d;r.has(d)||(r.add(d),e.actors.push({id:d,label:m,type:a}));continue}let s=i.match(/^Note\s+(left of|right of|over)\s+([^:]+):\s*(.+)$/i);if(s){let a=s[1].toLowerCase(),d=s[2].trim(),m=s[3].trim(),x=d.split(",").map(p=>p.trim());for(let p of x)ce(e,r,p);let g="over";a==="left of"?g="left":a==="right of"&&(g="right"),e.notes.push({actorIds:x,text:m,position:g,afterIndex:e.messages.length-1});continue}let l=i.match(/^(loop|alt|opt|par|critical|break|rect)\s*(.*)$/);if(l){let a=l[1],d=l[2]?.trim()??"";n.push({type:a,label:d,startIndex:e.messages.length,dividers:[]});continue}let f=i.match(/^(else|and)\s*(.*)$/);if(f&&n.length>0){let a=f[2]?.trim()??"";n[n.length-1].dividers.push({index:e.messages.length,label:a});continue}if(i==="end"&&n.length>0){let a=n.pop();e.blocks.push({type:a.type,label:a.label,startIndex:a.startIndex,endIndex:Math.max(e.messages.length-1,a.startIndex),dividers:a.dividers});continue}let u=i.match(/^(\S+?)\s*(--?>?>|--?[)x]|--?>>|--?>)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(u){let a=u[1],d=u[2],m=u[3],x=u[4],g=u[5].trim();ce(e,r,a),ce(e,r,x);let p=d.startsWith("--")?"dashed":"solid",y=d.includes(">>")||d.includes("x")?"filled":"open",C={from:a,to:x,label:g,lineStyle:p,arrowHead:y};m==="+"&&(C.activate=true),m==="-"&&(C.deactivate=true),e.messages.push(C);continue}let h=i.match(/^(\S+?)\s*(->>|-->>|-\)|--\)|-x|--x|->|-->)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(h){let a=h[1],d=h[2],m=h[3],x=h[4],g=h[5].trim();ce(e,r,a),ce(e,r,x);let p=d.startsWith("--")?"dashed":"solid",y=d.includes(">>")||d.includes("x")?"filled":"open",C={from:a,to:x,label:g,lineStyle:p,arrowHead:y};m==="+"&&(C.activate=true),m==="-"&&(C.deactivate=true),e.messages.push(C);continue}}return e}function ce(t,e,r){e.has(r)||(e.add(r),t.actors.push({id:r,label:r,type:"participant"}));}function Fn(t,e){let r=t.split(`
`).map(E=>E.trim()).filter(E=>E.length>0&&!E.startsWith("%%")),n=pe(r);if(n.actors.length===0)return "";let o=e.useAscii,i=o?"-":"\u2500",c=o?"|":"\u2502",s=o?"+":"\u250C",l=o?"+":"\u2510",f=o?"+":"\u2514",u=o?"+":"\u2518",h=o?"+":"\u252C",a=o?"+":"\u2534",d=o?"+":"\u251C",m=o?"+":"\u2524",x=new Map;n.actors.forEach((E,P)=>x.set(E.id,P));let g=1,y=n.actors.map(E=>at(E.label)+2*g+2).map(E=>Math.ceil(E/2)),C=3,_=new Array(Math.max(n.actors.length-1,0)).fill(0);for(let E of n.messages){let P=x.get(E.from),T=x.get(E.to);if(P===T)continue;let F=Math.min(P,T),H=Math.max(P,T),V=at(E.label)+4,z=H-F,B=Math.ceil(V/z);for(let b=F;b<H;b++)_[b]=Math.max(_[b],B);}let R=[y[0]];for(let E=1;E<n.actors.length;E++){let P=Math.max(y[E-1]+y[E]+2,_[E-1]+2,10);R[E]=R[E-1]+P;}let w=[],S=[],k=new Map,I=new Map,L=new Map,O=[],X=C;for(let E=0;E<n.messages.length;E++){for(let F=0;F<n.blocks.length;F++)n.blocks[F].startIndex===E&&(X+=2,k.set(F,X-1));for(let F=0;F<n.blocks.length;F++)for(let H=0;H<n.blocks[F].dividers.length;H++)n.blocks[F].dividers[H].index===E&&(X+=1,L.set(`${F}:${H}`,X),X+=1);X+=1;let P=n.messages[E];P.from===P.to?(S[E]=X+1,w[E]=X,X+=3):(S[E]=X,w[E]=X+1,X+=2);for(let F=0;F<n.notes.length;F++)if(n.notes[F].afterIndex===E){X+=1;let H=n.notes[F],V=H.text.split("\\n"),z=Math.max(...V.map(D=>at(D)))+4,B=V.length+2,b=x.get(H.actorIds[0])??0,M;if(H.position==="left")M=R[b]-z-1;else if(H.position==="right")M=R[b]+2;else if(H.actorIds.length>=2){let D=x.get(H.actorIds[1])??b;M=Math.floor((R[b]+R[D])/2)-Math.floor(z/2);}else M=R[b]-Math.floor(z/2);M=Math.max(0,M),O.push({x:M,y:X,width:z,height:B,lines:V}),X+=B;}for(let F=0;F<n.blocks.length;F++)n.blocks[F].endIndex===E&&(X+=1,I.set(F,X),X+=1);}X+=1;let U=X,$=U+C,N=R[R.length-1]??0,A=y[y.length-1]??0,G=N+A+2;for(let E=0;E<n.messages.length;E++){let P=n.messages[E];if(P.from===P.to){let T=x.get(P.from),F=R[T]+6+2+at(P.label);G=Math.max(G,F+1);}}for(let E of O)G=Math.max(G,E.x+E.width+1);let v=ut(G,$-1);function j(E,P,T){let F=at(T)+2*g+2,H=E-Math.floor(F/2);v[H][P]=s;for(let z=1;z<F-1;z++)v[H+z][P]=i;v[H+F-1][P]=l,v[H][P+1]=c,v[H+F-1][P+1]=c;let V=H+1+g;ht(v,{x:V,y:P+1},T),v[H][P+2]=f;for(let z=1;z<F-1;z++)v[H+z][P+2]=i;v[H+F-1][P+2]=u;}for(let E=0;E<n.actors.length;E++){let P=R[E];for(let T=C;T<=U;T++)v[P][T]=c;}for(let E=0;E<n.actors.length;E++){let P=n.actors[E];j(R[E],0,P.label),j(R[E],U,P.label),o||(v[R[E]][C-1]=h,v[R[E]][U]=a);}for(let E=0;E<n.messages.length;E++){let P=n.messages[E],T=x.get(P.from),F=x.get(P.to),H=R[T],V=R[F],z=T===F,B=P.lineStyle==="dashed",b=P.arrowHead==="filled",M=B?o?".":"\u254C":i;if(z){let D=w[E],Y=Math.max(4,4);v[H][D]=d;for(let Z=H+1;Z<H+Y;Z++)v[Z][D]=M;v[H+Y][D]=o?"+":"\u2510",v[H+Y][D+1]=c;let K=H+Y+2;ht(v,{x:K,y:D+1},P.label);let J=b?o?"<":"\u25C0":o?"<":"\u25C1";v[H][D+2]=J;for(let Z=H+1;Z<H+Y;Z++)v[Z][D+2]=M;v[H+Y][D+2]=o?"+":"\u2518";}else {let D=S[E],Y=w[E],K=H<V,Z=Math.floor((H+V)/2)-Math.floor(at(P.label)/2);if(ht(v,{x:Math.max(0,Z),y:D},P.label),K){for(let mt=H+1;mt<V;mt++)v[mt][Y]=M;let st=b?o?">":"\u25B6":o?">":"\u25B7";v[V][Y]=st;}else {for(let mt=V+1;mt<H;mt++)v[mt][Y]=M;let st=b?o?"<":"\u25C0":o?"<":"\u25C1";v[V][Y]=st;}}}for(let E=0;E<n.blocks.length;E++){let P=n.blocks[E],T=k.get(E),F=I.get(E);if(T===void 0||F===void 0)continue;let H=G,V=0;for(let M=P.startIndex;M<=P.endIndex&&!(M>=n.messages.length);M++){let D=n.messages[M],Y=x.get(D.from)??0,K=x.get(D.to)??0;H=Math.min(H,R[Math.min(Y,K)]),V=Math.max(V,R[Math.max(Y,K)]);}let z=Math.max(0,H-4),B=Math.min(G-1,V+4);v[z][T]=s;for(let M=z+1;M<B;M++)v[M][T]=i;v[B][T]=l;let b=P.label?`${P.type} [${P.label}]`:P.type;ht(v,{x:z+1,y:T},ae(b,B-(z+1))),v[z][F]=f;for(let M=z+1;M<B;M++)v[M][F]=i;v[B][F]=u;for(let M=T+1;M<F;M++)v[z][M]=c,v[B][M]=c;for(let M=0;M<P.dividers.length;M++){let D=L.get(`${E}:${M}`);if(D===void 0)continue;let Y=W();v[z][D]=d;for(let J=z+1;J<B;J++)v[J][D]=Y;v[B][D]=m;let K=P.dividers[M].label;if(K){let J=`[${K}]`;ht(v,{x:z+1,y:D},ae(J,B-(z+1)));}}}for(let E of O){Ut(v,E.x+E.width,E.y+E.height),v[E.x][E.y]=s;for(let T=1;T<E.width-1;T++)v[E.x+T][E.y]=i;v[E.x+E.width-1][E.y]=l;for(let T=0;T<E.lines.length;T++){let F=E.y+1+T;v[E.x][F]=c,v[E.x+E.width-1][F]=c,ht(v,{x:E.x+2,y:F},E.lines[T]);}let P=E.y+E.height-1;v[E.x][P]=f;for(let T=1;T<E.width-1;T++)v[E.x+T][P]=i;v[E.x+E.width-1][P]=u;}return At(v);function W(){return o?"-":"\u254C"}}function ge(t){let e={classes:[],relationships:[],namespaces:[]},r=new Map,n=null,o=null,i=0;for(let c=1;c<t.length;c++){let s=t[c];if(o&&i>0){if(s==="}"){i--,i===0&&(o=null);continue}let m=s.match(/^<<(\w+)>>$/);if(m){o.annotation=m[1];continue}let x=Yn(s);x&&(x.isMethod?o.methods.push(x.member):o.attributes.push(x.member));continue}let l=s.match(/^namespace\s+(\S+)\s*\{$/);if(l){n={name:l[1],classIds:[]};continue}if(s==="}"&&n){e.namespaces.push(n),n=null;continue}let f=s.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*\{$/);if(f){let m=f[1],x=f[2],g=Qt(r,m);x&&(g.label=`${m}<${x}>`),o=g,i=1,n&&n.classIds.push(m);continue}let u=s.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*$/);if(u){let m=u[1],x=u[2],g=Qt(r,m);x&&(g.label=`${m}<${x}>`),n&&n.classIds.push(m);continue}let h=s.match(/^class\s+(\S+?)\s*\{\s*<<(\w+)>>\s*\}$/);if(h){let m=Qt(r,h[1]);m.annotation=h[2];continue}let a=s.match(/^(\S+?)\s*:\s*(.+)$/);if(a){let m=a[2];if(!m.match(/<\|--|--|\*--|o--|-->|\.\.>|\.\.\|>/)){let x=Qt(r,a[1]),g=Yn(m);g&&(g.isMethod?x.methods.push(g.member):x.attributes.push(g.member));continue}}let d=Jo(s);if(d){Qt(r,d.from),Qt(r,d.to),e.relationships.push(d);continue}}return e.classes=[...r.values()],e}function Qt(t,e){let r=t.get(e);return r||(r={id:e,label:e,attributes:[],methods:[]},t.set(e,r)),r}function Yn(t){let e=t.trim().replace(/;$/,"");if(!e)return null;let r="",n=e;/^[+\-#~]/.test(n)&&(r=n[0],n=n.slice(1).trim());let o=n.match(/^(.+?)\(([^)]*)\)(?:\s*(.+))?$/);if(o){let u=o[1].trim(),h=o[3]?.trim(),a=u.endsWith("$")||n.includes("$"),d=u.endsWith("*")||n.includes("*");return {member:{visibility:r,name:u.replace(/[$*]$/,""),type:h||void 0,isStatic:a,isAbstract:d},isMethod:true}}let i=n.split(/\s+/),c,s;i.length>=2?(s=i[0],c=i.slice(1).join(" ")):c=i[0]??n;let l=c.endsWith("$"),f=c.endsWith("*");return {member:{visibility:r,name:c.replace(/[$*]$/,""),type:s||void 0,isStatic:l,isAbstract:f},isMethod:false}}function Jo(t){let e=t.match(/^(\S+?)\s+(?:"([^"]*?)"\s+)?(<\|--|<\|\.\.|\*--|o--|-->|--\*|--o|--|>\s*|\.\.>|\.\.\|>|--)\s+(?:"([^"]*?)"\s+)?(\S+?)(?:\s*:\s*(.+))?$/);if(!e)return null;let r=e[1],n=e[2]||void 0,o=e[3].trim(),i=e[4]||void 0,c=e[5],s=e[6]?.trim()||void 0,l=Zo(o);return l?{from:r,to:c,type:l.type,markerAt:l.markerAt,label:s,fromCardinality:n,toCardinality:i}:null}function Zo(t){switch(t){case "<|--":return {type:"inheritance",markerAt:"from"};case "<|..":return {type:"realization",markerAt:"from"};case "*--":return {type:"composition",markerAt:"from"};case "--*":return {type:"composition",markerAt:"to"};case "o--":return {type:"aggregation",markerAt:"from"};case "--o":return {type:"aggregation",markerAt:"to"};case "-->":return {type:"association",markerAt:"to"};case "..>":return {type:"dependency",markerAt:"to"};case "..|>":return {type:"realization",markerAt:"to"};case "--":return {type:"association",markerAt:"to"};default:return null}}function Wn(t){let e=t.visibility||"",r=t.type?`: ${t.type}`:"";return `${e}${t.name}${r}`}function Qo(t){let e=[];t.annotation&&e.push(`<<${t.annotation}>>`),e.push(t.label);let r=t.attributes.map(Wn),n=t.methods.map(Wn);return r.length===0&&n.length===0?[e]:n.length===0?[e,r]:[e,r,n]}function ti(t,e){return {type:t,markerAt:e,dashed:t==="dependency"||t==="realization"}}function te(t,e,r){switch(t){case "inheritance":case "realization":return r==="down"?e?"^":"\u25B3":r==="up"?e?"v":"\u25BD":r==="left"?e?">":"\u25C1":e?"<":"\u25B7";case "composition":return e?"*":"\u25C6";case "aggregation":return e?"o":"\u25C7";case "association":case "dependency":return r==="down"?e?"v":"\u25BC":r==="up"?e?"^":"\u25B2":r==="left"?e?"<":"\u25C0":e?">":"\u25B6"}}function Hn(t,e){let r=t.split(`
`).map(A=>A.trim()).filter(A=>A.length>0&&!A.startsWith("%%")),n=ge(r);if(n.classes.length===0)return "";let o=e.useAscii,i=n.relationships.reduce((A,G)=>Math.max(A,G.label?at(` ${G.label} `):0),0),c=Math.max(4,Math.ceil(i/2)+1),s=3,l=new Map,f=new Map,u=new Map;for(let A of n.classes){let G=Qo(A);l.set(A.id,G);let v=0;for(let P of G)for(let T of P)v=Math.max(v,at(T));let j=v+4,W=0;for(let P of G)W+=Math.max(P.length,1);let E=W+(G.length-1)+2;f.set(A.id,j),u.set(A.id,E);}let h=new Map;for(let A of n.classes)h.set(A.id,A);let a=new Map,d=new Map;for(let A of n.relationships){let G=A.type==="inheritance"||A.type==="realization",v=G&&A.markerAt==="to"?A.to:A.from,j=G&&A.markerAt==="to"?A.from:A.to;a.has(j)||a.set(j,new Set),a.get(j).add(v),d.has(v)||d.set(v,new Set),d.get(v).add(j);}let m=new Map,g=n.classes.filter(A=>!a.has(A.id)||a.get(A.id).size===0).map(A=>A.id);for(let A of g)m.set(A,0);let p=n.classes.length-1,y=0;for(;y<g.length;){let A=g[y++],G=d.get(A);if(G)for(let v of G){let j=(m.get(A)??0)+1;j>p||(!m.has(v)||m.get(v)<j)&&(m.set(v,j),g.push(v));}}for(let A of n.classes)m.has(A.id)||m.set(A.id,0);let C=Math.max(...m.values(),0),_=Array.from({length:C+1},()=>[]);for(let A of n.classes)_[m.get(A.id)].push(A.id);let R=new Map,w=0;for(let A=0;A<=C;A++){let G=_[A];if(G.length===0)continue;let v=0,j=0;for(let W of G){let E=h.get(W),P=f.get(W),T=u.get(W);R.set(W,{cls:E,sections:l.get(W),x:v,y:w,width:P,height:T}),v+=P+c,j=Math.max(j,T);}w+=j+s;}let S=0;for(let A of n.relationships){if(!A.label)continue;let G=R.get(A.from),v=R.get(A.to);if(!G||!v)continue;let j=G.x+Math.floor(G.width/2),W=v.x+Math.floor(v.width/2),E=Math.floor((j+W)/2),P=` ${A.label} `,T=E-Math.floor(at(P)/2);S=Math.min(S,T);}let k=S<0?-S:0;if(k>0)for(let A of R.values())A.x+=k;let I=0,L=0;for(let A of R.values())I=Math.max(I,A.x+A.width),L=Math.max(L,A.y+A.height);I+=4,L+=2;let O=ut(I-1,L-1);for(let A of R.values()){let G=he(A.sections,o);for(let v=0;v<G.length;v++)for(let j=0;j<G[0].length;j++){let W=G[v][j];if(W!==" "){let E=A.x+v,P=A.y+j;E<I&&P<L&&(O[E][P]=W);}}}let X=o?"-":"\u2500",U=o?"|":"\u2502",$=o?".":"\u254C",N=o?":":"\u250A";for(let A of n.relationships){let G=R.get(A.from),v=R.get(A.to);if(!G||!v)continue;let j=ti(A.type,A.markerAt),W=j.dashed?$:X,E=j.dashed?N:U,P=G.x+Math.floor(G.width/2),T=G.y+G.height-1,F=v.x+Math.floor(v.width/2),H=v.y;if(T<H){let V=T+Math.floor((H-T)/2);for(let z=T+1;z<=V;z++)z<L&&(O[P][z]=E);if(P!==F){let z=Math.min(P,F),B=Math.max(P,F);for(let b=z;b<=B;b++)b<I&&V<L&&(O[b][V]=W);!o&&V<L&&(P<F?(O[P][V]="\u2514",O[F][V]="\u2510"):(O[P][V]="\u2518",O[F][V]="\u250C"));}for(let z=V+1;z<H;z++)z<L&&(O[F][z]=E);if(j.markerAt==="to"){let z=te(j.type,o,"down"),B=H-1;if(B>=0&&B<L)for(let b=0;b<z.length;b++){let M=F-Math.floor(z.length/2)+b;M>=0&&M<I&&(O[M][B]=z[b]);}}if(j.markerAt==="from"){let z=te(j.type,o,"down"),B=T+1;if(B<L)for(let b=0;b<z.length;b++){let M=P-Math.floor(z.length/2)+b;M>=0&&M<I&&(O[M][B]=z[b]);}}}else if(v.y+v.height-1<G.y){let V=G.y,z=v.y+v.height-1,B=z+Math.floor((V-z)/2);for(let b=V-1;b>=B;b--)b>=0&&b<L&&(O[P][b]=E);if(P!==F){let b=Math.min(P,F),M=Math.max(P,F);for(let D=b;D<=M;D++)D<I&&B>=0&&B<L&&(O[D][B]=W);!o&&B>=0&&B<L&&(P<F?(O[P][B]="\u250C",O[F][B]="\u2518"):(O[P][B]="\u2510",O[F][B]="\u2514"));}for(let b=B-1;b>z;b--)b>=0&&b<L&&(O[F][b]=E);if(j.markerAt==="from"){let b=te(j.type,o,"up"),M=V-1;if(M>=0&&M<L)for(let D=0;D<b.length;D++){let Y=P-Math.floor(b.length/2)+D;Y>=0&&Y<I&&(O[Y][M]=b[D]);}}if(j.markerAt==="to"){let M=j.type==="inheritance"||j.type==="realization"?"down":"up",D=te(j.type,o,M),Y=z+1;if(Y<L)for(let K=0;K<D.length;K++){let J=F-Math.floor(D.length/2)+K;J>=0&&J<I&&(O[J][Y]=D[K]);}}}else {let V=Math.max(T,v.y+v.height-1)+2;Ut(O,I,V+1);for(let b=T+1;b<=V;b++)O[P][b]=E;let z=Math.min(P,F),B=Math.max(P,F);for(let b=z;b<=B;b++)O[b][V]=W;for(let b=V-1;b>=v.y+v.height;b--)O[F][b]=E;if(j.markerAt==="from"){let b=te(j.type,o,"down"),M=T+1;if(M<L)for(let D=0;D<b.length;D++){let Y=P-Math.floor(b.length/2)+D;Y>=0&&Y<I&&(O[Y][M]=b[D]);}}if(j.markerAt==="to"){let b=te(j.type,o,"up"),M=v.y+v.height;if(M<L)for(let D=0;D<b.length;D++){let Y=F-Math.floor(b.length/2)+D;Y>=0&&Y<I&&(O[Y][M]=b[D]);}}}if(A.label){let V=` ${A.label} `,z=Math.floor((P+F)/2),B;if(T<H)B=Math.floor((T+1+H-1)/2);else if(v.y+v.height-1<G.y){let M=v.y+v.height-1;B=Math.floor((M+1+G.y-1)/2);}else B=Math.max(T,v.y+v.height-1)+2;let b=z-Math.floor(at(V)/2);B>=0&&B<L&&ht(O,{x:Math.max(0,b),y:B},V);}}return At(O)}function xe(t){let e={entities:[],relationships:[]},r=new Map,n=null;for(let o=1;o<t.length;o++){let i=t[o];if(n){if(i==="}"){n=null;continue}let l=ei(i);l&&n.attributes.push(l);continue}let c=i.match(/^(\S+)\s*\{$/);if(c){let l=c[1];n=Ye(r,l);continue}let s=ni(i);if(s){Ye(r,s.entity1),Ye(r,s.entity2),e.relationships.push(s);continue}}return e.entities=[...r.values()],e}function Ye(t,e){let r=t.get(e);return r||(r={id:e,label:e,attributes:[]},t.set(e,r)),r}function ei(t){let e=t.match(/^(\S+)\s+(\S+)(?:\s+(.+))?$/);if(!e)return null;let r=e[1],n=e[2],o=e[3]?.trim()??"",i=[],c,s=o.match(/"([^"]*)"/);s&&(c=s[1]);let l=o.replace(/"[^"]*"/,"").trim();for(let f of l.split(/\s+/)){let u=f.toUpperCase();(u==="PK"||u==="FK"||u==="UK")&&i.push(u);}return {type:r,name:n,keys:i,comment:c}}function ni(t){let e=t.match(/^(\S+)\s+([|o}{]+(?:--|\.\.)[|o}{]+)\s+(\S+)\s*:\s*(.+)$/);if(!e)return null;let r=e[1],n=e[2],o=e[3],i=e[4].trim(),c=n.match(/^([|o}{]+)(--|\.\.?)([|o}{]+)$/);if(!c)return null;let s=c[1],l=c[2],f=c[3],u=jn(s),h=jn(f),a=l==="--";return !u||!h?null:{entity1:r,entity2:o,cardinality1:u,cardinality2:h,label:i,identifying:a}}function jn(t){let e=t.split("").sort().join("");return e==="||"?"one":e==="o|"?"zero-one":e==="|}"||e==="{|"?"many":e==="{o"||e==="o{"?"zero-many":null}function ri(t){return `${t.keys.length>0?t.keys.join(",")+" ":"   "}${t.type} ${t.name}`}function oi(t){let e=[t.label],r=t.attributes.map(ri);return r.length===0?[e]:[e,r]}function be(t,e){if(e)switch(t){case "one":return "||";case "zero-one":return "o|";case "many":return "}|";case "zero-many":return "o{"}else switch(t){case "one":return "\u2551";case "zero-one":return "o\u2551";case "many":return "\u255F";case "zero-many":return "o\u255F"}}function Un(t,e){let r=t.split(`
`).map(k=>k.trim()).filter(k=>k.length>0&&!k.startsWith("%%")),n=xe(r);if(n.entities.length===0)return "";let o=e.useAscii,i=n.relationships.reduce((k,I)=>Math.max(k,at(I.label)),0),c=Math.max(6,i),s=4,l=new Map,f=new Map,u=new Map;for(let k of n.entities){let I=oi(k);l.set(k.id,I);let L=0;for(let $ of I)for(let N of $)L=Math.max(L,at(N));let O=L+4,X=0;for(let $ of I)X+=Math.max($.length,1);let U=X+(I.length-1)+2;f.set(k.id,O),u.set(k.id,U);}let h=Math.max(2,Math.ceil(Math.sqrt(n.entities.length))),a=new Map,d=0,m=0,x=0,g=0;for(let k of n.entities){let I=f.get(k.id),L=u.get(k.id);g>=h&&(m+=x+s,d=0,x=0,g=0),a.set(k.id,{entity:k,sections:l.get(k.id),x:d,y:m,width:I,height:L}),d+=I+c,x=Math.max(x,L),g++;}let p=0,y=0;for(let k of a.values())p=Math.max(p,k.x+k.width),y=Math.max(y,k.y+k.height);p+=4,y+=2;let C=ut(p-1,y-1);for(let k of a.values()){let I=he(k.sections,o);for(let L=0;L<I.length;L++)for(let O=0;O<I[0].length;O++){let X=I[L][O];if(X!==" "){let U=k.x+L,$=k.y+O;U<p&&$<y&&(C[U][$]=X);}}}let _=o?"-":"\u2500",R=o?"|":"\u2502",w=o?".":"\u254C",S=o?":":"\u250A";for(let k of n.relationships){let I=a.get(k.entity1),L=a.get(k.entity2);if(!I||!L)continue;let O=k.identifying?_:w,X=k.identifying?R:S,U=I.x+Math.floor(I.width/2),$=I.y+Math.floor(I.height/2),N=L.x+Math.floor(L.width/2),A=L.y+Math.floor(L.height/2);if(Math.abs($-A)<Math.max(I.height,L.height)){let[v,j]=U<N?[I,L]:[L,I],[W,E]=U<N?[k.cardinality1,k.cardinality2]:[k.cardinality2,k.cardinality1],P=v.x+v.width,T=j.x-1,F=v.y+Math.floor(v.height/2);for(let z=P;z<=T;z++)z<p&&(C[z][F]=O);let H=be(W,o);for(let z=0;z<H.length;z++){let B=P+z;B<p&&(C[B][F]=H[z]);}let V=be(E,o);for(let z=0;z<V.length;z++){let B=T-V.length+1+z;B>=0&&B<p&&(C[B][F]=V[z]);}if(k.label){let z=Math.floor((P+T)/2),B=Math.max(P,z-Math.floor(at(k.label)/2)),b=F-1;if(b>=0){let M=Math.max(0,T-B+1),D=ae(k.label,M);ht(C,{x:B,y:b},D);}}}else {let[v,j]=$<A?[I,L]:[L,I],[W,E]=$<A?[k.cardinality1,k.cardinality2]:[k.cardinality2,k.cardinality1],P=v.y+v.height,T=j.y-1,F=v.x+Math.floor(v.width/2);for(let b=P;b<=T;b++)b<y&&(C[F][b]=X);let H=j.x+Math.floor(j.width/2);if(F!==H){let b=Math.floor((P+T)/2),M=Math.min(F,H),D=Math.max(F,H);for(let Y=M;Y<=D;Y++)Y<p&&b<y&&(C[Y][b]=O);for(let Y=b+1;Y<=T;Y++)Y<y&&(C[H][Y]=X);}let V=be(W,o);if(P<y)for(let b=0;b<V.length;b++){let M=F-Math.floor(V.length/2)+b;M>=0&&M<p&&(C[M][P]=V[b]);}let z=F!==H?H:F,B=be(E,o);if(T>=0&&T<y)for(let b=0;b<B.length;b++){let M=z-Math.floor(B.length/2)+b;M>=0&&M<p&&(C[M][T]=B[b]);}if(k.label){let b=Math.floor((P+T)/2),M=F+2;b>=0&&ht(C,{x:M,y:b},k.label);}}}return At(C)}function Kn(t){let e=t.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(e)?"sequence":/^classdiagram\s*$/.test(e)?"class":/^erdiagram\s*$/.test(e)?"er":"flowchart"}function Jn(t){let e=t.useAscii??false,r=t.routing??(e?"strict":"relaxed");return {useAscii:e,paddingX:t.paddingX??5,paddingY:t.paddingY??5,boxBorderPadding:t.boxBorderPadding??1,graphDirection:"TD",routing:r}}function Zn(t,e){let r=se(t);r.direction==="LR"||r.direction==="RL"?e.graphDirection="LR":e.graphDirection="TD";let n=pn(r,e);Xn(n),Gn(n);let o=r.direction==="BT";return o&&hn(n.canvas),n.config.useAscii||fn(n.canvas),{graph:n,flippedVertically:o}}function si(t){let e=t.nodes.filter(n=>n.drawingCoord&&n.drawing).map(n=>{let[o,i]=Ct(n.drawing);return {id:n.name,label:n.displayLabel,box:{x:n.drawingCoord.x,y:n.drawingCoord.y,width:o+1,height:i+1}}}),r=t.edges.map(n=>({from:n.from.name,to:n.to.name,label:n.text,path:On(t,n)}));return {nodes:e,edges:r}}function ai(t,e){return {nodes:t.nodes.map(r=>({...r,box:{...r.box,y:e-(r.box.y+r.box.height-1)}})),edges:t.edges.map(r=>({...r,path:r.path.map(n=>({x:n.x,y:e-n.y}))}))}}function ye(t,e={}){let r=Jn(e);switch(Kn(t)){case "sequence":return Fn(t,r);case "class":return Hn(t,r);case "er":return Un(t,r);default:{let{graph:o}=Zn(t,r);return At(o.canvas)}}}function We(t,e={}){let r=Jn(e);switch(Kn(t)){case "sequence":case "class":case "er":return {text:ye(t,e),meta:{nodes:[],edges:[]}};default:{let{graph:o,flippedVertically:i}=Zn(t,r),c=At(o.canvas),s=si(o);if(!i)return {text:c,meta:s};let[,l]=Ct(o.canvas);return {text:c,meta:ai(s,l)}}}}var ue=$e(we());function lt(t,e,r){let n=r>=600?.58:r>=500?.55:.52;return t.length*e*n}function Ce(t,e){return t.length*e*.6}var Q={nodeLabel:13,edgeLabel:11,groupHeader:12},nt={nodeLabel:500,edgeLabel:400,groupHeader:600},tr=8,ee={horizontal:16,vertical:10,diamondExtra:24},ct={outerBox:1,innerBox:.75,connector:.75},ft="0.35em",ne={width:8,height:4.8};function It(t,e,r,n){return {x:t-r/2,y:e-n/2}}function le(t,e,r,n,o){let i=t.x-e,c=t.y-r;if(Math.abs(i)<.5&&Math.abs(c)<.5)return t;let s=1/(Math.abs(i)/n+Math.abs(c)/o);return {x:e+s*i,y:r+s*c}}function de(t,e,r,n){let o=t.x-e,i=t.y-r,c=Math.sqrt(o*o+i*i);if(c<.5)return t;let s=n/c;return {x:e+s*o,y:r+s*i}}function Rt(t,e=true){if(t.length<2)return t;let r=[t[0]];for(let n=1;n<t.length;n++){let o=r[r.length-1],i=t[n],c=Math.abs(i.x-o.x),s=Math.abs(i.y-o.y);if(c<1||s<1){r.push(i);continue}e?r.push({x:o.x,y:i.y}):r.push({x:i.x,y:o.y}),r.push(i);}return li(r)}function li(t){if(t.length<3)return t;let e=[t[0]];for(let r=1;r<t.length-1;r++){let n=e[e.length-1],o=t[r],i=t[r+1],c=Math.abs(n.x-o.x)<1&&Math.abs(o.x-i.x)<1,s=Math.abs(n.y-o.y)<1&&Math.abs(o.y-i.y)<1;c||s||e.push(o);}return e.push(t[t.length-1]),e}function Xt(t,e,r){if(t.length<2)return t;let n=t.map(o=>({...o}));if(r){let o=n.length-1;if(t.length===2){let i=n[0],c=n[o],s=Math.abs(c.x-i.x);if(Math.abs(c.y-i.y)>=s){let u=c.y>i.y?r.cy-r.hh:r.cy+r.hh;n[o]={x:c.x,y:u};}else {let u=c.x>i.x?r.cx-r.hw:r.cx+r.hw;n[o]={x:u,y:c.y};}}else {let i=n[o-1],c=n[o],s=Math.abs(c.x-i.x),l=Math.abs(c.y-i.y),f=l<1&&s>=1,u=s<1&&l>=1,h=!f&&!u&&l<s,a=!f&&!u&&s<l;if(f){let m=c.x>i.x?r.cx-r.hw:r.cx+r.hw;n[o]={x:m,y:r.cy},n[o-1]={...i,y:r.cy};}else if(u){let m=c.y>i.y?r.cy-r.hh:r.cy+r.hh;n[o]={x:r.cx,y:m},n[o-1]={...i,x:r.cx};}else if(h){let m=c.x>i.x?r.cx-r.hw:r.cx+r.hw;i.y>=r.cy-r.hh&&i.y<=r.cy+r.hh?n[o]={x:m,y:i.y}:(n[o]={x:m,y:r.cy},n[o-1]={...i,y:r.cy});}else if(a){let m=c.y>i.y?r.cy-r.hh:r.cy+r.hh;i.x>=r.cx-r.hw&&i.x<=r.cx+r.hw?n[o]={x:i.x,y:m}:(n[o]={x:r.cx,y:m},n[o-1]={...i,x:r.cx});}}}if(e&&t.length>=3){let o=n[0],i=n[1],c=Math.abs(i.x-o.x),s=Math.abs(i.y-o.y),l=s<1&&c>=1,f=c<1&&s>=1,u=!l&&!f&&s<c,h=!l&&!f&&c<s;if(l){let d=i.x>o.x?e.cx+e.hw:e.cx-e.hw;n[0]={x:d,y:e.cy},n[1]={...n[1],y:e.cy};}else if(f){let d=i.y>o.y?e.cy+e.hh:e.cy-e.hh;n[0]={x:e.cx,y:d},n[1]={...n[1],x:e.cx};}else if(u){let d=i.x>o.x?e.cx+e.hw:e.cx-e.hw;i.y>=e.cy-e.hh&&i.y<=e.cy+e.hh?n[0]={x:d,y:i.y}:(n[0]={x:d,y:e.cy},n[1]={...n[1],y:e.cy});}else if(h){let d=i.y>o.y?e.cy+e.hh:e.cy-e.hh;i.x>=e.cx-e.hw&&i.x<=e.cx+e.hw?n[0]={x:i.x,y:d}:(n[0]={x:e.cx,y:d},n[1]={...n[1],x:e.cx});}}return n}function er(t){let e=Array.from(t.nodes.keys());if(e.length===0)return [];let r=new Map,n=new Map;for(let u of e)r.set(u,u),n.set(u,0);function o(u){return r.get(u)!==u&&r.set(u,o(r.get(u))),r.get(u)}function i(u,h){let a=o(u),d=o(h);if(a===d)return;let m=n.get(a),x=n.get(d);m<x?r.set(a,d):m>x?r.set(d,a):(r.set(d,a),n.set(a,m+1));}for(let u of t.edges)r.has(u.source)&&r.has(u.target)&&i(u.source,u.target);function c(u){let h=[...u.nodeIds];for(let a of u.children)s(a,h);if(r.has(u.id)&&h.length>0)for(let a of h)r.has(a)&&i(u.id,a);if(h.length>1){let a=h[0];for(let d=1;d<h.length;d++)r.has(a)&&r.has(h[d])&&i(a,h[d]);}for(let a of u.children)c(a);}function s(u,h){h.push(...u.nodeIds);for(let a of u.children)s(a,h);}for(let u of t.subgraphs)c(u);let l=new Map;for(let u of e){let h=o(u);l.has(h)||l.set(h,new Set),l.get(h).add(u);}let f=[];for(let[u,h]of l){let a={nodeIds:h,subgraphIds:new Set,edgeIndices:new Set};for(let d=0;d<t.edges.length;d++){let m=t.edges[d];h.has(m.source)&&h.has(m.target)&&a.edgeIndices.add(d);}f.push(a);}return nr(t.subgraphs,f),f.sort((u,h)=>{let a=Math.min(...Array.from(u.nodeIds).map(m=>m.charCodeAt(0))),d=Math.min(...Array.from(h.nodeIds).map(m=>m.charCodeAt(0)));return a-d}),f}function nr(t,e){for(let r of t){let n=rr(r);if(n.size>0){let o=n.values().next().value;for(let i of e)if(i.nodeIds.has(o)){i.subgraphIds.add(r.id),or(r,i.subgraphIds);break}}nr(r.children,e);}}function rr(t){let e=new Set(t.nodeIds);for(let r of t.children)for(let n of rr(r))e.add(n);return e}function or(t,e){for(let r of t.children)e.add(r.id),or(r,e);}function ir(t,e,r){if(t.length===0)return {width:0,height:0,nodes:[],edges:[],groups:[]};if(t.length===1)return t[0];let n=e==="TD"||e==="TB"||e==="BT",o={width:0,height:0,nodes:[],edges:[],groups:[]},i=0;for(let c=0;c<t.length;c++){let s=t[c];if(n){for(let l of s.nodes)o.nodes.push({...l,x:l.x+i});for(let l of s.edges)o.edges.push({...l,points:l.points.map(f=>({x:f.x+i,y:f.y})),labelPosition:l.labelPosition?{x:l.labelPosition.x+i,y:l.labelPosition.y}:void 0});for(let l of s.groups)o.groups.push(sr(l,i));o.width=i+s.width,o.height=Math.max(o.height,s.height),i+=s.width+r;}else {for(let l of s.nodes)o.nodes.push({...l,y:l.y+i});for(let l of s.edges)o.edges.push({...l,points:l.points.map(f=>({x:f.x,y:f.y+i})),labelPosition:l.labelPosition?{x:l.labelPosition.x,y:l.labelPosition.y+i}:void 0});for(let l of s.groups)o.groups.push(ar(l,i));o.width=Math.max(o.width,s.width),o.height=i+s.height,i+=s.height+r;}}return o}function sr(t,e){return {...t,x:t.x+e,children:t.children.map(r=>sr(r,e))}}function ar(t,e){return {...t,y:t.y+e,children:t.children.map(r=>ar(r,e))}}var ve=new Set(["circle","doublecircle","state-start","state-end"]),Se=new Set(["diamond","circle","doublecircle","state-start","state-end"]),di={font:"Inter",padding:40,nodeSpacing:24,layerSpacing:40};function ui(t,e,r){let n=new ue.default.graphlib.Graph({directed:true,compound:true});n.setGraph({rankdir:fr(t.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:16,marginy:12}),n.setDefaultEdgeLabel(()=>({}));let o=new Set;o.add(t.id),ze(t,o);for(let a of t.nodeIds){let d=e.nodes.get(a);if(d){let m=je(a,d.label,d.shape);n.setNode(a,{label:d.label,width:m.width,height:m.height});}}for(let a of t.children)Ue(n,a,e);let i=new Set;for(let a=0;a<e.edges.length;a++){let d=e.edges[a];if(o.has(d.source)&&o.has(d.target)){i.add(a);let m={_index:a};d.label&&(m.label=d.label,m.width=lt(d.label,Q.edgeLabel,nt.edgeLabel)+8,m.height=Q.edgeLabel+6,m.labelpos="c"),n.setEdge(d.source,d.target,m);}}ue.default.layout(n);let c=t.direction==="TD"||t.direction==="TB"||t.direction==="BT",s=new Set;for(let a of t.children)qe(a,s);let l=[];for(let a of n.nodes()){if(s.has(a))continue;let d=e.nodes.get(a);if(!d)continue;let m=n.node(a);if(!m)continue;let x=It(m.x,m.y,m.width,m.height);l.push({id:a,label:d.label,shape:d.shape,x:x.x,y:x.y,width:m.width,height:m.height,inlineStyle:mr(e,a)});}let f=n.edges().map(a=>{let d=n.edge(a),m=e.edges[d._index],x=d.points??[];if(x.length>0){let S=e.nodes.get(a.v)?.shape;if(S==="diamond"){let I=n.node(a.v);x[0]=le(x[0],I.x,I.y,I.width/2,I.height/2);}else if(S&&ve.has(S)){let I=n.node(a.v);x[0]=de(x[0],I.x,I.y,Math.min(I.width,I.height)/2);}let k=e.nodes.get(a.w)?.shape;if(k==="diamond"){let I=n.node(a.w),L=x.length-1;x[L]=le(x[L],I.x,I.y,I.width/2,I.height/2);}else if(k&&ve.has(k)){let I=n.node(a.w),L=x.length-1;x[L]=de(x[L],I.x,I.y,Math.min(I.width,I.height)/2);}}let g=Rt(x,c),p=e.nodes.get(a.v)?.shape,y=e.nodes.get(a.w)?.shape,C=p&&!Se.has(p)||!p?(()=>{let S=n.node(a.v);return S?{cx:S.x,cy:S.y,hw:S.width/2,hh:S.height/2}:null})():null,_=y&&!Se.has(y)||!y?(()=>{let S=n.node(a.w);return S?{cx:S.x,cy:S.y,hw:S.width/2,hh:S.height/2}:null})():null,R=Xt(g,C,_),w;return m.label&&d.x!=null&&d.y!=null&&(w={x:d.x,y:d.y}),{source:m.source,target:m.target,label:m.label,style:m.style,hasArrowStart:m.hasArrowStart,hasArrowEnd:m.hasArrowEnd,points:R,labelPosition:w}}),u=t.children.map(a=>Ve(n,a)),h=n.graph();return {id:t.id,label:t.label,width:h.width??200,height:h.height??100,nodes:l,edges:f,groups:u,nodeIds:o,internalEdgeIndices:i}}async function lr(t,e={}){let r={...di,...e},n=er(t);if(n.length>1){let o=[];for(let s of n){let l=fi(t,s),f=await cr(l,r);o.push(f);}let c=(r.componentSpacing??r.nodeSpacing)-2*r.padding;return ir(o,t.direction,c)}return cr(t,r)}function fi(t,e){let r=new Set,n=ur(t.subgraphs,e.subgraphIds);for(let c of n)dr(c,r);let o=new Map(Array.from(t.nodes.entries()).filter(([c])=>e.nodeIds.has(c)&&!r.has(c))),i=t.edges.filter((c,s)=>e.edgeIndices.has(s));return {direction:t.direction,nodes:o,edges:i,subgraphs:n,classDefs:t.classDefs,classAssignments:t.classAssignments,nodeStyles:t.nodeStyles}}function dr(t,e){e.add(t.id);for(let r of t.children)dr(r,e);}function ur(t,e){return t.filter(r=>e.has(r.id)).map(r=>({...r,children:ur(r.children,e)}))}async function cr(t,e){let r=new Map;for(let f of t.subgraphs)f.direction&&f.direction!==t.direction&&r.set(f.id,ui(f,t,e));let n=new ue.default.graphlib.Graph({directed:true,compound:true});n.setGraph({rankdir:fr(t.direction),acyclicer:"greedy",nodesep:e.nodeSpacing,ranksep:e.layerSpacing,marginx:e.padding,marginy:e.padding}),n.setDefaultEdgeLabel(()=>({}));let o=new Set;for(let f of t.subgraphs)o.add(f.id),ze(f,o);for(let[f,u]of t.nodes)if(!o.has(f)){let h=je(f,u.label,u.shape);n.setNode(f,{label:u.label,width:h.width,height:h.height});}for(let f of t.subgraphs)if(r.has(f.id)){let u=r.get(f.id);n.setNode(f.id,{width:u.width,height:u.height});}else Ue(n,f,t);let i=new Map,c=new Map;for(let f of t.subgraphs)r.has(f.id)||hr(f,i,c);for(let[f,u]of r)for(let h of u.nodeIds)i.set(h,f),c.set(h,f);let s=new Set;for(let f of r.values())for(let u of f.internalEdgeIndices)s.add(u);let l=new Set;for(let f=0;f<t.edges.length;f++){if(s.has(f))continue;let u=t.edges[f],h=c.get(u.source)??u.source,a=i.get(u.target)??u.target,d={_index:f};u.label&&(d.label=u.label,d.width=lt(u.label,Q.edgeLabel,nt.edgeLabel)+8,d.height=Q.edgeLabel+6,d.labelpos="c"),l.has(a)||(d.weight=2,l.add(a)),n.setEdge(h,a,d);}try{ue.default.layout(n);}catch(f){let u=f instanceof Error?f.message:String(f);throw new Error(`Dagre layout failed: ${u}`)}return hi(n,t,e.padding,r)}function fr(t){switch(t){case "LR":return "LR";case "RL":return "RL";case "BT":return "BT";default:return "TB"}}function je(t,e,r){let o=lt(e,Q.nodeLabel,nt.nodeLabel)+ee.horizontal*2,i=Q.nodeLabel+ee.vertical*2;if(r==="diamond"){let c=Math.max(o,i)+ee.diamondExtra;o=c,i=c;}if(r==="circle"||r==="doublecircle"){let c=Math.ceil(Math.sqrt(o*o+i*i))+8;o=r==="doublecircle"?c+12:c,i=o;}return r==="hexagon"&&(o+=ee.horizontal),(r==="trapezoid"||r==="trapezoid-alt")&&(o+=ee.horizontal),r==="asymmetric"&&(o+=12),r==="cylinder"&&(i+=14),(r==="state-start"||r==="state-end")&&(o=28,i=28),o=Math.max(o,60),i=Math.max(i,36),{width:o,height:i}}function Ue(t,e,r,n){t.setNode(e.id,{label:e.label}),n&&t.setParent(e.id,n);for(let o of e.nodeIds){let i=r.nodes.get(o);if(i){let c=je(o,i.label,i.shape);t.setNode(o,{label:i.label,width:c.width,height:c.height}),t.setParent(o,e.id);}}for(let o of e.children)Ue(t,o,r,e.id);}function hr(t,e,r){for(let c of t.children)hr(c,e,r);let n=[...t.nodeIds,...t.children.map(c=>c.id)];if(n.length===0){e.set(t.id,t.id),r.set(t.id,t.id);return}let o=n[0],i=n[n.length-1];e.set(t.id,e.get(o)??o),r.set(t.id,r.get(i)??i);}function mr(t,e){let r=t.classAssignments.get(e),n=r?t.classDefs.get(r):void 0,o=t.nodeStyles.get(e);if(!(!n&&!o))return {...n,...o}}function ze(t,e){for(let r of t.nodeIds)e.add(r);for(let r of t.children)ze(r,e);}function hi(t,e,r,n){let o=[],i=[],c=new Set;for(let p of e.subgraphs)qe(p,c);let s=new Set;if(n)for(let p of n.values())for(let y of p.nodeIds)s.add(y);for(let p of t.nodes()){if(c.has(p))continue;let y=e.nodes.get(p);if(!y)continue;let C=t.node(p);if(!C)continue;let _=It(C.x,C.y,C.width,C.height);o.push({id:p,label:y.label,shape:y.shape,x:_.x,y:_.y,width:C.width,height:C.height,inlineStyle:mr(e,p)});}for(let p of e.subgraphs)i.push(Ve(t,p));let l=e.direction==="TD"||e.direction==="TB"||e.direction==="BT",f=t.edges().map(p=>{let y=t.edge(p),C=e.edges[y._index],_=y.points??[];if(_.length>0){let X=e.nodes.get(p.v)?.shape;if(X==="diamond"){let $=t.node(p.v);_[0]=le(_[0],$.x,$.y,$.width/2,$.height/2);}else if(X&&ve.has(X)){let $=t.node(p.v);_[0]=de(_[0],$.x,$.y,Math.min($.width,$.height)/2);}let U=e.nodes.get(p.w)?.shape;if(U==="diamond"){let $=t.node(p.w),N=_.length-1;_[N]=le(_[N],$.x,$.y,$.width/2,$.height/2);}else if(U&&ve.has(U)){let $=t.node(p.w),N=_.length-1;_[N]=de(_[N],$.x,$.y,Math.min($.width,$.height)/2);}}let R=Rt(_,l),w=e.nodes.get(p.v)?.shape,S=e.nodes.get(p.w)?.shape,k=w&&!Se.has(w)||!w?(()=>{let X=t.node(p.v);return X?{cx:X.x,cy:X.y,hw:X.width/2,hh:X.height/2}:null})():null,I=S&&!Se.has(S)||!S?(()=>{let X=t.node(p.w);return X?{cx:X.x,cy:X.y,hw:X.width/2,hh:X.height/2}:null})():null,L=Xt(R,k,I),O;return C.label&&y.x!=null&&y.y!=null&&(O={x:y.x,y:y.y}),{source:C.source,target:C.target,label:C.label,style:C.style,hasArrowStart:C.hasArrowStart,hasArrowEnd:C.hasArrowEnd,points:L,labelPosition:O}});if(n&&n.size>0){let p=new Map;for(let y of o)p.set(y.id,{cx:y.x+y.width/2,cy:y.y+y.height/2});for(let[y,C]of n){let _=t.node(y);if(!_)continue;let R=It(_.x,_.y,_.width,_.height);for(let S of C.nodes){let k={...S,x:S.x+R.x,y:S.y+R.y};o.push(k),p.set(k.id,{cx:k.x+k.width/2,cy:k.y+k.height/2});}for(let S of C.edges)f.push({...S,points:S.points.map(k=>({x:k.x+R.x,y:k.y+R.y})),labelPosition:S.labelPosition?{x:S.labelPosition.x+R.x,y:S.labelPosition.y+R.y}:void 0});let w=xr(i,y);w&&C.groups.length>0&&(w.children=C.groups.map(S=>br(S,R.x,R.y)));}for(let y of f){if(s.has(y.source)&&s.has(y.target))continue;let C=false;if(s.has(y.source)){let _=p.get(y.source);_&&y.points.length>0&&(y.points[0]={x:_.cx,y:_.cy},C=true);}if(s.has(y.target)){let _=p.get(y.target);_&&y.points.length>0&&(y.points[y.points.length-1]={x:_.cx,y:_.cy},C=true);}C&&(y.points=Rt(y.points,l));}}let u=Q.groupHeader+16;mi(i,u);let h=gr(i),a=[...o.map(p=>p.y),...h.map(p=>p.y)],d=a.length>0?Math.min(...a):r,m=t.graph().width??800,x=t.graph().height??600;if(d<r){let p=r-d;for(let y of o)y.y+=p;for(let y of f){for(let C of y.points)C.y+=p;y.labelPosition&&(y.labelPosition.y+=p);}for(let y of h)y.y+=p;x+=p;}let g=Math.max(...o.map(p=>p.y+p.height),...h.map(p=>p.y+p.height),...f.flatMap(p=>p.points.map(y=>y.y)));return g+r>x&&(x=g+r),{width:m,height:x,nodes:o,edges:f,groups:i}}function Ve(t,e){let r=t.node(e.id),n=r?It(r.x,r.y,r.width,r.height):{x:0,y:0};return {id:e.id,label:e.label,x:n.x,y:n.y,width:r?.width??0,height:r?.height??0,children:e.children.map(o=>Ve(t,o))}}function mi(t,e){for(let r of t)pr(r,e);}function pr(t,e){for(let r of t.children)pr(r,e);if(t.children.length>0){let r=t.y,n=t.y+t.height;for(let o of t.children)r=Math.min(r,o.y),n=Math.max(n,o.y+o.height);t.height=n-r,t.y=r;}if(t.label){let r=e+tr;t.y-=r,t.height+=r;}}function gr(t){let e=[];for(let r of t)e.push(r),e.push(...gr(r.children));return e}function xr(t,e){for(let r of t){if(r.id===e)return r;let n=xr(r.children,e);if(n)return n}}function br(t,e,r){return {...t,x:t.x+e,y:t.y+r,children:t.children.map(n=>br(n,e,r))}}function qe(t,e){e.add(t.id);for(let r of t.children)qe(r,e);}function wr(t,e,r="Inter",n=false){let o=[];o.push(Dt(t.width,t.height,e,n)),o.push(Pt(r,false)),o.push("<defs>"),o.push(pi()),o.push("</defs>");for(let i of t.groups)o.push(Cr(i));for(let i of t.edges)o.push(gi(i));for(let i of t.edges)i.label&&o.push(bi(i));for(let i of t.nodes)o.push(wi(i));for(let i of t.nodes)o.push(Ri(i));return o.push("</svg>"),o.join(`
`)}function pi(){let t=ne.width,e=ne.height;return `  <marker id="arrowhead" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto">
    <polygon points="0 0, ${t} ${e/2}, 0 ${e}" fill="var(--_arrow)" />
  </marker>
  <marker id="arrowhead-start" markerWidth="${t}" markerHeight="${e}" refX="0" refY="${e/2}" orient="auto-start-reverse">
    <polygon points="${t} 0, 0 ${e/2}, ${t} ${e}" fill="var(--_arrow)" />
  </marker>`}function Cr(t,e){let r=Q.groupHeader+16,n=[];n.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" rx="0" ry="0" fill="var(--_group-fill)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),n.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${r}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),n.push(`<text x="${t.x+12}" y="${t.y+r/2}" dy="${ft}" font-size="${Q.groupHeader}" font-weight="${nt.groupHeader}" fill="var(--_text-sec)">${Ft(t.label)}</text>`);for(let o of t.children)n.push(Cr(o));return n.join(`
`)}function gi(t){if(t.points.length<2)return "";let e=xi(t.points),r=t.style==="dotted"?' stroke-dasharray="4 4"':"",n=t.style==="thick"?ct.connector*2:ct.connector,o="";return t.hasArrowEnd&&(o+=' marker-end="url(#arrowhead)"'),t.hasArrowStart&&(o+=' marker-start="url(#arrowhead-start)"'),`<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${n}"${r}${o} />`}function xi(t){return t.map(e=>`${e.x},${e.y}`).join(" ")}function bi(t,e){let r=t.labelPosition??yi(t.points),n=t.label,o=lt(n,Q.edgeLabel,nt.edgeLabel),i=8,c=o+i*2,s=Q.edgeLabel+i*2;return `<rect x="${r.x-c/2}" y="${r.y-s/2}" width="${c}" height="${s}" rx="4" ry="4" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${r.x}" y="${r.y}" text-anchor="middle" dy="${ft}" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Ft(n)}</text>`}function yi(t){if(t.length===0)return {x:0,y:0};if(t.length===1)return t[0];let e=0;for(let n=1;n<t.length;n++)e+=yr(t[n-1],t[n]);let r=e/2;for(let n=1;n<t.length;n++){let o=yr(t[n-1],t[n]);if(r<=o){let i=r/o;return {x:t[n-1].x+i*(t[n].x-t[n-1].x),y:t[n-1].y+i*(t[n].y-t[n-1].y)}}r-=o;}return t[t.length-1]}function yr(t,e){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}function wi(t){let{x:e,y:r,width:n,height:o,shape:i,inlineStyle:c}=t,s=Ft(c?.fill??"var(--_node-fill)"),l=Ft(c?.stroke??"var(--_node-stroke)"),f=Ft(c?.["stroke-width"]??String(ct.innerBox));switch(i){case "diamond":return Mi(e,r,n,o,s,l,f);case "rounded":return vi(e,r,n,o,s,l,f);case "stadium":return Si(e,r,n,o,s,l,f);case "circle":return ki(e,r,n,o,s,l,f);case "subroutine":return $i(e,r,n,o,s,l,f);case "doublecircle":return Ei(e,r,n,o,s,l,f);case "hexagon":return Ai(e,r,n,o,s,l,f);case "cylinder":return _i(e,r,n,o,s,l,f);case "asymmetric":return Li(e,r,n,o,s,l,f);case "trapezoid":return Ii(e,r,n,o,s,l,f);case "trapezoid-alt":return Ti(e,r,n,o,s,l,f);case "state-start":return Pi(e,r,n,o);case "state-end":return Di(e,r,n,o);default:return Ci(e,r,n,o,s,l,f)}}function Ci(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="0" ry="0" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function vi(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="6" ry="6" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Si(t,e,r,n,o,i,c){let s=n/2;return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="${s}" ry="${s}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function ki(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,f=Math.min(r,n)/2;return `<circle cx="${s}" cy="${l}" r="${f}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Mi(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,f=r/2,u=n/2;return `<polygon points="${[`${s},${l-u}`,`${s+f},${l}`,`${s},${l+u}`,`${s-f},${l}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function $i(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="0" ry="0" fill="${o}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+8}" y1="${e}" x2="${t+8}" y2="${e+n}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+r-8}" y1="${e}" x2="${t+r-8}" y2="${e+n}" stroke="${i}" stroke-width="${c}" />`}function Ei(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,f=Math.min(r,n)/2,u=f-5;return `<circle cx="${s}" cy="${l}" r="${f}" fill="${o}" stroke="${i}" stroke-width="${c}" />
<circle cx="${s}" cy="${l}" r="${u}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Ai(t,e,r,n,o,i,c){let s=n/4;return `<polygon points="${[`${t+s},${e}`,`${t+r-s},${e}`,`${t+r},${e+n/2}`,`${t+r-s},${e+n}`,`${t+s},${e+n}`,`${t},${e+n/2}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function _i(t,e,r,n,o,i,c){let l=t+r/2,f=e+7,u=n-14;return `<rect x="${t}" y="${f}" width="${r}" height="${u}" fill="${o}" stroke="none" />
<line x1="${t}" y1="${f}" x2="${t}" y2="${f+u}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+r}" y1="${f}" x2="${t+r}" y2="${f+u}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${e+n-7}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${f}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Li(t,e,r,n,o,i,c){return `<polygon points="${[`${t+12},${e}`,`${t+r},${e}`,`${t+r},${e+n}`,`${t+12},${e+n}`,`${t},${e+n/2}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Ii(t,e,r,n,o,i,c){let s=r*.15;return `<polygon points="${[`${t+s},${e}`,`${t+r-s},${e}`,`${t+r},${e+n}`,`${t},${e+n}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Ti(t,e,r,n,o,i,c){let s=r*.15;return `<polygon points="${[`${t},${e}`,`${t+r},${e}`,`${t+r-s},${e+n}`,`${t+s},${e+n}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Pi(t,e,r,n){let o=t+r/2,i=e+n/2,c=Math.min(r,n)/2-2;return `<circle cx="${o}" cy="${i}" r="${c}" fill="var(--_text)" stroke="none" />`}function Di(t,e,r,n){let o=t+r/2,i=e+n/2,c=Math.min(r,n)/2-2,s=c-4;return `<circle cx="${o}" cy="${i}" r="${c}" fill="none" stroke="var(--_text)" stroke-width="${ct.innerBox*2}" />
<circle cx="${o}" cy="${i}" r="${s}" fill="var(--_text)" stroke="none" />`}function Ri(t,e){if((t.shape==="state-start"||t.shape==="state-end")&&!t.label)return "";let r=t.x+t.width/2,n=t.y+t.height/2,o=Ft(t.inlineStyle?.color??"var(--_text)");return `<text x="${r}" y="${n}" text-anchor="middle" dy="${ft}" font-size="${Q.nodeLabel}" font-weight="${nt.nodeLabel}" fill="${o}">${Ft(t.label)}</text>`}function Ft(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var rt={padding:30,actorGap:140,actorHeight:40,actorPadX:16,headerGap:20,messageRowHeight:40,selfMessageHeight:30,activationWidth:10,blockPadX:10,blockPadTop:40,blockPadBottom:8,blockHeaderExtra:28,dividerExtra:24,noteWidth:120,notePadding:8,noteGap:10};function vr(t,e={}){if(t.actors.length===0)return {width:0,height:0,actors:[],lifelines:[],messages:[],activations:[],blocks:[],notes:[]};let r=t.actors.map(w=>{let S=lt(w.label,Q.nodeLabel,nt.nodeLabel);return Math.max(S+rt.actorPadX*2,80)}),n=[],o=rt.padding+r[0]/2;for(let w=0;w<t.actors.length;w++){if(w>0){let S=Math.max(rt.actorGap,(r[w-1]+r[w])/2+40);o+=S;}n.push(o);}let i=new Map;for(let w=0;w<t.actors.length;w++)i.set(t.actors[w].id,w);let c=rt.padding,s=t.actors.map((w,S)=>({id:w.id,label:w.label,type:w.type,x:n[S],y:c,width:r[S],height:rt.actorHeight})),l=c+rt.actorHeight+rt.headerGap,f=[],u=new Map;for(let w of t.blocks){let S=u.get(w.startIndex)??0;u.set(w.startIndex,Math.max(S,rt.blockHeaderExtra));for(let k of w.dividers){let I=u.get(k.index)??0;u.set(k.index,Math.max(I,rt.dividerExtra));}}let h=new Map,a=[];for(let w=0;w<t.messages.length;w++){let S=t.messages[w],k=i.get(S.from)??0,I=i.get(S.to)??0,L=S.from===S.to,O=u.get(w)??0;O>0&&(l+=O);let X=n[k],U=n[I];if(f.push({from:S.from,to:S.to,label:S.label,lineStyle:S.lineStyle,arrowHead:S.arrowHead,x1:X,x2:U,y:l,isSelf:L}),S.activate&&(h.has(S.to)||h.set(S.to,[]),h.get(S.to).push(l)),S.deactivate){let $=h.get(S.from);if($&&$.length>0){let N=$.pop(),A=i.get(S.from)??0;a.push({actorId:S.from,x:n[A]-rt.activationWidth/2,topY:N,bottomY:l,width:rt.activationWidth});}}l+=L?rt.selfMessageHeight+rt.messageRowHeight:rt.messageRowHeight;}for(let[w,S]of h)for(let k of S){let I=i.get(w)??0;a.push({actorId:w,x:n[I]-rt.activationWidth/2,topY:k,bottomY:l-rt.messageRowHeight/2,width:rt.activationWidth});}let d=t.blocks.map(w=>{let S=f[w.startIndex],k=f[w.endIndex],I=(S?.y??l)-rt.blockPadTop,L=(k?.y??l)+rt.blockPadBottom+12,O=new Set;for(let G=w.startIndex;G<=w.endIndex;G++){let v=t.messages[G];v&&(O.add(i.get(v.from)??0),O.add(i.get(v.to)??0));}if(O.size===0)for(let G=0;G<t.actors.length;G++)O.add(G);let X=Math.min(...O),U=Math.max(...O),$=n[X]-r[X]/2-rt.blockPadX,N=n[U]+r[U]/2+rt.blockPadX,A=w.dividers.map(G=>{let v=f[G.index],j=v?.y??l,W=28;if(G.label&&v?.label){let E=`[${G.label}]`,P=lt(E,Q.edgeLabel,nt.edgeLabel),T=$+8,F=T+P,H=lt(v.label,Q.edgeLabel,nt.edgeLabel),V=v.isSelf?v.x1+36:(v.x1+v.x2)/2-H/2,z=V+H;F>V&&T<z&&(W=36);}return {y:j-W,label:G.label}});return {type:w.type,label:w.label,x:$,y:I,width:N-$,height:L-I,dividers:A}}),m=t.notes.map(w=>{let S=Math.max(rt.noteWidth,lt(w.text,Q.edgeLabel,nt.edgeLabel)+rt.notePadding*2),k=Q.edgeLabel+rt.notePadding*2,L=(f[w.afterIndex]?.y??c+rt.actorHeight)+4,O=i.get(w.actorIds[0]??"")??0,X;if(w.position==="left")X=n[O]-r[O]/2-S-rt.noteGap;else if(w.position==="right")X=n[O]+r[O]/2+rt.noteGap;else if(w.actorIds.length>1){let U=i.get(w.actorIds[w.actorIds.length-1]??"")??O;X=(n[O]+n[U])/2-S/2;}else X=n[O]-S/2;return {text:w.text,x:X,y:L,width:S,height:k}}),x=l+rt.padding,g=rt.padding,p=0;for(let w of s)g=Math.min(g,w.x-w.width/2),p=Math.max(p,w.x+w.width/2);for(let w of d)g=Math.min(g,w.x),p=Math.max(p,w.x+w.width);for(let w of m)g=Math.min(g,w.x),p=Math.max(p,w.x+w.width);let y=g<rt.padding?rt.padding-g:0;if(y>0){for(let w of s)w.x+=y;for(let w of f)w.x1+=y,w.x2+=y;for(let w of a)w.x+=y;for(let w of d)w.x+=y;for(let w of m)w.x+=y;for(let w=0;w<n.length;w++)n[w]+=y;}let C=t.actors.map((w,S)=>({actorId:w.id,x:n[S],topY:c+rt.actorHeight,bottomY:x-rt.padding})),_=p+y+rt.padding,R=x;return {width:Math.max(_,200),height:Math.max(R,100),actors:s,lifelines:C,messages:f,activations:a,blocks:d,notes:m}}function Sr(t,e,r="Inter",n=false){let o=[];o.push(Dt(t.width,t.height,e,n)),o.push(Pt(r,false)),o.push("<defs>"),o.push(Oi()),o.push("</defs>");for(let i of t.blocks)o.push(Fi(i));for(let i of t.lifelines)o.push(Gi(i));for(let i of t.activations)o.push(Bi(i));for(let i of t.messages)o.push(Xi(i));for(let i of t.notes)o.push(Yi(i));for(let i of t.actors)o.push(Ni(i));return o.push("</svg>"),o.join(`
`)}function Oi(){let t=ne.width,e=ne.height;return `  <marker id="seq-arrow" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto-start-reverse">
    <polygon points="0 0, ${t} ${e/2}, 0 ${e}" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto-start-reverse">
    <polyline points="0 0, ${t} ${e/2}, 0 ${e}" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>`}function Ni(t){let{x:e,y:r,width:n,height:o,label:i,type:c}=t;if(c==="actor"){let l=o/24*.9,f=e-12*l,u=r+(o-24*l)/2,h=ct.outerBox/l,a="var(--_line)";return `<g transform="translate(${f},${u}) scale(${l})">
  <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" fill="none" stroke="${a}" stroke-width="${h}" />
  <path d="M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z" fill="none" stroke="${a}" stroke-width="${h}" />
  <path d="M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563" fill="none" stroke="${a}" stroke-width="${h}" />
</g>
<text x="${e}" y="${r+o+14}" text-anchor="middle" font-size="${Q.nodeLabel}" font-weight="${nt.nodeLabel}" fill="var(--_text)">${Yt(i)}</text>`}return `<rect x="${e-n/2}" y="${r}" width="${n}" height="${o}" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />
<text x="${e}" y="${r+o/2}" text-anchor="middle" dy="${ft}" font-size="${Q.nodeLabel}" font-weight="${nt.nodeLabel}" fill="var(--_text)">${Yt(i)}</text>`}function Gi(t){return `<line x1="${t.x}" y1="${t.topY}" x2="${t.x}" y2="${t.bottomY}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`}function Bi(t){return `<rect x="${t.x}" y="${t.topY}" width="${t.width}" height="${t.bottomY-t.topY}" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ct.innerBox}" />`}function Xi(t){let e=[],r=t.lineStyle==="dashed"?' stroke-dasharray="6 4"':"",n=t.arrowHead==="filled"?"seq-arrow":"seq-arrow-open";if(t.isSelf)e.push(`<polyline points="${t.x1},${t.y} ${t.x1+30},${t.y} ${t.x1+30},${t.y+20} ${t.x2},${t.y+20}" fill="none" stroke="var(--_line)" stroke-width="${ct.connector}"${r} marker-end="url(#${n})" />`),e.push(`<text x="${t.x1+30+6}" y="${t.y+20/2}" dy="${ft}" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Yt(t.label)}</text>`);else {e.push(`<line x1="${t.x1}" y1="${t.y}" x2="${t.x2}" y2="${t.y}" stroke="var(--_line)" stroke-width="${ct.connector}"${r} marker-end="url(#${n})" />`);let o=(t.x1+t.x2)/2;e.push(`<text x="${o}" y="${t.y-6}" text-anchor="middle" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Yt(t.label)}</text>`);}return e.join(`
`)}function Fi(t){let e=[];e.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`);let r=`${t.type}${t.label?` [${t.label}]`:""}`,n=lt(r,Q.edgeLabel,nt.groupHeader)+16,o=18;e.push(`<rect x="${t.x}" y="${t.y}" width="${n}" height="${o}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),e.push(`<text x="${t.x+6}" y="${t.y+o/2}" dy="${ft}" font-size="${Q.edgeLabel}" font-weight="${nt.groupHeader}" fill="var(--_text-sec)">${Yt(r)}</text>`);for(let i of t.dividers)e.push(`<line x1="${t.x}" y1="${i.y}" x2="${t.x+t.width}" y2="${i.y}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`),i.label&&e.push(`<text x="${t.x+8}" y="${i.y+14}" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">[${Yt(i.label)}]</text>`);return e.join(`
`)}function Yi(t){return `<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ct.innerBox}" />
<polygon points="${t.x+t.width-6},${t.y} ${t.x+t.width},${t.y+6} ${t.x+t.width-6},${t.y+6}" fill="var(--_inner-stroke)" />
<text x="${t.x+t.width/2}" y="${t.y+t.height/2}" text-anchor="middle" dy="${ft}" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Yt(t.text)}</text>`}function Yt(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Ke=$e(we());var dt={padding:40,boxPadX:8,headerBaseHeight:32,annotationHeight:16,memberRowHeight:20,sectionPadY:8,emptySectionHeight:8,minWidth:120,memberFontSize:11,nodeSpacing:40,layerSpacing:60};async function Mr(t,e={}){if(t.classes.length===0)return {width:0,height:0,classes:[],relationships:[]};let r=new Map;for(let s of t.classes){let l=s.annotation?dt.headerBaseHeight+dt.annotationHeight:dt.headerBaseHeight,f=s.attributes.length>0?s.attributes.length*dt.memberRowHeight+dt.sectionPadY:dt.emptySectionHeight,u=s.methods.length>0?s.methods.length*dt.memberRowHeight+dt.sectionPadY:dt.emptySectionHeight,h=lt(s.label,Q.nodeLabel,nt.nodeLabel),a=kr(s.attributes),d=kr(s.methods),m=Math.max(dt.minWidth,h+dt.boxPadX*2,a+dt.boxPadX*2,d+dt.boxPadX*2),x=l+f+u;r.set(s.id,{width:m,height:x,headerHeight:l,attrHeight:f,methodHeight:u});}let n=new Ke.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"TB",acyclicer:"greedy",nodesep:dt.nodeSpacing,ranksep:dt.layerSpacing,marginx:dt.padding,marginy:dt.padding}),n.setDefaultEdgeLabel(()=>({}));for(let s of t.classes){let l=r.get(s.id);n.setNode(s.id,{width:l.width,height:l.height});}for(let s=0;s<t.relationships.length;s++){let l=t.relationships[s],f={_index:s};l.label&&(f.label=l.label,f.width=lt(l.label,Q.edgeLabel,nt.edgeLabel)+8,f.height=Q.edgeLabel+6,f.labelpos="c"),n.setEdge(l.from,l.to,f);}try{Ke.default.layout(n);}catch(s){let l=s instanceof Error?s.message:String(s);throw new Error(`Dagre layout failed (class diagram): ${l}`)}let o=new Map;for(let s of t.classes)o.set(s.id,s);let i=t.classes.map(s=>{let l=n.node(s.id),f=r.get(s.id),u=It(l.x,l.y,l.width,l.height);return {id:s.id,label:s.label,annotation:s.annotation,attributes:s.attributes,methods:s.methods,x:u.x,y:u.y,width:l.width??f.width,height:l.height??f.height,headerHeight:f.headerHeight,attrHeight:f.attrHeight,methodHeight:f.methodHeight}}),c=n.edges().map(s=>{let l=n.edge(s),f=t.relationships[l._index],u=l.points??[],h=Rt(u,true),a=n.node(s.v),d=n.node(s.w),m=Xt(h,a?{cx:a.x,cy:a.y,hw:a.width/2,hh:a.height/2}:null,d?{cx:d.x,cy:d.y,hw:d.width/2,hh:d.height/2}:null),x;return f.label&&l.x!=null&&l.y!=null&&(x={x:l.x,y:l.y}),{from:f.from,to:f.to,type:f.type,markerAt:f.markerAt,label:f.label,fromCardinality:f.fromCardinality,toCardinality:f.toCardinality,points:m,labelPosition:x}});return {width:n.graph().width??600,height:n.graph().height??400,classes:i,relationships:c}}function kr(t){if(t.length===0)return 0;let e=0;for(let r of t){let n=Wi(r),o=Ce(n,dt.memberFontSize);o>e&&(e=o);}return e}function Wi(t){let e=t.visibility?`${t.visibility} `:"",r=t.type?`: ${t.type}`:"";return `${e}${t.name}${r}`}var ke={memberSize:11,memberWeight:400,annotationSize:10,annotationWeight:500};function Ar(t,e,r="Inter",n=false){let o=[];o.push(Dt(t.width,t.height,e,n)),o.push(Pt(r,true)),o.push("<defs>"),o.push(Hi()),o.push("</defs>");for(let i of t.relationships)o.push(Ui(i));for(let i of t.classes)o.push(ji(i));for(let i of t.relationships)o.push(qi(i));return o.push("</svg>"),o.join(`
`)}function Hi(){return `  <marker id="cls-inherit" markerWidth="12" markerHeight="10" refX="12" refY="5" orient="auto-start-reverse">
    <polygon points="0 0, 12 5, 0 10" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-composition" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--_arrow)" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
  <marker id="cls-aggregation" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto-start-reverse">
    <polyline points="0 0, 8 3, 0 6" fill="none" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>`}function ji(t){let{x:e,y:r,width:n,height:o,headerHeight:i,attrHeight:c,methodHeight:s}=t,l=[];l.push(`<rect x="${e}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),l.push(`<rect x="${e}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`);let f=r+i/2;if(t.annotation){let d=r+12;l.push(`<text x="${e+n/2}" y="${d}" text-anchor="middle" dy="${ft}" font-size="${ke.annotationSize}" font-weight="${ke.annotationWeight}" font-style="italic" fill="var(--_text-muted)">&lt;&lt;${Ot(t.annotation)}&gt;&gt;</text>`),f=r+i/2+6;}l.push(`<text x="${e+n/2}" y="${f}" text-anchor="middle" dy="${ft}" font-size="${Q.nodeLabel}" font-weight="700" fill="var(--_text)">${Ot(t.label)}</text>`);let u=r+i;l.push(`<line x1="${e}" y1="${u}" x2="${e+n}" y2="${u}" stroke="var(--_node-stroke)" stroke-width="${ct.innerBox}" />`);let h=20;for(let d=0;d<t.attributes.length;d++){let m=t.attributes[d],x=u+4+d*h+h/2;l.push($r(m,e+dt.boxPadX,x));}let a=u+c;l.push(`<line x1="${e}" y1="${a}" x2="${e+n}" y2="${a}" stroke="var(--_node-stroke)" stroke-width="${ct.innerBox}" />`);for(let d=0;d<t.methods.length;d++){let m=t.methods[d],x=a+4+d*h+h/2;l.push($r(m,e+dt.boxPadX,x));}return l.join(`
`)}function $r(t,e,r){let n=t.isAbstract?' font-style="italic"':"",o=t.isStatic?' text-decoration="underline"':"",i=[];return t.visibility&&i.push(`<tspan fill="var(--_text-faint)">${Ot(t.visibility)} </tspan>`),i.push(`<tspan fill="var(--_text-sec)">${Ot(t.name)}</tspan>`),t.type&&(i.push('<tspan fill="var(--_text-faint)">: </tspan>'),i.push(`<tspan fill="var(--_text-muted)">${Ot(t.type)}</tspan>`)),`<text x="${e}" y="${r}" class="mono" dy="${ft}" font-size="${ke.memberSize}" font-weight="${ke.memberWeight}"${n}${o}>${i.join("")}</text>`}function Ui(t){if(t.points.length<2)return "";let e=t.points.map(i=>`${i.x},${i.y}`).join(" "),n=t.type==="dependency"||t.type==="realization"?' stroke-dasharray="6 4"':"",o=zi(t.type,t.markerAt);return `<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${ct.connector}"${n}${o} />`}function zi(t,e){let r=Vi(t);return r?e==="from"?` marker-start="url(#${r})"`:` marker-end="url(#${r})"`:""}function Vi(t){switch(t){case "inheritance":case "realization":return "cls-inherit";case "composition":return "cls-composition";case "aggregation":return "cls-aggregation";case "association":case "dependency":return "cls-arrow";default:return null}}function qi(t){if(!t.label&&!t.fromCardinality&&!t.toCardinality||t.points.length<2)return "";let e=[];if(t.label){let r=t.labelPosition??Ki(t.points);e.push(`<text x="${r.x}" y="${r.y-8}" text-anchor="middle" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Ot(t.label)}</text>`);}if(t.fromCardinality){let r=t.points[0],n=t.points[1],o=Er(r,n);e.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Ot(t.fromCardinality)}</text>`);}if(t.toCardinality){let r=t.points[t.points.length-1],n=t.points[t.points.length-2],o=Er(r,n);e.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Ot(t.toCardinality)}</text>`);}return e.join(`
`)}function Ki(t){if(t.length===0)return {x:0,y:0};let e=Math.floor(t.length/2);return t[e]}function Er(t,e){let r=e.x-t.x,n=e.y-t.y;return Math.abs(r)>Math.abs(n)?{x:r>0?14:-14,y:-10}:{x:-14,y:n>0?14:-14}}function Ot(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Je=$e(we());var St={padding:40,boxPadX:12,headerHeight:32,rowHeight:22,minWidth:140,attrFontSize:11,nodeSpacing:50,layerSpacing:70};async function _r(t,e={}){if(t.entities.length===0)return {width:0,height:0,entities:[],relationships:[]};let r=new Map;for(let s of t.entities){let l=lt(s.label,Q.nodeLabel,nt.nodeLabel),f=0;for(let a of s.attributes){let d=`${a.type}  ${a.name}${a.keys.length>0?"  "+a.keys.join(","):""}`,m=Ce(d,St.attrFontSize);m>f&&(f=m);}let u=Math.max(St.minWidth,l+St.boxPadX*2,f+St.boxPadX*2),h=St.headerHeight+Math.max(s.attributes.length,1)*St.rowHeight;r.set(s.id,{width:u,height:h});}let n=new Je.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"LR",acyclicer:"greedy",nodesep:St.nodeSpacing,ranksep:St.layerSpacing,marginx:St.padding,marginy:St.padding}),n.setDefaultEdgeLabel(()=>({}));for(let s of t.entities){let l=r.get(s.id);n.setNode(s.id,{width:l.width,height:l.height});}for(let s=0;s<t.relationships.length;s++){let l=t.relationships[s];n.setEdge(l.entity1,l.entity2,{_index:s,label:l.label,width:lt(l.label,Q.edgeLabel,nt.edgeLabel)+8,height:Q.edgeLabel+6,labelpos:"c"});}try{Je.default.layout(n);}catch(s){let l=s instanceof Error?s.message:String(s);throw new Error(`Dagre layout failed (ER diagram): ${l}`)}let o=new Map;for(let s of t.entities)o.set(s.id,s);let i=t.entities.map(s=>{let l=n.node(s.id),f=It(l.x,l.y,l.width,l.height);return {id:s.id,label:s.label,attributes:s.attributes,x:f.x,y:f.y,width:l.width??r.get(s.id).width,height:l.height??r.get(s.id).height,headerHeight:St.headerHeight,rowHeight:St.rowHeight}}),c=n.edges().map(s=>{let l=n.edge(s),f=t.relationships[l._index],u=l.points??[],h=Rt(u,false),a=n.node(s.v),d=n.node(s.w),m=Xt(h,a?{cx:a.x,cy:a.y,hw:a.width/2,hh:a.height/2}:null,d?{cx:d.x,cy:d.y,hw:d.width/2,hh:d.height/2}:null);return {entity1:f.entity1,entity2:f.entity2,cardinality1:f.cardinality1,cardinality2:f.cardinality2,label:f.label,identifying:f.identifying,points:m}});return {width:n.graph().width??600,height:n.graph().height??400,entities:i,relationships:c}}var Tt={attrSize:11,attrWeight:400,keySize:9,keyWeight:600};function Ir(t,e,r="Inter",n=false){let o=[];o.push(Dt(t.width,t.height,e,n)),o.push(Pt(r,true)),o.push("<defs>"),o.push("</defs>");for(let i of t.relationships)o.push(Qi(i));for(let i of t.entities)o.push(Ji(i));for(let i of t.relationships)o.push(es(i));for(let i of t.relationships)o.push(ts(i));return o.push("</svg>"),o.join(`
`)}function Ji(t){let{x:e,y:r,width:n,height:o,headerHeight:i,rowHeight:c,label:s,attributes:l}=t,f=[];f.push(`<rect x="${e}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),f.push(`<rect x="${e}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ct.outerBox}" />`),f.push(`<text x="${e+n/2}" y="${r+i/2}" text-anchor="middle" dy="${ft}" font-size="${Q.nodeLabel}" font-weight="700" fill="var(--_text)">${Me(s)}</text>`);let u=r+i;f.push(`<line x1="${e}" y1="${u}" x2="${e+n}" y2="${u}" stroke="var(--_node-stroke)" stroke-width="${ct.innerBox}" />`);for(let h=0;h<l.length;h++){let a=l[h],d=u+h*c+c/2;f.push(Zi(a,e,d,n));}return l.length===0&&f.push(`<text x="${e+n/2}" y="${u+c/2}" text-anchor="middle" dy="${ft}" font-size="${Tt.attrSize}" fill="var(--_text-faint)" font-style="italic">(no attributes)</text>`),f.join(`
`)}function Zi(t,e,r,n){let o=[],i=0;if(t.keys.length>0){let l=t.keys.join(",");i=lt(l,Tt.keySize,Tt.keyWeight)+8,o.push(`<rect x="${e+6}" y="${r-7}" width="${i}" height="14" rx="2" ry="2" fill="var(--_key-badge)" />`),o.push(`<text x="${e+6+i/2}" y="${r}" text-anchor="middle" dy="${ft}" font-size="${Tt.keySize}" font-weight="${Tt.keyWeight}" fill="var(--_text-sec)">${t.keys.join(",")}</text>`);}let c=e+8+(i>0?i+6:0);o.push(`<text x="${c}" y="${r}" class="mono" dy="${ft}" font-size="${Tt.attrSize}" font-weight="${Tt.attrWeight}"><tspan fill="var(--_text-muted)">${Me(t.type)}</tspan></text>`);let s=e+n-8;return o.push(`<text x="${s}" y="${r}" class="mono" text-anchor="end" dy="${ft}" font-size="${Tt.attrSize}" font-weight="${Tt.attrWeight}"><tspan fill="var(--_text-sec)">${Me(t.name)}</tspan></text>`),o.join(`
`)}function Qi(t){if(t.points.length<2)return "";let e=t.points.map(n=>`${n.x},${n.y}`).join(" "),r=t.identifying?"":' stroke-dasharray="6 4"';return `<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${ct.connector}"${r} />`}function ts(t){if(!t.label||t.points.length<2)return "";let e=ns(t.points),n=lt(t.label,Q.edgeLabel,nt.edgeLabel)+8,o=Q.edgeLabel+6;return `<rect x="${e.x-n/2}" y="${e.y-o/2}" width="${n}" height="${o}" rx="2" ry="2" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${e.x}" y="${e.y}" text-anchor="middle" dy="${ft}" font-size="${Q.edgeLabel}" font-weight="${nt.edgeLabel}" fill="var(--_text-muted)">${Me(t.label)}</text>`}function es(t){if(t.points.length<2)return "";let e=[],r=t.points[0],n=t.points[1];e.push(Lr(r,n,t.cardinality1));let o=t.points[t.points.length-1],i=t.points[t.points.length-2];return e.push(Lr(o,i,t.cardinality2)),e.join(`
`)}function Lr(t,e,r){let n=[],o=ct.connector+.25,i=t.x-e.x,c=t.y-e.y,s=Math.sqrt(i*i+c*c);if(s===0)return "";let l=i/s,f=c/s,u=-f,h=l,a=t.x-l*4,d=t.y-f*4,m=t.x-l*16,x=t.y-f*16,g=r==="one"||r==="zero-one",p=r==="many"||r==="zero-many",y=r==="zero-one"||r==="zero-many";if(g){n.push(`<line x1="${a+u*6}" y1="${d+h*6}" x2="${a-u*6}" y2="${d-h*6}" stroke="var(--_line)" stroke-width="${o}" />`);let _=a-l*4,R=d-f*4;n.push(`<line x1="${_+u*6}" y1="${R+h*6}" x2="${_-u*6}" y2="${R-h*6}" stroke="var(--_line)" stroke-width="${o}" />`);}if(p){let _=a,R=d;n.push(`<line x1="${_+u*7}" y1="${R+h*7}" x2="${m}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),n.push(`<line x1="${_}" y1="${R}" x2="${m}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),n.push(`<line x1="${_-u*7}" y1="${R-h*7}" x2="${m}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`);}if(y){let C=p?20:12,_=t.x-l*C,R=t.y-f*C;n.push(`<circle cx="${_}" cy="${R}" r="4" fill="var(--bg)" stroke="var(--_line)" stroke-width="${o}" />`);}return n.join(`
`)}function ns(t){if(t.length===0)return {x:0,y:0};if(t.length===1)return t[0];let e=0;for(let o=1;o<t.length;o++){let i=t[o].x-t[o-1].x,c=t[o].y-t[o-1].y;e+=Math.sqrt(i*i+c*c);}if(e===0)return t[0];let r=e/2,n=0;for(let o=1;o<t.length;o++){let i=t[o].x-t[o-1].x,c=t[o].y-t[o-1].y,s=Math.sqrt(i*i+c*c);if(n+s>=r){let l=s>0?(r-n)/s:0;return {x:t[o-1].x+i*l,y:t[o-1].y+c*l}}n+=s;}return t[t.length-1]}function Me(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function rs(t){let e=t.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(e)?"sequence":/^classdiagram\s*$/.test(e)?"class":/^erdiagram\s*$/.test(e)?"er":"flowchart"}function os(t){return {bg:t.bg??Wt.bg,fg:t.fg??Wt.fg,line:t.line,accent:t.accent,muted:t.muted,surface:t.surface,border:t.border}}async function Tr(t,e={}){let r=os(e),n=e.font??"Inter",o=e.transparent??false,i=rs(t),c=t.split(/[\n;]/).map(s=>s.trim()).filter(s=>s.length>0&&!s.startsWith("%%"));switch(i){case "sequence":{let s=pe(c),l=vr(s,e);return Sr(l,r,n,o)}case "class":{let s=ge(c),l=await Mr(s,e);return Ar(l,r,n,o)}case "er":{let s=xe(c),l=await _r(s,e);return Ir(l,r,n,o)}default:{let s=se(t),l=await lr(s,e);return wr(l,r,n,o)}}}typeof window<"u"&&(window.__mermaid={renderMermaid:Tr,renderMermaidAscii:ye,renderMermaidAsciiWithMeta:We,THEMES:Ee,DEFAULTS:Wt,fromShikiTheme:Ae});exports.DEFAULTS=Wt;exports.THEMES=Ee;exports.fromShikiTheme=Ae;exports.renderMermaid=Tr;exports.renderMermaidAscii=ye;exports.renderMermaidAsciiWithMeta=We;return exports;})({});//# sourceMappingURL=beautiful-mermaid.browser.global.js.map
//# sourceMappingURL=beautiful-mermaid.browser.global.js.map