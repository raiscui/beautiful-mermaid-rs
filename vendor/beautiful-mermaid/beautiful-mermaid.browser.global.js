var beautifulMermaid=(function(exports){'use strict';var Gn=Object.create;var Ot=Object.defineProperty;var On=Object.getOwnPropertyDescriptor;var Wn=Object.getOwnPropertyNames;var Hn=Object.getPrototypeOf,Fn=Object.prototype.hasOwnProperty;var ze=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Yn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Bn=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Wn(t))!Fn.call(e,i)&&i!==r&&Ot(e,i,{get:()=>t[i],enumerable:!(n=On(t,i))||n.enumerable});return e};var mt=(e,t,r)=>(r=e!=null?Gn(Hn(e)):{},Bn(Ot(r,"default",{value:e,enumerable:true}),e));var dt=Yn((un,_t)=>{(function(e){if(typeof un=="object"&&typeof _t<"u")_t.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else {var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.dagre=e();}})(function(){return (function(){function n(i,o,c){function a(h,u){if(!o[h]){if(!i[h]){var s=typeof ze=="function"&&ze;if(!u&&s)return s(h,true);if(l)return l(h,true);var d=new Error("Cannot find module '"+h+"'");throw d.code="MODULE_NOT_FOUND",d}var p=o[h]={exports:{}};i[h][0].call(p.exports,function(x){var m=i[h][1][x];return a(m||x)},p,p.exports,n,i,o,c);}return o[h].exports}for(var l=typeof ze=="function"&&ze,f=0;f<c.length;f++)a(c[f]);return a}return n})()({1:[function(n,i,o){i.exports={graphlib:n("@dagrejs/graphlib"),layout:n("./lib/layout"),debug:n("./lib/debug"),util:{time:n("./lib/util").time,notime:n("./lib/util").notime},version:n("./lib/version")};},{"./lib/debug":6,"./lib/layout":8,"./lib/util":27,"./lib/version":28,"@dagrejs/graphlib":29}],2:[function(n,i,o){let c=n("./greedy-fas"),a=n("./util").uniqueId;i.exports={run:l,undo:h};function l(u){(u.graph().acyclicer==="greedy"?c(u,d(u)):f(u)).forEach(p=>{let x=u.edge(p);u.removeEdge(p),x.forwardName=p.name,x.reversed=true,u.setEdge(p.w,p.v,x,a("rev"));});function d(p){return x=>p.edge(x).weight}}function f(u){let s=[],d={},p={};function x(m){Object.hasOwn(p,m)||(p[m]=true,d[m]=true,u.outEdges(m).forEach(g=>{Object.hasOwn(d,g.w)?s.push(g):x(g.w);}),delete d[m]);}return u.nodes().forEach(x),s}function h(u){u.edges().forEach(s=>{let d=u.edge(s);if(d.reversed){u.removeEdge(s);let p=d.forwardName;delete d.reversed,delete d.forwardName,u.setEdge(s.w,s.v,d,p);}});}},{"./greedy-fas":7,"./util":27}],3:[function(n,i,o){let c=n("./util");i.exports=a;function a(f){function h(u){let s=f.children(u),d=f.node(u);if(s.length&&s.forEach(h),Object.hasOwn(d,"minRank")){d.borderLeft=[],d.borderRight=[];for(let p=d.minRank,x=d.maxRank+1;p<x;++p)l(f,"borderLeft","_bl",u,d,p),l(f,"borderRight","_br",u,d,p);}}f.children().forEach(h);}function l(f,h,u,s,d,p){let x={width:0,height:0,rank:p,borderType:h},m=d[h][p-1],g=c.addDummyNode(f,"border",x,u);d[h][p]=g,f.setParent(g,s),m&&f.setEdge(m,g,{weight:1});}},{"./util":27}],4:[function(n,i,o){i.exports={adjust:c,undo:a};function c(p){let x=p.graph().rankdir.toLowerCase();(x==="lr"||x==="rl")&&l(p);}function a(p){let x=p.graph().rankdir.toLowerCase();(x==="bt"||x==="rl")&&h(p),(x==="lr"||x==="rl")&&(s(p),l(p));}function l(p){p.nodes().forEach(x=>f(p.node(x))),p.edges().forEach(x=>f(p.edge(x)));}function f(p){let x=p.width;p.width=p.height,p.height=x;}function h(p){p.nodes().forEach(x=>u(p.node(x))),p.edges().forEach(x=>{let m=p.edge(x);m.points.forEach(u),Object.hasOwn(m,"y")&&u(m);});}function u(p){p.y=-p.y;}function s(p){p.nodes().forEach(x=>d(p.node(x))),p.edges().forEach(x=>{let m=p.edge(x);m.points.forEach(d),Object.hasOwn(m,"x")&&d(m);});}function d(p){let x=p.x;p.x=p.y,p.y=x;}},{}],5:[function(n,i,o){class c{constructor(){let h={};h._next=h._prev=h,this._sentinel=h;}dequeue(){let h=this._sentinel,u=h._prev;if(u!==h)return a(u),u}enqueue(h){let u=this._sentinel;h._prev&&h._next&&a(h),h._next=u._next,u._next._prev=h,u._next=h,h._prev=u;}toString(){let h=[],u=this._sentinel,s=u._prev;for(;s!==u;)h.push(JSON.stringify(s,l)),s=s._prev;return "["+h.join(", ")+"]"}}function a(f){f._prev._next=f._next,f._next._prev=f._prev,delete f._next,delete f._prev;}function l(f,h){if(f!=="_next"&&f!=="_prev")return h}i.exports=c;},{}],6:[function(n,i,o){let c=n("./util"),a=n("@dagrejs/graphlib").Graph;i.exports={debugOrdering:l};function l(f){let h=c.buildLayerMatrix(f),u=new a({compound:true,multigraph:true}).setGraph({});return f.nodes().forEach(s=>{u.setNode(s,{label:s}),u.setParent(s,"layer"+f.node(s).rank);}),f.edges().forEach(s=>u.setEdge(s.v,s.w,{},s.name)),h.forEach((s,d)=>{let p="layer"+d;u.setNode(p,{rank:"same"}),s.reduce((x,m)=>(u.setEdge(x,m,{style:"invis"}),m));}),u}},{"./util":27,"@dagrejs/graphlib":29}],7:[function(n,i,o){let c=n("@dagrejs/graphlib").Graph,a=n("./data/list");i.exports=f;let l=()=>1;function f(x,m){if(x.nodeCount()<=1)return [];let g=s(x,m||l);return h(g.graph,g.buckets,g.zeroIdx).flatMap(v=>x.outEdges(v.v,v.w))}function h(x,m,g){let b=[],v=m[m.length-1],M=m[0],I;for(;x.nodeCount();){for(;I=M.dequeue();)u(x,m,g,I);for(;I=v.dequeue();)u(x,m,g,I);if(x.nodeCount()){for(let y=m.length-2;y>0;--y)if(I=m[y].dequeue(),I){b=b.concat(u(x,m,g,I,true));break}}}return b}function u(x,m,g,b,v){let M=v?[]:void 0;return x.inEdges(b.v).forEach(I=>{let y=x.edge(I),w=x.node(I.v);v&&M.push({v:I.v,w:I.w}),w.out-=y,d(m,g,w);}),x.outEdges(b.v).forEach(I=>{let y=x.edge(I),w=I.w,$=x.node(w);$.in-=y,d(m,g,$);}),x.removeNode(b.v),M}function s(x,m){let g=new c,b=0,v=0;x.nodes().forEach(y=>{g.setNode(y,{v:y,in:0,out:0});}),x.edges().forEach(y=>{let w=g.edge(y.v,y.w)||0,$=m(y),L=w+$;g.setEdge(y.v,y.w,L),v=Math.max(v,g.node(y.v).out+=$),b=Math.max(b,g.node(y.w).in+=$);});let M=p(v+b+3).map(()=>new a),I=b+1;return g.nodes().forEach(y=>{d(M,I,g.node(y));}),{graph:g,buckets:M,zeroIdx:I}}function d(x,m,g){g.out?g.in?x[g.out-g.in+m].enqueue(g):x[x.length-1].enqueue(g):x[0].enqueue(g);}function p(x){let m=[];for(let g=0;g<x;g++)m.push(g);return m}},{"./data/list":5,"@dagrejs/graphlib":29}],8:[function(n,i,o){let c=n("./acyclic"),a=n("./normalize"),l=n("./rank"),f=n("./util").normalizeRanks,h=n("./parent-dummy-chains"),u=n("./util").removeEmptyRanks,s=n("./nesting-graph"),d=n("./add-border-segments"),p=n("./coordinate-system"),x=n("./order"),m=n("./position"),g=n("./util"),b=n("@dagrejs/graphlib").Graph;i.exports=v;function v(S,T){let P=T&&T.debugTiming?g.time:g.notime;P("layout",()=>{let j=P("  buildLayoutGraph",()=>E(S));P("  runLayout",()=>M(j,P,T)),P("  updateInputGraph",()=>I(S,j));});}function M(S,T,P){T("    makeSpaceForEdgeLabels",()=>k(S)),T("    removeSelfEdges",()=>F(S)),T("    acyclic",()=>c.run(S)),T("    nestingGraph.run",()=>s.run(S)),T("    rank",()=>l(g.asNonCompoundGraph(S))),T("    injectEdgeLabelProxies",()=>A(S)),T("    removeEmptyRanks",()=>u(S)),T("    nestingGraph.cleanup",()=>s.cleanup(S)),T("    normalizeRanks",()=>f(S)),T("    assignRankMinMax",()=>D(S)),T("    removeEdgeLabelProxies",()=>C(S)),T("    normalize.run",()=>a.run(S)),T("    parentDummyChains",()=>h(S)),T("    addBorderSegments",()=>d(S)),T("    order",()=>x(S,P)),T("    insertSelfEdges",()=>Y(S)),T("    adjustCoordinateSystem",()=>p.adjust(S)),T("    position",()=>m(S)),T("    positionSelfEdges",()=>W(S)),T("    removeBorderNodes",()=>X(S)),T("    normalize.undo",()=>a.undo(S)),T("    fixupEdgeLabelCoords",()=>_(S)),T("    undoCoordinateSystem",()=>p.undo(S)),T("    translateGraph",()=>H(S)),T("    assignNodeIntersects",()=>q(S)),T("    reversePoints",()=>B(S)),T("    acyclic.undo",()=>c.undo(S));}function I(S,T){S.nodes().forEach(P=>{let j=S.node(P),J=T.node(P);j&&(j.x=J.x,j.y=J.y,j.rank=J.rank,T.children(P).length&&(j.width=J.width,j.height=J.height));}),S.edges().forEach(P=>{let j=S.edge(P),J=T.edge(P);j.points=J.points,Object.hasOwn(J,"x")&&(j.x=J.x,j.y=J.y);}),S.graph().width=T.graph().width,S.graph().height=T.graph().height;}let y=["nodesep","edgesep","ranksep","marginx","marginy"],w={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},$=["acyclicer","ranker","rankdir","align"],L=["width","height","rank"],G={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],R={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},N=["labelpos"];function E(S){let T=new b({multigraph:true,compound:true}),P=V(S.graph());return T.setGraph(Object.assign({},w,z(P,y),g.pick(P,$))),S.nodes().forEach(j=>{let J=V(S.node(j)),Q=z(J,L);Object.keys(G).forEach(te=>{Q[te]===void 0&&(Q[te]=G[te]);}),T.setNode(j,Q),T.setParent(j,S.parent(j));}),S.edges().forEach(j=>{let J=V(S.edge(j));T.setEdge(j,Object.assign({},R,z(J,O),g.pick(J,N)));}),T}function k(S){let T=S.graph();T.ranksep/=2,S.edges().forEach(P=>{let j=S.edge(P);j.minlen*=2,j.labelpos.toLowerCase()!=="c"&&(T.rankdir==="TB"||T.rankdir==="BT"?j.width+=j.labeloffset:j.height+=j.labeloffset);});}function A(S){S.edges().forEach(T=>{let P=S.edge(T);if(P.width&&P.height){let j=S.node(T.v),Q={rank:(S.node(T.w).rank-j.rank)/2+j.rank,e:T};g.addDummyNode(S,"edge-proxy",Q,"_ep");}});}function D(S){let T=0;S.nodes().forEach(P=>{let j=S.node(P);j.borderTop&&(j.minRank=S.node(j.borderTop).rank,j.maxRank=S.node(j.borderBottom).rank,T=Math.max(T,j.maxRank));}),S.graph().maxRank=T;}function C(S){S.nodes().forEach(T=>{let P=S.node(T);P.dummy==="edge-proxy"&&(S.edge(P.e).labelRank=P.rank,S.removeNode(T));});}function H(S){let T=Number.POSITIVE_INFINITY,P=0,j=Number.POSITIVE_INFINITY,J=0,Q=S.graph(),te=Q.marginx||0,ue=Q.marginy||0;function ye(ge){let pe=ge.x,je=ge.y,Pt=ge.width,Gt=ge.height;T=Math.min(T,pe-Pt/2),P=Math.max(P,pe+Pt/2),j=Math.min(j,je-Gt/2),J=Math.max(J,je+Gt/2);}S.nodes().forEach(ge=>ye(S.node(ge))),S.edges().forEach(ge=>{let pe=S.edge(ge);Object.hasOwn(pe,"x")&&ye(pe);}),T-=te,j-=ue,S.nodes().forEach(ge=>{let pe=S.node(ge);pe.x-=T,pe.y-=j;}),S.edges().forEach(ge=>{let pe=S.edge(ge);pe.points.forEach(je=>{je.x-=T,je.y-=j;}),Object.hasOwn(pe,"x")&&(pe.x-=T),Object.hasOwn(pe,"y")&&(pe.y-=j);}),Q.width=P-T+te,Q.height=J-j+ue;}function q(S){S.edges().forEach(T=>{let P=S.edge(T),j=S.node(T.v),J=S.node(T.w),Q,te;P.points?(Q=P.points[0],te=P.points[P.points.length-1]):(P.points=[],Q=J,te=j),P.points.unshift(g.intersectRect(j,Q)),P.points.push(g.intersectRect(J,te));});}function _(S){S.edges().forEach(T=>{let P=S.edge(T);if(Object.hasOwn(P,"x"))switch((P.labelpos==="l"||P.labelpos==="r")&&(P.width-=P.labeloffset),P.labelpos){case "l":P.x-=P.width/2+P.labeloffset;break;case "r":P.x+=P.width/2+P.labeloffset;break}});}function B(S){S.edges().forEach(T=>{let P=S.edge(T);P.reversed&&P.points.reverse();});}function X(S){S.nodes().forEach(T=>{if(S.children(T).length){let P=S.node(T),j=S.node(P.borderTop),J=S.node(P.borderBottom),Q=S.node(P.borderLeft[P.borderLeft.length-1]),te=S.node(P.borderRight[P.borderRight.length-1]);P.width=Math.abs(te.x-Q.x),P.height=Math.abs(J.y-j.y),P.x=Q.x+P.width/2,P.y=j.y+P.height/2;}}),S.nodes().forEach(T=>{S.node(T).dummy==="border"&&S.removeNode(T);});}function F(S){S.edges().forEach(T=>{if(T.v===T.w){var P=S.node(T.v);P.selfEdges||(P.selfEdges=[]),P.selfEdges.push({e:T,label:S.edge(T)}),S.removeEdge(T);}});}function Y(S){var T=g.buildLayerMatrix(S);T.forEach(P=>{var j=0;P.forEach((J,Q)=>{var te=S.node(J);te.order=Q+j,(te.selfEdges||[]).forEach(ue=>{g.addDummyNode(S,"selfedge",{width:ue.label.width,height:ue.label.height,rank:te.rank,order:Q+ ++j,e:ue.e,label:ue.label},"_se");}),delete te.selfEdges;});});}function W(S){S.nodes().forEach(T=>{var P=S.node(T);if(P.dummy==="selfedge"){var j=S.node(P.e.v),J=j.x+j.width/2,Q=j.y,te=P.x-J,ue=j.height/2;S.setEdge(P.e,P.label),S.removeNode(T),P.label.points=[{x:J+2*te/3,y:Q-ue},{x:J+5*te/6,y:Q-ue},{x:J+te,y:Q},{x:J+5*te/6,y:Q+ue},{x:J+2*te/3,y:Q+ue}],P.label.x=P.x,P.label.y=P.y;}});}function z(S,T){return g.mapValues(g.pick(S,T),Number)}function V(S){var T={};return S&&Object.entries(S).forEach(([P,j])=>{typeof P=="string"&&(P=P.toLowerCase()),T[P]=j;}),T}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./nesting-graph":9,"./normalize":10,"./order":15,"./parent-dummy-chains":20,"./position":22,"./rank":24,"./util":27,"@dagrejs/graphlib":29}],9:[function(n,i,o){let c=n("./util");i.exports={run:a,cleanup:u};function a(s){let d=c.addDummyNode(s,"root",{},"_root"),p=f(s),x=Object.values(p),m=c.applyWithChunking(Math.max,x)-1,g=2*m+1;s.graph().nestingRoot=d,s.edges().forEach(v=>s.edge(v).minlen*=g);let b=h(s)+1;s.children().forEach(v=>l(s,d,g,b,m,p,v)),s.graph().nodeRankFactor=g;}function l(s,d,p,x,m,g,b){let v=s.children(b);if(!v.length){b!==d&&s.setEdge(d,b,{weight:0,minlen:p});return}let M=c.addBorderNode(s,"_bt"),I=c.addBorderNode(s,"_bb"),y=s.node(b);s.setParent(M,b),y.borderTop=M,s.setParent(I,b),y.borderBottom=I,v.forEach(w=>{l(s,d,p,x,m,g,w);let $=s.node(w),L=$.borderTop?$.borderTop:w,G=$.borderBottom?$.borderBottom:w,O=$.borderTop?x:2*x,R=L!==G?1:m-g[b]+1;s.setEdge(M,L,{weight:O,minlen:R,nestingEdge:true}),s.setEdge(G,I,{weight:O,minlen:R,nestingEdge:true});}),s.parent(b)||s.setEdge(d,M,{weight:0,minlen:m+g[b]});}function f(s){var d={};function p(x,m){var g=s.children(x);g&&g.length&&g.forEach(b=>p(b,m+1)),d[x]=m;}return s.children().forEach(x=>p(x,1)),d}function h(s){return s.edges().reduce((d,p)=>d+s.edge(p).weight,0)}function u(s){var d=s.graph();s.removeNode(d.nestingRoot),delete d.nestingRoot,s.edges().forEach(p=>{var x=s.edge(p);x.nestingEdge&&s.removeEdge(p);});}},{"./util":27}],10:[function(n,i,o){let c=n("./util");i.exports={run:a,undo:f};function a(h){h.graph().dummyChains=[],h.edges().forEach(u=>l(h,u));}function l(h,u){let s=u.v,d=h.node(s).rank,p=u.w,x=h.node(p).rank,m=u.name,g=h.edge(u),b=g.labelRank;if(x===d+1)return;h.removeEdge(u);let v,M,I;for(I=0,++d;d<x;++I,++d)g.points=[],M={width:0,height:0,edgeLabel:g,edgeObj:u,rank:d},v=c.addDummyNode(h,"edge",M,"_d"),d===b&&(M.width=g.width,M.height=g.height,M.dummy="edge-label",M.labelpos=g.labelpos),h.setEdge(s,v,{weight:g.weight},m),I===0&&h.graph().dummyChains.push(v),s=v;h.setEdge(s,p,{weight:g.weight},m);}function f(h){h.graph().dummyChains.forEach(u=>{let s=h.node(u),d=s.edgeLabel,p;for(h.setEdge(s.edgeObj,d);s.dummy;)p=h.successors(u)[0],h.removeNode(u),d.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(d.x=s.x,d.y=s.y,d.width=s.width,d.height=s.height),u=p,s=h.node(u);});}},{"./util":27}],11:[function(n,i,o){i.exports=c;function c(a,l,f){let h={},u;f.forEach(s=>{let d=a.parent(s),p,x;for(;d;){if(p=a.parent(d),p?(x=h[p],h[p]=d):(x=u,u=d),x&&x!==d){l.setEdge(x,d);return}d=p;}});}},{}],12:[function(n,i,o){i.exports=c;function c(a,l=[]){return l.map(f=>{let h=a.inEdges(f);if(h.length){let u=h.reduce((s,d)=>{let p=a.edge(d),x=a.node(d.v);return {sum:s.sum+p.weight*x.order,weight:s.weight+p.weight}},{sum:0,weight:0});return {v:f,barycenter:u.sum/u.weight,weight:u.weight}}else return {v:f}})}},{}],13:[function(n,i,o){let c=n("@dagrejs/graphlib").Graph,a=n("../util");i.exports=l;function l(h,u,s,d){d||(d=h.nodes());let p=f(h),x=new c({compound:true}).setGraph({root:p}).setDefaultNodeLabel(m=>h.node(m));return d.forEach(m=>{let g=h.node(m),b=h.parent(m);(g.rank===u||g.minRank<=u&&u<=g.maxRank)&&(x.setNode(m),x.setParent(m,b||p),h[s](m).forEach(v=>{let M=v.v===m?v.w:v.v,I=x.edge(M,m),y=I!==void 0?I.weight:0;x.setEdge(M,m,{weight:h.edge(v).weight+y});}),Object.hasOwn(g,"minRank")&&x.setNode(m,{borderLeft:g.borderLeft[u],borderRight:g.borderRight[u]}));}),x}function f(h){for(var u;h.hasNode(u=a.uniqueId("_root")););return u}},{"../util":27,"@dagrejs/graphlib":29}],14:[function(n,i,o){let c=n("../util").zipObject;i.exports=a;function a(f,h){let u=0;for(let s=1;s<h.length;++s)u+=l(f,h[s-1],h[s]);return u}function l(f,h,u){let s=c(u,u.map((b,v)=>v)),d=h.flatMap(b=>f.outEdges(b).map(v=>({pos:s[v.w],weight:f.edge(v).weight})).sort((v,M)=>v.pos-M.pos)),p=1;for(;p<u.length;)p<<=1;let x=2*p-1;p-=1;let m=new Array(x).fill(0),g=0;return d.forEach(b=>{let v=b.pos+p;m[v]+=b.weight;let M=0;for(;v>0;)v%2&&(M+=m[v+1]),v=v-1>>1,m[v]+=b.weight;g+=b.weight*M;}),g}},{"../util":27}],15:[function(n,i,o){let c=n("./init-order"),a=n("./cross-count"),l=n("./sort-subgraph"),f=n("./build-layer-graph"),h=n("./add-subgraph-constraints"),u=n("@dagrejs/graphlib").Graph,s=n("../util");i.exports=d;function d(g,b){if(b&&typeof b.customOrder=="function"){b.customOrder(g,d);return}let v=s.maxRank(g),M=p(g,s.range(1,v+1),"inEdges"),I=p(g,s.range(v-1,-1,-1),"outEdges"),y=c(g);if(m(g,y),b&&b.disableOptimalOrderHeuristic)return;let w=Number.POSITIVE_INFINITY,$;for(let L=0,G=0;G<4;++L,++G){x(L%2?M:I,L%4>=2),y=s.buildLayerMatrix(g);let O=a(g,y);O<w&&(G=0,$=Object.assign({},y),w=O);}m(g,$);}function p(g,b,v){let M=new Map,I=(y,w)=>{M.has(y)||M.set(y,[]),M.get(y).push(w);};for(let y of g.nodes()){let w=g.node(y);if(typeof w.rank=="number"&&I(w.rank,y),typeof w.minRank=="number"&&typeof w.maxRank=="number")for(let $=w.minRank;$<=w.maxRank;$++)$!==w.rank&&I($,y);}return b.map(function(y){return f(g,y,v,M.get(y)||[])})}function x(g,b){let v=new u;g.forEach(function(M){let I=M.graph().root,y=l(M,I,v,b);y.vs.forEach((w,$)=>M.node(w).order=$),h(M,v,y.vs);});}function m(g,b){Object.values(b).forEach(v=>v.forEach((M,I)=>g.node(M).order=I));}},{"../util":27,"./add-subgraph-constraints":11,"./build-layer-graph":13,"./cross-count":14,"./init-order":16,"./sort-subgraph":18,"@dagrejs/graphlib":29}],16:[function(n,i,o){let c=n("../util");i.exports=a;function a(l){let f={},h=l.nodes().filter(m=>!l.children(m).length),u=h.map(m=>l.node(m).rank),s=c.applyWithChunking(Math.max,u),d=c.range(s+1).map(()=>[]);function p(m){if(f[m])return;f[m]=true;let g=l.node(m);d[g.rank].push(m),l.successors(m).forEach(p);}return h.sort((m,g)=>l.node(m).rank-l.node(g).rank).forEach(p),d}},{"../util":27}],17:[function(n,i,o){let c=n("../util");i.exports=a;function a(h,u){let s={};h.forEach((p,x)=>{let m=s[p.v]={indegree:0,in:[],out:[],vs:[p.v],i:x};p.barycenter!==void 0&&(m.barycenter=p.barycenter,m.weight=p.weight);}),u.edges().forEach(p=>{let x=s[p.v],m=s[p.w];x!==void 0&&m!==void 0&&(m.indegree++,x.out.push(s[p.w]));});let d=Object.values(s).filter(p=>!p.indegree);return l(d)}function l(h){let u=[];function s(p){return x=>{x.merged||(x.barycenter===void 0||p.barycenter===void 0||x.barycenter>=p.barycenter)&&f(p,x);}}function d(p){return x=>{x.in.push(p),--x.indegree===0&&h.push(x);}}for(;h.length;){let p=h.pop();u.push(p),p.in.reverse().forEach(s(p)),p.out.forEach(d(p));}return u.filter(p=>!p.merged).map(p=>c.pick(p,["vs","i","barycenter","weight"]))}function f(h,u){let s=0,d=0;h.weight&&(s+=h.barycenter*h.weight,d+=h.weight),u.weight&&(s+=u.barycenter*u.weight,d+=u.weight),h.vs=u.vs.concat(h.vs),h.barycenter=s/d,h.weight=d,h.i=Math.min(u.i,h.i),u.merged=true;}},{"../util":27}],18:[function(n,i,o){let c=n("./barycenter"),a=n("./resolve-conflicts"),l=n("./sort");i.exports=f;function f(s,d,p,x){let m=s.children(d),g=s.node(d),b=g?g.borderLeft:void 0,v=g?g.borderRight:void 0,M={};b&&(m=m.filter($=>$!==b&&$!==v));let I=c(s,m);I.forEach($=>{if(s.children($.v).length){let L=f(s,$.v,p,x);M[$.v]=L,Object.hasOwn(L,"barycenter")&&u($,L);}});let y=a(I,p);h(y,M);let w=l(y,x);if(b&&(w.vs=[b,w.vs,v].flat(true),s.predecessors(b).length)){let $=s.node(s.predecessors(b)[0]),L=s.node(s.predecessors(v)[0]);Object.hasOwn(w,"barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+$.order+L.order)/(w.weight+2),w.weight+=2;}return w}function h(s,d){s.forEach(p=>{p.vs=p.vs.flatMap(x=>d[x]?d[x].vs:x);});}function u(s,d){s.barycenter!==void 0?(s.barycenter=(s.barycenter*s.weight+d.barycenter*d.weight)/(s.weight+d.weight),s.weight+=d.weight):(s.barycenter=d.barycenter,s.weight=d.weight);}},{"./barycenter":12,"./resolve-conflicts":17,"./sort":19}],19:[function(n,i,o){let c=n("../util");i.exports=a;function a(h,u){let s=c.partition(h,M=>Object.hasOwn(M,"barycenter")),d=s.lhs,p=s.rhs.sort((M,I)=>I.i-M.i),x=[],m=0,g=0,b=0;d.sort(f(!!u)),b=l(x,p,b),d.forEach(M=>{b+=M.vs.length,x.push(M.vs),m+=M.barycenter*M.weight,g+=M.weight,b=l(x,p,b);});let v={vs:x.flat(true)};return g&&(v.barycenter=m/g,v.weight=g),v}function l(h,u,s){let d;for(;u.length&&(d=u[u.length-1]).i<=s;)u.pop(),h.push(d.vs),s++;return s}function f(h){return (u,s)=>u.barycenter<s.barycenter?-1:u.barycenter>s.barycenter?1:h?s.i-u.i:u.i-s.i}},{"../util":27}],20:[function(n,i,o){i.exports=c;function c(f){let h=l(f);f.graph().dummyChains.forEach(u=>{let s=f.node(u),d=s.edgeObj,p=a(f,h,d.v,d.w),x=p.path,m=p.lca,g=0,b=x[g],v=true;for(;u!==d.w;){if(s=f.node(u),v){for(;(b=x[g])!==m&&f.node(b).maxRank<s.rank;)g++;b===m&&(v=false);}if(!v){for(;g<x.length-1&&f.node(b=x[g+1]).minRank<=s.rank;)g++;b=x[g];}f.setParent(u,b),u=f.successors(u)[0];}});}function a(f,h,u,s){let d=[],p=[],x=Math.min(h[u].low,h[s].low),m=Math.max(h[u].lim,h[s].lim),g,b;g=u;do g=f.parent(g),d.push(g);while(g&&(h[g].low>x||m>h[g].lim));for(b=g,g=s;(g=f.parent(g))!==b;)p.push(g);return {path:d.concat(p.reverse()),lca:b}}function l(f){let h={},u=0;function s(d){let p=u;f.children(d).forEach(s),h[d]={low:p,lim:u++};}return f.children().forEach(s),h}},{}],21:[function(n,i,o){let c=n("@dagrejs/graphlib").Graph,a=n("../util");i.exports={positionX:v,findType1Conflicts:l,findType2Conflicts:f,addConflict:u,hasConflict:s,verticalAlignment:d,horizontalCompaction:p,alignCoordinates:g,findSmallestWidthAlignment:m,balance:b};function l(y,w){let $={};function L(G,O){let R=0,N=0,E=G.length,k=O[O.length-1];return O.forEach((A,D)=>{let C=h(y,A),H=C?y.node(C).order:E;(C||A===k)&&(O.slice(N,D+1).forEach(q=>{y.predecessors(q).forEach(_=>{let B=y.node(_),X=B.order;(X<R||H<X)&&!(B.dummy&&y.node(q).dummy)&&u($,_,q);});}),N=D+1,R=H);}),O}return w.length&&w.reduce(L),$}function f(y,w){let $={};function L(O,R,N,E,k){let A;a.range(R,N).forEach(D=>{A=O[D],y.node(A).dummy&&y.predecessors(A).forEach(C=>{let H=y.node(C);H.dummy&&(H.order<E||H.order>k)&&u($,C,A);});});}function G(O,R){let N=-1,E,k=0;return R.forEach((A,D)=>{if(y.node(A).dummy==="border"){let C=y.predecessors(A);C.length&&(E=y.node(C[0]).order,L(R,k,D,N,E),k=D,N=E);}L(R,k,R.length,E,O.length);}),R}return w.length&&w.reduce(G),$}function h(y,w){if(y.node(w).dummy)return y.predecessors(w).find($=>y.node($).dummy)}function u(y,w,$){if(w>$){let G=w;w=$,$=G;}let L=y[w];L||(y[w]=L={}),L[$]=true;}function s(y,w,$){if(w>$){let L=w;w=$,$=L;}return !!y[w]&&Object.hasOwn(y[w],$)}function d(y,w,$,L){let G={},O={},R={};return w.forEach(N=>{N.forEach((E,k)=>{G[E]=E,O[E]=E,R[E]=k;});}),w.forEach(N=>{let E=-1;N.forEach(k=>{let A=L(k);if(A.length){A=A.sort((C,H)=>R[C]-R[H]);let D=(A.length-1)/2;for(let C=Math.floor(D),H=Math.ceil(D);C<=H;++C){let q=A[C];O[k]===k&&E<R[q]&&!s($,k,q)&&(O[q]=k,O[k]=G[k]=G[q],E=R[q]);}}});}),{root:G,align:O}}function p(y,w,$,L,G){let O={},R=x(y,w,$,G),N=G?"borderLeft":"borderRight";function E(D,C){let H=R.nodes(),q=H.pop(),_={};for(;q;)_[q]?D(q):(_[q]=true,H.push(q),H=H.concat(C(q))),q=H.pop();}function k(D){O[D]=R.inEdges(D).reduce((C,H)=>Math.max(C,O[H.v]+R.edge(H)),0);}function A(D){let C=R.outEdges(D).reduce((q,_)=>Math.min(q,O[_.w]-R.edge(_)),Number.POSITIVE_INFINITY),H=y.node(D);C!==Number.POSITIVE_INFINITY&&H.borderType!==N&&(O[D]=Math.max(O[D],C));}return E(k,R.predecessors.bind(R)),E(A,R.successors.bind(R)),Object.keys(L).forEach(D=>O[D]=O[$[D]]),O}function x(y,w,$,L){let G=new c,O=y.graph(),R=M(O.nodesep,O.edgesep,L);return w.forEach(N=>{let E;N.forEach(k=>{let A=$[k];if(G.setNode(A),E){var D=$[E],C=G.edge(D,A);G.setEdge(D,A,Math.max(R(y,k,E),C||0));}E=k;});}),G}function m(y,w){return Object.values(w).reduce(($,L)=>{let G=Number.NEGATIVE_INFINITY,O=Number.POSITIVE_INFINITY;Object.entries(L).forEach(([N,E])=>{let k=I(y,N)/2;G=Math.max(E+k,G),O=Math.min(E-k,O);});let R=G-O;return R<$[0]&&($=[R,L]),$},[Number.POSITIVE_INFINITY,null])[1]}function g(y,w){let $=Object.values(w),L=a.applyWithChunking(Math.min,$),G=a.applyWithChunking(Math.max,$);["u","d"].forEach(O=>{["l","r"].forEach(R=>{let N=O+R,E=y[N];if(E===w)return;let k=Object.values(E),A=L-a.applyWithChunking(Math.min,k);R!=="l"&&(A=G-a.applyWithChunking(Math.max,k)),A&&(y[N]=a.mapValues(E,D=>D+A));});});}function b(y,w){return a.mapValues(y.ul,($,L)=>{if(w)return y[w.toLowerCase()][L];{let G=Object.values(y).map(O=>O[L]).sort((O,R)=>O-R);return (G[1]+G[2])/2}})}function v(y){let w=a.buildLayerMatrix(y),$=Object.assign(l(y,w),f(y,w)),L={},G;["u","d"].forEach(R=>{G=R==="u"?w:Object.values(w).reverse(),["l","r"].forEach(N=>{N==="r"&&(G=G.map(D=>Object.values(D).reverse()));let E=(R==="u"?y.predecessors:y.successors).bind(y),k=d(y,G,$,E),A=p(y,G,k.root,k.align,N==="r");N==="r"&&(A=a.mapValues(A,D=>-D)),L[R+N]=A;});});let O=m(y,L);return g(L,O),b(L,y.graph().align)}function M(y,w,$){return (L,G,O)=>{let R=L.node(G),N=L.node(O),E=0,k;if(E+=R.width/2,Object.hasOwn(R,"labelpos"))switch(R.labelpos.toLowerCase()){case "l":k=-R.width/2;break;case "r":k=R.width/2;break}if(k&&(E+=$?k:-k),k=0,E+=(R.dummy?w:y)/2,E+=(N.dummy?w:y)/2,E+=N.width/2,Object.hasOwn(N,"labelpos"))switch(N.labelpos.toLowerCase()){case "l":k=N.width/2;break;case "r":k=-N.width/2;break}return k&&(E+=$?k:-k),k=0,E}}function I(y,w){return y.node(w).width}},{"../util":27,"@dagrejs/graphlib":29}],22:[function(n,i,o){let c=n("../util"),a=n("./bk").positionX;i.exports=l;function l(h){h=c.asNonCompoundGraph(h),f(h),Object.entries(a(h)).forEach(([u,s])=>h.node(u).x=s);}function f(h){let u=c.buildLayerMatrix(h),s=h.graph().ranksep,d=0;u.forEach(p=>{let x=p.reduce((m,g)=>{let b=h.node(g).height;return m>b?m:b},0);p.forEach(m=>h.node(m).y=d+x/2),d+=x+s;});}},{"../util":27,"./bk":21}],23:[function(n,i,o){var c=n("@dagrejs/graphlib").Graph,a=n("./util").slack;i.exports=l;function l(s){var d=new c({directed:false}),p=s.nodes()[0],x=s.nodeCount();d.setNode(p,{});for(var m,g;f(d,s)<x;)m=h(d,s),g=d.hasNode(m.v)?a(s,m):-a(s,m),u(d,s,g);return d}function f(s,d){function p(x){d.nodeEdges(x).forEach(m=>{var g=m.v,b=x===g?m.w:g;!s.hasNode(b)&&!a(d,m)&&(s.setNode(b,{}),s.setEdge(x,b,{}),p(b));});}return s.nodes().forEach(p),s.nodeCount()}function h(s,d){return d.edges().reduce((x,m)=>{let g=Number.POSITIVE_INFINITY;return s.hasNode(m.v)!==s.hasNode(m.w)&&(g=a(d,m)),g<x[0]?[g,m]:x},[Number.POSITIVE_INFINITY,null])[1]}function u(s,d,p){s.nodes().forEach(x=>d.node(x).rank+=p);}},{"./util":26,"@dagrejs/graphlib":29}],24:[function(n,i,o){var c=n("./util"),a=c.longestPath,l=n("./feasible-tree"),f=n("./network-simplex");i.exports=h;function h(p){var x=p.graph().ranker;if(x instanceof Function)return x(p);switch(p.graph().ranker){case "network-simplex":d(p);break;case "tight-tree":s(p);break;case "longest-path":u(p);break;case "none":break;default:d(p);}}var u=a;function s(p){a(p),l(p);}function d(p){f(p);}},{"./feasible-tree":23,"./network-simplex":25,"./util":26}],25:[function(n,i,o){var c=n("./feasible-tree"),a=n("./util").slack,l=n("./util").longestPath,f=n("@dagrejs/graphlib").alg.preorder,h=n("@dagrejs/graphlib").alg.postorder,u=n("../util").simplify;i.exports=s,s.initLowLimValues=m,s.initCutValues=d,s.calcCutValue=x,s.leaveEdge=b,s.enterEdge=v,s.exchangeEdges=M;function s($){$=u($),l($);var L=c($);m(L),d(L,$);for(var G,O;G=b(L);)O=v(L,$,G),M(L,$,G,O);}function d($,L){var G=h($,$.nodes());G=G.slice(0,G.length-1),G.forEach(O=>p($,L,O));}function p($,L,G){var O=$.node(G),R=O.parent;$.edge(G,R).cutvalue=x($,L,G);}function x($,L,G){var O=$.node(G),R=O.parent,N=true,E=L.edge(G,R),k=0;return E||(N=false,E=L.edge(R,G)),k=E.weight,L.nodeEdges(G).forEach(A=>{var D=A.v===G,C=D?A.w:A.v;if(C!==R){var H=D===N,q=L.edge(A).weight;if(k+=H?q:-q,y($,G,C)){var _=$.edge(G,C).cutvalue;k+=H?-_:_;}}}),k}function m($,L){arguments.length<2&&(L=$.nodes()[0]),g($,{},1,L);}function g($,L,G,O,R){var N=G,E=$.node(O);return L[O]=true,$.neighbors(O).forEach(k=>{Object.hasOwn(L,k)||(G=g($,L,G,k,O));}),E.low=N,E.lim=G++,R?E.parent=R:delete E.parent,G}function b($){return $.edges().find(L=>$.edge(L).cutvalue<0)}function v($,L,G){var O=G.v,R=G.w;L.hasEdge(O,R)||(O=G.w,R=G.v);var N=$.node(O),E=$.node(R),k=N,A=false;N.lim>E.lim&&(k=E,A=true);var D=L.edges().filter(C=>A===w($,$.node(C.v),k)&&A!==w($,$.node(C.w),k));return D.reduce((C,H)=>a(L,H)<a(L,C)?H:C)}function M($,L,G,O){var R=G.v,N=G.w;$.removeEdge(R,N),$.setEdge(O.v,O.w,{}),m($),d($,L),I($,L);}function I($,L){var G=$.nodes().find(R=>!L.node(R).parent),O=f($,G);O=O.slice(1),O.forEach(R=>{var N=$.node(R).parent,E=L.edge(R,N),k=false;E||(E=L.edge(N,R),k=true),L.node(R).rank=L.node(N).rank+(k?E.minlen:-E.minlen);});}function y($,L,G){return $.hasEdge(L,G)}function w($,L,G){return G.low<=L.lim&&L.lim<=G.lim}},{"../util":27,"./feasible-tree":23,"./util":26,"@dagrejs/graphlib":29}],26:[function(n,i,o){let{applyWithChunking:c}=n("../util");i.exports={longestPath:a,slack:l};function a(f){var h={};function u(s){var d=f.node(s);if(Object.hasOwn(h,s))return d.rank;h[s]=true;let p=f.outEdges(s).map(m=>m==null?Number.POSITIVE_INFINITY:u(m.w)-f.edge(m).minlen);var x=c(Math.min,p);return x===Number.POSITIVE_INFINITY&&(x=0),d.rank=x}f.sources().forEach(u);}function l(f,h){return f.node(h.w).rank-f.node(h.v).rank-f.edge(h).minlen}},{"../util":27}],27:[function(n,i,o){let c=n("@dagrejs/graphlib").Graph;i.exports={addBorderNode:m,addDummyNode:a,applyWithChunking:v,asNonCompoundGraph:f,buildLayerMatrix:d,intersectRect:s,mapValues:R,maxRank:M,normalizeRanks:p,notime:w,partition:I,pick:O,predecessorWeights:u,range:G,removeEmptyRanks:x,simplify:l,successorWeights:h,time:y,uniqueId:L,zipObject:N};function a(E,k,A,D){for(var C=D;E.hasNode(C);)C=L(D);return A.dummy=k,E.setNode(C,A),C}function l(E){let k=new c().setGraph(E.graph());return E.nodes().forEach(A=>k.setNode(A,E.node(A))),E.edges().forEach(A=>{let D=k.edge(A.v,A.w)||{weight:0,minlen:1},C=E.edge(A);k.setEdge(A.v,A.w,{weight:D.weight+C.weight,minlen:Math.max(D.minlen,C.minlen)});}),k}function f(E){let k=new c({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(A=>{E.children(A).length||k.setNode(A,E.node(A));}),E.edges().forEach(A=>{k.setEdge(A,E.edge(A));}),k}function h(E){let k=E.nodes().map(A=>{let D={};return E.outEdges(A).forEach(C=>{D[C.w]=(D[C.w]||0)+E.edge(C).weight;}),D});return N(E.nodes(),k)}function u(E){let k=E.nodes().map(A=>{let D={};return E.inEdges(A).forEach(C=>{D[C.v]=(D[C.v]||0)+E.edge(C).weight;}),D});return N(E.nodes(),k)}function s(E,k){let A=E.x,D=E.y,C=k.x-A,H=k.y-D,q=E.width/2,_=E.height/2;if(!C&&!H)throw new Error("Not possible to find intersection inside of the rectangle");let B,X;return Math.abs(H)*q>Math.abs(C)*_?(H<0&&(_=-_),B=_*C/H,X=_):(C<0&&(q=-q),B=q,X=q*H/C),{x:A+B,y:D+X}}function d(E){let k=G(M(E)+1).map(()=>[]);return E.nodes().forEach(A=>{let D=E.node(A),C=D.rank;C!==void 0&&(k[C][D.order]=A);}),k}function p(E){let k=E.nodes().map(D=>{let C=E.node(D).rank;return C===void 0?Number.MAX_VALUE:C}),A=v(Math.min,k);E.nodes().forEach(D=>{let C=E.node(D);Object.hasOwn(C,"rank")&&(C.rank-=A);});}function x(E){let k=E.nodes().map(q=>E.node(q).rank),A=v(Math.min,k),D=[];E.nodes().forEach(q=>{let _=E.node(q).rank-A;D[_]||(D[_]=[]),D[_].push(q);});let C=0,H=E.graph().nodeRankFactor;Array.from(D).forEach((q,_)=>{q===void 0&&_%H!==0?--C:q!==void 0&&C&&q.forEach(B=>E.node(B).rank+=C);});}function m(E,k,A,D){let C={width:0,height:0};return arguments.length>=4&&(C.rank=A,C.order=D),a(E,"border",C,k)}function g(E,k=b){let A=[];for(let D=0;D<E.length;D+=k){let C=E.slice(D,D+k);A.push(C);}return A}let b=65535;function v(E,k){if(k.length>b){let A=g(k);return E.apply(null,A.map(D=>E.apply(null,D)))}else return E.apply(null,k)}function M(E){let A=E.nodes().map(D=>{let C=E.node(D).rank;return C===void 0?Number.MIN_VALUE:C});return v(Math.max,A)}function I(E,k){let A={lhs:[],rhs:[]};return E.forEach(D=>{k(D)?A.lhs.push(D):A.rhs.push(D);}),A}function y(E,k){let A=Date.now();try{return k()}finally{console.log(E+" time: "+(Date.now()-A)+"ms");}}function w(E,k){return k()}let $=0;function L(E){var k=++$;return E+(""+k)}function G(E,k,A=1){k==null&&(k=E,E=0);let D=H=>H<k;A<0&&(D=H=>k<H);let C=[];for(let H=E;D(H);H+=A)C.push(H);return C}function O(E,k){let A={};for(let D of k)E[D]!==void 0&&(A[D]=E[D]);return A}function R(E,k){let A=k;return typeof k=="string"&&(A=D=>D[k]),Object.entries(E).reduce((D,[C,H])=>(D[C]=A(H,C),D),{})}function N(E,k){return E.reduce((A,D,C)=>(A[D]=k[C],A),{})}},{"@dagrejs/graphlib":29}],28:[function(n,i,o){i.exports="1.1.8";},{}],29:[function(n,i,o){var c=n("./lib");i.exports={Graph:c.Graph,json:n("./lib/json"),alg:n("./lib/alg"),version:c.version};},{"./lib":45,"./lib/alg":36,"./lib/json":46}],30:[function(n,i,o){i.exports=c;function c(a){var l={},f=[],h;function u(s){Object.hasOwn(l,s)||(l[s]=true,h.push(s),a.successors(s).forEach(u),a.predecessors(s).forEach(u));}return a.nodes().forEach(function(s){h=[],u(s),h.length&&f.push(h);}),f}},{}],31:[function(n,i,o){i.exports=c;function c(h,u,s){Array.isArray(u)||(u=[u]);var d=h.isDirected()?g=>h.successors(g):g=>h.neighbors(g),p=s==="post"?a:l,x=[],m={};return u.forEach(g=>{if(!h.hasNode(g))throw new Error("Graph does not have node: "+g);p(g,d,m,x);}),x}function a(h,u,s,d){for(var p=[[h,false]];p.length>0;){var x=p.pop();x[1]?d.push(x[0]):Object.hasOwn(s,x[0])||(s[x[0]]=true,p.push([x[0],true]),f(u(x[0]),m=>p.push([m,false])));}}function l(h,u,s,d){for(var p=[h];p.length>0;){var x=p.pop();Object.hasOwn(s,x)||(s[x]=true,d.push(x),f(u(x),m=>p.push(m)));}}function f(h,u){for(var s=h.length;s--;)u(h[s],s,h);return h}},{}],32:[function(n,i,o){var c=n("./dijkstra");i.exports=a;function a(l,f,h){return l.nodes().reduce(function(u,s){return u[s]=c(l,s,f,h),u},{})}},{"./dijkstra":33}],33:[function(n,i,o){var c=n("../data/priority-queue");i.exports=l;var a=()=>1;function l(h,u,s,d){return f(h,String(u),s||a,d||function(p){return h.outEdges(p)})}function f(h,u,s,d){var p={},x=new c,m,g,b=function(v){var M=v.v!==m?v.v:v.w,I=p[M],y=s(v),w=g.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+y);w<I.distance&&(I.distance=w,I.predecessor=m,x.decrease(M,w));};for(h.nodes().forEach(function(v){var M=v===u?0:Number.POSITIVE_INFINITY;p[v]={distance:M},x.add(v,M);});x.size()>0&&(m=x.removeMin(),g=p[m],g.distance!==Number.POSITIVE_INFINITY);)d(m).forEach(b);return p}},{"../data/priority-queue":43}],34:[function(n,i,o){var c=n("./tarjan");i.exports=a;function a(l){return c(l).filter(function(f){return f.length>1||f.length===1&&l.hasEdge(f[0],f[0])})}},{"./tarjan":41}],35:[function(n,i,o){i.exports=a;var c=()=>1;function a(f,h,u){return l(f,h||c,u||function(s){return f.outEdges(s)})}function l(f,h,u){var s={},d=f.nodes();return d.forEach(function(p){s[p]={},s[p][p]={distance:0},d.forEach(function(x){p!==x&&(s[p][x]={distance:Number.POSITIVE_INFINITY});}),u(p).forEach(function(x){var m=x.v===p?x.w:x.v,g=h(x);s[p][m]={distance:g,predecessor:p};});}),d.forEach(function(p){var x=s[p];d.forEach(function(m){var g=s[m];d.forEach(function(b){var v=g[p],M=x[b],I=g[b],y=v.distance+M.distance;y<I.distance&&(I.distance=y,I.predecessor=M.predecessor);});});}),s}},{}],36:[function(n,i,o){i.exports={components:n("./components"),dijkstra:n("./dijkstra"),dijkstraAll:n("./dijkstra-all"),findCycles:n("./find-cycles"),floydWarshall:n("./floyd-warshall"),isAcyclic:n("./is-acyclic"),postorder:n("./postorder"),preorder:n("./preorder"),prim:n("./prim"),tarjan:n("./tarjan"),topsort:n("./topsort")};},{"./components":30,"./dijkstra":33,"./dijkstra-all":32,"./find-cycles":34,"./floyd-warshall":35,"./is-acyclic":37,"./postorder":38,"./preorder":39,"./prim":40,"./tarjan":41,"./topsort":42}],37:[function(n,i,o){var c=n("./topsort");i.exports=a;function a(l){try{c(l);}catch(f){if(f instanceof c.CycleException)return  false;throw f}return  true}},{"./topsort":42}],38:[function(n,i,o){var c=n("./dfs");i.exports=a;function a(l,f){return c(l,f,"post")}},{"./dfs":31}],39:[function(n,i,o){var c=n("./dfs");i.exports=a;function a(l,f){return c(l,f,"pre")}},{"./dfs":31}],40:[function(n,i,o){var c=n("../graph"),a=n("../data/priority-queue");i.exports=l;function l(f,h){var u=new c,s={},d=new a,p;function x(g){var b=g.v===p?g.w:g.v,v=d.priority(b);if(v!==void 0){var M=h(g);M<v&&(s[b]=p,d.decrease(b,M));}}if(f.nodeCount()===0)return u;f.nodes().forEach(function(g){d.add(g,Number.POSITIVE_INFINITY),u.setNode(g);}),d.decrease(f.nodes()[0],0);for(var m=false;d.size()>0;){if(p=d.removeMin(),Object.hasOwn(s,p))u.setEdge(p,s[p]);else {if(m)throw new Error("Input graph is not connected: "+f);m=true;}f.nodeEdges(p).forEach(x);}return u}},{"../data/priority-queue":43,"../graph":44}],41:[function(n,i,o){i.exports=c;function c(a){var l=0,f=[],h={},u=[];function s(d){var p=h[d]={onStack:true,lowlink:l,index:l++};if(f.push(d),a.successors(d).forEach(function(g){Object.hasOwn(h,g)?h[g].onStack&&(p.lowlink=Math.min(p.lowlink,h[g].index)):(s(g),p.lowlink=Math.min(p.lowlink,h[g].lowlink));}),p.lowlink===p.index){var x=[],m;do m=f.pop(),h[m].onStack=false,x.push(m);while(d!==m);u.push(x);}}return a.nodes().forEach(function(d){Object.hasOwn(h,d)||s(d);}),u}},{}],42:[function(n,i,o){function c(l){var f={},h={},u=[];function s(d){if(Object.hasOwn(h,d))throw new a;Object.hasOwn(f,d)||(h[d]=true,f[d]=true,l.predecessors(d).forEach(s),delete h[d],u.push(d));}if(l.sinks().forEach(s),Object.keys(f).length!==l.nodeCount())throw new a;return u}class a extends Error{constructor(){super(...arguments);}}i.exports=c,c.CycleException=a;},{}],43:[function(n,i,o){class c{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(l){return l.key})}has(l){return Object.hasOwn(this._keyIndices,l)}priority(l){var f=this._keyIndices[l];if(f!==void 0)return this._arr[f].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(l,f){var h=this._keyIndices;if(l=String(l),!Object.hasOwn(h,l)){var u=this._arr,s=u.length;return h[l]=s,u.push({key:l,priority:f}),this._decrease(s),true}return  false}removeMin(){this._swap(0,this._arr.length-1);var l=this._arr.pop();return delete this._keyIndices[l.key],this._heapify(0),l.key}decrease(l,f){var h=this._keyIndices[l];if(f>this._arr[h].priority)throw new Error("New priority is greater than current priority. Key: "+l+" Old: "+this._arr[h].priority+" New: "+f);this._arr[h].priority=f,this._decrease(h);}_heapify(l){var f=this._arr,h=2*l,u=h+1,s=l;h<f.length&&(s=f[h].priority<f[s].priority?h:s,u<f.length&&(s=f[u].priority<f[s].priority?u:s),s!==l&&(this._swap(l,s),this._heapify(s)));}_decrease(l){for(var f=this._arr,h=f[l].priority,u;l!==0&&(u=l>>1,!(f[u].priority<h));)this._swap(l,u),l=u;}_swap(l,f){var h=this._arr,u=this._keyIndices,s=h[l],d=h[f];h[l]=d,h[f]=s,u[d.key]=l,u[s.key]=f;}}i.exports=c;},{}],44:[function(n,i,o){var c="\0",a="\0",l="";class f{_isDirected=true;_isMultigraph=false;_isCompound=false;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(m){m&&(this._isDirected=Object.hasOwn(m,"directed")?m.directed:true,this._isMultigraph=Object.hasOwn(m,"multigraph")?m.multigraph:false,this._isCompound=Object.hasOwn(m,"compound")?m.compound:false),this._isCompound&&(this._parent={},this._children={},this._children[a]={});}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(m){return this._label=m,this}graph(){return this._label}setDefaultNodeLabel(m){return this._defaultNodeLabelFn=m,typeof m!="function"&&(this._defaultNodeLabelFn=()=>m),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var m=this;return this.nodes().filter(g=>Object.keys(m._in[g]).length===0)}sinks(){var m=this;return this.nodes().filter(g=>Object.keys(m._out[g]).length===0)}setNodes(m,g){var b=arguments,v=this;return m.forEach(function(M){b.length>1?v.setNode(M,g):v.setNode(M);}),this}setNode(m,g){return Object.hasOwn(this._nodes,m)?(arguments.length>1&&(this._nodes[m]=g),this):(this._nodes[m]=arguments.length>1?g:this._defaultNodeLabelFn(m),this._isCompound&&(this._parent[m]=a,this._children[m]={},this._children[a][m]=true),this._in[m]={},this._preds[m]={},this._out[m]={},this._sucs[m]={},++this._nodeCount,this)}node(m){return this._nodes[m]}hasNode(m){return Object.hasOwn(this._nodes,m)}removeNode(m){var g=this;if(Object.hasOwn(this._nodes,m)){var b=v=>g.removeEdge(g._edgeObjs[v]);delete this._nodes[m],this._isCompound&&(this._removeFromParentsChildList(m),delete this._parent[m],this.children(m).forEach(function(v){g.setParent(v);}),delete this._children[m]),Object.keys(this._in[m]).forEach(b),delete this._in[m],delete this._preds[m],Object.keys(this._out[m]).forEach(b),delete this._out[m],delete this._sucs[m],--this._nodeCount;}return this}setParent(m,g){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(g===void 0)g=a;else {g+="";for(var b=g;b!==void 0;b=this.parent(b))if(b===m)throw new Error("Setting "+g+" as parent of "+m+" would create a cycle");this.setNode(g);}return this.setNode(m),this._removeFromParentsChildList(m),this._parent[m]=g,this._children[g][m]=true,this}_removeFromParentsChildList(m){delete this._children[this._parent[m]][m];}parent(m){if(this._isCompound){var g=this._parent[m];if(g!==a)return g}}children(m=a){if(this._isCompound){var g=this._children[m];if(g)return Object.keys(g)}else {if(m===a)return this.nodes();if(this.hasNode(m))return []}}predecessors(m){var g=this._preds[m];if(g)return Object.keys(g)}successors(m){var g=this._sucs[m];if(g)return Object.keys(g)}neighbors(m){var g=this.predecessors(m);if(g){let v=new Set(g);for(var b of this.successors(m))v.add(b);return Array.from(v.values())}}isLeaf(m){var g;return this.isDirected()?g=this.successors(m):g=this.neighbors(m),g.length===0}filterNodes(m){var g=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});g.setGraph(this.graph());var b=this;Object.entries(this._nodes).forEach(function([I,y]){m(I)&&g.setNode(I,y);}),Object.values(this._edgeObjs).forEach(function(I){g.hasNode(I.v)&&g.hasNode(I.w)&&g.setEdge(I,b.edge(I));});var v={};function M(I){var y=b.parent(I);return y===void 0||g.hasNode(y)?(v[I]=y,y):y in v?v[y]:M(y)}return this._isCompound&&g.nodes().forEach(I=>g.setParent(I,M(I))),g}setDefaultEdgeLabel(m){return this._defaultEdgeLabelFn=m,typeof m!="function"&&(this._defaultEdgeLabelFn=()=>m),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(m,g){var b=this,v=arguments;return m.reduce(function(M,I){return v.length>1?b.setEdge(M,I,g):b.setEdge(M,I),I}),this}setEdge(){var m,g,b,v,M=false,I=arguments[0];typeof I=="object"&&I!==null&&"v"in I?(m=I.v,g=I.w,b=I.name,arguments.length===2&&(v=arguments[1],M=true)):(m=I,g=arguments[1],b=arguments[3],arguments.length>2&&(v=arguments[2],M=true)),m=""+m,g=""+g,b!==void 0&&(b=""+b);var y=s(this._isDirected,m,g,b);if(Object.hasOwn(this._edgeLabels,y))return M&&(this._edgeLabels[y]=v),this;if(b!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(m),this.setNode(g),this._edgeLabels[y]=M?v:this._defaultEdgeLabelFn(m,g,b);var w=d(this._isDirected,m,g,b);return m=w.v,g=w.w,Object.freeze(w),this._edgeObjs[y]=w,h(this._preds[g],m),h(this._sucs[m],g),this._in[g][y]=w,this._out[m][y]=w,this._edgeCount++,this}edge(m,g,b){var v=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,m,g,b);return this._edgeLabels[v]}edgeAsObj(){let m=this.edge(...arguments);return typeof m!="object"?{label:m}:m}hasEdge(m,g,b){var v=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,m,g,b);return Object.hasOwn(this._edgeLabels,v)}removeEdge(m,g,b){var v=arguments.length===1?p(this._isDirected,arguments[0]):s(this._isDirected,m,g,b),M=this._edgeObjs[v];return M&&(m=M.v,g=M.w,delete this._edgeLabels[v],delete this._edgeObjs[v],u(this._preds[g],m),u(this._sucs[m],g),delete this._in[g][v],delete this._out[m][v],this._edgeCount--),this}inEdges(m,g){var b=this._in[m];if(b){var v=Object.values(b);return g?v.filter(M=>M.v===g):v}}outEdges(m,g){var b=this._out[m];if(b){var v=Object.values(b);return g?v.filter(M=>M.w===g):v}}nodeEdges(m,g){var b=this.inEdges(m,g);if(b)return b.concat(this.outEdges(m,g))}}function h(x,m){x[m]?x[m]++:x[m]=1;}function u(x,m){--x[m]||delete x[m];}function s(x,m,g,b){var v=""+m,M=""+g;if(!x&&v>M){var I=v;v=M,M=I;}return v+l+M+l+(b===void 0?c:b)}function d(x,m,g,b){var v=""+m,M=""+g;if(!x&&v>M){var I=v;v=M,M=I;}var y={v,w:M};return b&&(y.name=b),y}function p(x,m){return s(x,m.v,m.w,m.name)}i.exports=f;},{}],45:[function(n,i,o){i.exports={Graph:n("./graph"),version:n("./version")};},{"./graph":44,"./version":47}],46:[function(n,i,o){var c=n("./graph");i.exports={write:a,read:h};function a(u){var s={options:{directed:u.isDirected(),multigraph:u.isMultigraph(),compound:u.isCompound()},nodes:l(u),edges:f(u)};return u.graph()!==void 0&&(s.value=structuredClone(u.graph())),s}function l(u){return u.nodes().map(function(s){var d=u.node(s),p=u.parent(s),x={v:s};return d!==void 0&&(x.value=d),p!==void 0&&(x.parent=p),x})}function f(u){return u.edges().map(function(s){var d=u.edge(s),p={v:s.v,w:s.w};return s.name!==void 0&&(p.name=s.name),d!==void 0&&(p.value=d),p})}function h(u){var s=new c(u.options).setGraph(u.value);return u.nodes.forEach(function(d){s.setNode(d.v,d.value),d.parent&&s.setParent(d.v,d.parent);}),u.edges.forEach(function(d){s.setEdge({v:d.v,w:d.w,name:d.name},d.value);}),s}},{"./graph":44}],47:[function(n,i,o){i.exports="2.2.4";},{}]},{},[1])(1)});});var Oe={bg:"#FFFFFF",fg:"#27272A"},be={textSec:60,textMuted:40,textFaint:25,line:30,arrow:50,nodeFill:3,nodeStroke:20,groupHeader:5,innerStroke:12,keyBadge:10},xt={"zinc-light":{bg:"#FFFFFF",fg:"#27272A"},"zinc-dark":{bg:"#18181B",fg:"#FAFAFA"},"tokyo-night":{bg:"#1a1b26",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-storm":{bg:"#24283b",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-light":{bg:"#d5d6db",fg:"#343b58",line:"#34548a",accent:"#34548a",muted:"#9699a3"},"catppuccin-mocha":{bg:"#1e1e2e",fg:"#cdd6f4",line:"#585b70",accent:"#cba6f7",muted:"#6c7086"},"catppuccin-latte":{bg:"#eff1f5",fg:"#4c4f69",line:"#9ca0b0",accent:"#8839ef",muted:"#9ca0b0"},nord:{bg:"#2e3440",fg:"#d8dee9",line:"#4c566a",accent:"#88c0d0",muted:"#616e88"},"nord-light":{bg:"#eceff4",fg:"#2e3440",line:"#aab1c0",accent:"#5e81ac",muted:"#7b88a1"},dracula:{bg:"#282a36",fg:"#f8f8f2",line:"#6272a4",accent:"#bd93f9",muted:"#6272a4"},"github-light":{bg:"#ffffff",fg:"#1f2328",line:"#d1d9e0",accent:"#0969da",muted:"#59636e"},"github-dark":{bg:"#0d1117",fg:"#e6edf3",line:"#3d444d",accent:"#4493f8",muted:"#9198a1"},"solarized-light":{bg:"#fdf6e3",fg:"#657b83",line:"#93a1a1",accent:"#268bd2",muted:"#93a1a1"},"solarized-dark":{bg:"#002b36",fg:"#839496",line:"#586e75",accent:"#268bd2",muted:"#586e75"},"one-dark":{bg:"#282c34",fg:"#abb2bf",line:"#4b5263",accent:"#c678dd",muted:"#5c6370"}};function yt(e){let t=e.colors??{},r=e.type==="dark",n=i=>e.tokenColors?.find(o=>Array.isArray(o.scope)?o.scope.includes(i):o.scope===i)?.settings?.foreground;return {bg:t["editor.background"]??(r?"#1e1e1e":"#ffffff"),fg:t["editor.foreground"]??(r?"#d4d4d4":"#333333"),line:t["editorLineNumber.foreground"]??void 0,accent:t.focusBorder??n("keyword")??void 0,muted:n("comment")??t["editorLineNumber.foreground"]??void 0,surface:t["editor.selectionBackground"]??void 0,border:t["editorWidget.border"]??void 0}}function Se(e,t){let r=[`@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(e)}:wght@400;500;600;700&amp;display=swap');`,...t?["@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');"]:[]],n=`
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${be.textSec}%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${be.textMuted}%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) ${be.textFaint}%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) ${be.line}%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${be.arrow}%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${be.nodeFill}%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${be.nodeStroke}%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) ${be.groupHeader}%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) ${be.innerStroke}%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) ${be.keyBadge}%, var(--bg));`;return ["<style>",`  ${r.join(`
  `)}`,`  text { font-family: '${e}', system-ui, sans-serif; }`,...t?["  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }"]:[],`  svg {${n}`,"  }","</style>"].join(`
`)}function _e(e,t,r,n){let i=[`--bg:${r.bg}`,`--fg:${r.fg}`,r.line?`--line:${r.line}`:"",r.accent?`--accent:${r.accent}`:"",r.muted?`--muted:${r.muted}`:"",r.surface?`--surface:${r.surface}`:"",r.border?`--border:${r.border}`:""].filter(Boolean).join(";");return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${t}" width="${e}" height="${t}" style="${i}${n?"":";background:var(--bg)"}">`}function Ue(e){let t=e.split(/[\n;]/).map(n=>n.trim()).filter(n=>n.length>0&&!n.startsWith("%%"));if(t.length===0)throw new Error("Empty mermaid diagram");let r=t[0];return /^stateDiagram(-v2)?\s*$/i.test(r)?jn(t):Xn(t)}function Xn(e){let t=e[0].match(/^(?:graph|flowchart)\s+(TD|TB|LR|BT|RL)\s*$/i);if(!t)throw new Error(`Invalid mermaid header: "${e[0]}". Expected "graph TD", "flowchart LR", "stateDiagram-v2", etc.`);let n={direction:t[1].toUpperCase(),nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},i=[];for(let o=1;o<e.length;o++){let c=e[o],a=c.match(/^classDef\s+(\w+)\s+(.+)$/);if(a){let s=a[1],d=a[2],p=Ht(d);n.classDefs.set(s,p);continue}let l=c.match(/^class\s+([^\s]+)\s+(\w+)$/);if(l){let s=l[1].split(",").map(p=>p.trim()),d=l[2];for(let p of s)n.classAssignments.set(p,d);continue}let f=c.match(/^style\s+([^\s]+)\s+(.+)$/);if(f){let s=f[1].split(",").map(p=>p.trim()),d=Ht(f[2]);for(let p of s)n.nodeStyles.set(p,{...n.nodeStyles.get(p),...d});continue}let h=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(h&&i.length>0){i[i.length-1].direction=h[1].toUpperCase();continue}let u=c.match(/^subgraph\s+(.+)$/);if(u){let s=u[1].trim(),d=s.match(/^([\p{L}\p{N}_-]+)\s*\[(.+)\]$/u),p,x;d?(p=d[1],x=d[2]):(x=s,p=s.replace(/\s+/g,"_").replace(/[^\p{L}\p{N}_]/gu,""));let m={id:p,label:x,nodeIds:[],children:[]};i.push(m);continue}if(c==="end"){let s=i.pop();s&&(i.length>0?i[i.length-1].children.push(s):n.subgraphs.push(s));continue}Kn(c,n,i);}return n}function jn(e){let t={direction:"TD",nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},r=[],n=0,i=0;for(let o=1;o<e.length;o++){let c=e[o],a=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(a){r.length>0?r[r.length-1].direction=a[1].toUpperCase():t.direction=a[1].toUpperCase();continue}let l=c.match(/^state\s+(?:"([^"]+)"\s+as\s+)?([\p{L}\p{N}_-]+)\s*\{$/u);if(l){let s=l[1]??l[2],p={id:l[2],label:s,nodeIds:[],children:[]};r.push(p);continue}if(c==="}"){let s=r.pop();s&&(r.length>0?r[r.length-1].children.push(s):t.subgraphs.push(s));continue}let f=c.match(/^state\s+"([^"]+)"\s+as\s+([\p{L}\p{N}_-]+)\s*$/u);if(f){let s=f[1],d=f[2];Ve(t,r,{id:d,label:s,shape:"rounded"});continue}let h=c.match(/^(\[\*\]|[\p{L}\p{N}_-]+)\s*(-->)\s*(\[\*\]|[\p{L}\p{N}_-]+)(?:\s*:\s*(.+))?$/u);if(h){let s=h[1],d=h[3],p=h[4]?.trim()||void 0;s==="[*]"?(n++,s=`_start${n>1?n:""}`,Ve(t,r,{id:s,label:"",shape:"state-start"})):Wt(t,r,s),d==="[*]"?(i++,d=`_end${i>1?i:""}`,Ve(t,r,{id:d,label:"",shape:"state-end"})):Wt(t,r,d),t.edges.push({source:s,target:d,label:p,style:"solid",hasArrowStart:false,hasArrowEnd:true});continue}let u=c.match(/^([\p{L}\p{N}_-]+)\s*:\s*(.+)$/u);if(u){let s=u[1],d=u[2].trim();Ve(t,r,{id:s,label:d,shape:"rounded"});continue}}return t}function Ve(e,t,r){if(!e.nodes.has(r.id)&&e.nodes.set(r.id,r),t.length>0){let i=t[t.length-1];i.nodeIds.includes(r.id)||i.nodeIds.push(r.id);}}function Wt(e,t,r){if(!e.nodes.has(r))Ve(e,t,{id:r,label:r,shape:"rounded"});else if(t.length>0){let n=t[t.length-1];n.nodeIds.includes(r)||n.nodeIds.push(r);}}function Ht(e){let t={};for(let r of e.split(",")){let n=r.indexOf(":");if(n>0){let i=r.slice(0,n).trim(),o=r.slice(n+1).trim();i&&o&&(t[i]=o);}}return t}var zn=/^(<)?(-->|-.->|==>|---|-\.-|===)(?:\|([^|]*)\|)?/,Vn=[{regex:/^([\p{L}\p{N}_-]+)\(\(\((.+?)\)\)\)/u,shape:"doublecircle"},{regex:/^([\p{L}\p{N}_-]+)\(\[(.+?)\]\)/u,shape:"stadium"},{regex:/^([\p{L}\p{N}_-]+)\(\((.+?)\)\)/u,shape:"circle"},{regex:/^([\p{L}\p{N}_-]+)\[\[(.+?)\]\]/u,shape:"subroutine"},{regex:/^([\p{L}\p{N}_-]+)\[\((.+?)\)\]/u,shape:"cylinder"},{regex:/^([\p{L}\p{N}_-]+)\[\/(.+?)\\\]/u,shape:"trapezoid"},{regex:/^([\p{L}\p{N}_-]+)\[\\(.+?)\/\]/u,shape:"trapezoid-alt"},{regex:/^([\p{L}\p{N}_-]+)>(.+?)\]/u,shape:"asymmetric"},{regex:/^([\p{L}\p{N}_-]+)\{\{(.+?)\}\}/u,shape:"hexagon"},{regex:/^([\p{L}\p{N}_-]+)\[(.+?)\]/u,shape:"rectangle"},{regex:/^([\p{L}\p{N}_-]+)\((.+?)\)/u,shape:"rounded"},{regex:/^([\p{L}\p{N}_-]+)\{(.+?)\}/u,shape:"diamond"}],Un=/^([\p{L}\p{N}_-]+)/u,qn=/^:::([\w][\w-]*)/;function Kn(e,t,r){let n=e.trim(),i=Ft(n,t,r);if(!i||i.ids.length===0)return;n=i.remaining.trim();let o=i.ids;for(;n.length>0;){let c=n.match(zn);if(!c)break;let a=!!c[1],l=c[2],f=c[3]?.trim()||void 0;n=n.slice(c[0].length).trim();let h=Jn(l),u=l.endsWith(">"),s=Ft(n,t,r);if(!s||s.ids.length===0)break;n=s.remaining.trim();for(let d of o)for(let p of s.ids)t.edges.push({source:d,target:p,label:f,style:h,hasArrowStart:a,hasArrowEnd:u});o=s.ids;}}function Ft(e,t,r){let n=Yt(e,t,r);if(!n)return null;let i=[n.id],o=n.remaining.trim();for(;o.startsWith("&");){o=o.slice(1).trim();let c=Yt(o,t,r);if(!c)break;i.push(c.id),o=c.remaining.trim();}return {ids:i,remaining:o}}function Yt(e,t,r){let n=null,i=e;for(let{regex:c,shape:a}of Vn){let l=e.match(c);if(l){n=l[1];let f=l[2];Bt(t,r,{id:n,label:f,shape:a}),i=e.slice(l[0].length);break}}if(n===null){let c=e.match(Un);c&&(n=c[1],t.nodes.has(n)?Xt(r,n):Bt(t,r,{id:n,label:n,shape:"rectangle"}),i=e.slice(c[0].length));}if(n===null)return null;let o=i.match(qn);return o&&(t.classAssignments.set(n,o[1]),i=i.slice(o[0].length)),{id:n,remaining:i}}function Bt(e,t,r){!e.nodes.has(r.id)&&e.nodes.set(r.id,r),Xt(t,r.id);}function Xt(e,t){if(e.length>0){let r=e[e.length-1];r.nodeIds.includes(t)||r.nodeIds.push(t);}}function Jn(e){return e==="-.->"||e==="-.-"?"dotted":e==="==>"||e==="==="?"thick":"solid"}var oe={x:1,y:0},ne={x:1,y:2},se={x:0,y:1},re={x:2,y:1},we={x:2,y:0},xe={x:0,y:0},Ee={x:2,y:2},ve={x:0,y:2},rt={x:1,y:1};function bt(e,t){return e.x===t.x&&e.y===t.y}function jt(e,t){return e.x===t.x&&e.y===t.y}function qe(e,t){return {x:e.x+t.x,y:e.y+t.y}}function $e(e){return `${e.x},${e.y}`}var zt={name:"",styles:{}};function Zn(e){return e>=768&&e<=879||e>=6832&&e<=6911||e>=7616&&e<=7679||e>=8400&&e<=8447||e>=65056&&e<=65071}function Qn(e){return e>=4352&&e<=4447||e>=11904&&e<=42191||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65135||e>=65280&&e<=65376||e>=65504&&e<=65510||e>=127744&&e<=129791||e>=129280&&e<=129535}function Je(e){let t=e.codePointAt(0);return t==null||t===0||t<32||t>=127&&t<160||Zn(t)?0:Qn(t)?2:1}function ae(e){let t=0;for(let r of e)t+=Je(r);return t}function Ie(e,t){if(t<=0)return "";let r=0,n="";for(let i of e){let o=Je(i);if(r+o>t)break;n+=i,r+=o;}return n}function Ut(e,t){if(t<=0)return e;let r=0,n="";for(let i of e){let o=Je(i);if(r<t){r+=o;continue}n+=i;}return n}function he(e,t){let r=[];for(let n=0;n<=e;n++){let i=[];for(let o=0;o<=t;o++)i.push(" ");r.push(i);}return r}function Ne(e){let[t,r]=Ke(e);return he(t,r)}function Ke(e){return [e.length-1,(e[0]?.length??1)-1]}function We(e,t,r){let[n,i]=Ke(e),o=Math.max(t,n),c=Math.max(r,i),a=he(o,c);for(let l=0;l<a.length;l++)for(let f=0;f<a[0].length;f++)l<e.length&&f<e[0].length&&(a[l][f]=e[l][f]);return e.length=0,e.push(...a),e}var er=new Set(["\u2500","\u2502","\u250C","\u2510","\u2514","\u2518","\u251C","\u2524","\u252C","\u2534","\u253C","\u2574","\u2575","\u2576","\u2577"]);function Vt(e){return er.has(e)}var tr={"\u2500":{"\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u2534"},"\u2502":{"\u2500":"\u253C","\u250C":"\u251C","\u2510":"\u2524","\u2514":"\u251C","\u2518":"\u2524","\u251C":"\u251C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u253C"},"\u250C":{"\u2500":"\u252C","\u2502":"\u251C","\u2510":"\u252C","\u2514":"\u251C","\u2518":"\u253C","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u253C"},"\u2510":{"\u2500":"\u252C","\u2502":"\u2524","\u250C":"\u252C","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u252C","\u2534":"\u253C"},"\u2514":{"\u2500":"\u2534","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2518":"\u2534","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u2534"},"\u2518":{"\u2500":"\u2534","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u2534","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u2534"},"\u251C":{"\u2500":"\u253C","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2514":"\u251C","\u2518":"\u253C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u2524":{"\u2500":"\u253C","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u252C":{"\u2500":"\u252C","\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u253C","\u2518":"\u253C","\u251C":"\u253C","\u2524":"\u253C","\u2534":"\u253C"},"\u2534":{"\u2500":"\u2534","\u2502":"\u253C","\u250C":"\u253C","\u2510":"\u253C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u253C"}};function nr(e,t){return tr[e]?.[t]??e}function ke(e,t,r,...n){let[i,o]=Ke(e);for(let a of n){let[l,f]=Ke(a);i=Math.max(i,l+t.x),o=Math.max(o,f+t.y);}let c=he(i,o);for(let a=0;a<=i;a++)for(let l=0;l<=o;l++)a<e.length&&l<e[0].length&&(c[a][l]=e[a][l]);for(let a of n)for(let l=0;l<a.length;l++)for(let f=0;f<a[0].length;f++){let h=a[l][f];if(h!==" "){let u=l+t.x,s=f+t.y,d=c[u][s];!r&&Vt(h)&&Vt(d)?c[u][s]=nr(d,h):c[u][s]=h;}}return c}function Le(e){let[t,r]=Ke(e),n=[];for(let i=0;i<=r;i++){let o="";for(let c=0;c<=t;c++){let a=e[c][i];o+=a,Je(a)===2&&(c+=1);}n.push(o);}return n.join(`
`)}var rr={"\u25B2":"\u25BC","\u25BC":"\u25B2","\u25E4":"\u25E3","\u25E3":"\u25E4","\u25E5":"\u25E2","\u25E2":"\u25E5","^":"v",v:"^","\u250C":"\u2514","\u2514":"\u250C","\u2510":"\u2518","\u2518":"\u2510","\u252C":"\u2534","\u2534":"\u252C","\u2575":"\u2577","\u2577":"\u2575"};function qt(e){for(let t of e)t.reverse();for(let t of e)for(let r=0;r<t.length;r++){let n=rr[t[r]];n&&(t[r]=n);}return e}function fe(e,t,r){We(e,t.x+ae(r),t.y);let n=t.x;for(let i of r)e[n][t.y]=i,n+=Je(i);}function Kt(e,t,r){let n=0,i=0;for(let o of t.values())n+=o;for(let o of r.values())i+=o;We(e,n-1,i-1);}function Jt(e,t){let r=new Map,n=0;for(let[a,l]of e.nodes){let f={name:a,displayLabel:l.label,index:n,gridCoord:null,drawingCoord:null,drawing:null,drawn:false,styleClassName:"",styleClass:zt};r.set(a,f),n++;}let i=[...r.values()],o=[];for(let a of e.edges){let l=r.get(a.source),f=r.get(a.target);!l||!f||o.push({from:l,to:f,text:a.label??"",path:[],labelLine:[],startDir:{x:0,y:0},endDir:{x:0,y:0}});}let c=[];for(let a of e.subgraphs)Zt(a,null,r,c);ir(e.subgraphs,c,r);for(let[a,l]of e.classAssignments){let f=r.get(a),h=e.classDefs.get(l);f&&h&&(f.styleClassName=l,f.styleClass={name:l,styles:h});}return {nodes:i,edges:o,canvas:he(0,0),grid:new Map,columnWidth:new Map,rowHeight:new Map,subgraphs:c,config:t,offsetX:0,offsetY:0}}function Zt(e,t,r,n){let i={name:e.label,nodes:[],parent:t,children:[],minX:0,minY:0,maxX:0,maxY:0};for(let o of e.nodeIds){let c=r.get(o);c&&i.nodes.push(c);}n.push(i);for(let o of e.children){let c=Zt(o,i,r,n);i.children.push(c);for(let a of c.nodes)i.nodes.includes(a)||i.nodes.push(a);}return i}function ir(e,t,r,n){let i=new Map;sr(e,t,i);let o=new Map;function c(a){let l=i.get(a);if(l){for(let f of a.children)c(f);for(let f of a.nodeIds)o.has(f)||o.set(f,l);}}for(let a of e)c(a);for(let a of t)a.nodes=a.nodes.filter(l=>{let f;for(let[u,s]of r)if(s===l){f=u;break}if(!f)return  false;let h=o.get(f);return h?or(a,h):true});}function or(e,t){let r=t;for(;r!==null;){if(r===e)return  true;r=r.parent;}return  false}function sr(e,t,r){let n=[];function i(o){for(let c of o)n.push(c),i(c.children);}i(e);for(let o=0;o<n.length&&o<t.length;o++)r.set(n[o],t[o]);}var wt=class{items=[];get length(){return this.items.length}push(t){this.items.push(t),this.bubbleUp(this.items.length-1);}pop(){if(this.items.length===0)return;let t=this.items[0],r=this.items.pop();return this.items.length>0&&(this.items[0]=r,this.sinkDown(0)),t}bubbleUp(t){for(;t>0;){let r=t-1>>1;if(this.items[t].priority<this.items[r].priority)[this.items[t],this.items[r]]=[this.items[r],this.items[t]],t=r;else break}}sinkDown(t){let r=this.items.length;for(;;){let n=t,i=2*t+1,o=2*t+2;if(i<r&&this.items[i].priority<this.items[n].priority&&(n=i),o<r&&this.items[o].priority<this.items[n].priority&&(n=o),n!==t)[this.items[t],this.items[n]]=[this.items[n],this.items[t]],t=n;else break}}};function ar(e,t){let r=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return r===0||n===0?r+n:r+n+1}var cr=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];function lr(e,t){return t.x<0||t.y<0?false:!e.has($e(t))}function vt(e,t,r){let n=new wt;n.push({coord:t,priority:0});let i=new Map;i.set($e(t),0);let o=new Map;for(o.set($e(t),null);n.length>0;){let c=n.pop().coord;if(bt(c,r)){let l=[],f=c;for(;f!==null;)l.unshift(f),f=o.get($e(f))??null;return l}let a=i.get($e(c));for(let l of cr){let f={x:c.x+l.x,y:c.y+l.y};if(!lr(e,f)&&!bt(f,r))continue;let h=a+1,u=$e(f),s=i.get(u);if(s===void 0||h<s){i.set(u,h);let d=h+ar(f,r);n.push({coord:f,priority:d}),o.set(u,c);}}}return null}function $t(e){if(e.length<=2)return e;let t=new Set,r=e[0],n=e[1];for(let i=2;i<e.length;i++){let o=e[i],c=n.x-r.x,a=n.y-r.y,l=o.x-n.x,f=o.y-n.y;c===l&&a===f&&t.add(i-1),r=n,n=o;}return e.filter((i,o)=>!t.has(o))}function it(e){return e===oe?ne:e===ne?oe:e===se?re:e===re?se:e===we?ve:e===xe?Ee:e===Ee?xe:e===ve?we:rt}function U(e,t){return e.x===t.x&&e.y===t.y}function Ae(e,t){return e.x===t.x?e.y<t.y?ne:oe:e.y===t.y?e.x<t.x?re:se:e.x<t.x?e.y<t.y?Ee:we:e.y<t.y?ve:xe}function dr(e){return e==="LR"?[re,ne,ne,re]:[ne,re,re,ne]}function hr(e,t){if(e.from===e.to)return dr(t);let r=Ae(e.from.gridCoord,e.to.gridCoord),n,i,o,c,a=t==="LR"?U(r,se)||U(r,xe)||U(r,ve):U(r,oe)||U(r,xe)||U(r,we);return U(r,Ee)?t==="LR"?(n=ne,i=se,o=re,c=oe):(n=re,i=oe,o=ne,c=se):U(r,we)?t==="LR"?(n=oe,i=se,o=re,c=ne):(n=re,i=ne,o=oe,c=se):U(r,ve)?t==="LR"?(n=ne,i=ne,o=se,c=oe):(n=se,i=oe,o=ne,c=re):U(r,xe)?t==="LR"?(n=ne,i=ne,o=se,c=ne):(n=re,i=re,o=oe,c=re):a?t==="LR"&&U(r,se)?(n=ne,i=ne,o=se,c=re):t==="TD"&&U(r,oe)?(n=re,i=re,o=oe,c=ne):(n=r,i=it(r),o=r,c=it(r)):(n=r,i=it(r),o=r,c=it(r)),[n,i,o,c]}function Qt(e,t){let[r,n,i,o]=hr(t,e.config.graphDirection),c=qe(t.from.gridCoord,r),a=qe(t.to.gridCoord,n),l=vt(e.grid,c,a);if(l===null){t.startDir=i,t.endDir=o,t.path=[];return}l=$t(l);let f=qe(t.from.gridCoord,i),h=qe(t.to.gridCoord,o),u=vt(e.grid,f,h);if(u===null){t.startDir=r,t.endDir=n,t.path=l;return}u=$t(u),l.length<=u.length?(t.startDir=r,t.endDir=n,t.path=l):(t.startDir=i,t.endDir=o,t.path=u);}function en(e,t){if(t.text.length===0)return;let r=ae(t.text),n=t.path[0],i=[n,t.path[1]],o=0;for(let h=1;h<t.path.length;h++){let u=t.path[h],s=[n,u],d=fr(e,s);if(d>=r){i=s;break}else d>o&&(o=d,i=s);n=u;}let c=Math.min(i[0].x,i[1].x),a=Math.max(i[0].x,i[1].x),l=c+Math.floor((a-c)/2),f=e.columnWidth.get(l)??0;e.columnWidth.set(l,Math.max(f,r+2)),t.labelLine=[i[0],i[1]];}function fr(e,t){let r=0,n=Math.min(t[0].x,t[1].x),i=Math.max(t[0].x,t[1].x);for(let o=n;o<=i;o++)r+=e.columnWidth.get(o)??0;return r}function tn(e,t){let r=e.gridCoord,n=t.config.useAscii,i=0;for(let d=0;d<2;d++)i+=t.columnWidth.get(r.x+d)??0;let o=0;for(let d=0;d<2;d++)o+=t.rowHeight.get(r.y+d)??0;let c={x:0,y:0},a={x:i,y:o},l=he(Math.max(c.x,a.x),Math.max(c.y,a.y));if(n){for(let d=c.x+1;d<a.x;d++)l[d][c.y]="-";for(let d=c.x+1;d<a.x;d++)l[d][a.y]="-";for(let d=c.y+1;d<a.y;d++)l[c.x][d]="|";for(let d=c.y+1;d<a.y;d++)l[a.x][d]="|";l[c.x][c.y]="+",l[a.x][c.y]="+",l[c.x][a.y]="+",l[a.x][a.y]="+";}else {for(let d=c.x+1;d<a.x;d++)l[d][c.y]="\u2500";for(let d=c.x+1;d<a.x;d++)l[d][a.y]="\u2500";for(let d=c.y+1;d<a.y;d++)l[c.x][d]="\u2502";for(let d=c.y+1;d<a.y;d++)l[a.x][d]="\u2502";l[c.x][c.y]="\u250C",l[a.x][c.y]="\u2510",l[c.x][a.y]="\u2514",l[a.x][a.y]="\u2518";}let f=e.displayLabel,h=c.y+Math.floor(o/2),u=ae(f),s=c.x+Math.floor(i/2)-Math.ceil(u/2)+1;return fe(l,{x:s,y:h},f),l}function ot(e,t,r=1){let n=0;for(let v of e)for(let M of v)n=Math.max(n,ae(M));let o=n+2*r+2,c=0;for(let v of e)c+=Math.max(v.length,1);let a=e.length-1,l=c+a+2,f=t?"-":"\u2500",h=t?"|":"\u2502",u=t?"+":"\u250C",s=t?"+":"\u2510",d=t?"+":"\u2514",p=t?"+":"\u2518",x=t?"+":"\u251C",m=t?"+":"\u2524",g=he(o-1,l-1);g[0][0]=u;for(let v=1;v<o-1;v++)g[v][0]=f;g[o-1][0]=s,g[0][l-1]=d;for(let v=1;v<o-1;v++)g[v][l-1]=f;g[o-1][l-1]=p;for(let v=1;v<l-1;v++)g[0][v]=h,g[o-1][v]=h;let b=1;for(let v=0;v<e.length;v++){let M=e[v],I=M.length>0?M:[""];for(let y of I){let w=1+r;fe(g,{x:w,y:b},y),b++;}if(v<e.length-1){g[0][b]=x;for(let y=1;y<o-1;y++)g[y][b]=f;g[o-1][b]=m,b++;}}return g}function ur(e,t,r,n,i,o){let c=Ae(t,r),a=[],l=o?"-":"\u2500",f=o?"|":"\u2502",h=o?"\\":"\u2572",u=o?"/":"\u2571";if(U(c,oe))for(let s=t.y-n;s>=r.y-i;s--)a.push({x:t.x,y:s}),e[t.x][s]=f;else if(U(c,ne))for(let s=t.y+n;s<=r.y+i;s++)a.push({x:t.x,y:s}),e[t.x][s]=f;else if(U(c,se))for(let s=t.x-n;s>=r.x-i;s--)a.push({x:s,y:t.y}),e[s][t.y]=l;else if(U(c,re))for(let s=t.x+n;s<=r.x+i;s++)a.push({x:s,y:t.y}),e[s][t.y]=l;else if(U(c,xe))for(let s=t.x,d=t.y-n;s>=r.x-i&&d>=r.y-i;s--,d--)a.push({x:s,y:d}),e[s][d]=h;else if(U(c,we))for(let s=t.x,d=t.y-n;s<=r.x+i&&d>=r.y-i;s++,d--)a.push({x:s,y:d}),e[s][d]=u;else if(U(c,ve))for(let s=t.x,d=t.y+n;s>=r.x-i&&d<=r.y+i;s--,d++)a.push({x:s,y:d}),e[s][d]=u;else if(U(c,Ee))for(let s=t.x,d=t.y+n;s<=r.x+i&&d<=r.y+i;s++,d++)a.push({x:s,y:d}),e[s][d]=h;return a}function pr(e,t){if(t.path.length===0){let f=Ne(e.canvas);return [f,f,f,f,f]}let r=br(e,t),[n,i,o]=gr(e,t.path),c=mr(e,t.path,i[0]),a=xr(e,i[i.length-1],o[o.length-1]),l=yr(e,t.path);return [n,c,a,l,r]}function gr(e,t){let r=Ne(e.canvas),n=t[0],i=[],o=[];for(let c=1;c<t.length;c++){let a=t[c],l=He(e,n),f=He(e,a);if(jt(l,f)){n=a;continue}let h=Ae(n,a),u=ur(r,l,f,1,-1,e.config.useAscii);u.length===0&&u.push(l),i.push(u),o.push(h),n=a;}return [r,i,o]}function mr(e,t,r){let n=Ne(e.canvas);if(e.config.useAscii)return n;let i=r[0],o=Ae(t[0],t[1]);return U(o,oe)?n[i.x][i.y+1]="\u2534":U(o,ne)?n[i.x][i.y-1]="\u252C":U(o,se)?n[i.x+1][i.y]="\u2524":U(o,re)&&(n[i.x-1][i.y]="\u251C"),n}function xr(e,t,r){let n=Ne(e.canvas);if(t.length===0)return n;let i=t[0],o=t[t.length-1],c=Ae(i,o);(t.length===1||U(c,rt))&&(c=r);let a;return e.config.useAscii?U(c,oe)?a="^":U(c,ne)?a="v":U(c,se)?a="<":U(c,re)?a=">":U(r,oe)?a="^":U(r,ne)?a="v":U(r,se)?a="<":U(r,re)?a=">":a="*":U(c,oe)?a="\u25B2":U(c,ne)?a="\u25BC":U(c,se)?a="\u25C4":U(c,re)?a="\u25BA":U(c,we)?a="\u25E5":U(c,xe)?a="\u25E4":U(c,Ee)?a="\u25E2":U(c,ve)?a="\u25E3":U(r,oe)?a="\u25B2":U(r,ne)?a="\u25BC":U(r,se)?a="\u25C4":U(r,re)?a="\u25BA":U(r,we)?a="\u25E5":U(r,xe)?a="\u25E4":U(r,Ee)?a="\u25E2":U(r,ve)?a="\u25E3":a="\u25CF",n[o.x][o.y]=a,n}function yr(e,t){let r=Ne(e.canvas);for(let n=1;n<t.length-1;n++){let i=t[n],o=He(e,i),c=Ae(t[n-1],i),a=Ae(i,t[n+1]),l;e.config.useAscii?l="+":U(c,re)&&U(a,ne)||U(c,oe)&&U(a,se)?l="\u2510":U(c,re)&&U(a,oe)||U(c,ne)&&U(a,se)?l="\u2518":U(c,se)&&U(a,ne)||U(c,oe)&&U(a,re)?l="\u250C":U(c,se)&&U(a,oe)||U(c,ne)&&U(a,re)?l="\u2514":l="+",r[o.x][o.y]=l;}return r}function br(e,t){let r=Ne(e.canvas);if(t.text.length===0)return r;let n=rn(e,t.labelLine);return wr(r,n,t.text),r}function wr(e,t,r){if(t.length<2)return;let n=Math.min(t[0].x,t[1].x),i=Math.max(t[0].x,t[1].x),o=Math.min(t[0].y,t[1].y),c=Math.max(t[0].y,t[1].y),a=n+Math.floor((i-n)/2),l=o+Math.floor((c-o)/2),f=a-Math.floor(ae(r)/2);fe(e,{x:f,y:l},r);}function vr(e,t){let r=e.maxX-e.minX,n=e.maxY-e.minY;if(r<=0||n<=0)return he(0,0);let i={x:0,y:0},o={x:r,y:n},c=he(r,n);if(t.config.useAscii){for(let a=i.x+1;a<o.x;a++)c[a][i.y]="-";for(let a=i.x+1;a<o.x;a++)c[a][o.y]="-";for(let a=i.y+1;a<o.y;a++)c[i.x][a]="|";for(let a=i.y+1;a<o.y;a++)c[o.x][a]="|";c[i.x][i.y]="+",c[o.x][i.y]="+",c[i.x][o.y]="+",c[o.x][o.y]="+";}else {for(let a=i.x+1;a<o.x;a++)c[a][i.y]="\u2500";for(let a=i.x+1;a<o.x;a++)c[a][o.y]="\u2500";for(let a=i.y+1;a<o.y;a++)c[i.x][a]="\u2502";for(let a=i.y+1;a<o.y;a++)c[o.x][a]="\u2502";c[i.x][i.y]="\u250C",c[o.x][i.y]="\u2510",c[i.x][o.y]="\u2514",c[o.x][o.y]="\u2518";}return c}function $r(e,t){let r=e.maxX-e.minX,n=e.maxY-e.minY;if(r<=0||n<=0)return [he(0,0),{x:0,y:0}];let i=he(r,n),o=1,c=Math.floor(r/2)-Math.floor(ae(e.name)/2);return c<1&&(c=1),fe(i,{x:c,y:o},e.name),[i,{x:e.minX,y:e.minY}]}function Er(e){function t(n){return n.parent===null?0:1+t(n.parent)}let r=[...e];return r.sort((n,i)=>t(n)-t(i)),r}function nn(e){let t=e.config.useAscii,r=Er(e.subgraphs);for(let f of r){let h=vr(f,e),u={x:f.minX,y:f.minY};e.canvas=ke(e.canvas,u,t,h);}for(let f of e.nodes)!f.drawn&&f.drawingCoord&&f.drawing&&(e.canvas=ke(e.canvas,f.drawingCoord,t,f.drawing),f.drawn=true);let n=[],i=[],o=[],c=[],a=[];for(let f of e.edges){let[h,u,s,d,p]=pr(e,f);n.push(h),i.push(d),o.push(s),c.push(u),a.push(p);}let l={x:0,y:0};e.canvas=ke(e.canvas,l,t,...n),e.canvas=ke(e.canvas,l,t,...i),e.canvas=ke(e.canvas,l,t,...o),e.canvas=ke(e.canvas,l,t,...c),e.canvas=ke(e.canvas,l,t,...a);for(let f of e.subgraphs){if(f.nodes.length===0)continue;let[h,u]=$r(f);e.canvas=ke(e.canvas,u,t,h);}return e.canvas}function He(e,t,r){let n=t,i=0;for(let l=0;l<n.x;l++)i+=e.columnWidth.get(l)??0;let o=0;for(let l=0;l<n.y;l++)o+=e.rowHeight.get(l)??0;let c=e.columnWidth.get(n.x)??0,a=e.rowHeight.get(n.y)??0;return {x:i+Math.floor(c/2)+e.offsetX,y:o+Math.floor(a/2)+e.offsetY}}function rn(e,t){return t.map(r=>He(e,r))}function Ze(e,t,r){if(e.grid.has($e(r)))return e.config.graphDirection==="LR"?Ze(e,t,{x:r.x,y:r.y+4}):Ze(e,t,{x:r.x+4,y:r.y});for(let n=0;n<3;n++)for(let i=0;i<3;i++){let o={x:r.x+n,y:r.y+i};e.grid.set($e(o),t);}return t.gridCoord=r,r}function kr(e,t){let r=t.gridCoord,n=e.config.boxBorderPadding,i=[1,2*n+ae(t.displayLabel),1],o=[1,1+2*n,1];for(let c=0;c<i.length;c++){let a=r.x+c,l=e.columnWidth.get(a)??0;e.columnWidth.set(a,Math.max(l,i[c]));}for(let c=0;c<o.length;c++){let a=r.y+c,l=e.rowHeight.get(a)??0;e.rowHeight.set(a,Math.max(l,o[c]));}if(r.x>0){let c=e.columnWidth.get(r.x-1)??0;e.columnWidth.set(r.x-1,Math.max(c,e.config.paddingX));}if(r.y>0){let c=e.config.paddingY;Mr(e,t)&&(c+=4);let a=e.rowHeight.get(r.y-1)??0;e.rowHeight.set(r.y-1,Math.max(a,c));}}function Cr(e,t){for(let r of t)e.columnWidth.has(r.x)||e.columnWidth.set(r.x,Math.floor(e.config.paddingX/2)),e.rowHeight.has(r.y)||e.rowHeight.set(r.y,Math.floor(e.config.paddingY/2));}function Et(e,t){return e.subgraphs.some(r=>r.nodes.includes(t))}function kt(e,t){for(let r of e.subgraphs)if(r.nodes.includes(t))return r;return null}function Mr(e,t){let r=kt(e,t);if(!r)return  false;let n=false;for(let i of e.edges)if(i.to===t&&kt(e,i.from)!==r){n=true;break}if(!n)return  false;for(let i of r.nodes){if(i===t||!i.gridCoord)continue;let o=false;for(let c of e.edges)if(c.to===i&&kt(e,c.from)!==r){o=true;break}if(o&&i.gridCoord.y<t.gridCoord.y)return  false}return  true}function on(e,t){if(t.nodes.length===0)return;let r=1e6,n=1e6,i=-1e6,o=-1e6;for(let l of t.children)on(e,l),l.nodes.length>0&&(r=Math.min(r,l.minX),n=Math.min(n,l.minY),i=Math.max(i,l.maxX),o=Math.max(o,l.maxY));for(let l of t.nodes){if(!l.drawingCoord||!l.drawing)continue;let f=l.drawingCoord.x,h=l.drawingCoord.y,u=f+l.drawing.length-1,s=h+l.drawing[0].length-1;r=Math.min(r,f),n=Math.min(n,h),i=Math.max(i,u),o=Math.max(o,s);}let c=2,a=2;t.minX=r-c,t.minY=n-c-a,t.maxX=i+c,t.maxY=o+c;}function Sr(e){let r=e.subgraphs.filter(n=>n.parent===null&&n.nodes.length>0);for(let n=0;n<r.length;n++)for(let i=n+1;i<r.length;i++){let o=r[n],c=r[i];o.minX<c.maxX&&o.maxX>c.minX&&(o.maxY>=c.minY-1&&o.minY<c.minY?c.minY=o.maxY+1+1:c.maxY>=o.minY-1&&c.minY<o.minY&&(o.minY=c.maxY+1+1)),o.minY<c.maxY&&o.maxY>c.minY&&(o.maxX>=c.minX-1&&o.minX<c.minX?c.minX=o.maxX+1+1:c.maxX>=o.minX-1&&c.minX<o.minX&&(o.minX=c.maxX+1+1));}}function _r(e){for(let t of e.subgraphs)on(e,t);Sr(e);}function Lr(e){if(e.subgraphs.length===0)return;let t=0,r=0;for(let o of e.subgraphs)t=Math.min(t,o.minX),r=Math.min(r,o.minY);let n=-t,i=-r;if(!(n===0&&i===0)){e.offsetX=n,e.offsetY=i;for(let o of e.subgraphs)o.minX+=n,o.minY+=i,o.maxX+=n,o.maxY+=i;for(let o of e.nodes)o.drawingCoord&&(o.drawingCoord.x+=n,o.drawingCoord.y+=i);}}function sn(e){let t=e.config.graphDirection,r=new Array(100).fill(0),n=new Set,i=[];for(let h of e.nodes){n.has(h.name)||i.push(h),n.add(h.name);for(let u of Ct(e,h))n.add(u.name);}let o=false,c=false;for(let h of i)Et(e,h)?Ct(e,h).length>0&&(c=true):o=true;let a=t==="LR"&&o&&c,l,f=[];a?(l=i.filter(h=>!Et(e,h)),f=i.filter(h=>Et(e,h))):l=i;for(let h of l){let u=t==="LR"?{x:0,y:r[0]}:{x:r[0],y:0};Ze(e,e.nodes[h.index],u),r[0]=r[0]+4;}if(a&&f.length>0)for(let u of f){let s=t==="LR"?{x:4,y:r[4]}:{x:r[4],y:4};Ze(e,e.nodes[u.index],s),r[4]=r[4]+4;}for(let h of e.nodes){let u=h.gridCoord,s=t==="LR"?u.x+4:u.y+4,d=r[s];for(let p of Ct(e,h)){if(p.gridCoord!==null)continue;let x=t==="LR"?{x:s,y:d}:{x:d,y:s};Ze(e,e.nodes[p.index],x),r[s]=d+4,d=r[s];}}for(let h of e.nodes)kr(e,h);for(let h of e.edges)Qt(e,h),Cr(e,h.path),en(e,h);for(let h of e.nodes)h.drawingCoord=He(e,h.gridCoord),h.drawing=tn(h,e);Kt(e.canvas,e.columnWidth,e.rowHeight),_r(e),Lr(e);}function Ar(e,t){return e.edges.filter(r=>r.from.name===t.name)}function Ct(e,t){return Ar(e,t).map(r=>r.to)}function st(e){let t={actors:[],messages:[],blocks:[],notes:[]},r=new Set,n=[];for(let i=1;i<e.length;i++){let o=e[i],c=o.match(/^(participant|actor)\s+(\S+?)(?:\s+as\s+(.+))?$/);if(c){let s=c[1],d=c[2],p=c[3]?.trim()??d;r.has(d)||(r.add(d),t.actors.push({id:d,label:p,type:s}));continue}let a=o.match(/^Note\s+(left of|right of|over)\s+([^:]+):\s*(.+)$/i);if(a){let s=a[1].toLowerCase(),d=a[2].trim(),p=a[3].trim(),x=d.split(",").map(g=>g.trim());for(let g of x)Qe(t,r,g);let m="over";s==="left of"?m="left":s==="right of"&&(m="right"),t.notes.push({actorIds:x,text:p,position:m,afterIndex:t.messages.length-1});continue}let l=o.match(/^(loop|alt|opt|par|critical|break|rect)\s*(.*)$/);if(l){let s=l[1],d=l[2]?.trim()??"";n.push({type:s,label:d,startIndex:t.messages.length,dividers:[]});continue}let f=o.match(/^(else|and)\s*(.*)$/);if(f&&n.length>0){let s=f[2]?.trim()??"";n[n.length-1].dividers.push({index:t.messages.length,label:s});continue}if(o==="end"&&n.length>0){let s=n.pop();t.blocks.push({type:s.type,label:s.label,startIndex:s.startIndex,endIndex:Math.max(t.messages.length-1,s.startIndex),dividers:s.dividers});continue}let h=o.match(/^(\S+?)\s*(--?>?>|--?[)x]|--?>>|--?>)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(h){let s=h[1],d=h[2],p=h[3],x=h[4],m=h[5].trim();Qe(t,r,s),Qe(t,r,x);let g=d.startsWith("--")?"dashed":"solid",b=d.includes(">>")||d.includes("x")?"filled":"open",v={from:s,to:x,label:m,lineStyle:g,arrowHead:b};p==="+"&&(v.activate=true),p==="-"&&(v.deactivate=true),t.messages.push(v);continue}let u=o.match(/^(\S+?)\s*(->>|-->>|-\)|--\)|-x|--x|->|-->)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(u){let s=u[1],d=u[2],p=u[3],x=u[4],m=u[5].trim();Qe(t,r,s),Qe(t,r,x);let g=d.startsWith("--")?"dashed":"solid",b=d.includes(">>")||d.includes("x")?"filled":"open",v={from:s,to:x,label:m,lineStyle:g,arrowHead:b};p==="+"&&(v.activate=true),p==="-"&&(v.deactivate=true),t.messages.push(v);continue}}return t}function Qe(e,t,r){t.has(r)||(t.add(r),e.actors.push({id:r,label:r,type:"participant"}));}function an(e,t){let r=e.split(`
`).map(_=>_.trim()).filter(_=>_.length>0&&!_.startsWith("%%")),n=st(r);if(n.actors.length===0)return "";let i=t.useAscii,o=i?"-":"\u2500",c=i?"|":"\u2502",a=i?"+":"\u250C",l=i?"+":"\u2510",f=i?"+":"\u2514",h=i?"+":"\u2518",u=i?"+":"\u252C",s=i?"+":"\u2534",d=i?"+":"\u251C",p=i?"+":"\u2524",x=new Map;n.actors.forEach((_,B)=>x.set(_.id,B));let m=1,b=n.actors.map(_=>ae(_.label)+2*m+2).map(_=>Math.ceil(_/2)),v=3,M=new Array(Math.max(n.actors.length-1,0)).fill(0);for(let _ of n.messages){let B=x.get(_.from),X=x.get(_.to);if(B===X)continue;let F=Math.min(B,X),Y=Math.max(B,X),W=ae(_.label)+4,z=Y-F,V=Math.ceil(W/z);for(let S=F;S<Y;S++)M[S]=Math.max(M[S],V);}let I=[b[0]];for(let _=1;_<n.actors.length;_++){let B=Math.max(b[_-1]+b[_]+2,M[_-1]+2,10);I[_]=I[_-1]+B;}let y=[],w=[],$=new Map,L=new Map,G=new Map,O=[],R=v;for(let _=0;_<n.messages.length;_++){for(let F=0;F<n.blocks.length;F++)n.blocks[F].startIndex===_&&(R+=2,$.set(F,R-1));for(let F=0;F<n.blocks.length;F++)for(let Y=0;Y<n.blocks[F].dividers.length;Y++)n.blocks[F].dividers[Y].index===_&&(R+=1,G.set(`${F}:${Y}`,R),R+=1);R+=1;let B=n.messages[_];B.from===B.to?(w[_]=R+1,y[_]=R,R+=3):(w[_]=R,y[_]=R+1,R+=2);for(let F=0;F<n.notes.length;F++)if(n.notes[F].afterIndex===_){R+=1;let Y=n.notes[F],W=Y.text.split("\\n"),z=Math.max(...W.map(P=>ae(P)))+4,V=W.length+2,S=x.get(Y.actorIds[0])??0,T;if(Y.position==="left")T=I[S]-z-1;else if(Y.position==="right")T=I[S]+2;else if(Y.actorIds.length>=2){let P=x.get(Y.actorIds[1])??S;T=Math.floor((I[S]+I[P])/2)-Math.floor(z/2);}else T=I[S]-Math.floor(z/2);T=Math.max(0,T),O.push({x:T,y:R,width:z,height:V,lines:W}),R+=V;}for(let F=0;F<n.blocks.length;F++)n.blocks[F].endIndex===_&&(R+=1,L.set(F,R),R+=1);}R+=1;let N=R,E=N+v,k=I[I.length-1]??0,A=b[b.length-1]??0,D=k+A+2;for(let _=0;_<n.messages.length;_++){let B=n.messages[_];if(B.from===B.to){let X=x.get(B.from),F=I[X]+6+2+ae(B.label);D=Math.max(D,F+1);}}for(let _ of O)D=Math.max(D,_.x+_.width+1);let C=he(D,E-1);function H(_,B,X){let F=ae(X)+2*m+2,Y=_-Math.floor(F/2);C[Y][B]=a;for(let z=1;z<F-1;z++)C[Y+z][B]=o;C[Y+F-1][B]=l,C[Y][B+1]=c,C[Y+F-1][B+1]=c;let W=Y+1+m;fe(C,{x:W,y:B+1},X),C[Y][B+2]=f;for(let z=1;z<F-1;z++)C[Y+z][B+2]=o;C[Y+F-1][B+2]=h;}for(let _=0;_<n.actors.length;_++){let B=I[_];for(let X=v;X<=N;X++)C[B][X]=c;}for(let _=0;_<n.actors.length;_++){let B=n.actors[_];H(I[_],0,B.label),H(I[_],N,B.label),i||(C[I[_]][v-1]=u,C[I[_]][N]=s);}for(let _=0;_<n.messages.length;_++){let B=n.messages[_],X=x.get(B.from),F=x.get(B.to),Y=I[X],W=I[F],z=X===F,V=B.lineStyle==="dashed",S=B.arrowHead==="filled",T=V?i?".":"\u254C":o;if(z){let P=y[_],j=Math.max(4,4);C[Y][P]=d;for(let te=Y+1;te<Y+j;te++)C[te][P]=T;C[Y+j][P]=i?"+":"\u2510",C[Y+j][P+1]=c;let J=Y+j+2;fe(C,{x:J,y:P+1},B.label);let Q=S?i?"<":"\u25C0":i?"<":"\u25C1";C[Y][P+2]=Q;for(let te=Y+1;te<Y+j;te++)C[te][P+2]=T;C[Y+j][P+2]=i?"+":"\u2518";}else {let P=w[_],j=y[_],J=Y<W,te=Math.floor((Y+W)/2)-Math.floor(ae(B.label)/2);if(fe(C,{x:Math.max(0,te),y:P},B.label),J){for(let ye=Y+1;ye<W;ye++)C[ye][j]=T;let ue=S?i?">":"\u25B6":i?">":"\u25B7";C[W][j]=ue;}else {for(let ye=W+1;ye<Y;ye++)C[ye][j]=T;let ue=S?i?"<":"\u25C0":i?"<":"\u25C1";C[W][j]=ue;}}}for(let _=0;_<n.blocks.length;_++){let B=n.blocks[_],X=$.get(_),F=L.get(_);if(X===void 0||F===void 0)continue;let Y=D,W=0;for(let T=B.startIndex;T<=B.endIndex&&!(T>=n.messages.length);T++){let P=n.messages[T],j=x.get(P.from)??0,J=x.get(P.to)??0;Y=Math.min(Y,I[Math.min(j,J)]),W=Math.max(W,I[Math.max(j,J)]);}let z=Math.max(0,Y-4),V=Math.min(D-1,W+4);C[z][X]=a;for(let T=z+1;T<V;T++)C[T][X]=o;C[V][X]=l;let S=B.label?`${B.type} [${B.label}]`:B.type;fe(C,{x:z+1,y:X},Ie(S,V-(z+1))),C[z][F]=f;for(let T=z+1;T<V;T++)C[T][F]=o;C[V][F]=h;for(let T=X+1;T<F;T++)C[z][T]=c,C[V][T]=c;for(let T=0;T<B.dividers.length;T++){let P=G.get(`${_}:${T}`);if(P===void 0)continue;let j=q();C[z][P]=d;for(let Q=z+1;Q<V;Q++)C[Q][P]=j;C[V][P]=p;let J=B.dividers[T].label;if(J){let Q=`[${J}]`;fe(C,{x:z+1,y:P},Ie(Q,V-(z+1)));}}}for(let _ of O){We(C,_.x+_.width,_.y+_.height),C[_.x][_.y]=a;for(let X=1;X<_.width-1;X++)C[_.x+X][_.y]=o;C[_.x+_.width-1][_.y]=l;for(let X=0;X<_.lines.length;X++){let F=_.y+1+X;C[_.x][F]=c,C[_.x+_.width-1][F]=c,fe(C,{x:_.x+2,y:F},_.lines[X]);}let B=_.y+_.height-1;C[_.x][B]=f;for(let X=1;X<_.width-1;X++)C[_.x+X][B]=o;C[_.x+_.width-1][B]=h;}return Le(C);function q(){return i?"-":"\u254C"}}function at(e){let t={classes:[],relationships:[],namespaces:[]},r=new Map,n=null,i=null,o=0;for(let c=1;c<e.length;c++){let a=e[c];if(i&&o>0){if(a==="}"){o--,o===0&&(i=null);continue}let p=a.match(/^<<(\w+)>>$/);if(p){i.annotation=p[1];continue}let x=cn(a);x&&(x.isMethod?i.methods.push(x.member):i.attributes.push(x.member));continue}let l=a.match(/^namespace\s+(\S+)\s*\{$/);if(l){n={name:l[1],classIds:[]};continue}if(a==="}"&&n){t.namespaces.push(n),n=null;continue}let f=a.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*\{$/);if(f){let p=f[1],x=f[2],m=Fe(r,p);x&&(m.label=`${p}<${x}>`),i=m,o=1,n&&n.classIds.push(p);continue}let h=a.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*$/);if(h){let p=h[1],x=h[2],m=Fe(r,p);x&&(m.label=`${p}<${x}>`),n&&n.classIds.push(p);continue}let u=a.match(/^class\s+(\S+?)\s*\{\s*<<(\w+)>>\s*\}$/);if(u){let p=Fe(r,u[1]);p.annotation=u[2];continue}let s=a.match(/^(\S+?)\s*:\s*(.+)$/);if(s){let p=s[2];if(!p.match(/<\|--|--|\*--|o--|-->|\.\.>|\.\.\|>/)){let x=Fe(r,s[1]),m=cn(p);m&&(m.isMethod?x.methods.push(m.member):x.attributes.push(m.member));continue}}let d=Dr(a);if(d){Fe(r,d.from),Fe(r,d.to),t.relationships.push(d);continue}}return t.classes=[...r.values()],t}function Fe(e,t){let r=e.get(t);return r||(r={id:t,label:t,attributes:[],methods:[]},e.set(t,r)),r}function cn(e){let t=e.trim().replace(/;$/,"");if(!t)return null;let r="",n=t;/^[+\-#~]/.test(n)&&(r=n[0],n=n.slice(1).trim());let i=n.match(/^(.+?)\(([^)]*)\)(?:\s*(.+))?$/);if(i){let h=i[1].trim(),u=i[3]?.trim(),s=h.endsWith("$")||n.includes("$"),d=h.endsWith("*")||n.includes("*");return {member:{visibility:r,name:h.replace(/[$*]$/,""),type:u||void 0,isStatic:s,isAbstract:d},isMethod:true}}let o=n.split(/\s+/),c,a;o.length>=2?(a=o[0],c=o.slice(1).join(" ")):c=o[0]??n;let l=c.endsWith("$"),f=c.endsWith("*");return {member:{visibility:r,name:c.replace(/[$*]$/,""),type:a||void 0,isStatic:l,isAbstract:f},isMethod:false}}function Dr(e){let t=e.match(/^(\S+?)\s+(?:"([^"]*?)"\s+)?(<\|--|<\|\.\.|\*--|o--|-->|--\*|--o|--|>\s*|\.\.>|\.\.\|>|--)\s+(?:"([^"]*?)"\s+)?(\S+?)(?:\s*:\s*(.+))?$/);if(!t)return null;let r=t[1],n=t[2]||void 0,i=t[3].trim(),o=t[4]||void 0,c=t[5],a=t[6]?.trim()||void 0,l=Tr(i);return l?{from:r,to:c,type:l.type,markerAt:l.markerAt,label:a,fromCardinality:n,toCardinality:o}:null}function Tr(e){switch(e){case "<|--":return {type:"inheritance",markerAt:"from"};case "<|..":return {type:"realization",markerAt:"from"};case "*--":return {type:"composition",markerAt:"from"};case "--*":return {type:"composition",markerAt:"to"};case "o--":return {type:"aggregation",markerAt:"from"};case "--o":return {type:"aggregation",markerAt:"to"};case "-->":return {type:"association",markerAt:"to"};case "..>":return {type:"dependency",markerAt:"to"};case "..|>":return {type:"realization",markerAt:"to"};case "--":return {type:"association",markerAt:"to"};default:return null}}function ln(e){let t=e.visibility||"",r=e.type?`: ${e.type}`:"";return `${t}${e.name}${r}`}function Ir(e){let t=[];e.annotation&&t.push(`<<${e.annotation}>>`),t.push(e.label);let r=e.attributes.map(ln),n=e.methods.map(ln);return r.length===0&&n.length===0?[t]:n.length===0?[t,r]:[t,r,n]}function Nr(e,t){return {type:e,markerAt:t,dashed:e==="dependency"||e==="realization"}}function Ye(e,t,r){switch(e){case "inheritance":case "realization":return r==="down"?t?"^":"\u25B3":r==="up"?t?"v":"\u25BD":r==="left"?t?">":"\u25C1":t?"<":"\u25B7";case "composition":return t?"*":"\u25C6";case "aggregation":return t?"o":"\u25C7";case "association":case "dependency":return r==="down"?t?"v":"\u25BC":r==="up"?t?"^":"\u25B2":r==="left"?t?"<":"\u25C0":t?">":"\u25B6"}}function dn(e,t){let r=e.split(`
`).map(N=>N.trim()).filter(N=>N.length>0&&!N.startsWith("%%")),n=at(r);if(n.classes.length===0)return "";let i=t.useAscii,o=4,c=3,a=new Map,l=new Map,f=new Map;for(let N of n.classes){let E=Ir(N);a.set(N.id,E);let k=0;for(let H of E)for(let q of H)k=Math.max(k,ae(q));let A=k+4,D=0;for(let H of E)D+=Math.max(H.length,1);let C=D+(E.length-1)+2;l.set(N.id,A),f.set(N.id,C);}let h=new Map;for(let N of n.classes)h.set(N.id,N);let u=new Map,s=new Map;for(let N of n.relationships){let E=N.type==="inheritance"||N.type==="realization",k=E&&N.markerAt==="to"?N.to:N.from,A=E&&N.markerAt==="to"?N.from:N.to;u.has(A)||u.set(A,new Set),u.get(A).add(k),s.has(k)||s.set(k,new Set),s.get(k).add(A);}let d=new Map,x=n.classes.filter(N=>!u.has(N.id)||u.get(N.id).size===0).map(N=>N.id);for(let N of x)d.set(N,0);let m=n.classes.length-1,g=0;for(;g<x.length;){let N=x[g++],E=s.get(N);if(E)for(let k of E){let A=(d.get(N)??0)+1;A>m||(!d.has(k)||d.get(k)<A)&&(d.set(k,A),x.push(k));}}for(let N of n.classes)d.has(N.id)||d.set(N.id,0);let b=Math.max(...d.values(),0),v=Array.from({length:b+1},()=>[]);for(let N of n.classes)v[d.get(N.id)].push(N.id);let M=new Map,I=0;for(let N=0;N<=b;N++){let E=v[N];if(E.length===0)continue;let k=0,A=0;for(let D of E){let C=h.get(D),H=l.get(D),q=f.get(D);M.set(D,{cls:C,sections:a.get(D),x:k,y:I,width:H,height:q}),k+=H+o,A=Math.max(A,q);}I+=A+c;}let y=0,w=0;for(let N of M.values())y=Math.max(y,N.x+N.width),w=Math.max(w,N.y+N.height);y+=4,w+=2;let $=he(y-1,w-1);for(let N of M.values()){let E=ot(N.sections,i);for(let k=0;k<E.length;k++)for(let A=0;A<E[0].length;A++){let D=E[k][A];if(D!==" "){let C=N.x+k,H=N.y+A;C<y&&H<w&&($[C][H]=D);}}}let L=i?"-":"\u2500",G=i?"|":"\u2502",O=i?".":"\u254C",R=i?":":"\u250A";for(let N of n.relationships){let E=M.get(N.from),k=M.get(N.to);if(!E||!k)continue;let A=Nr(N.type,N.markerAt),D=A.dashed?O:L,C=A.dashed?R:G,H=E.x+Math.floor(E.width/2),q=E.y+E.height-1,_=k.x+Math.floor(k.width/2),B=k.y;if(q<B){let X=q+Math.floor((B-q)/2);for(let F=q+1;F<=X;F++)F<w&&($[H][F]=C);if(H!==_){let F=Math.min(H,_),Y=Math.max(H,_);for(let W=F;W<=Y;W++)W<y&&X<w&&($[W][X]=D);!i&&X<w&&(H<_?($[H][X]="\u2514",$[_][X]="\u2510"):($[H][X]="\u2518",$[_][X]="\u250C"));}for(let F=X+1;F<B;F++)F<w&&($[_][F]=C);if(A.markerAt==="to"){let F=Ye(A.type,i,"down"),Y=B-1;if(Y>=0&&Y<w)for(let W=0;W<F.length;W++){let z=_-Math.floor(F.length/2)+W;z>=0&&z<y&&($[z][Y]=F[W]);}}if(A.markerAt==="from"){let F=Ye(A.type,i,"down"),Y=q+1;if(Y<w)for(let W=0;W<F.length;W++){let z=H-Math.floor(F.length/2)+W;z>=0&&z<y&&($[z][Y]=F[W]);}}}else if(k.y+k.height-1<E.y){let X=E.y,F=k.y+k.height-1,Y=F+Math.floor((X-F)/2);for(let W=X-1;W>=Y;W--)W>=0&&W<w&&($[H][W]=C);if(H!==_){let W=Math.min(H,_),z=Math.max(H,_);for(let V=W;V<=z;V++)V<y&&Y>=0&&Y<w&&($[V][Y]=D);!i&&Y>=0&&Y<w&&(H<_?($[H][Y]="\u250C",$[_][Y]="\u2518"):($[H][Y]="\u2510",$[_][Y]="\u2514"));}for(let W=Y-1;W>F;W--)W>=0&&W<w&&($[_][W]=C);if(A.markerAt==="from"){let W=Ye(A.type,i,"up"),z=X-1;if(z>=0&&z<w)for(let V=0;V<W.length;V++){let S=H-Math.floor(W.length/2)+V;S>=0&&S<y&&($[S][z]=W[V]);}}if(A.markerAt==="to"){let z=A.type==="inheritance"||A.type==="realization"?"down":"up",V=Ye(A.type,i,z),S=F+1;if(S<w)for(let T=0;T<V.length;T++){let P=_-Math.floor(V.length/2)+T;P>=0&&P<y&&($[P][S]=V[T]);}}}else {let X=Math.max(q,k.y+k.height-1)+2;We($,y,X+1);for(let W=q+1;W<=X;W++)$[H][W]=C;let F=Math.min(H,_),Y=Math.max(H,_);for(let W=F;W<=Y;W++)$[W][X]=D;for(let W=X-1;W>=k.y+k.height;W--)$[_][W]=C;if(A.markerAt==="from"){let W=Ye(A.type,i,"down"),z=q+1;if(z<w)for(let V=0;V<W.length;V++){let S=H-Math.floor(W.length/2)+V;S>=0&&S<y&&($[S][z]=W[V]);}}if(A.markerAt==="to"){let W=Ye(A.type,i,"up"),z=k.y+k.height;if(z<w)for(let V=0;V<W.length;V++){let S=_-Math.floor(W.length/2)+V;S>=0&&S<y&&($[S][z]=W[V]);}}}if(N.label){let X=` ${N.label} `,F=Math.floor((H+_)/2),Y;if(q<B)Y=Math.floor((q+1+B-1)/2);else if(k.y+k.height-1<E.y){let S=k.y+k.height-1;Y=Math.floor((S+1+E.y-1)/2);}else Y=Math.max(q,k.y+k.height-1)+2;let z=F-Math.floor(ae(X)/2),V=X;if(z<0&&(V=Ut(V,-z),z=0),Y>=0&&Y<w){let S=Math.max(0,y-z);fe($,{x:z,y:Y},Ie(V,S));}}}return Le($)}function ct(e){let t={entities:[],relationships:[]},r=new Map,n=null;for(let i=1;i<e.length;i++){let o=e[i];if(n){if(o==="}"){n=null;continue}let l=Rr(o);l&&n.attributes.push(l);continue}let c=o.match(/^(\S+)\s*\{$/);if(c){let l=c[1];n=Mt(r,l);continue}let a=Pr(o);if(a){Mt(r,a.entity1),Mt(r,a.entity2),t.relationships.push(a);continue}}return t.entities=[...r.values()],t}function Mt(e,t){let r=e.get(t);return r||(r={id:t,label:t,attributes:[]},e.set(t,r)),r}function Rr(e){let t=e.match(/^(\S+)\s+(\S+)(?:\s+(.+))?$/);if(!t)return null;let r=t[1],n=t[2],i=t[3]?.trim()??"",o=[],c,a=i.match(/"([^"]*)"/);a&&(c=a[1]);let l=i.replace(/"[^"]*"/,"").trim();for(let f of l.split(/\s+/)){let h=f.toUpperCase();(h==="PK"||h==="FK"||h==="UK")&&o.push(h);}return {type:r,name:n,keys:o,comment:c}}function Pr(e){let t=e.match(/^(\S+)\s+([|o}{]+(?:--|\.\.)[|o}{]+)\s+(\S+)\s*:\s*(.+)$/);if(!t)return null;let r=t[1],n=t[2],i=t[3],o=t[4].trim(),c=n.match(/^([|o}{]+)(--|\.\.?)([|o}{]+)$/);if(!c)return null;let a=c[1],l=c[2],f=c[3],h=hn(a),u=hn(f),s=l==="--";return !h||!u?null:{entity1:r,entity2:i,cardinality1:h,cardinality2:u,label:o,identifying:s}}function hn(e){let t=e.split("").sort().join("");return t==="||"?"one":t==="o|"?"zero-one":t==="|}"||t==="{|"?"many":t==="{o"||t==="o{"?"zero-many":null}function Gr(e){return `${e.keys.length>0?e.keys.join(",")+" ":"   "}${e.type} ${e.name}`}function Or(e){let t=[e.label],r=e.attributes.map(Gr);return r.length===0?[t]:[t,r]}function lt(e,t){if(t)switch(e){case "one":return "||";case "zero-one":return "o|";case "many":return "}|";case "zero-many":return "o{"}else switch(e){case "one":return "\u2551";case "zero-one":return "o\u2551";case "many":return "\u255F";case "zero-many":return "o\u255F"}}function fn(e,t){let r=e.split(`
`).map(w=>w.trim()).filter(w=>w.length>0&&!w.startsWith("%%")),n=ct(r);if(n.entities.length===0)return "";let i=t.useAscii,o=6,c=4,a=new Map,l=new Map,f=new Map;for(let w of n.entities){let $=Or(w);a.set(w.id,$);let L=0;for(let N of $)for(let E of N)L=Math.max(L,ae(E));let G=L+4,O=0;for(let N of $)O+=Math.max(N.length,1);let R=O+($.length-1)+2;l.set(w.id,G),f.set(w.id,R);}let h=Math.max(2,Math.ceil(Math.sqrt(n.entities.length))),u=new Map,s=0,d=0,p=0,x=0;for(let w of n.entities){let $=l.get(w.id),L=f.get(w.id);x>=h&&(d+=p+c,s=0,p=0,x=0),u.set(w.id,{entity:w,sections:a.get(w.id),x:s,y:d,width:$,height:L}),s+=$+o,p=Math.max(p,L),x++;}let m=0,g=0;for(let w of u.values())m=Math.max(m,w.x+w.width),g=Math.max(g,w.y+w.height);m+=4,g+=2;let b=he(m-1,g-1);for(let w of u.values()){let $=ot(w.sections,i);for(let L=0;L<$.length;L++)for(let G=0;G<$[0].length;G++){let O=$[L][G];if(O!==" "){let R=w.x+L,N=w.y+G;R<m&&N<g&&(b[R][N]=O);}}}let v=i?"-":"\u2500",M=i?"|":"\u2502",I=i?".":"\u254C",y=i?":":"\u250A";for(let w of n.relationships){let $=u.get(w.entity1),L=u.get(w.entity2);if(!$||!L)continue;let G=w.identifying?v:I,O=w.identifying?M:y,R=$.x+Math.floor($.width/2),N=$.y+Math.floor($.height/2),E=L.x+Math.floor(L.width/2),k=L.y+Math.floor(L.height/2);if(Math.abs(N-k)<Math.max($.height,L.height)){let[D,C]=R<E?[$,L]:[L,$],[H,q]=R<E?[w.cardinality1,w.cardinality2]:[w.cardinality2,w.cardinality1],_=D.x+D.width,B=C.x-1,X=D.y+Math.floor(D.height/2);for(let W=_;W<=B;W++)W<m&&(b[W][X]=G);let F=lt(H,i);for(let W=0;W<F.length;W++){let z=_+W;z<m&&(b[z][X]=F[W]);}let Y=lt(q,i);for(let W=0;W<Y.length;W++){let z=B-Y.length+1+W;z>=0&&z<m&&(b[z][X]=Y[W]);}if(w.label){let W=Math.floor((_+B)/2),z=Math.max(_,W-Math.floor(ae(w.label)/2)),V=X-1;if(V>=0){let S=Math.max(0,B-z+1),T=Ie(w.label,S);fe(b,{x:z,y:V},T);}}}else {let[D,C]=N<k?[$,L]:[L,$],[H,q]=N<k?[w.cardinality1,w.cardinality2]:[w.cardinality2,w.cardinality1],_=D.y+D.height,B=C.y-1,X=D.x+Math.floor(D.width/2);for(let V=_;V<=B;V++)V<g&&(b[X][V]=O);let F=C.x+Math.floor(C.width/2);if(X!==F){let V=Math.floor((_+B)/2),S=Math.min(X,F),T=Math.max(X,F);for(let P=S;P<=T;P++)P<m&&V<g&&(b[P][V]=G);for(let P=V+1;P<=B;P++)P<g&&(b[F][P]=O);}let Y=lt(H,i);if(_<g)for(let V=0;V<Y.length;V++){let S=X-Math.floor(Y.length/2)+V;S>=0&&S<m&&(b[S][_]=Y[V]);}let W=X!==F?F:X,z=lt(q,i);if(B>=0&&B<g)for(let V=0;V<z.length;V++){let S=W-Math.floor(z.length/2)+V;S>=0&&S<m&&(b[S][B]=z[V]);}if(w.label){let V=Math.floor((_+B)/2),S=X+2;V>=0&&fe(b,{x:S,y:V},w.label);}}}return Le(b)}function Wr(e){let t=e.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(t)?"sequence":/^classdiagram\s*$/.test(t)?"class":/^erdiagram\s*$/.test(t)?"er":"flowchart"}function St(e,t={}){let r={useAscii:t.useAscii??false,paddingX:t.paddingX??5,paddingY:t.paddingY??5,boxBorderPadding:t.boxBorderPadding??1,graphDirection:"TD"};switch(Wr(e)){case "sequence":return an(e,r);case "class":return dn(e,r);case "er":return fn(e,r);default:{let i=Ue(e);i.direction==="LR"||i.direction==="RL"?r.graphDirection="LR":r.graphDirection="TD";let o=Jt(i,r);return sn(o),nn(o),i.direction==="BT"&&qt(o.canvas),Le(o.canvas)}}}var nt=mt(dt());function ce(e,t,r){let n=r>=600?.58:r>=500?.55:.52;return e.length*t*n}function ht(e,t){return e.length*t*.6}var K={nodeLabel:13,edgeLabel:11,groupHeader:12},Z={nodeLabel:500,edgeLabel:400,groupHeader:600},pn=8,Be={horizontal:16,vertical:10,diamondExtra:24},ie={outerBox:1,innerBox:.75,connector:.75},de="0.35em",Xe={width:8,height:4.8};function Ce(e,t,r,n){return {x:e-r/2,y:t-n/2}}function et(e,t,r,n,i){let o=e.x-t,c=e.y-r;if(Math.abs(o)<.5&&Math.abs(c)<.5)return e;let a=1/(Math.abs(o)/n+Math.abs(c)/i);return {x:t+a*o,y:r+a*c}}function tt(e,t,r,n){let i=e.x-t,o=e.y-r,c=Math.sqrt(i*i+o*o);if(c<.5)return e;let a=n/c;return {x:t+a*i,y:r+a*o}}function De(e,t=true){if(e.length<2)return e;let r=[e[0]];for(let n=1;n<e.length;n++){let i=r[r.length-1],o=e[n],c=Math.abs(o.x-i.x),a=Math.abs(o.y-i.y);if(c<1||a<1){r.push(o);continue}t?r.push({x:i.x,y:o.y}):r.push({x:o.x,y:i.y}),r.push(o);}return Fr(r)}function Fr(e){if(e.length<3)return e;let t=[e[0]];for(let r=1;r<e.length-1;r++){let n=t[t.length-1],i=e[r],o=e[r+1],c=Math.abs(n.x-i.x)<1&&Math.abs(i.x-o.x)<1,a=Math.abs(n.y-i.y)<1&&Math.abs(i.y-o.y)<1;c||a||t.push(i);}return t.push(e[e.length-1]),t}function Re(e,t,r){if(e.length<2)return e;let n=e.map(i=>({...i}));if(r){let i=n.length-1;if(e.length===2){let o=n[0],c=n[i],a=Math.abs(c.x-o.x);if(Math.abs(c.y-o.y)>=a){let h=c.y>o.y?r.cy-r.hh:r.cy+r.hh;n[i]={x:c.x,y:h};}else {let h=c.x>o.x?r.cx-r.hw:r.cx+r.hw;n[i]={x:h,y:c.y};}}else {let o=n[i-1],c=n[i],a=Math.abs(c.x-o.x),l=Math.abs(c.y-o.y),f=l<1&&a>=1,h=a<1&&l>=1,u=!f&&!h&&l<a,s=!f&&!h&&a<l;if(f){let p=c.x>o.x?r.cx-r.hw:r.cx+r.hw;n[i]={x:p,y:r.cy},n[i-1]={...o,y:r.cy};}else if(h){let p=c.y>o.y?r.cy-r.hh:r.cy+r.hh;n[i]={x:r.cx,y:p},n[i-1]={...o,x:r.cx};}else if(u){let p=c.x>o.x?r.cx-r.hw:r.cx+r.hw;o.y>=r.cy-r.hh&&o.y<=r.cy+r.hh?n[i]={x:p,y:o.y}:(n[i]={x:p,y:r.cy},n[i-1]={...o,y:r.cy});}else if(s){let p=c.y>o.y?r.cy-r.hh:r.cy+r.hh;o.x>=r.cx-r.hw&&o.x<=r.cx+r.hw?n[i]={x:o.x,y:p}:(n[i]={x:r.cx,y:p},n[i-1]={...o,x:r.cx});}}}if(t&&e.length>=3){let i=n[0],o=n[1],c=Math.abs(o.x-i.x),a=Math.abs(o.y-i.y),l=a<1&&c>=1,f=c<1&&a>=1,h=!l&&!f&&a<c,u=!l&&!f&&c<a;if(l){let d=o.x>i.x?t.cx+t.hw:t.cx-t.hw;n[0]={x:d,y:t.cy},n[1]={...n[1],y:t.cy};}else if(f){let d=o.y>i.y?t.cy+t.hh:t.cy-t.hh;n[0]={x:t.cx,y:d},n[1]={...n[1],x:t.cx};}else if(h){let d=o.x>i.x?t.cx+t.hw:t.cx-t.hw;o.y>=t.cy-t.hh&&o.y<=t.cy+t.hh?n[0]={x:d,y:o.y}:(n[0]={x:d,y:t.cy},n[1]={...n[1],y:t.cy});}else if(u){let d=o.y>i.y?t.cy+t.hh:t.cy-t.hh;o.x>=t.cx-t.hw&&o.x<=t.cx+t.hw?n[0]={x:o.x,y:d}:(n[0]={x:t.cx,y:d},n[1]={...n[1],x:t.cx});}}return n}var ft=new Set(["circle","doublecircle","state-start","state-end"]),ut=new Set(["diamond","circle","doublecircle","state-start","state-end"]),Yr={font:"Inter",padding:40,nodeSpacing:24,layerSpacing:40};function Br(e,t,r){let n=new nt.default.graphlib.Graph({directed:true,compound:true});n.setGraph({rankdir:mn(e.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:16,marginy:12}),n.setDefaultEdgeLabel(()=>({}));let i=new Set;i.add(e.id),Dt(e,i);for(let s of e.nodeIds){let d=t.nodes.get(s);if(d){let p=Lt(s,d.label,d.shape);n.setNode(s,{label:d.label,width:p.width,height:p.height});}}for(let s of e.children)At(n,s,t);let o=new Set;for(let s=0;s<t.edges.length;s++){let d=t.edges[s];if(i.has(d.source)&&i.has(d.target)){o.add(s);let p={_index:s};d.label&&(p.label=d.label,p.width=ce(d.label,K.edgeLabel,Z.edgeLabel)+8,p.height=K.edgeLabel+6,p.labelpos="c"),n.setEdge(d.source,d.target,p);}}nt.default.layout(n);let c=e.direction==="TD"||e.direction==="TB"||e.direction==="BT",a=new Set;for(let s of e.children)It(s,a);let l=[];for(let s of n.nodes()){if(a.has(s))continue;let d=t.nodes.get(s);if(!d)continue;let p=n.node(s);if(!p)continue;let x=Ce(p.x,p.y,p.width,p.height);l.push({id:s,label:d.label,shape:d.shape,x:x.x,y:x.y,width:p.width,height:p.height,inlineStyle:yn(t,s)});}let f=n.edges().map(s=>{let d=n.edge(s),p=t.edges[d._index],x=d.points??[];if(x.length>0){let w=t.nodes.get(s.v)?.shape;if(w==="diamond"){let L=n.node(s.v);x[0]=et(x[0],L.x,L.y,L.width/2,L.height/2);}else if(w&&ft.has(w)){let L=n.node(s.v);x[0]=tt(x[0],L.x,L.y,Math.min(L.width,L.height)/2);}let $=t.nodes.get(s.w)?.shape;if($==="diamond"){let L=n.node(s.w),G=x.length-1;x[G]=et(x[G],L.x,L.y,L.width/2,L.height/2);}else if($&&ft.has($)){let L=n.node(s.w),G=x.length-1;x[G]=tt(x[G],L.x,L.y,Math.min(L.width,L.height)/2);}}let m=De(x,c),g=t.nodes.get(s.v)?.shape,b=t.nodes.get(s.w)?.shape,v=g&&!ut.has(g)||!g?(()=>{let w=n.node(s.v);return w?{cx:w.x,cy:w.y,hw:w.width/2,hh:w.height/2}:null})():null,M=b&&!ut.has(b)||!b?(()=>{let w=n.node(s.w);return w?{cx:w.x,cy:w.y,hw:w.width/2,hh:w.height/2}:null})():null,I=Re(m,v,M),y;return p.label&&d.x!=null&&d.y!=null&&(y={x:d.x,y:d.y}),{source:p.source,target:p.target,label:p.label,style:p.style,hasArrowStart:p.hasArrowStart,hasArrowEnd:p.hasArrowEnd,points:I,labelPosition:y}}),h=e.children.map(s=>Tt(n,s)),u=n.graph();return {id:e.id,label:e.label,width:u.width??200,height:u.height??100,nodes:l,edges:f,groups:h,nodeIds:i,internalEdgeIndices:o}}async function gn(e,t={}){let r={...Yr,...t},n=new Map;for(let h of e.subgraphs)h.direction&&h.direction!==e.direction&&n.set(h.id,Br(h,e,r));let i=new nt.default.graphlib.Graph({directed:true,compound:true});i.setGraph({rankdir:mn(e.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:r.padding,marginy:r.padding}),i.setDefaultEdgeLabel(()=>({}));let o=new Set;for(let h of e.subgraphs)o.add(h.id),Dt(h,o);for(let[h,u]of e.nodes)if(!o.has(h)){let s=Lt(h,u.label,u.shape);i.setNode(h,{label:u.label,width:s.width,height:s.height});}for(let h of e.subgraphs)if(n.has(h.id)){let u=n.get(h.id);i.setNode(h.id,{width:u.width,height:u.height});}else At(i,h,e);let c=new Map,a=new Map;for(let h of e.subgraphs)n.has(h.id)||xn(h,c,a);for(let[h,u]of n)for(let s of u.nodeIds)c.set(s,h),a.set(s,h);let l=new Set;for(let h of n.values())for(let u of h.internalEdgeIndices)l.add(u);let f=new Set;for(let h=0;h<e.edges.length;h++){if(l.has(h))continue;let u=e.edges[h],s=a.get(u.source)??u.source,d=c.get(u.target)??u.target,p={_index:h};u.label&&(p.label=u.label,p.width=ce(u.label,K.edgeLabel,Z.edgeLabel)+8,p.height=K.edgeLabel+6,p.labelpos="c"),f.has(d)||(p.weight=2,f.add(d)),i.setEdge(s,d,p);}try{nt.default.layout(i);}catch(h){let u=h instanceof Error?h.message:String(h);throw new Error(`Dagre layout failed: ${u}`)}return Xr(i,e,r.padding,n)}function mn(e){switch(e){case "LR":return "LR";case "RL":return "RL";case "BT":return "BT";default:return "TB"}}function Lt(e,t,r){let i=ce(t,K.nodeLabel,Z.nodeLabel)+Be.horizontal*2,o=K.nodeLabel+Be.vertical*2;if(r==="diamond"){let c=Math.max(i,o)+Be.diamondExtra;i=c,o=c;}if(r==="circle"||r==="doublecircle"){let c=Math.ceil(Math.sqrt(i*i+o*o))+8;i=r==="doublecircle"?c+12:c,o=i;}return r==="hexagon"&&(i+=Be.horizontal),(r==="trapezoid"||r==="trapezoid-alt")&&(i+=Be.horizontal),r==="asymmetric"&&(i+=12),r==="cylinder"&&(o+=14),(r==="state-start"||r==="state-end")&&(i=28,o=28),i=Math.max(i,60),o=Math.max(o,36),{width:i,height:o}}function At(e,t,r,n){e.setNode(t.id,{label:t.label}),n&&e.setParent(t.id,n);for(let i of t.nodeIds){let o=r.nodes.get(i);if(o){let c=Lt(i,o.label,o.shape);e.setNode(i,{label:o.label,width:c.width,height:c.height}),e.setParent(i,t.id);}}for(let i of t.children)At(e,i,r,t.id);}function xn(e,t,r){for(let c of e.children)xn(c,t,r);let n=[...e.nodeIds,...e.children.map(c=>c.id)];if(n.length===0){t.set(e.id,e.id),r.set(e.id,e.id);return}let i=n[0],o=n[n.length-1];t.set(e.id,t.get(i)??i),r.set(e.id,r.get(o)??o);}function yn(e,t){let r=e.classAssignments.get(t),n=r?e.classDefs.get(r):void 0,i=e.nodeStyles.get(t);if(!(!n&&!i))return {...n,...i}}function Dt(e,t){for(let r of e.nodeIds)t.add(r);for(let r of e.children)Dt(r,t);}function Xr(e,t,r,n){let i=[],o=[],c=new Set;for(let g of t.subgraphs)It(g,c);let a=new Set;if(n)for(let g of n.values())for(let b of g.nodeIds)a.add(b);for(let g of e.nodes()){if(c.has(g))continue;let b=t.nodes.get(g);if(!b)continue;let v=e.node(g);if(!v)continue;let M=Ce(v.x,v.y,v.width,v.height);i.push({id:g,label:b.label,shape:b.shape,x:M.x,y:M.y,width:v.width,height:v.height,inlineStyle:yn(t,g)});}for(let g of t.subgraphs)o.push(Tt(e,g));let l=t.direction==="TD"||t.direction==="TB"||t.direction==="BT",f=e.edges().map(g=>{let b=e.edge(g),v=t.edges[b._index],M=b.points??[];if(M.length>0){let R=t.nodes.get(g.v)?.shape;if(R==="diamond"){let E=e.node(g.v);M[0]=et(M[0],E.x,E.y,E.width/2,E.height/2);}else if(R&&ft.has(R)){let E=e.node(g.v);M[0]=tt(M[0],E.x,E.y,Math.min(E.width,E.height)/2);}let N=t.nodes.get(g.w)?.shape;if(N==="diamond"){let E=e.node(g.w),k=M.length-1;M[k]=et(M[k],E.x,E.y,E.width/2,E.height/2);}else if(N&&ft.has(N)){let E=e.node(g.w),k=M.length-1;M[k]=tt(M[k],E.x,E.y,Math.min(E.width,E.height)/2);}}let I=De(M,l),y=t.nodes.get(g.v)?.shape,w=t.nodes.get(g.w)?.shape,$=y&&!ut.has(y)||!y?(()=>{let R=e.node(g.v);return R?{cx:R.x,cy:R.y,hw:R.width/2,hh:R.height/2}:null})():null,L=w&&!ut.has(w)||!w?(()=>{let R=e.node(g.w);return R?{cx:R.x,cy:R.y,hw:R.width/2,hh:R.height/2}:null})():null,G=Re(I,$,L),O;return v.label&&b.x!=null&&b.y!=null&&(O={x:b.x,y:b.y}),{source:v.source,target:v.target,label:v.label,style:v.style,hasArrowStart:v.hasArrowStart,hasArrowEnd:v.hasArrowEnd,points:G,labelPosition:O}});if(n&&n.size>0){let g=new Map;for(let b of i)g.set(b.id,{cx:b.x+b.width/2,cy:b.y+b.height/2});for(let[b,v]of n){let M=e.node(b);if(!M)continue;let I=Ce(M.x,M.y,M.width,M.height);for(let w of v.nodes){let $={...w,x:w.x+I.x,y:w.y+I.y};i.push($),g.set($.id,{cx:$.x+$.width/2,cy:$.y+$.height/2});}for(let w of v.edges)f.push({...w,points:w.points.map($=>({x:$.x+I.x,y:$.y+I.y})),labelPosition:w.labelPosition?{x:w.labelPosition.x+I.x,y:w.labelPosition.y+I.y}:void 0});let y=vn(o,b);y&&v.groups.length>0&&(y.children=v.groups.map(w=>$n(w,I.x,I.y)));}for(let b of f){if(a.has(b.source)&&a.has(b.target))continue;let v=false;if(a.has(b.source)){let M=g.get(b.source);M&&b.points.length>0&&(b.points[0]={x:M.cx,y:M.cy},v=true);}if(a.has(b.target)){let M=g.get(b.target);M&&b.points.length>0&&(b.points[b.points.length-1]={x:M.cx,y:M.cy},v=true);}v&&(b.points=De(b.points,l));}}let h=K.groupHeader+16;jr(o,h);let u=wn(o),s=[...i.map(g=>g.y),...u.map(g=>g.y)],d=s.length>0?Math.min(...s):r,p=e.graph().width??800,x=e.graph().height??600;if(d<r){let g=r-d;for(let b of i)b.y+=g;for(let b of f){for(let v of b.points)v.y+=g;b.labelPosition&&(b.labelPosition.y+=g);}for(let b of u)b.y+=g;x+=g;}let m=Math.max(...i.map(g=>g.y+g.height),...u.map(g=>g.y+g.height),...f.flatMap(g=>g.points.map(b=>b.y)));return m+r>x&&(x=m+r),{width:p,height:x,nodes:i,edges:f,groups:o}}function Tt(e,t){let r=e.node(t.id),n=r?Ce(r.x,r.y,r.width,r.height):{x:0,y:0};return {id:t.id,label:t.label,x:n.x,y:n.y,width:r?.width??0,height:r?.height??0,children:t.children.map(i=>Tt(e,i))}}function jr(e,t){for(let r of e)bn(r,t);}function bn(e,t){for(let r of e.children)bn(r,t);if(e.children.length>0){let r=e.y,n=e.y+e.height;for(let i of e.children)r=Math.min(r,i.y),n=Math.max(n,i.y+i.height);e.height=n-r,e.y=r;}if(e.label){let r=t+pn;e.y-=r,e.height+=r;}}function wn(e){let t=[];for(let r of e)t.push(r),t.push(...wn(r.children));return t}function vn(e,t){for(let r of e){if(r.id===t)return r;let n=vn(r.children,t);if(n)return n}}function $n(e,t,r){return {...e,x:e.x+t,y:e.y+r,children:e.children.map(n=>$n(n,t,r))}}function It(e,t){t.add(e.id);for(let r of e.children)It(r,t);}function kn(e,t,r="Inter",n=false){let i=[];i.push(_e(e.width,e.height,t,n)),i.push(Se(r,false)),i.push("<defs>"),i.push(zr()),i.push("</defs>");for(let o of e.groups)i.push(Cn(o));for(let o of e.edges)i.push(Vr(o));for(let o of e.edges)o.label&&i.push(qr(o));for(let o of e.nodes)i.push(Jr(o));for(let o of e.nodes)i.push(fi(o));return i.push("</svg>"),i.join(`
`)}function zr(){let e=Xe.width,t=Xe.height;return `  <marker id="arrowhead" markerWidth="${e}" markerHeight="${t}" refX="${e}" refY="${t/2}" orient="auto">
    <polygon points="0 0, ${e} ${t/2}, 0 ${t}" fill="var(--_arrow)" />
  </marker>
  <marker id="arrowhead-start" markerWidth="${e}" markerHeight="${t}" refX="0" refY="${t/2}" orient="auto-start-reverse">
    <polygon points="${e} 0, 0 ${t/2}, ${e} ${t}" fill="var(--_arrow)" />
  </marker>`}function Cn(e,t){let r=K.groupHeader+16,n=[];n.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="0" ry="0" fill="var(--_group-fill)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),n.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${r}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),n.push(`<text x="${e.x+12}" y="${e.y+r/2}" dy="${de}" font-size="${K.groupHeader}" font-weight="${Z.groupHeader}" fill="var(--_text-sec)">${Pe(e.label)}</text>`);for(let i of e.children)n.push(Cn(i));return n.join(`
`)}function Vr(e){if(e.points.length<2)return "";let t=Ur(e.points),r=e.style==="dotted"?' stroke-dasharray="4 4"':"",n=e.style==="thick"?ie.connector*2:ie.connector,i="";return e.hasArrowEnd&&(i+=' marker-end="url(#arrowhead)"'),e.hasArrowStart&&(i+=' marker-start="url(#arrowhead-start)"'),`<polyline points="${t}" fill="none" stroke="var(--_line)" stroke-width="${n}"${r}${i} />`}function Ur(e){return e.map(t=>`${t.x},${t.y}`).join(" ")}function qr(e,t){let r=e.labelPosition??Kr(e.points),n=e.label,i=ce(n,K.edgeLabel,Z.edgeLabel),o=8,c=i+o*2,a=K.edgeLabel+o*2;return `<rect x="${r.x-c/2}" y="${r.y-a/2}" width="${c}" height="${a}" rx="4" ry="4" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${r.x}" y="${r.y}" text-anchor="middle" dy="${de}" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Pe(n)}</text>`}function Kr(e){if(e.length===0)return {x:0,y:0};if(e.length===1)return e[0];let t=0;for(let n=1;n<e.length;n++)t+=En(e[n-1],e[n]);let r=t/2;for(let n=1;n<e.length;n++){let i=En(e[n-1],e[n]);if(r<=i){let o=r/i;return {x:e[n-1].x+o*(e[n].x-e[n-1].x),y:e[n-1].y+o*(e[n].y-e[n-1].y)}}r-=i;}return e[e.length-1]}function En(e,t){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function Jr(e){let{x:t,y:r,width:n,height:i,shape:o,inlineStyle:c}=e,a=Pe(c?.fill??"var(--_node-fill)"),l=Pe(c?.stroke??"var(--_node-stroke)"),f=Pe(c?.["stroke-width"]??String(ie.innerBox));switch(o){case "diamond":return ni(t,r,n,i,a,l,f);case "rounded":return Qr(t,r,n,i,a,l,f);case "stadium":return ei(t,r,n,i,a,l,f);case "circle":return ti(t,r,n,i,a,l,f);case "subroutine":return ri(t,r,n,i,a,l,f);case "doublecircle":return ii(t,r,n,i,a,l,f);case "hexagon":return oi(t,r,n,i,a,l,f);case "cylinder":return si(t,r,n,i,a,l,f);case "asymmetric":return ai(t,r,n,i,a,l,f);case "trapezoid":return ci(t,r,n,i,a,l,f);case "trapezoid-alt":return li(t,r,n,i,a,l,f);case "state-start":return di(t,r,n,i);case "state-end":return hi(t,r,n,i);default:return Zr(t,r,n,i,a,l,f)}}function Zr(e,t,r,n,i,o,c){return `<rect x="${e}" y="${t}" width="${r}" height="${n}" rx="0" ry="0" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function Qr(e,t,r,n,i,o,c){return `<rect x="${e}" y="${t}" width="${r}" height="${n}" rx="6" ry="6" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ei(e,t,r,n,i,o,c){let a=n/2;return `<rect x="${e}" y="${t}" width="${r}" height="${n}" rx="${a}" ry="${a}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ti(e,t,r,n,i,o,c){let a=e+r/2,l=t+n/2,f=Math.min(r,n)/2;return `<circle cx="${a}" cy="${l}" r="${f}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ni(e,t,r,n,i,o,c){let a=e+r/2,l=t+n/2,f=r/2,h=n/2;return `<polygon points="${[`${a},${l-h}`,`${a+f},${l}`,`${a},${l+h}`,`${a-f},${l}`].join(" ")}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ri(e,t,r,n,i,o,c){return `<rect x="${e}" y="${t}" width="${r}" height="${n}" rx="0" ry="0" fill="${i}" stroke="${o}" stroke-width="${c}" />
<line x1="${e+8}" y1="${t}" x2="${e+8}" y2="${t+n}" stroke="${o}" stroke-width="${c}" />
<line x1="${e+r-8}" y1="${t}" x2="${e+r-8}" y2="${t+n}" stroke="${o}" stroke-width="${c}" />`}function ii(e,t,r,n,i,o,c){let a=e+r/2,l=t+n/2,f=Math.min(r,n)/2,h=f-5;return `<circle cx="${a}" cy="${l}" r="${f}" fill="${i}" stroke="${o}" stroke-width="${c}" />
<circle cx="${a}" cy="${l}" r="${h}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function oi(e,t,r,n,i,o,c){let a=n/4;return `<polygon points="${[`${e+a},${t}`,`${e+r-a},${t}`,`${e+r},${t+n/2}`,`${e+r-a},${t+n}`,`${e+a},${t+n}`,`${e},${t+n/2}`].join(" ")}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function si(e,t,r,n,i,o,c){let l=e+r/2,f=t+7,h=n-14;return `<rect x="${e}" y="${f}" width="${r}" height="${h}" fill="${i}" stroke="none" />
<line x1="${e}" y1="${f}" x2="${e}" y2="${f+h}" stroke="${o}" stroke-width="${c}" />
<line x1="${e+r}" y1="${f}" x2="${e+r}" y2="${f+h}" stroke="${o}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${t+n-7}" rx="${r/2}" ry="7" fill="${i}" stroke="${o}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${f}" rx="${r/2}" ry="7" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ai(e,t,r,n,i,o,c){return `<polygon points="${[`${e+12},${t}`,`${e+r},${t}`,`${e+r},${t+n}`,`${e+12},${t+n}`,`${e},${t+n/2}`].join(" ")}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function ci(e,t,r,n,i,o,c){let a=r*.15;return `<polygon points="${[`${e+a},${t}`,`${e+r-a},${t}`,`${e+r},${t+n}`,`${e},${t+n}`].join(" ")}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function li(e,t,r,n,i,o,c){let a=r*.15;return `<polygon points="${[`${e},${t}`,`${e+r},${t}`,`${e+r-a},${t+n}`,`${e+a},${t+n}`].join(" ")}" fill="${i}" stroke="${o}" stroke-width="${c}" />`}function di(e,t,r,n){let i=e+r/2,o=t+n/2,c=Math.min(r,n)/2-2;return `<circle cx="${i}" cy="${o}" r="${c}" fill="var(--_text)" stroke="none" />`}function hi(e,t,r,n){let i=e+r/2,o=t+n/2,c=Math.min(r,n)/2-2,a=c-4;return `<circle cx="${i}" cy="${o}" r="${c}" fill="none" stroke="var(--_text)" stroke-width="${ie.innerBox*2}" />
<circle cx="${i}" cy="${o}" r="${a}" fill="var(--_text)" stroke="none" />`}function fi(e,t){if((e.shape==="state-start"||e.shape==="state-end")&&!e.label)return "";let r=e.x+e.width/2,n=e.y+e.height/2,i=Pe(e.inlineStyle?.color??"var(--_text)");return `<text x="${r}" y="${n}" text-anchor="middle" dy="${de}" font-size="${K.nodeLabel}" font-weight="${Z.nodeLabel}" fill="${i}">${Pe(e.label)}</text>`}function Pe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var ee={padding:30,actorGap:140,actorHeight:40,actorPadX:16,headerGap:20,messageRowHeight:40,selfMessageHeight:30,activationWidth:10,blockPadX:10,blockPadTop:40,blockPadBottom:8,blockHeaderExtra:28,dividerExtra:24,noteWidth:120,notePadding:8,noteGap:10};function Mn(e,t={}){if(e.actors.length===0)return {width:0,height:0,actors:[],lifelines:[],messages:[],activations:[],blocks:[],notes:[]};let r=e.actors.map(y=>{let w=ce(y.label,K.nodeLabel,Z.nodeLabel);return Math.max(w+ee.actorPadX*2,80)}),n=[],i=ee.padding+r[0]/2;for(let y=0;y<e.actors.length;y++){if(y>0){let w=Math.max(ee.actorGap,(r[y-1]+r[y])/2+40);i+=w;}n.push(i);}let o=new Map;for(let y=0;y<e.actors.length;y++)o.set(e.actors[y].id,y);let c=ee.padding,a=e.actors.map((y,w)=>({id:y.id,label:y.label,type:y.type,x:n[w],y:c,width:r[w],height:ee.actorHeight})),l=c+ee.actorHeight+ee.headerGap,f=[],h=new Map;for(let y of e.blocks){let w=h.get(y.startIndex)??0;h.set(y.startIndex,Math.max(w,ee.blockHeaderExtra));for(let $ of y.dividers){let L=h.get($.index)??0;h.set($.index,Math.max(L,ee.dividerExtra));}}let u=new Map,s=[];for(let y=0;y<e.messages.length;y++){let w=e.messages[y],$=o.get(w.from)??0,L=o.get(w.to)??0,G=w.from===w.to,O=h.get(y)??0;O>0&&(l+=O);let R=n[$],N=n[L];if(f.push({from:w.from,to:w.to,label:w.label,lineStyle:w.lineStyle,arrowHead:w.arrowHead,x1:R,x2:N,y:l,isSelf:G}),w.activate&&(u.has(w.to)||u.set(w.to,[]),u.get(w.to).push(l)),w.deactivate){let E=u.get(w.from);if(E&&E.length>0){let k=E.pop(),A=o.get(w.from)??0;s.push({actorId:w.from,x:n[A]-ee.activationWidth/2,topY:k,bottomY:l,width:ee.activationWidth});}}l+=G?ee.selfMessageHeight+ee.messageRowHeight:ee.messageRowHeight;}for(let[y,w]of u)for(let $ of w){let L=o.get(y)??0;s.push({actorId:y,x:n[L]-ee.activationWidth/2,topY:$,bottomY:l-ee.messageRowHeight/2,width:ee.activationWidth});}let d=e.blocks.map(y=>{let w=f[y.startIndex],$=f[y.endIndex],L=(w?.y??l)-ee.blockPadTop,G=($?.y??l)+ee.blockPadBottom+12,O=new Set;for(let D=y.startIndex;D<=y.endIndex;D++){let C=e.messages[D];C&&(O.add(o.get(C.from)??0),O.add(o.get(C.to)??0));}if(O.size===0)for(let D=0;D<e.actors.length;D++)O.add(D);let R=Math.min(...O),N=Math.max(...O),E=n[R]-r[R]/2-ee.blockPadX,k=n[N]+r[N]/2+ee.blockPadX,A=y.dividers.map(D=>{let C=f[D.index],H=C?.y??l,q=28;if(D.label&&C?.label){let _=`[${D.label}]`,B=ce(_,K.edgeLabel,Z.edgeLabel),X=E+8,F=X+B,Y=ce(C.label,K.edgeLabel,Z.edgeLabel),W=C.isSelf?C.x1+36:(C.x1+C.x2)/2-Y/2,z=W+Y;F>W&&X<z&&(q=36);}return {y:H-q,label:D.label}});return {type:y.type,label:y.label,x:E,y:L,width:k-E,height:G-L,dividers:A}}),p=e.notes.map(y=>{let w=Math.max(ee.noteWidth,ce(y.text,K.edgeLabel,Z.edgeLabel)+ee.notePadding*2),$=K.edgeLabel+ee.notePadding*2,G=(f[y.afterIndex]?.y??c+ee.actorHeight)+4,O=o.get(y.actorIds[0]??"")??0,R;if(y.position==="left")R=n[O]-r[O]/2-w-ee.noteGap;else if(y.position==="right")R=n[O]+r[O]/2+ee.noteGap;else if(y.actorIds.length>1){let N=o.get(y.actorIds[y.actorIds.length-1]??"")??O;R=(n[O]+n[N])/2-w/2;}else R=n[O]-w/2;return {text:y.text,x:R,y:G,width:w,height:$}}),x=l+ee.padding,m=ee.padding,g=0;for(let y of a)m=Math.min(m,y.x-y.width/2),g=Math.max(g,y.x+y.width/2);for(let y of d)m=Math.min(m,y.x),g=Math.max(g,y.x+y.width);for(let y of p)m=Math.min(m,y.x),g=Math.max(g,y.x+y.width);let b=m<ee.padding?ee.padding-m:0;if(b>0){for(let y of a)y.x+=b;for(let y of f)y.x1+=b,y.x2+=b;for(let y of s)y.x+=b;for(let y of d)y.x+=b;for(let y of p)y.x+=b;for(let y=0;y<n.length;y++)n[y]+=b;}let v=e.actors.map((y,w)=>({actorId:y.id,x:n[w],topY:c+ee.actorHeight,bottomY:x-ee.padding})),M=g+b+ee.padding,I=x;return {width:Math.max(M,200),height:Math.max(I,100),actors:a,lifelines:v,messages:f,activations:s,blocks:d,notes:p}}function Sn(e,t,r="Inter",n=false){let i=[];i.push(_e(e.width,e.height,t,n)),i.push(Se(r,false)),i.push("<defs>"),i.push(ui()),i.push("</defs>");for(let o of e.blocks)i.push(yi(o));for(let o of e.lifelines)i.push(gi(o));for(let o of e.activations)i.push(mi(o));for(let o of e.messages)i.push(xi(o));for(let o of e.notes)i.push(bi(o));for(let o of e.actors)i.push(pi(o));return i.push("</svg>"),i.join(`
`)}function ui(){let e=Xe.width,t=Xe.height;return `  <marker id="seq-arrow" markerWidth="${e}" markerHeight="${t}" refX="${e}" refY="${t/2}" orient="auto-start-reverse">
    <polygon points="0 0, ${e} ${t/2}, 0 ${t}" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="${e}" markerHeight="${t}" refX="${e}" refY="${t/2}" orient="auto-start-reverse">
    <polyline points="0 0, ${e} ${t/2}, 0 ${t}" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>`}function pi(e){let{x:t,y:r,width:n,height:i,label:o,type:c}=e;if(c==="actor"){let l=i/24*.9,f=t-12*l,h=r+(i-24*l)/2,u=ie.outerBox/l,s="var(--_line)";return `<g transform="translate(${f},${h}) scale(${l})">
  <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" fill="none" stroke="${s}" stroke-width="${u}" />
  <path d="M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z" fill="none" stroke="${s}" stroke-width="${u}" />
  <path d="M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563" fill="none" stroke="${s}" stroke-width="${u}" />
</g>
<text x="${t}" y="${r+i+14}" text-anchor="middle" font-size="${K.nodeLabel}" font-weight="${Z.nodeLabel}" fill="var(--_text)">${Ge(o)}</text>`}return `<rect x="${t-n/2}" y="${r}" width="${n}" height="${i}" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />
<text x="${t}" y="${r+i/2}" text-anchor="middle" dy="${de}" font-size="${K.nodeLabel}" font-weight="${Z.nodeLabel}" fill="var(--_text)">${Ge(o)}</text>`}function gi(e){return `<line x1="${e.x}" y1="${e.topY}" x2="${e.x}" y2="${e.bottomY}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`}function mi(e){return `<rect x="${e.x}" y="${e.topY}" width="${e.width}" height="${e.bottomY-e.topY}" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ie.innerBox}" />`}function xi(e){let t=[],r=e.lineStyle==="dashed"?' stroke-dasharray="6 4"':"",n=e.arrowHead==="filled"?"seq-arrow":"seq-arrow-open";if(e.isSelf)t.push(`<polyline points="${e.x1},${e.y} ${e.x1+30},${e.y} ${e.x1+30},${e.y+20} ${e.x2},${e.y+20}" fill="none" stroke="var(--_line)" stroke-width="${ie.connector}"${r} marker-end="url(#${n})" />`),t.push(`<text x="${e.x1+30+6}" y="${e.y+20/2}" dy="${de}" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Ge(e.label)}</text>`);else {t.push(`<line x1="${e.x1}" y1="${e.y}" x2="${e.x2}" y2="${e.y}" stroke="var(--_line)" stroke-width="${ie.connector}"${r} marker-end="url(#${n})" />`);let i=(e.x1+e.x2)/2;t.push(`<text x="${i}" y="${e.y-6}" text-anchor="middle" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Ge(e.label)}</text>`);}return t.join(`
`)}function yi(e){let t=[];t.push(`<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`);let r=`${e.type}${e.label?` [${e.label}]`:""}`,n=ce(r,K.edgeLabel,Z.groupHeader)+16,i=18;t.push(`<rect x="${e.x}" y="${e.y}" width="${n}" height="${i}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),t.push(`<text x="${e.x+6}" y="${e.y+i/2}" dy="${de}" font-size="${K.edgeLabel}" font-weight="${Z.groupHeader}" fill="var(--_text-sec)">${Ge(r)}</text>`);for(let o of e.dividers)t.push(`<line x1="${e.x}" y1="${o.y}" x2="${e.x+e.width}" y2="${o.y}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`),o.label&&t.push(`<text x="${e.x+8}" y="${o.y+14}" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">[${Ge(o.label)}]</text>`);return t.join(`
`)}function bi(e){return `<rect x="${e.x}" y="${e.y}" width="${e.width}" height="${e.height}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ie.innerBox}" />
<polygon points="${e.x+e.width-6},${e.y} ${e.x+e.width},${e.y+6} ${e.x+e.width-6},${e.y+6}" fill="var(--_inner-stroke)" />
<text x="${e.x+e.width/2}" y="${e.y+e.height/2}" text-anchor="middle" dy="${de}" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Ge(e.text)}</text>`}function Ge(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Nt=mt(dt());var le={padding:40,boxPadX:8,headerBaseHeight:32,annotationHeight:16,memberRowHeight:20,sectionPadY:8,emptySectionHeight:8,minWidth:120,memberFontSize:11,nodeSpacing:40,layerSpacing:60};async function Ln(e,t={}){if(e.classes.length===0)return {width:0,height:0,classes:[],relationships:[]};let r=new Map;for(let a of e.classes){let l=a.annotation?le.headerBaseHeight+le.annotationHeight:le.headerBaseHeight,f=a.attributes.length>0?a.attributes.length*le.memberRowHeight+le.sectionPadY:le.emptySectionHeight,h=a.methods.length>0?a.methods.length*le.memberRowHeight+le.sectionPadY:le.emptySectionHeight,u=ce(a.label,K.nodeLabel,Z.nodeLabel),s=_n(a.attributes),d=_n(a.methods),p=Math.max(le.minWidth,u+le.boxPadX*2,s+le.boxPadX*2,d+le.boxPadX*2),x=l+f+h;r.set(a.id,{width:p,height:x,headerHeight:l,attrHeight:f,methodHeight:h});}let n=new Nt.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"TB",acyclicer:"greedy",nodesep:le.nodeSpacing,ranksep:le.layerSpacing,marginx:le.padding,marginy:le.padding}),n.setDefaultEdgeLabel(()=>({}));for(let a of e.classes){let l=r.get(a.id);n.setNode(a.id,{width:l.width,height:l.height});}for(let a=0;a<e.relationships.length;a++){let l=e.relationships[a],f={_index:a};l.label&&(f.label=l.label,f.width=ce(l.label,K.edgeLabel,Z.edgeLabel)+8,f.height=K.edgeLabel+6,f.labelpos="c"),n.setEdge(l.from,l.to,f);}try{Nt.default.layout(n);}catch(a){let l=a instanceof Error?a.message:String(a);throw new Error(`Dagre layout failed (class diagram): ${l}`)}let i=new Map;for(let a of e.classes)i.set(a.id,a);let o=e.classes.map(a=>{let l=n.node(a.id),f=r.get(a.id),h=Ce(l.x,l.y,l.width,l.height);return {id:a.id,label:a.label,annotation:a.annotation,attributes:a.attributes,methods:a.methods,x:h.x,y:h.y,width:l.width??f.width,height:l.height??f.height,headerHeight:f.headerHeight,attrHeight:f.attrHeight,methodHeight:f.methodHeight}}),c=n.edges().map(a=>{let l=n.edge(a),f=e.relationships[l._index],h=l.points??[],u=De(h,true),s=n.node(a.v),d=n.node(a.w),p=Re(u,s?{cx:s.x,cy:s.y,hw:s.width/2,hh:s.height/2}:null,d?{cx:d.x,cy:d.y,hw:d.width/2,hh:d.height/2}:null),x;return f.label&&l.x!=null&&l.y!=null&&(x={x:l.x,y:l.y}),{from:f.from,to:f.to,type:f.type,markerAt:f.markerAt,label:f.label,fromCardinality:f.fromCardinality,toCardinality:f.toCardinality,points:p,labelPosition:x}});return {width:n.graph().width??600,height:n.graph().height??400,classes:o,relationships:c}}function _n(e){if(e.length===0)return 0;let t=0;for(let r of e){let n=wi(r),i=ht(n,le.memberFontSize);i>t&&(t=i);}return t}function wi(e){let t=e.visibility?`${e.visibility} `:"",r=e.type?`: ${e.type}`:"";return `${t}${e.name}${r}`}var pt={memberSize:11,memberWeight:400,annotationSize:10,annotationWeight:500};function Tn(e,t,r="Inter",n=false){let i=[];i.push(_e(e.width,e.height,t,n)),i.push(Se(r,true)),i.push("<defs>"),i.push(vi()),i.push("</defs>");for(let o of e.relationships)i.push(Ei(o));for(let o of e.classes)i.push($i(o));for(let o of e.relationships)i.push(Mi(o));return i.push("</svg>"),i.join(`
`)}function vi(){return `  <marker id="cls-inherit" markerWidth="12" markerHeight="10" refX="12" refY="5" orient="auto-start-reverse">
    <polygon points="0 0, 12 5, 0 10" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-composition" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--_arrow)" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
  <marker id="cls-aggregation" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto-start-reverse">
    <polyline points="0 0, 8 3, 0 6" fill="none" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>`}function $i(e){let{x:t,y:r,width:n,height:i,headerHeight:o,attrHeight:c,methodHeight:a}=e,l=[];l.push(`<rect x="${t}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),l.push(`<rect x="${t}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`);let f=r+o/2;if(e.annotation){let d=r+12;l.push(`<text x="${t+n/2}" y="${d}" text-anchor="middle" dy="${de}" font-size="${pt.annotationSize}" font-weight="${pt.annotationWeight}" font-style="italic" fill="var(--_text-muted)">&lt;&lt;${Te(e.annotation)}&gt;&gt;</text>`),f=r+o/2+6;}l.push(`<text x="${t+n/2}" y="${f}" text-anchor="middle" dy="${de}" font-size="${K.nodeLabel}" font-weight="700" fill="var(--_text)">${Te(e.label)}</text>`);let h=r+o;l.push(`<line x1="${t}" y1="${h}" x2="${t+n}" y2="${h}" stroke="var(--_node-stroke)" stroke-width="${ie.innerBox}" />`);let u=20;for(let d=0;d<e.attributes.length;d++){let p=e.attributes[d],x=h+4+d*u+u/2;l.push(An(p,t+le.boxPadX,x));}let s=h+c;l.push(`<line x1="${t}" y1="${s}" x2="${t+n}" y2="${s}" stroke="var(--_node-stroke)" stroke-width="${ie.innerBox}" />`);for(let d=0;d<e.methods.length;d++){let p=e.methods[d],x=s+4+d*u+u/2;l.push(An(p,t+le.boxPadX,x));}return l.join(`
`)}function An(e,t,r){let n=e.isAbstract?' font-style="italic"':"",i=e.isStatic?' text-decoration="underline"':"",o=[];return e.visibility&&o.push(`<tspan fill="var(--_text-faint)">${Te(e.visibility)} </tspan>`),o.push(`<tspan fill="var(--_text-sec)">${Te(e.name)}</tspan>`),e.type&&(o.push('<tspan fill="var(--_text-faint)">: </tspan>'),o.push(`<tspan fill="var(--_text-muted)">${Te(e.type)}</tspan>`)),`<text x="${t}" y="${r}" class="mono" dy="${de}" font-size="${pt.memberSize}" font-weight="${pt.memberWeight}"${n}${i}>${o.join("")}</text>`}function Ei(e){if(e.points.length<2)return "";let t=e.points.map(o=>`${o.x},${o.y}`).join(" "),n=e.type==="dependency"||e.type==="realization"?' stroke-dasharray="6 4"':"",i=ki(e.type,e.markerAt);return `<polyline points="${t}" fill="none" stroke="var(--_line)" stroke-width="${ie.connector}"${n}${i} />`}function ki(e,t){let r=Ci(e);return r?t==="from"?` marker-start="url(#${r})"`:` marker-end="url(#${r})"`:""}function Ci(e){switch(e){case "inheritance":case "realization":return "cls-inherit";case "composition":return "cls-composition";case "aggregation":return "cls-aggregation";case "association":case "dependency":return "cls-arrow";default:return null}}function Mi(e){if(!e.label&&!e.fromCardinality&&!e.toCardinality||e.points.length<2)return "";let t=[];if(e.label){let r=e.labelPosition??Si(e.points);t.push(`<text x="${r.x}" y="${r.y-8}" text-anchor="middle" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Te(e.label)}</text>`);}if(e.fromCardinality){let r=e.points[0],n=e.points[1],i=Dn(r,n);t.push(`<text x="${r.x+i.x}" y="${r.y+i.y}" text-anchor="middle" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Te(e.fromCardinality)}</text>`);}if(e.toCardinality){let r=e.points[e.points.length-1],n=e.points[e.points.length-2],i=Dn(r,n);t.push(`<text x="${r.x+i.x}" y="${r.y+i.y}" text-anchor="middle" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${Te(e.toCardinality)}</text>`);}return t.join(`
`)}function Si(e){if(e.length===0)return {x:0,y:0};let t=Math.floor(e.length/2);return e[t]}function Dn(e,t){let r=t.x-e.x,n=t.y-e.y;return Math.abs(r)>Math.abs(n)?{x:r>0?14:-14,y:-10}:{x:-14,y:n>0?14:-14}}function Te(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Rt=mt(dt());var me={padding:40,boxPadX:12,headerHeight:32,rowHeight:22,minWidth:140,attrFontSize:11,nodeSpacing:50,layerSpacing:70};async function In(e,t={}){if(e.entities.length===0)return {width:0,height:0,entities:[],relationships:[]};let r=new Map;for(let a of e.entities){let l=ce(a.label,K.nodeLabel,Z.nodeLabel),f=0;for(let s of a.attributes){let d=`${s.type}  ${s.name}${s.keys.length>0?"  "+s.keys.join(","):""}`,p=ht(d,me.attrFontSize);p>f&&(f=p);}let h=Math.max(me.minWidth,l+me.boxPadX*2,f+me.boxPadX*2),u=me.headerHeight+Math.max(a.attributes.length,1)*me.rowHeight;r.set(a.id,{width:h,height:u});}let n=new Rt.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"LR",acyclicer:"greedy",nodesep:me.nodeSpacing,ranksep:me.layerSpacing,marginx:me.padding,marginy:me.padding}),n.setDefaultEdgeLabel(()=>({}));for(let a of e.entities){let l=r.get(a.id);n.setNode(a.id,{width:l.width,height:l.height});}for(let a=0;a<e.relationships.length;a++){let l=e.relationships[a];n.setEdge(l.entity1,l.entity2,{_index:a,label:l.label,width:ce(l.label,K.edgeLabel,Z.edgeLabel)+8,height:K.edgeLabel+6,labelpos:"c"});}try{Rt.default.layout(n);}catch(a){let l=a instanceof Error?a.message:String(a);throw new Error(`Dagre layout failed (ER diagram): ${l}`)}let i=new Map;for(let a of e.entities)i.set(a.id,a);let o=e.entities.map(a=>{let l=n.node(a.id),f=Ce(l.x,l.y,l.width,l.height);return {id:a.id,label:a.label,attributes:a.attributes,x:f.x,y:f.y,width:l.width??r.get(a.id).width,height:l.height??r.get(a.id).height,headerHeight:me.headerHeight,rowHeight:me.rowHeight}}),c=n.edges().map(a=>{let l=n.edge(a),f=e.relationships[l._index],h=l.points??[],u=De(h,false),s=n.node(a.v),d=n.node(a.w),p=Re(u,s?{cx:s.x,cy:s.y,hw:s.width/2,hh:s.height/2}:null,d?{cx:d.x,cy:d.y,hw:d.width/2,hh:d.height/2}:null);return {entity1:f.entity1,entity2:f.entity2,cardinality1:f.cardinality1,cardinality2:f.cardinality2,label:f.label,identifying:f.identifying,points:p}});return {width:n.graph().width??600,height:n.graph().height??400,entities:o,relationships:c}}var Me={attrSize:11,attrWeight:400,keySize:9,keyWeight:600};function Rn(e,t,r="Inter",n=false){let i=[];i.push(_e(e.width,e.height,t,n)),i.push(Se(r,true)),i.push("<defs>"),i.push("</defs>");for(let o of e.relationships)i.push(Ai(o));for(let o of e.entities)i.push(_i(o));for(let o of e.relationships)i.push(Ti(o));for(let o of e.relationships)i.push(Di(o));return i.push("</svg>"),i.join(`
`)}function _i(e){let{x:t,y:r,width:n,height:i,headerHeight:o,rowHeight:c,label:a,attributes:l}=e,f=[];f.push(`<rect x="${t}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),f.push(`<rect x="${t}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${ie.outerBox}" />`),f.push(`<text x="${t+n/2}" y="${r+o/2}" text-anchor="middle" dy="${de}" font-size="${K.nodeLabel}" font-weight="700" fill="var(--_text)">${gt(a)}</text>`);let h=r+o;f.push(`<line x1="${t}" y1="${h}" x2="${t+n}" y2="${h}" stroke="var(--_node-stroke)" stroke-width="${ie.innerBox}" />`);for(let u=0;u<l.length;u++){let s=l[u],d=h+u*c+c/2;f.push(Li(s,t,d,n));}return l.length===0&&f.push(`<text x="${t+n/2}" y="${h+c/2}" text-anchor="middle" dy="${de}" font-size="${Me.attrSize}" fill="var(--_text-faint)" font-style="italic">(no attributes)</text>`),f.join(`
`)}function Li(e,t,r,n){let i=[],o=0;if(e.keys.length>0){let l=e.keys.join(",");o=ce(l,Me.keySize,Me.keyWeight)+8,i.push(`<rect x="${t+6}" y="${r-7}" width="${o}" height="14" rx="2" ry="2" fill="var(--_key-badge)" />`),i.push(`<text x="${t+6+o/2}" y="${r}" text-anchor="middle" dy="${de}" font-size="${Me.keySize}" font-weight="${Me.keyWeight}" fill="var(--_text-sec)">${e.keys.join(",")}</text>`);}let c=t+8+(o>0?o+6:0);i.push(`<text x="${c}" y="${r}" class="mono" dy="${de}" font-size="${Me.attrSize}" font-weight="${Me.attrWeight}"><tspan fill="var(--_text-muted)">${gt(e.type)}</tspan></text>`);let a=t+n-8;return i.push(`<text x="${a}" y="${r}" class="mono" text-anchor="end" dy="${de}" font-size="${Me.attrSize}" font-weight="${Me.attrWeight}"><tspan fill="var(--_text-sec)">${gt(e.name)}</tspan></text>`),i.join(`
`)}function Ai(e){if(e.points.length<2)return "";let t=e.points.map(n=>`${n.x},${n.y}`).join(" "),r=e.identifying?"":' stroke-dasharray="6 4"';return `<polyline points="${t}" fill="none" stroke="var(--_line)" stroke-width="${ie.connector}"${r} />`}function Di(e){if(!e.label||e.points.length<2)return "";let t=Ii(e.points),n=ce(e.label,K.edgeLabel,Z.edgeLabel)+8,i=K.edgeLabel+6;return `<rect x="${t.x-n/2}" y="${t.y-i/2}" width="${n}" height="${i}" rx="2" ry="2" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${t.x}" y="${t.y}" text-anchor="middle" dy="${de}" font-size="${K.edgeLabel}" font-weight="${Z.edgeLabel}" fill="var(--_text-muted)">${gt(e.label)}</text>`}function Ti(e){if(e.points.length<2)return "";let t=[],r=e.points[0],n=e.points[1];t.push(Nn(r,n,e.cardinality1));let i=e.points[e.points.length-1],o=e.points[e.points.length-2];return t.push(Nn(i,o,e.cardinality2)),t.join(`
`)}function Nn(e,t,r){let n=[],i=ie.connector+.25,o=e.x-t.x,c=e.y-t.y,a=Math.sqrt(o*o+c*c);if(a===0)return "";let l=o/a,f=c/a,h=-f,u=l,s=e.x-l*4,d=e.y-f*4,p=e.x-l*16,x=e.y-f*16,m=r==="one"||r==="zero-one",g=r==="many"||r==="zero-many",b=r==="zero-one"||r==="zero-many";if(m){n.push(`<line x1="${s+h*6}" y1="${d+u*6}" x2="${s-h*6}" y2="${d-u*6}" stroke="var(--_line)" stroke-width="${i}" />`);let M=s-l*4,I=d-f*4;n.push(`<line x1="${M+h*6}" y1="${I+u*6}" x2="${M-h*6}" y2="${I-u*6}" stroke="var(--_line)" stroke-width="${i}" />`);}if(g){let M=s,I=d;n.push(`<line x1="${M+h*7}" y1="${I+u*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${i}" />`),n.push(`<line x1="${M}" y1="${I}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${i}" />`),n.push(`<line x1="${M-h*7}" y1="${I-u*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${i}" />`);}if(b){let v=g?20:12,M=e.x-l*v,I=e.y-f*v;n.push(`<circle cx="${M}" cy="${I}" r="4" fill="var(--bg)" stroke="var(--_line)" stroke-width="${i}" />`);}return n.join(`
`)}function Ii(e){if(e.length===0)return {x:0,y:0};if(e.length===1)return e[0];let t=0;for(let i=1;i<e.length;i++){let o=e[i].x-e[i-1].x,c=e[i].y-e[i-1].y;t+=Math.sqrt(o*o+c*c);}if(t===0)return e[0];let r=t/2,n=0;for(let i=1;i<e.length;i++){let o=e[i].x-e[i-1].x,c=e[i].y-e[i-1].y,a=Math.sqrt(o*o+c*c);if(n+a>=r){let l=a>0?(r-n)/a:0;return {x:e[i-1].x+o*l,y:e[i-1].y+c*l}}n+=a;}return e[e.length-1]}function gt(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Ni(e){let t=e.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(t)?"sequence":/^classdiagram\s*$/.test(t)?"class":/^erdiagram\s*$/.test(t)?"er":"flowchart"}function Ri(e){return {bg:e.bg??Oe.bg,fg:e.fg??Oe.fg,line:e.line,accent:e.accent,muted:e.muted,surface:e.surface,border:e.border}}async function Pn(e,t={}){let r=Ri(t),n=t.font??"Inter",i=t.transparent??false,o=Ni(e),c=e.split(/[\n;]/).map(a=>a.trim()).filter(a=>a.length>0&&!a.startsWith("%%"));switch(o){case "sequence":{let a=st(c),l=Mn(a,t);return Sn(l,r,n,i)}case "class":{let a=at(c),l=await Ln(a,t);return Tn(l,r,n,i)}case "er":{let a=ct(c),l=await In(a,t);return Rn(l,r,n,i)}default:{let a=Ue(e),l=await gn(a,t);return kn(l,r,n,i)}}}typeof window<"u"&&(window.__mermaid={renderMermaid:Pn,renderMermaidAscii:St,THEMES:xt,DEFAULTS:Oe,fromShikiTheme:yt});exports.DEFAULTS=Oe;exports.THEMES=xt;exports.fromShikiTheme=yt;exports.renderMermaid=Pn;exports.renderMermaidAscii=St;return exports;})({});//# sourceMappingURL=beautiful-mermaid.browser.global.js.map
//# sourceMappingURL=beautiful-mermaid.browser.global.js.map