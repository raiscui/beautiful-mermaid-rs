var beautifulMermaid=(function(exports){'use strict';var go=Object.create;var An=Object.defineProperty;var xo=Object.getOwnPropertyDescriptor;var bo=Object.getOwnPropertyNames;var yo=Object.getPrototypeOf,wo=Object.prototype.hasOwnProperty;var ye=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var Mo=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Co=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of bo(e))!wo.call(t,o)&&o!==r&&An(t,o,{get:()=>e[o],enumerable:!(n=xo(e,o))||n.enumerable});return t};var Ve=(t,e,r)=>(r=t!=null?go(yo(t)):{},Co(An(r,"default",{value:t,enumerable:true}),t));var Ye=Mo((Dr,xn)=>{(function(t){if(typeof Dr=="object"&&typeof xn<"u")xn.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else {var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.dagre=t();}})(function(){return (function(){function n(o,i,c){function s(m,g){if(!i[m]){if(!o[m]){var a=typeof ye=="function"&&ye;if(!g&&a)return a(m,true);if(l)return l(m,true);var h=new Error("Cannot find module '"+m+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[m]={exports:{}};o[m][0].call(p.exports,function(x){var u=o[m][1][x];return s(u||x)},p,p.exports,n,o,i,c);}return i[m].exports}for(var l=typeof ye=="function"&&ye,d=0;d<c.length;d++)s(c[d]);return s}return n})()({1:[function(n,o,i){o.exports={graphlib:n("@dagrejs/graphlib"),layout:n("./lib/layout"),debug:n("./lib/debug"),util:{time:n("./lib/util").time,notime:n("./lib/util").notime},version:n("./lib/version")};},{"./lib/debug":6,"./lib/layout":8,"./lib/util":27,"./lib/version":28,"@dagrejs/graphlib":29}],2:[function(n,o,i){let c=n("./greedy-fas"),s=n("./util").uniqueId;o.exports={run:l,undo:m};function l(g){(g.graph().acyclicer==="greedy"?c(g,h(g)):d(g)).forEach(p=>{let x=g.edge(p);g.removeEdge(p),x.forwardName=p.name,x.reversed=true,g.setEdge(p.w,p.v,x,s("rev"));});function h(p){return x=>p.edge(x).weight}}function d(g){let a=[],h={},p={};function x(u){Object.hasOwn(p,u)||(p[u]=true,h[u]=true,g.outEdges(u).forEach(f=>{Object.hasOwn(h,f.w)?a.push(f):x(f.w);}),delete h[u]);}return g.nodes().forEach(x),a}function m(g){g.edges().forEach(a=>{let h=g.edge(a);if(h.reversed){g.removeEdge(a);let p=h.forwardName;delete h.reversed,delete h.forwardName,g.setEdge(a.w,a.v,h,p);}});}},{"./greedy-fas":7,"./util":27}],3:[function(n,o,i){let c=n("./util");o.exports=s;function s(d){function m(g){let a=d.children(g),h=d.node(g);if(a.length&&a.forEach(m),Object.hasOwn(h,"minRank")){h.borderLeft=[],h.borderRight=[];for(let p=h.minRank,x=h.maxRank+1;p<x;++p)l(d,"borderLeft","_bl",g,h,p),l(d,"borderRight","_br",g,h,p);}}d.children().forEach(m);}function l(d,m,g,a,h,p){let x={width:0,height:0,rank:p,borderType:m},u=h[m][p-1],f=c.addDummyNode(d,"border",x,g);h[m][p]=f,d.setParent(f,a),u&&d.setEdge(u,f,{weight:1});}},{"./util":27}],4:[function(n,o,i){o.exports={adjust:c,undo:s};function c(p){let x=p.graph().rankdir.toLowerCase();(x==="lr"||x==="rl")&&l(p);}function s(p){let x=p.graph().rankdir.toLowerCase();(x==="bt"||x==="rl")&&m(p),(x==="lr"||x==="rl")&&(a(p),l(p));}function l(p){p.nodes().forEach(x=>d(p.node(x))),p.edges().forEach(x=>d(p.edge(x)));}function d(p){let x=p.width;p.width=p.height,p.height=x;}function m(p){p.nodes().forEach(x=>g(p.node(x))),p.edges().forEach(x=>{let u=p.edge(x);u.points.forEach(g),Object.hasOwn(u,"y")&&g(u);});}function g(p){p.y=-p.y;}function a(p){p.nodes().forEach(x=>h(p.node(x))),p.edges().forEach(x=>{let u=p.edge(x);u.points.forEach(h),Object.hasOwn(u,"x")&&h(u);});}function h(p){let x=p.x;p.x=p.y,p.y=x;}},{}],5:[function(n,o,i){class c{constructor(){let m={};m._next=m._prev=m,this._sentinel=m;}dequeue(){let m=this._sentinel,g=m._prev;if(g!==m)return s(g),g}enqueue(m){let g=this._sentinel;m._prev&&m._next&&s(m),m._next=g._next,g._next._prev=m,g._next=m,m._prev=g;}toString(){let m=[],g=this._sentinel,a=g._prev;for(;a!==g;)m.push(JSON.stringify(a,l)),a=a._prev;return "["+m.join(", ")+"]"}}function s(d){d._prev._next=d._next,d._next._prev=d._prev,delete d._next,delete d._prev;}function l(d,m){if(d!=="_next"&&d!=="_prev")return m}o.exports=c;},{}],6:[function(n,o,i){let c=n("./util"),s=n("@dagrejs/graphlib").Graph;o.exports={debugOrdering:l};function l(d){let m=c.buildLayerMatrix(d),g=new s({compound:true,multigraph:true}).setGraph({});return d.nodes().forEach(a=>{g.setNode(a,{label:a}),g.setParent(a,"layer"+d.node(a).rank);}),d.edges().forEach(a=>g.setEdge(a.v,a.w,{},a.name)),m.forEach((a,h)=>{let p="layer"+h;g.setNode(p,{rank:"same"}),a.reduce((x,u)=>(g.setEdge(x,u,{style:"invis"}),u));}),g}},{"./util":27,"@dagrejs/graphlib":29}],7:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("./data/list");o.exports=d;let l=()=>1;function d(x,u){if(x.nodeCount()<=1)return [];let f=a(x,u||l);return m(f.graph,f.buckets,f.zeroIdx).flatMap(y=>x.outEdges(y.v,y.w))}function m(x,u,f){let b=[],y=u[u.length-1],M=u[0],A;for(;x.nodeCount();){for(;A=M.dequeue();)g(x,u,f,A);for(;A=y.dequeue();)g(x,u,f,A);if(x.nodeCount()){for(let w=u.length-2;w>0;--w)if(A=u[w].dequeue(),A){b=b.concat(g(x,u,f,A,true));break}}}return b}function g(x,u,f,b,y){let M=y?[]:void 0;return x.inEdges(b.v).forEach(A=>{let w=x.edge(A),$=x.node(A.v);y&&M.push({v:A.v,w:A.w}),$.out-=w,h(u,f,$);}),x.outEdges(b.v).forEach(A=>{let w=x.edge(A),$=A.w,k=x.node($);k.in-=w,h(u,f,k);}),x.removeNode(b.v),M}function a(x,u){let f=new c,b=0,y=0;x.nodes().forEach(w=>{f.setNode(w,{v:w,in:0,out:0});}),x.edges().forEach(w=>{let $=f.edge(w.v,w.w)||0,k=u(w),P=$+k;f.setEdge(w.v,w.w,P),y=Math.max(y,f.node(w.v).out+=k),b=Math.max(b,f.node(w.w).in+=k);});let M=p(y+b+3).map(()=>new s),A=b+1;return f.nodes().forEach(w=>{h(M,A,f.node(w));}),{graph:f,buckets:M,zeroIdx:A}}function h(x,u,f){f.out?f.in?x[f.out-f.in+u].enqueue(f):x[x.length-1].enqueue(f):x[0].enqueue(f);}function p(x){let u=[];for(let f=0;f<x;f++)u.push(f);return u}},{"./data/list":5,"@dagrejs/graphlib":29}],8:[function(n,o,i){let c=n("./acyclic"),s=n("./normalize"),l=n("./rank"),d=n("./util").normalizeRanks,m=n("./parent-dummy-chains"),g=n("./util").removeEmptyRanks,a=n("./nesting-graph"),h=n("./add-border-segments"),p=n("./coordinate-system"),x=n("./order"),u=n("./position"),f=n("./util"),b=n("@dagrejs/graphlib").Graph;o.exports=y;function y(C,E){let R=E&&E.debugTiming?f.time:f.notime;R("layout",()=>{let H=R("  buildLayoutGraph",()=>_(C));R("  runLayout",()=>M(H,R,E)),R("  updateInputGraph",()=>A(C,H));});}function M(C,E,R){E("    makeSpaceForEdgeLabels",()=>F(C)),E("    removeSelfEdges",()=>G(C)),E("    acyclic",()=>c.run(C)),E("    nestingGraph.run",()=>a.run(C)),E("    rank",()=>l(f.asNonCompoundGraph(C))),E("    injectEdgeLabelProxies",()=>I(C)),E("    removeEmptyRanks",()=>g(C)),E("    nestingGraph.cleanup",()=>a.cleanup(C)),E("    normalizeRanks",()=>d(C)),E("    assignRankMinMax",()=>S(C)),E("    removeEdgeLabelProxies",()=>v(C)),E("    normalize.run",()=>s.run(C)),E("    parentDummyChains",()=>m(C)),E("    addBorderSegments",()=>h(C)),E("    order",()=>x(C,R)),E("    insertSelfEdges",()=>W(C)),E("    adjustCoordinateSystem",()=>p.adjust(C)),E("    position",()=>u(C)),E("    positionSelfEdges",()=>K(C)),E("    removeBorderNodes",()=>T(C)),E("    normalize.undo",()=>s.undo(C)),E("    fixupEdgeLabelCoords",()=>L(C)),E("    undoCoordinateSystem",()=>p.undo(C)),E("    translateGraph",()=>V(C)),E("    assignNodeIntersects",()=>z(C)),E("    reversePoints",()=>D(C)),E("    acyclic.undo",()=>c.undo(C));}function A(C,E){C.nodes().forEach(R=>{let H=C.node(R),J=E.node(R);H&&(H.x=J.x,H.y=J.y,H.rank=J.rank,E.children(R).length&&(H.width=J.width,H.height=J.height));}),C.edges().forEach(R=>{let H=C.edge(R),J=E.edge(R);H.points=J.points,Object.hasOwn(J,"x")&&(H.x=J.x,H.y=J.y);}),C.graph().width=E.graph().width,C.graph().height=E.graph().height;}let w=["nodesep","edgesep","ranksep","marginx","marginy"],$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},k=["acyclicer","ranker","rankdir","align"],P=["width","height","rank"],X={width:0,height:0},N=["minlen","weight","width","height","labeloffset"],Y={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},q=["labelpos"];function _(C){let E=new b({multigraph:true,compound:true}),R=O(C.graph());return E.setGraph(Object.assign({},$,B(R,w),f.pick(R,k))),C.nodes().forEach(H=>{let J=O(C.node(H)),et=B(J,P);Object.keys(X).forEach(rt=>{et[rt]===void 0&&(et[rt]=X[rt]);}),E.setNode(H,et),E.setParent(H,C.parent(H));}),C.edges().forEach(H=>{let J=O(C.edge(H));E.setEdge(H,Object.assign({},Y,B(J,N),f.pick(J,q)));}),E}function F(C){let E=C.graph();E.ranksep/=2,C.edges().forEach(R=>{let H=C.edge(R);H.minlen*=2,H.labelpos.toLowerCase()!=="c"&&(E.rankdir==="TB"||E.rankdir==="BT"?H.width+=H.labeloffset:H.height+=H.labeloffset);});}function I(C){C.edges().forEach(E=>{let R=C.edge(E);if(R.width&&R.height){let H=C.node(E.v),et={rank:(C.node(E.w).rank-H.rank)/2+H.rank,e:E};f.addDummyNode(C,"edge-proxy",et,"_ep");}});}function S(C){let E=0;C.nodes().forEach(R=>{let H=C.node(R);H.borderTop&&(H.minRank=C.node(H.borderTop).rank,H.maxRank=C.node(H.borderBottom).rank,E=Math.max(E,H.maxRank));}),C.graph().maxRank=E;}function v(C){C.nodes().forEach(E=>{let R=C.node(E);R.dummy==="edge-proxy"&&(C.edge(R.e).labelRank=R.rank,C.removeNode(E));});}function V(C){let E=Number.POSITIVE_INFINITY,R=0,H=Number.POSITIVE_INFINITY,J=0,et=C.graph(),rt=et.marginx||0,U=et.marginy||0;function Z(Q){let tt=Q.x,it=Q.y,nt=Q.width,ot=Q.height;E=Math.min(E,tt-nt/2),R=Math.max(R,tt+nt/2),H=Math.min(H,it-ot/2),J=Math.max(J,it+ot/2);}C.nodes().forEach(Q=>Z(C.node(Q))),C.edges().forEach(Q=>{let tt=C.edge(Q);Object.hasOwn(tt,"x")&&Z(tt);}),E-=rt,H-=U,C.nodes().forEach(Q=>{let tt=C.node(Q);tt.x-=E,tt.y-=H;}),C.edges().forEach(Q=>{let tt=C.edge(Q);tt.points.forEach(it=>{it.x-=E,it.y-=H;}),Object.hasOwn(tt,"x")&&(tt.x-=E),Object.hasOwn(tt,"y")&&(tt.y-=H);}),et.width=R-E+rt,et.height=J-H+U;}function z(C){C.edges().forEach(E=>{let R=C.edge(E),H=C.node(E.v),J=C.node(E.w),et,rt;R.points?(et=R.points[0],rt=R.points[R.points.length-1]):(R.points=[],et=J,rt=H),R.points.unshift(f.intersectRect(H,et)),R.points.push(f.intersectRect(J,rt));});}function L(C){C.edges().forEach(E=>{let R=C.edge(E);if(Object.hasOwn(R,"x"))switch((R.labelpos==="l"||R.labelpos==="r")&&(R.width-=R.labeloffset),R.labelpos){case "l":R.x-=R.width/2+R.labeloffset;break;case "r":R.x+=R.width/2+R.labeloffset;break}});}function D(C){C.edges().forEach(E=>{let R=C.edge(E);R.reversed&&R.points.reverse();});}function T(C){C.nodes().forEach(E=>{if(C.children(E).length){let R=C.node(E),H=C.node(R.borderTop),J=C.node(R.borderBottom),et=C.node(R.borderLeft[R.borderLeft.length-1]),rt=C.node(R.borderRight[R.borderRight.length-1]);R.width=Math.abs(rt.x-et.x),R.height=Math.abs(J.y-H.y),R.x=et.x+R.width/2,R.y=H.y+R.height/2;}}),C.nodes().forEach(E=>{C.node(E).dummy==="border"&&C.removeNode(E);});}function G(C){C.edges().forEach(E=>{if(E.v===E.w){var R=C.node(E.v);R.selfEdges||(R.selfEdges=[]),R.selfEdges.push({e:E,label:C.edge(E)}),C.removeEdge(E);}});}function W(C){var E=f.buildLayerMatrix(C);E.forEach(R=>{var H=0;R.forEach((J,et)=>{var rt=C.node(J);rt.order=et+H,(rt.selfEdges||[]).forEach(U=>{f.addDummyNode(C,"selfedge",{width:U.label.width,height:U.label.height,rank:rt.rank,order:et+ ++H,e:U.e,label:U.label},"_se");}),delete rt.selfEdges;});});}function K(C){C.nodes().forEach(E=>{var R=C.node(E);if(R.dummy==="selfedge"){var H=C.node(R.e.v),J=H.x+H.width/2,et=H.y,rt=R.x-J,U=H.height/2;C.setEdge(R.e,R.label),C.removeNode(E),R.label.points=[{x:J+2*rt/3,y:et-U},{x:J+5*rt/6,y:et-U},{x:J+rt,y:et},{x:J+5*rt/6,y:et+U},{x:J+2*rt/3,y:et+U}],R.label.x=R.x,R.label.y=R.y;}});}function B(C,E){return f.mapValues(f.pick(C,E),Number)}function O(C){var E={};return C&&Object.entries(C).forEach(([R,H])=>{typeof R=="string"&&(R=R.toLowerCase()),E[R]=H;}),E}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./nesting-graph":9,"./normalize":10,"./order":15,"./parent-dummy-chains":20,"./position":22,"./rank":24,"./util":27,"@dagrejs/graphlib":29}],9:[function(n,o,i){let c=n("./util");o.exports={run:s,cleanup:g};function s(a){let h=c.addDummyNode(a,"root",{},"_root"),p=d(a),x=Object.values(p),u=c.applyWithChunking(Math.max,x)-1,f=2*u+1;a.graph().nestingRoot=h,a.edges().forEach(y=>a.edge(y).minlen*=f);let b=m(a)+1;a.children().forEach(y=>l(a,h,f,b,u,p,y)),a.graph().nodeRankFactor=f;}function l(a,h,p,x,u,f,b){let y=a.children(b);if(!y.length){b!==h&&a.setEdge(h,b,{weight:0,minlen:p});return}let M=c.addBorderNode(a,"_bt"),A=c.addBorderNode(a,"_bb"),w=a.node(b);a.setParent(M,b),w.borderTop=M,a.setParent(A,b),w.borderBottom=A,y.forEach($=>{l(a,h,p,x,u,f,$);let k=a.node($),P=k.borderTop?k.borderTop:$,X=k.borderBottom?k.borderBottom:$,N=k.borderTop?x:2*x,Y=P!==X?1:u-f[b]+1;a.setEdge(M,P,{weight:N,minlen:Y,nestingEdge:true}),a.setEdge(X,A,{weight:N,minlen:Y,nestingEdge:true});}),a.parent(b)||a.setEdge(h,M,{weight:0,minlen:u+f[b]});}function d(a){var h={};function p(x,u){var f=a.children(x);f&&f.length&&f.forEach(b=>p(b,u+1)),h[x]=u;}return a.children().forEach(x=>p(x,1)),h}function m(a){return a.edges().reduce((h,p)=>h+a.edge(p).weight,0)}function g(a){var h=a.graph();a.removeNode(h.nestingRoot),delete h.nestingRoot,a.edges().forEach(p=>{var x=a.edge(p);x.nestingEdge&&a.removeEdge(p);});}},{"./util":27}],10:[function(n,o,i){let c=n("./util");o.exports={run:s,undo:d};function s(m){m.graph().dummyChains=[],m.edges().forEach(g=>l(m,g));}function l(m,g){let a=g.v,h=m.node(a).rank,p=g.w,x=m.node(p).rank,u=g.name,f=m.edge(g),b=f.labelRank;if(x===h+1)return;m.removeEdge(g);let y,M,A;for(A=0,++h;h<x;++A,++h)f.points=[],M={width:0,height:0,edgeLabel:f,edgeObj:g,rank:h},y=c.addDummyNode(m,"edge",M,"_d"),h===b&&(M.width=f.width,M.height=f.height,M.dummy="edge-label",M.labelpos=f.labelpos),m.setEdge(a,y,{weight:f.weight},u),A===0&&m.graph().dummyChains.push(y),a=y;m.setEdge(a,p,{weight:f.weight},u);}function d(m){m.graph().dummyChains.forEach(g=>{let a=m.node(g),h=a.edgeLabel,p;for(m.setEdge(a.edgeObj,h);a.dummy;)p=m.successors(g)[0],m.removeNode(g),h.points.push({x:a.x,y:a.y}),a.dummy==="edge-label"&&(h.x=a.x,h.y=a.y,h.width=a.width,h.height=a.height),g=p,a=m.node(g);});}},{"./util":27}],11:[function(n,o,i){o.exports=c;function c(s,l,d){let m={},g;d.forEach(a=>{let h=s.parent(a),p,x;for(;h;){if(p=s.parent(h),p?(x=m[p],m[p]=h):(x=g,g=h),x&&x!==h){l.setEdge(x,h);return}h=p;}});}},{}],12:[function(n,o,i){o.exports=c;function c(s,l=[]){return l.map(d=>{let m=s.inEdges(d);if(m.length){let g=m.reduce((a,h)=>{let p=s.edge(h),x=s.node(h.v);return {sum:a.sum+p.weight*x.order,weight:a.weight+p.weight}},{sum:0,weight:0});return {v:d,barycenter:g.sum/g.weight,weight:g.weight}}else return {v:d}})}},{}],13:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("../util");o.exports=l;function l(m,g,a,h){h||(h=m.nodes());let p=d(m),x=new c({compound:true}).setGraph({root:p}).setDefaultNodeLabel(u=>m.node(u));return h.forEach(u=>{let f=m.node(u),b=m.parent(u);(f.rank===g||f.minRank<=g&&g<=f.maxRank)&&(x.setNode(u),x.setParent(u,b||p),m[a](u).forEach(y=>{let M=y.v===u?y.w:y.v,A=x.edge(M,u),w=A!==void 0?A.weight:0;x.setEdge(M,u,{weight:m.edge(y).weight+w});}),Object.hasOwn(f,"minRank")&&x.setNode(u,{borderLeft:f.borderLeft[g],borderRight:f.borderRight[g]}));}),x}function d(m){for(var g;m.hasNode(g=s.uniqueId("_root")););return g}},{"../util":27,"@dagrejs/graphlib":29}],14:[function(n,o,i){let c=n("../util").zipObject;o.exports=s;function s(d,m){let g=0;for(let a=1;a<m.length;++a)g+=l(d,m[a-1],m[a]);return g}function l(d,m,g){let a=c(g,g.map((b,y)=>y)),h=m.flatMap(b=>d.outEdges(b).map(y=>({pos:a[y.w],weight:d.edge(y).weight})).sort((y,M)=>y.pos-M.pos)),p=1;for(;p<g.length;)p<<=1;let x=2*p-1;p-=1;let u=new Array(x).fill(0),f=0;return h.forEach(b=>{let y=b.pos+p;u[y]+=b.weight;let M=0;for(;y>0;)y%2&&(M+=u[y+1]),y=y-1>>1,u[y]+=b.weight;f+=b.weight*M;}),f}},{"../util":27}],15:[function(n,o,i){let c=n("./init-order"),s=n("./cross-count"),l=n("./sort-subgraph"),d=n("./build-layer-graph"),m=n("./add-subgraph-constraints"),g=n("@dagrejs/graphlib").Graph,a=n("../util");o.exports=h;function h(f,b){if(b&&typeof b.customOrder=="function"){b.customOrder(f,h);return}let y=a.maxRank(f),M=p(f,a.range(1,y+1),"inEdges"),A=p(f,a.range(y-1,-1,-1),"outEdges"),w=c(f);if(u(f,w),b&&b.disableOptimalOrderHeuristic)return;let $=Number.POSITIVE_INFINITY,k;for(let P=0,X=0;X<4;++P,++X){x(P%2?M:A,P%4>=2),w=a.buildLayerMatrix(f);let N=s(f,w);N<$&&(X=0,k=Object.assign({},w),$=N);}u(f,k);}function p(f,b,y){let M=new Map,A=(w,$)=>{M.has(w)||M.set(w,[]),M.get(w).push($);};for(let w of f.nodes()){let $=f.node(w);if(typeof $.rank=="number"&&A($.rank,w),typeof $.minRank=="number"&&typeof $.maxRank=="number")for(let k=$.minRank;k<=$.maxRank;k++)k!==$.rank&&A(k,w);}return b.map(function(w){return d(f,w,y,M.get(w)||[])})}function x(f,b){let y=new g;f.forEach(function(M){let A=M.graph().root,w=l(M,A,y,b);w.vs.forEach(($,k)=>M.node($).order=k),m(M,y,w.vs);});}function u(f,b){Object.values(b).forEach(y=>y.forEach((M,A)=>f.node(M).order=A));}},{"../util":27,"./add-subgraph-constraints":11,"./build-layer-graph":13,"./cross-count":14,"./init-order":16,"./sort-subgraph":18,"@dagrejs/graphlib":29}],16:[function(n,o,i){let c=n("../util");o.exports=s;function s(l){let d={},m=l.nodes().filter(u=>!l.children(u).length),g=m.map(u=>l.node(u).rank),a=c.applyWithChunking(Math.max,g),h=c.range(a+1).map(()=>[]);function p(u){if(d[u])return;d[u]=true;let f=l.node(u);h[f.rank].push(u),l.successors(u).forEach(p);}return m.sort((u,f)=>l.node(u).rank-l.node(f).rank).forEach(p),h}},{"../util":27}],17:[function(n,o,i){let c=n("../util");o.exports=s;function s(m,g){let a={};m.forEach((p,x)=>{let u=a[p.v]={indegree:0,in:[],out:[],vs:[p.v],i:x};p.barycenter!==void 0&&(u.barycenter=p.barycenter,u.weight=p.weight);}),g.edges().forEach(p=>{let x=a[p.v],u=a[p.w];x!==void 0&&u!==void 0&&(u.indegree++,x.out.push(a[p.w]));});let h=Object.values(a).filter(p=>!p.indegree);return l(h)}function l(m){let g=[];function a(p){return x=>{x.merged||(x.barycenter===void 0||p.barycenter===void 0||x.barycenter>=p.barycenter)&&d(p,x);}}function h(p){return x=>{x.in.push(p),--x.indegree===0&&m.push(x);}}for(;m.length;){let p=m.pop();g.push(p),p.in.reverse().forEach(a(p)),p.out.forEach(h(p));}return g.filter(p=>!p.merged).map(p=>c.pick(p,["vs","i","barycenter","weight"]))}function d(m,g){let a=0,h=0;m.weight&&(a+=m.barycenter*m.weight,h+=m.weight),g.weight&&(a+=g.barycenter*g.weight,h+=g.weight),m.vs=g.vs.concat(m.vs),m.barycenter=a/h,m.weight=h,m.i=Math.min(g.i,m.i),g.merged=true;}},{"../util":27}],18:[function(n,o,i){let c=n("./barycenter"),s=n("./resolve-conflicts"),l=n("./sort");o.exports=d;function d(a,h,p,x){let u=a.children(h),f=a.node(h),b=f?f.borderLeft:void 0,y=f?f.borderRight:void 0,M={};b&&(u=u.filter(k=>k!==b&&k!==y));let A=c(a,u);A.forEach(k=>{if(a.children(k.v).length){let P=d(a,k.v,p,x);M[k.v]=P,Object.hasOwn(P,"barycenter")&&g(k,P);}});let w=s(A,p);m(w,M);let $=l(w,x);if(b&&($.vs=[b,$.vs,y].flat(true),a.predecessors(b).length)){let k=a.node(a.predecessors(b)[0]),P=a.node(a.predecessors(y)[0]);Object.hasOwn($,"barycenter")||($.barycenter=0,$.weight=0),$.barycenter=($.barycenter*$.weight+k.order+P.order)/($.weight+2),$.weight+=2;}return $}function m(a,h){a.forEach(p=>{p.vs=p.vs.flatMap(x=>h[x]?h[x].vs:x);});}function g(a,h){a.barycenter!==void 0?(a.barycenter=(a.barycenter*a.weight+h.barycenter*h.weight)/(a.weight+h.weight),a.weight+=h.weight):(a.barycenter=h.barycenter,a.weight=h.weight);}},{"./barycenter":12,"./resolve-conflicts":17,"./sort":19}],19:[function(n,o,i){let c=n("../util");o.exports=s;function s(m,g){let a=c.partition(m,M=>Object.hasOwn(M,"barycenter")),h=a.lhs,p=a.rhs.sort((M,A)=>A.i-M.i),x=[],u=0,f=0,b=0;h.sort(d(!!g)),b=l(x,p,b),h.forEach(M=>{b+=M.vs.length,x.push(M.vs),u+=M.barycenter*M.weight,f+=M.weight,b=l(x,p,b);});let y={vs:x.flat(true)};return f&&(y.barycenter=u/f,y.weight=f),y}function l(m,g,a){let h;for(;g.length&&(h=g[g.length-1]).i<=a;)g.pop(),m.push(h.vs),a++;return a}function d(m){return (g,a)=>g.barycenter<a.barycenter?-1:g.barycenter>a.barycenter?1:m?a.i-g.i:g.i-a.i}},{"../util":27}],20:[function(n,o,i){o.exports=c;function c(d){let m=l(d);d.graph().dummyChains.forEach(g=>{let a=d.node(g),h=a.edgeObj,p=s(d,m,h.v,h.w),x=p.path,u=p.lca,f=0,b=x[f],y=true;for(;g!==h.w;){if(a=d.node(g),y){for(;(b=x[f])!==u&&d.node(b).maxRank<a.rank;)f++;b===u&&(y=false);}if(!y){for(;f<x.length-1&&d.node(b=x[f+1]).minRank<=a.rank;)f++;b=x[f];}d.setParent(g,b),g=d.successors(g)[0];}});}function s(d,m,g,a){let h=[],p=[],x=Math.min(m[g].low,m[a].low),u=Math.max(m[g].lim,m[a].lim),f,b;f=g;do f=d.parent(f),h.push(f);while(f&&(m[f].low>x||u>m[f].lim));for(b=f,f=a;(f=d.parent(f))!==b;)p.push(f);return {path:h.concat(p.reverse()),lca:b}}function l(d){let m={},g=0;function a(h){let p=g;d.children(h).forEach(a),m[h]={low:p,lim:g++};}return d.children().forEach(a),m}},{}],21:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph,s=n("../util");o.exports={positionX:y,findType1Conflicts:l,findType2Conflicts:d,addConflict:g,hasConflict:a,verticalAlignment:h,horizontalCompaction:p,alignCoordinates:f,findSmallestWidthAlignment:u,balance:b};function l(w,$){let k={};function P(X,N){let Y=0,q=0,_=X.length,F=N[N.length-1];return N.forEach((I,S)=>{let v=m(w,I),V=v?w.node(v).order:_;(v||I===F)&&(N.slice(q,S+1).forEach(z=>{w.predecessors(z).forEach(L=>{let D=w.node(L),T=D.order;(T<Y||V<T)&&!(D.dummy&&w.node(z).dummy)&&g(k,L,z);});}),q=S+1,Y=V);}),N}return $.length&&$.reduce(P),k}function d(w,$){let k={};function P(N,Y,q,_,F){let I;s.range(Y,q).forEach(S=>{I=N[S],w.node(I).dummy&&w.predecessors(I).forEach(v=>{let V=w.node(v);V.dummy&&(V.order<_||V.order>F)&&g(k,v,I);});});}function X(N,Y){let q=-1,_,F=0;return Y.forEach((I,S)=>{if(w.node(I).dummy==="border"){let v=w.predecessors(I);v.length&&(_=w.node(v[0]).order,P(Y,F,S,q,_),F=S,q=_);}P(Y,F,Y.length,_,N.length);}),Y}return $.length&&$.reduce(X),k}function m(w,$){if(w.node($).dummy)return w.predecessors($).find(k=>w.node(k).dummy)}function g(w,$,k){if($>k){let X=$;$=k,k=X;}let P=w[$];P||(w[$]=P={}),P[k]=true;}function a(w,$,k){if($>k){let P=$;$=k,k=P;}return !!w[$]&&Object.hasOwn(w[$],k)}function h(w,$,k,P){let X={},N={},Y={};return $.forEach(q=>{q.forEach((_,F)=>{X[_]=_,N[_]=_,Y[_]=F;});}),$.forEach(q=>{let _=-1;q.forEach(F=>{let I=P(F);if(I.length){I=I.sort((v,V)=>Y[v]-Y[V]);let S=(I.length-1)/2;for(let v=Math.floor(S),V=Math.ceil(S);v<=V;++v){let z=I[v];N[F]===F&&_<Y[z]&&!a(k,F,z)&&(N[z]=F,N[F]=X[F]=X[z],_=Y[z]);}}});}),{root:X,align:N}}function p(w,$,k,P,X){let N={},Y=x(w,$,k,X),q=X?"borderLeft":"borderRight";function _(S,v){let V=Y.nodes(),z=V.pop(),L={};for(;z;)L[z]?S(z):(L[z]=true,V.push(z),V=V.concat(v(z))),z=V.pop();}function F(S){N[S]=Y.inEdges(S).reduce((v,V)=>Math.max(v,N[V.v]+Y.edge(V)),0);}function I(S){let v=Y.outEdges(S).reduce((z,L)=>Math.min(z,N[L.w]-Y.edge(L)),Number.POSITIVE_INFINITY),V=w.node(S);v!==Number.POSITIVE_INFINITY&&V.borderType!==q&&(N[S]=Math.max(N[S],v));}return _(F,Y.predecessors.bind(Y)),_(I,Y.successors.bind(Y)),Object.keys(P).forEach(S=>N[S]=N[k[S]]),N}function x(w,$,k,P){let X=new c,N=w.graph(),Y=M(N.nodesep,N.edgesep,P);return $.forEach(q=>{let _;q.forEach(F=>{let I=k[F];if(X.setNode(I),_){var S=k[_],v=X.edge(S,I);X.setEdge(S,I,Math.max(Y(w,F,_),v||0));}_=F;});}),X}function u(w,$){return Object.values($).reduce((k,P)=>{let X=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY;Object.entries(P).forEach(([q,_])=>{let F=A(w,q)/2;X=Math.max(_+F,X),N=Math.min(_-F,N);});let Y=X-N;return Y<k[0]&&(k=[Y,P]),k},[Number.POSITIVE_INFINITY,null])[1]}function f(w,$){let k=Object.values($),P=s.applyWithChunking(Math.min,k),X=s.applyWithChunking(Math.max,k);["u","d"].forEach(N=>{["l","r"].forEach(Y=>{let q=N+Y,_=w[q];if(_===$)return;let F=Object.values(_),I=P-s.applyWithChunking(Math.min,F);Y!=="l"&&(I=X-s.applyWithChunking(Math.max,F)),I&&(w[q]=s.mapValues(_,S=>S+I));});});}function b(w,$){return s.mapValues(w.ul,(k,P)=>{if($)return w[$.toLowerCase()][P];{let X=Object.values(w).map(N=>N[P]).sort((N,Y)=>N-Y);return (X[1]+X[2])/2}})}function y(w){let $=s.buildLayerMatrix(w),k=Object.assign(l(w,$),d(w,$)),P={},X;["u","d"].forEach(Y=>{X=Y==="u"?$:Object.values($).reverse(),["l","r"].forEach(q=>{q==="r"&&(X=X.map(S=>Object.values(S).reverse()));let _=(Y==="u"?w.predecessors:w.successors).bind(w),F=h(w,X,k,_),I=p(w,X,F.root,F.align,q==="r");q==="r"&&(I=s.mapValues(I,S=>-S)),P[Y+q]=I;});});let N=u(w,P);return f(P,N),b(P,w.graph().align)}function M(w,$,k){return (P,X,N)=>{let Y=P.node(X),q=P.node(N),_=0,F;if(_+=Y.width/2,Object.hasOwn(Y,"labelpos"))switch(Y.labelpos.toLowerCase()){case "l":F=-Y.width/2;break;case "r":F=Y.width/2;break}if(F&&(_+=k?F:-F),F=0,_+=(Y.dummy?$:w)/2,_+=(q.dummy?$:w)/2,_+=q.width/2,Object.hasOwn(q,"labelpos"))switch(q.labelpos.toLowerCase()){case "l":F=q.width/2;break;case "r":F=-q.width/2;break}return F&&(_+=k?F:-F),F=0,_}}function A(w,$){return w.node($).width}},{"../util":27,"@dagrejs/graphlib":29}],22:[function(n,o,i){let c=n("../util"),s=n("./bk").positionX;o.exports=l;function l(m){m=c.asNonCompoundGraph(m),d(m),Object.entries(s(m)).forEach(([g,a])=>m.node(g).x=a);}function d(m){let g=c.buildLayerMatrix(m),a=m.graph().ranksep,h=0;g.forEach(p=>{let x=p.reduce((u,f)=>{let b=m.node(f).height;return u>b?u:b},0);p.forEach(u=>m.node(u).y=h+x/2),h+=x+a;});}},{"../util":27,"./bk":21}],23:[function(n,o,i){var c=n("@dagrejs/graphlib").Graph,s=n("./util").slack;o.exports=l;function l(a){var h=new c({directed:false}),p=a.nodes()[0],x=a.nodeCount();h.setNode(p,{});for(var u,f;d(h,a)<x;)u=m(h,a),f=h.hasNode(u.v)?s(a,u):-s(a,u),g(h,a,f);return h}function d(a,h){function p(x){h.nodeEdges(x).forEach(u=>{var f=u.v,b=x===f?u.w:f;!a.hasNode(b)&&!s(h,u)&&(a.setNode(b,{}),a.setEdge(x,b,{}),p(b));});}return a.nodes().forEach(p),a.nodeCount()}function m(a,h){return h.edges().reduce((x,u)=>{let f=Number.POSITIVE_INFINITY;return a.hasNode(u.v)!==a.hasNode(u.w)&&(f=s(h,u)),f<x[0]?[f,u]:x},[Number.POSITIVE_INFINITY,null])[1]}function g(a,h,p){a.nodes().forEach(x=>h.node(x).rank+=p);}},{"./util":26,"@dagrejs/graphlib":29}],24:[function(n,o,i){var c=n("./util"),s=c.longestPath,l=n("./feasible-tree"),d=n("./network-simplex");o.exports=m;function m(p){var x=p.graph().ranker;if(x instanceof Function)return x(p);switch(p.graph().ranker){case "network-simplex":h(p);break;case "tight-tree":a(p);break;case "longest-path":g(p);break;case "none":break;default:h(p);}}var g=s;function a(p){s(p),l(p);}function h(p){d(p);}},{"./feasible-tree":23,"./network-simplex":25,"./util":26}],25:[function(n,o,i){var c=n("./feasible-tree"),s=n("./util").slack,l=n("./util").longestPath,d=n("@dagrejs/graphlib").alg.preorder,m=n("@dagrejs/graphlib").alg.postorder,g=n("../util").simplify;o.exports=a,a.initLowLimValues=u,a.initCutValues=h,a.calcCutValue=x,a.leaveEdge=b,a.enterEdge=y,a.exchangeEdges=M;function a(k){k=g(k),l(k);var P=c(k);u(P),h(P,k);for(var X,N;X=b(P);)N=y(P,k,X),M(P,k,X,N);}function h(k,P){var X=m(k,k.nodes());X=X.slice(0,X.length-1),X.forEach(N=>p(k,P,N));}function p(k,P,X){var N=k.node(X),Y=N.parent;k.edge(X,Y).cutvalue=x(k,P,X);}function x(k,P,X){var N=k.node(X),Y=N.parent,q=true,_=P.edge(X,Y),F=0;return _||(q=false,_=P.edge(Y,X)),F=_.weight,P.nodeEdges(X).forEach(I=>{var S=I.v===X,v=S?I.w:I.v;if(v!==Y){var V=S===q,z=P.edge(I).weight;if(F+=V?z:-z,w(k,X,v)){var L=k.edge(X,v).cutvalue;F+=V?-L:L;}}}),F}function u(k,P){arguments.length<2&&(P=k.nodes()[0]),f(k,{},1,P);}function f(k,P,X,N,Y){var q=X,_=k.node(N);return P[N]=true,k.neighbors(N).forEach(F=>{Object.hasOwn(P,F)||(X=f(k,P,X,F,N));}),_.low=q,_.lim=X++,Y?_.parent=Y:delete _.parent,X}function b(k){return k.edges().find(P=>k.edge(P).cutvalue<0)}function y(k,P,X){var N=X.v,Y=X.w;P.hasEdge(N,Y)||(N=X.w,Y=X.v);var q=k.node(N),_=k.node(Y),F=q,I=false;q.lim>_.lim&&(F=_,I=true);var S=P.edges().filter(v=>I===$(k,k.node(v.v),F)&&I!==$(k,k.node(v.w),F));return S.reduce((v,V)=>s(P,V)<s(P,v)?V:v)}function M(k,P,X,N){var Y=X.v,q=X.w;k.removeEdge(Y,q),k.setEdge(N.v,N.w,{}),u(k),h(k,P),A(k,P);}function A(k,P){var X=k.nodes().find(Y=>!P.node(Y).parent),N=d(k,X);N=N.slice(1),N.forEach(Y=>{var q=k.node(Y).parent,_=P.edge(Y,q),F=false;_||(_=P.edge(q,Y),F=true),P.node(Y).rank=P.node(q).rank+(F?_.minlen:-_.minlen);});}function w(k,P,X){return k.hasEdge(P,X)}function $(k,P,X){return X.low<=P.lim&&P.lim<=X.lim}},{"../util":27,"./feasible-tree":23,"./util":26,"@dagrejs/graphlib":29}],26:[function(n,o,i){let{applyWithChunking:c}=n("../util");o.exports={longestPath:s,slack:l};function s(d){var m={};function g(a){var h=d.node(a);if(Object.hasOwn(m,a))return h.rank;m[a]=true;let p=d.outEdges(a).map(u=>u==null?Number.POSITIVE_INFINITY:g(u.w)-d.edge(u).minlen);var x=c(Math.min,p);return x===Number.POSITIVE_INFINITY&&(x=0),h.rank=x}d.sources().forEach(g);}function l(d,m){return d.node(m.w).rank-d.node(m.v).rank-d.edge(m).minlen}},{"../util":27}],27:[function(n,o,i){let c=n("@dagrejs/graphlib").Graph;o.exports={addBorderNode:u,addDummyNode:s,applyWithChunking:y,asNonCompoundGraph:d,buildLayerMatrix:h,intersectRect:a,mapValues:Y,maxRank:M,normalizeRanks:p,notime:$,partition:A,pick:N,predecessorWeights:g,range:X,removeEmptyRanks:x,simplify:l,successorWeights:m,time:w,uniqueId:P,zipObject:q};function s(_,F,I,S){for(var v=S;_.hasNode(v);)v=P(S);return I.dummy=F,_.setNode(v,I),v}function l(_){let F=new c().setGraph(_.graph());return _.nodes().forEach(I=>F.setNode(I,_.node(I))),_.edges().forEach(I=>{let S=F.edge(I.v,I.w)||{weight:0,minlen:1},v=_.edge(I);F.setEdge(I.v,I.w,{weight:S.weight+v.weight,minlen:Math.max(S.minlen,v.minlen)});}),F}function d(_){let F=new c({multigraph:_.isMultigraph()}).setGraph(_.graph());return _.nodes().forEach(I=>{_.children(I).length||F.setNode(I,_.node(I));}),_.edges().forEach(I=>{F.setEdge(I,_.edge(I));}),F}function m(_){let F=_.nodes().map(I=>{let S={};return _.outEdges(I).forEach(v=>{S[v.w]=(S[v.w]||0)+_.edge(v).weight;}),S});return q(_.nodes(),F)}function g(_){let F=_.nodes().map(I=>{let S={};return _.inEdges(I).forEach(v=>{S[v.v]=(S[v.v]||0)+_.edge(v).weight;}),S});return q(_.nodes(),F)}function a(_,F){let I=_.x,S=_.y,v=F.x-I,V=F.y-S,z=_.width/2,L=_.height/2;if(!v&&!V)throw new Error("Not possible to find intersection inside of the rectangle");let D,T;return Math.abs(V)*z>Math.abs(v)*L?(V<0&&(L=-L),D=L*v/V,T=L):(v<0&&(z=-z),D=z,T=z*V/v),{x:I+D,y:S+T}}function h(_){let F=X(M(_)+1).map(()=>[]);return _.nodes().forEach(I=>{let S=_.node(I),v=S.rank;v!==void 0&&(F[v][S.order]=I);}),F}function p(_){let F=_.nodes().map(S=>{let v=_.node(S).rank;return v===void 0?Number.MAX_VALUE:v}),I=y(Math.min,F);_.nodes().forEach(S=>{let v=_.node(S);Object.hasOwn(v,"rank")&&(v.rank-=I);});}function x(_){let F=_.nodes().map(z=>_.node(z).rank),I=y(Math.min,F),S=[];_.nodes().forEach(z=>{let L=_.node(z).rank-I;S[L]||(S[L]=[]),S[L].push(z);});let v=0,V=_.graph().nodeRankFactor;Array.from(S).forEach((z,L)=>{z===void 0&&L%V!==0?--v:z!==void 0&&v&&z.forEach(D=>_.node(D).rank+=v);});}function u(_,F,I,S){let v={width:0,height:0};return arguments.length>=4&&(v.rank=I,v.order=S),s(_,"border",v,F)}function f(_,F=b){let I=[];for(let S=0;S<_.length;S+=F){let v=_.slice(S,S+F);I.push(v);}return I}let b=65535;function y(_,F){if(F.length>b){let I=f(F);return _.apply(null,I.map(S=>_.apply(null,S)))}else return _.apply(null,F)}function M(_){let I=_.nodes().map(S=>{let v=_.node(S).rank;return v===void 0?Number.MIN_VALUE:v});return y(Math.max,I)}function A(_,F){let I={lhs:[],rhs:[]};return _.forEach(S=>{F(S)?I.lhs.push(S):I.rhs.push(S);}),I}function w(_,F){let I=Date.now();try{return F()}finally{console.log(_+" time: "+(Date.now()-I)+"ms");}}function $(_,F){return F()}let k=0;function P(_){var F=++k;return _+(""+F)}function X(_,F,I=1){F==null&&(F=_,_=0);let S=V=>V<F;I<0&&(S=V=>F<V);let v=[];for(let V=_;S(V);V+=I)v.push(V);return v}function N(_,F){let I={};for(let S of F)_[S]!==void 0&&(I[S]=_[S]);return I}function Y(_,F){let I=F;return typeof F=="string"&&(I=S=>S[F]),Object.entries(_).reduce((S,[v,V])=>(S[v]=I(V,v),S),{})}function q(_,F){return _.reduce((I,S,v)=>(I[S]=F[v],I),{})}},{"@dagrejs/graphlib":29}],28:[function(n,o,i){o.exports="1.1.8";},{}],29:[function(n,o,i){var c=n("./lib");o.exports={Graph:c.Graph,json:n("./lib/json"),alg:n("./lib/alg"),version:c.version};},{"./lib":45,"./lib/alg":36,"./lib/json":46}],30:[function(n,o,i){o.exports=c;function c(s){var l={},d=[],m;function g(a){Object.hasOwn(l,a)||(l[a]=true,m.push(a),s.successors(a).forEach(g),s.predecessors(a).forEach(g));}return s.nodes().forEach(function(a){m=[],g(a),m.length&&d.push(m);}),d}},{}],31:[function(n,o,i){o.exports=c;function c(m,g,a){Array.isArray(g)||(g=[g]);var h=m.isDirected()?f=>m.successors(f):f=>m.neighbors(f),p=a==="post"?s:l,x=[],u={};return g.forEach(f=>{if(!m.hasNode(f))throw new Error("Graph does not have node: "+f);p(f,h,u,x);}),x}function s(m,g,a,h){for(var p=[[m,false]];p.length>0;){var x=p.pop();x[1]?h.push(x[0]):Object.hasOwn(a,x[0])||(a[x[0]]=true,p.push([x[0],true]),d(g(x[0]),u=>p.push([u,false])));}}function l(m,g,a,h){for(var p=[m];p.length>0;){var x=p.pop();Object.hasOwn(a,x)||(a[x]=true,h.push(x),d(g(x),u=>p.push(u)));}}function d(m,g){for(var a=m.length;a--;)g(m[a],a,m);return m}},{}],32:[function(n,o,i){var c=n("./dijkstra");o.exports=s;function s(l,d,m){return l.nodes().reduce(function(g,a){return g[a]=c(l,a,d,m),g},{})}},{"./dijkstra":33}],33:[function(n,o,i){var c=n("../data/priority-queue");o.exports=l;var s=()=>1;function l(m,g,a,h){return d(m,String(g),a||s,h||function(p){return m.outEdges(p)})}function d(m,g,a,h){var p={},x=new c,u,f,b=function(y){var M=y.v!==u?y.v:y.w,A=p[M],w=a(y),$=f.distance+w;if(w<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+w);$<A.distance&&(A.distance=$,A.predecessor=u,x.decrease(M,$));};for(m.nodes().forEach(function(y){var M=y===g?0:Number.POSITIVE_INFINITY;p[y]={distance:M},x.add(y,M);});x.size()>0&&(u=x.removeMin(),f=p[u],f.distance!==Number.POSITIVE_INFINITY);)h(u).forEach(b);return p}},{"../data/priority-queue":43}],34:[function(n,o,i){var c=n("./tarjan");o.exports=s;function s(l){return c(l).filter(function(d){return d.length>1||d.length===1&&l.hasEdge(d[0],d[0])})}},{"./tarjan":41}],35:[function(n,o,i){o.exports=s;var c=()=>1;function s(d,m,g){return l(d,m||c,g||function(a){return d.outEdges(a)})}function l(d,m,g){var a={},h=d.nodes();return h.forEach(function(p){a[p]={},a[p][p]={distance:0},h.forEach(function(x){p!==x&&(a[p][x]={distance:Number.POSITIVE_INFINITY});}),g(p).forEach(function(x){var u=x.v===p?x.w:x.v,f=m(x);a[p][u]={distance:f,predecessor:p};});}),h.forEach(function(p){var x=a[p];h.forEach(function(u){var f=a[u];h.forEach(function(b){var y=f[p],M=x[b],A=f[b],w=y.distance+M.distance;w<A.distance&&(A.distance=w,A.predecessor=M.predecessor);});});}),a}},{}],36:[function(n,o,i){o.exports={components:n("./components"),dijkstra:n("./dijkstra"),dijkstraAll:n("./dijkstra-all"),findCycles:n("./find-cycles"),floydWarshall:n("./floyd-warshall"),isAcyclic:n("./is-acyclic"),postorder:n("./postorder"),preorder:n("./preorder"),prim:n("./prim"),tarjan:n("./tarjan"),topsort:n("./topsort")};},{"./components":30,"./dijkstra":33,"./dijkstra-all":32,"./find-cycles":34,"./floyd-warshall":35,"./is-acyclic":37,"./postorder":38,"./preorder":39,"./prim":40,"./tarjan":41,"./topsort":42}],37:[function(n,o,i){var c=n("./topsort");o.exports=s;function s(l){try{c(l);}catch(d){if(d instanceof c.CycleException)return  false;throw d}return  true}},{"./topsort":42}],38:[function(n,o,i){var c=n("./dfs");o.exports=s;function s(l,d){return c(l,d,"post")}},{"./dfs":31}],39:[function(n,o,i){var c=n("./dfs");o.exports=s;function s(l,d){return c(l,d,"pre")}},{"./dfs":31}],40:[function(n,o,i){var c=n("../graph"),s=n("../data/priority-queue");o.exports=l;function l(d,m){var g=new c,a={},h=new s,p;function x(f){var b=f.v===p?f.w:f.v,y=h.priority(b);if(y!==void 0){var M=m(f);M<y&&(a[b]=p,h.decrease(b,M));}}if(d.nodeCount()===0)return g;d.nodes().forEach(function(f){h.add(f,Number.POSITIVE_INFINITY),g.setNode(f);}),h.decrease(d.nodes()[0],0);for(var u=false;h.size()>0;){if(p=h.removeMin(),Object.hasOwn(a,p))g.setEdge(p,a[p]);else {if(u)throw new Error("Input graph is not connected: "+d);u=true;}d.nodeEdges(p).forEach(x);}return g}},{"../data/priority-queue":43,"../graph":44}],41:[function(n,o,i){o.exports=c;function c(s){var l=0,d=[],m={},g=[];function a(h){var p=m[h]={onStack:true,lowlink:l,index:l++};if(d.push(h),s.successors(h).forEach(function(f){Object.hasOwn(m,f)?m[f].onStack&&(p.lowlink=Math.min(p.lowlink,m[f].index)):(a(f),p.lowlink=Math.min(p.lowlink,m[f].lowlink));}),p.lowlink===p.index){var x=[],u;do u=d.pop(),m[u].onStack=false,x.push(u);while(h!==u);g.push(x);}}return s.nodes().forEach(function(h){Object.hasOwn(m,h)||a(h);}),g}},{}],42:[function(n,o,i){function c(l){var d={},m={},g=[];function a(h){if(Object.hasOwn(m,h))throw new s;Object.hasOwn(d,h)||(m[h]=true,d[h]=true,l.predecessors(h).forEach(a),delete m[h],g.push(h));}if(l.sinks().forEach(a),Object.keys(d).length!==l.nodeCount())throw new s;return g}class s extends Error{constructor(){super(...arguments);}}o.exports=c,c.CycleException=s;},{}],43:[function(n,o,i){class c{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(l){return l.key})}has(l){return Object.hasOwn(this._keyIndices,l)}priority(l){var d=this._keyIndices[l];if(d!==void 0)return this._arr[d].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(l,d){var m=this._keyIndices;if(l=String(l),!Object.hasOwn(m,l)){var g=this._arr,a=g.length;return m[l]=a,g.push({key:l,priority:d}),this._decrease(a),true}return  false}removeMin(){this._swap(0,this._arr.length-1);var l=this._arr.pop();return delete this._keyIndices[l.key],this._heapify(0),l.key}decrease(l,d){var m=this._keyIndices[l];if(d>this._arr[m].priority)throw new Error("New priority is greater than current priority. Key: "+l+" Old: "+this._arr[m].priority+" New: "+d);this._arr[m].priority=d,this._decrease(m);}_heapify(l){var d=this._arr,m=2*l,g=m+1,a=l;m<d.length&&(a=d[m].priority<d[a].priority?m:a,g<d.length&&(a=d[g].priority<d[a].priority?g:a),a!==l&&(this._swap(l,a),this._heapify(a)));}_decrease(l){for(var d=this._arr,m=d[l].priority,g;l!==0&&(g=l>>1,!(d[g].priority<m));)this._swap(l,g),l=g;}_swap(l,d){var m=this._arr,g=this._keyIndices,a=m[l],h=m[d];m[l]=h,m[d]=a,g[h.key]=l,g[a.key]=d;}}o.exports=c;},{}],44:[function(n,o,i){var c="\0",s="\0",l="";class d{_isDirected=true;_isMultigraph=false;_isCompound=false;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(u){u&&(this._isDirected=Object.hasOwn(u,"directed")?u.directed:true,this._isMultigraph=Object.hasOwn(u,"multigraph")?u.multigraph:false,this._isCompound=Object.hasOwn(u,"compound")?u.compound:false),this._isCompound&&(this._parent={},this._children={},this._children[s]={});}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(u){return this._label=u,this}graph(){return this._label}setDefaultNodeLabel(u){return this._defaultNodeLabelFn=u,typeof u!="function"&&(this._defaultNodeLabelFn=()=>u),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var u=this;return this.nodes().filter(f=>Object.keys(u._in[f]).length===0)}sinks(){var u=this;return this.nodes().filter(f=>Object.keys(u._out[f]).length===0)}setNodes(u,f){var b=arguments,y=this;return u.forEach(function(M){b.length>1?y.setNode(M,f):y.setNode(M);}),this}setNode(u,f){return Object.hasOwn(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=s,this._children[u]={},this._children[s][u]=true),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)}node(u){return this._nodes[u]}hasNode(u){return Object.hasOwn(this._nodes,u)}removeNode(u){var f=this;if(Object.hasOwn(this._nodes,u)){var b=y=>f.removeEdge(f._edgeObjs[y]);delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],this.children(u).forEach(function(y){f.setParent(y);}),delete this._children[u]),Object.keys(this._in[u]).forEach(b),delete this._in[u],delete this._preds[u],Object.keys(this._out[u]).forEach(b),delete this._out[u],delete this._sucs[u],--this._nodeCount;}return this}setParent(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(f===void 0)f=s;else {f+="";for(var b=f;b!==void 0;b=this.parent(b))if(b===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f);}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=true,this}_removeFromParentsChildList(u){delete this._children[this._parent[u]][u];}parent(u){if(this._isCompound){var f=this._parent[u];if(f!==s)return f}}children(u=s){if(this._isCompound){var f=this._children[u];if(f)return Object.keys(f)}else {if(u===s)return this.nodes();if(this.hasNode(u))return []}}predecessors(u){var f=this._preds[u];if(f)return Object.keys(f)}successors(u){var f=this._sucs[u];if(f)return Object.keys(f)}neighbors(u){var f=this.predecessors(u);if(f){let y=new Set(f);for(var b of this.successors(u))y.add(b);return Array.from(y.values())}}isLeaf(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0}filterNodes(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var b=this;Object.entries(this._nodes).forEach(function([A,w]){u(A)&&f.setNode(A,w);}),Object.values(this._edgeObjs).forEach(function(A){f.hasNode(A.v)&&f.hasNode(A.w)&&f.setEdge(A,b.edge(A));});var y={};function M(A){var w=b.parent(A);return w===void 0||f.hasNode(w)?(y[A]=w,w):w in y?y[w]:M(w)}return this._isCompound&&f.nodes().forEach(A=>f.setParent(A,M(A))),f}setDefaultEdgeLabel(u){return this._defaultEdgeLabelFn=u,typeof u!="function"&&(this._defaultEdgeLabelFn=()=>u),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(u,f){var b=this,y=arguments;return u.reduce(function(M,A){return y.length>1?b.setEdge(M,A,f):b.setEdge(M,A),A}),this}setEdge(){var u,f,b,y,M=false,A=arguments[0];typeof A=="object"&&A!==null&&"v"in A?(u=A.v,f=A.w,b=A.name,arguments.length===2&&(y=arguments[1],M=true)):(u=A,f=arguments[1],b=arguments[3],arguments.length>2&&(y=arguments[2],M=true)),u=""+u,f=""+f,b!==void 0&&(b=""+b);var w=a(this._isDirected,u,f,b);if(Object.hasOwn(this._edgeLabels,w))return M&&(this._edgeLabels[w]=y),this;if(b!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[w]=M?y:this._defaultEdgeLabelFn(u,f,b);var $=h(this._isDirected,u,f,b);return u=$.v,f=$.w,Object.freeze($),this._edgeObjs[w]=$,m(this._preds[f],u),m(this._sucs[u],f),this._in[f][w]=$,this._out[u][w]=$,this._edgeCount++,this}edge(u,f,b){var y=arguments.length===1?p(this._isDirected,arguments[0]):a(this._isDirected,u,f,b);return this._edgeLabels[y]}edgeAsObj(){let u=this.edge(...arguments);return typeof u!="object"?{label:u}:u}hasEdge(u,f,b){var y=arguments.length===1?p(this._isDirected,arguments[0]):a(this._isDirected,u,f,b);return Object.hasOwn(this._edgeLabels,y)}removeEdge(u,f,b){var y=arguments.length===1?p(this._isDirected,arguments[0]):a(this._isDirected,u,f,b),M=this._edgeObjs[y];return M&&(u=M.v,f=M.w,delete this._edgeLabels[y],delete this._edgeObjs[y],g(this._preds[f],u),g(this._sucs[u],f),delete this._in[f][y],delete this._out[u][y],this._edgeCount--),this}inEdges(u,f){var b=this._in[u];if(b){var y=Object.values(b);return f?y.filter(M=>M.v===f):y}}outEdges(u,f){var b=this._out[u];if(b){var y=Object.values(b);return f?y.filter(M=>M.w===f):y}}nodeEdges(u,f){var b=this.inEdges(u,f);if(b)return b.concat(this.outEdges(u,f))}}function m(x,u){x[u]?x[u]++:x[u]=1;}function g(x,u){--x[u]||delete x[u];}function a(x,u,f,b){var y=""+u,M=""+f;if(!x&&y>M){var A=y;y=M,M=A;}return y+l+M+l+(b===void 0?c:b)}function h(x,u,f,b){var y=""+u,M=""+f;if(!x&&y>M){var A=y;y=M,M=A;}var w={v:y,w:M};return b&&(w.name=b),w}function p(x,u){return a(x,u.v,u.w,u.name)}o.exports=d;},{}],45:[function(n,o,i){o.exports={Graph:n("./graph"),version:n("./version")};},{"./graph":44,"./version":47}],46:[function(n,o,i){var c=n("./graph");o.exports={write:s,read:m};function s(g){var a={options:{directed:g.isDirected(),multigraph:g.isMultigraph(),compound:g.isCompound()},nodes:l(g),edges:d(g)};return g.graph()!==void 0&&(a.value=structuredClone(g.graph())),a}function l(g){return g.nodes().map(function(a){var h=g.node(a),p=g.parent(a),x={v:a};return h!==void 0&&(x.value=h),p!==void 0&&(x.parent=p),x})}function d(g){return g.edges().map(function(a){var h=g.edge(a),p={v:a.v,w:a.w};return a.name!==void 0&&(p.name=a.name),h!==void 0&&(p.value=h),p})}function m(g){var a=new c(g.options).setGraph(g.value);return g.nodes.forEach(function(h){a.setNode(h.v,h.value),h.parent&&a.setParent(h.v,h.parent);}),g.edges.forEach(function(h){a.setEdge({v:h.v,w:h.w,name:h.name},h.value);}),a}},{"./graph":44}],47:[function(n,o,i){o.exports="2.2.4";},{}]},{},[1])(1)});});var ce={bg:"#FFFFFF",fg:"#27272A"},Nt={textSec:60,textMuted:40,textFaint:25,line:30,arrow:50,nodeFill:3,nodeStroke:20,groupHeader:5,innerStroke:12,keyBadge:10},Ke={"zinc-light":{bg:"#FFFFFF",fg:"#27272A"},"zinc-dark":{bg:"#18181B",fg:"#FAFAFA"},"tokyo-night":{bg:"#1a1b26",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-storm":{bg:"#24283b",fg:"#a9b1d6",line:"#3d59a1",accent:"#7aa2f7",muted:"#565f89"},"tokyo-night-light":{bg:"#d5d6db",fg:"#343b58",line:"#34548a",accent:"#34548a",muted:"#9699a3"},"catppuccin-mocha":{bg:"#1e1e2e",fg:"#cdd6f4",line:"#585b70",accent:"#cba6f7",muted:"#6c7086"},"catppuccin-latte":{bg:"#eff1f5",fg:"#4c4f69",line:"#9ca0b0",accent:"#8839ef",muted:"#9ca0b0"},nord:{bg:"#2e3440",fg:"#d8dee9",line:"#4c566a",accent:"#88c0d0",muted:"#616e88"},"nord-light":{bg:"#eceff4",fg:"#2e3440",line:"#aab1c0",accent:"#5e81ac",muted:"#7b88a1"},dracula:{bg:"#282a36",fg:"#f8f8f2",line:"#6272a4",accent:"#bd93f9",muted:"#6272a4"},"github-light":{bg:"#ffffff",fg:"#1f2328",line:"#d1d9e0",accent:"#0969da",muted:"#59636e"},"github-dark":{bg:"#0d1117",fg:"#e6edf3",line:"#3d444d",accent:"#4493f8",muted:"#9198a1"},"solarized-light":{bg:"#fdf6e3",fg:"#657b83",line:"#93a1a1",accent:"#268bd2",muted:"#93a1a1"},"solarized-dark":{bg:"#002b36",fg:"#839496",line:"#586e75",accent:"#268bd2",muted:"#586e75"},"one-dark":{bg:"#282c34",fg:"#abb2bf",line:"#4b5263",accent:"#c678dd",muted:"#5c6370"}};function qe(t){let e=t.colors??{},r=t.type==="dark",n=o=>t.tokenColors?.find(i=>Array.isArray(i.scope)?i.scope.includes(o):i.scope===o)?.settings?.foreground;return {bg:e["editor.background"]??(r?"#1e1e1e":"#ffffff"),fg:e["editor.foreground"]??(r?"#d4d4d4":"#333333"),line:e["editorLineNumber.foreground"]??void 0,accent:e.focusBorder??n("keyword")??void 0,muted:n("comment")??e["editorLineNumber.foreground"]??void 0,surface:e["editor.selectionBackground"]??void 0,border:e["editorWidget.border"]??void 0}}function zt(t,e){let r=[`@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(t)}:wght@400;500;600;700&amp;display=swap');`,...e?["@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');"]:[]],n=`
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${Nt.textSec}%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${Nt.textMuted}%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) ${Nt.textFaint}%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) ${Nt.line}%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${Nt.arrow}%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${Nt.nodeFill}%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${Nt.nodeStroke}%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) ${Nt.groupHeader}%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) ${Nt.innerStroke}%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) ${Nt.keyBadge}%, var(--bg));`;return ["<style>",`  ${r.join(`
  `)}`,`  text { font-family: '${t}', system-ui, sans-serif; }`,...e?["  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }"]:[],`  svg {${n}`,"  }","</style>"].join(`
`)}function Vt(t,e,r,n){let o=[`--bg:${r.bg}`,`--fg:${r.fg}`,r.line?`--line:${r.line}`:"",r.accent?`--accent:${r.accent}`:"",r.muted?`--muted:${r.muted}`:"",r.surface?`--surface:${r.surface}`:"",r.border?`--border:${r.border}`:""].filter(Boolean).join(";");return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${e}" width="${t}" height="${e}" style="${o}${n?"":";background:var(--bg)"}">`}function Me(t){let e=t.split(/[\n;]/).map(n=>n.trim()).filter(n=>n.length>0&&!n.startsWith("%%"));if(e.length===0)throw new Error("Empty mermaid diagram");let r=e[0];return /^stateDiagram(-v2)?\s*$/i.test(r)?vo(e):So(e)}function So(t){let e=t[0].match(/^(?:graph|flowchart)\s+(TD|TB|LR|BT|RL)\s*$/i);if(!e)throw new Error(`Invalid mermaid header: "${t[0]}". Expected "graph TD", "flowchart LR", "stateDiagram-v2", etc.`);let n={direction:e[1].toUpperCase(),nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},o=[];for(let i=1;i<t.length;i++){let c=t[i],s=c.match(/^classDef\s+(\w+)\s+(.+)$/);if(s){let a=s[1],h=s[2],p=_n(h);n.classDefs.set(a,p);continue}let l=c.match(/^class\s+([^\s]+)\s+(\w+)$/);if(l){let a=l[1].split(",").map(p=>p.trim()),h=l[2];for(let p of a)n.classAssignments.set(p,h);continue}let d=c.match(/^style\s+([^\s]+)\s+(.+)$/);if(d){let a=d[1].split(",").map(p=>p.trim()),h=_n(d[2]);for(let p of a)n.nodeStyles.set(p,{...n.nodeStyles.get(p),...h});continue}let m=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(m&&o.length>0){o[o.length-1].direction=m[1].toUpperCase();continue}let g=c.match(/^subgraph\s+(.+)$/);if(g){let a=g[1].trim(),h=a.match(/^([\p{L}\p{N}_-]+)\s*\[(.+)\]$/u),p,x;h?(p=h[1],x=h[2]):(x=a,p=a.replace(/\s+/g,"_").replace(/[^\p{L}\p{N}_]/gu,""));let u={id:p,label:x,nodeIds:[],children:[]};o.push(u);continue}if(c==="end"){let a=o.pop();a&&(o.length>0?o[o.length-1].children.push(a):n.subgraphs.push(a));continue}Ao(c,n,o);}return n}function vo(t){let e={direction:"TD",nodes:new Map,edges:[],subgraphs:[],classDefs:new Map,classAssignments:new Map,nodeStyles:new Map},r=[],n=0,o=0;for(let i=1;i<t.length;i++){let c=t[i],s=c.match(/^direction\s+(TD|TB|LR|BT|RL)\s*$/i);if(s){r.length>0?r[r.length-1].direction=s[1].toUpperCase():e.direction=s[1].toUpperCase();continue}let l=c.match(/^state\s+(?:"([^"]+)"\s+as\s+)?([\p{L}\p{N}_-]+)\s*\{$/u);if(l){let a=l[1]??l[2],p={id:l[2],label:a,nodeIds:[],children:[]};r.push(p);continue}if(c==="}"){let a=r.pop();a&&(r.length>0?r[r.length-1].children.push(a):e.subgraphs.push(a));continue}let d=c.match(/^state\s+"([^"]+)"\s+as\s+([\p{L}\p{N}_-]+)\s*$/u);if(d){let a=d[1],h=d[2];we(e,r,{id:h,label:a,shape:"rounded"});continue}let m=c.match(/^(\[\*\]|[\p{L}\p{N}_-]+)\s*(-->)\s*(\[\*\]|[\p{L}\p{N}_-]+)(?:\s*:\s*(.+))?$/u);if(m){let a=m[1],h=m[3],p=m[4]?.trim()||void 0;a==="[*]"?(n++,a=`_start${n>1?n:""}`,we(e,r,{id:a,label:"",shape:"state-start"})):Ln(e,r,a),h==="[*]"?(o++,h=`_end${o>1?o:""}`,we(e,r,{id:h,label:"",shape:"state-end"})):Ln(e,r,h),e.edges.push({source:a,target:h,label:p,style:"solid",hasArrowStart:false,hasArrowEnd:true});continue}let g=c.match(/^([\p{L}\p{N}_-]+)\s*:\s*(.+)$/u);if(g){let a=g[1],h=g[2].trim();we(e,r,{id:a,label:h,shape:"rounded"});continue}}return e}function we(t,e,r){if(!t.nodes.has(r.id)&&t.nodes.set(r.id,r),e.length>0){let o=e[e.length-1];o.nodeIds.includes(r.id)||o.nodeIds.push(r.id);}}function Ln(t,e,r){if(!t.nodes.has(r))we(t,e,{id:r,label:r,shape:"rounded"});else if(e.length>0){let n=e[e.length-1];n.nodeIds.includes(r)||n.nodeIds.push(r);}}function _n(t){let e={};for(let r of t.split(",")){let n=r.indexOf(":");if(n>0){let o=r.slice(0,n).trim(),i=r.slice(n+1).trim();o&&i&&(e[o]=i);}}return e}var Dn=/^(<)?(-->|-.->|==>|---|-\.-|===)(?:\|([^|]*)\|)?/,ko=[{regex:/^([\p{L}\p{N}_-]+)\(\(\((.+?)\)\)\)/u,shape:"doublecircle"},{regex:/^([\p{L}\p{N}_-]+)\(\[(.+?)\]\)/u,shape:"stadium"},{regex:/^([\p{L}\p{N}_-]+)\(\((.+?)\)\)/u,shape:"circle"},{regex:/^([\p{L}\p{N}_-]+)\[\[(.+?)\]\]/u,shape:"subroutine"},{regex:/^([\p{L}\p{N}_-]+)\[\((.+?)\)\]/u,shape:"cylinder"},{regex:/^([\p{L}\p{N}_-]+)\[\/(.+?)\\\]/u,shape:"trapezoid"},{regex:/^([\p{L}\p{N}_-]+)\[\\(.+?)\/\]/u,shape:"trapezoid-alt"},{regex:/^([\p{L}\p{N}_-]+)>(.+?)\]/u,shape:"asymmetric"},{regex:/^([\p{L}\p{N}_-]+)\{\{(.+?)\}\}/u,shape:"hexagon"},{regex:/^([\p{L}\p{N}_-]+)\[(.+?)\]/u,shape:"rectangle"},{regex:/^([\p{L}\p{N}_-]+)\((.+?)\)/u,shape:"rounded"},{regex:/^([\p{L}\p{N}_-]+)\{(.+?)\}/u,shape:"diamond"}],Rn=/^([\p{L}\p{N}_-]+)/u,Eo=/^:::([\w][\w-]*)/;function $o(t){let e=t.trim();return e.length>=2&&e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1).replaceAll('\\"','"'):t}function Ao(t,e,r){let n=t.trim(),o=Tn(n,e,r);if(!o||o.ids.length===0)return;n=o.remaining.trim();let i=o.ids;for(;n.length>0;){let c=n.match(Dn);if(!c)break;let s=!!c[1],l=c[2],d=c[3]?.trim()||void 0;n=n.slice(c[0].length).trim();let m=_o(l),g=l.endsWith(">"),a=Tn(n,e,r);if(!a||a.ids.length===0)break;n=a.remaining.trim();for(let h of i)for(let p of a.ids)e.edges.push({source:h,target:p,label:d,style:m,hasArrowStart:s,hasArrowEnd:g});i=a.ids;}}function Tn(t,e,r){let n=In(t,e,r);if(!n)return null;let o=[n.id],i=n.remaining.trim();for(;i.startsWith("&");){i=i.slice(1).trim();let c=In(i,e,r);if(!c)break;o.push(c.id),i=c.remaining.trim();}return {ids:o,remaining:i}}function In(t,e,r){let n=null,o=t;for(let{regex:c,shape:s}of ko){let l=t.match(c);if(l){n=l[1];let d=$o(l[2]);Pn(e,r,{id:n,label:d,shape:s}),o=t.slice(l[0].length);break}}if(n===null){let c=t.match(Rn);if(c){let s=c[1],l=Lo(t,s.length);n=t.slice(0,l),e.nodes.has(n)?On(r,n):Pn(e,r,{id:n,label:n,shape:"rectangle"}),o=t.slice(l);}}if(n===null)return null;let i=o.match(Eo);return i&&(e.classAssignments.set(n,i[1]),o=o.slice(i[0].length)),{id:n,remaining:o}}function Lo(t,e){for(let r=e;r>=1;r--){let n=t.slice(r),o=n.match(Dn);if(!o)continue;let i=n.slice(o[0].length).trimStart();if(i.length!==0&&Rn.test(i))return r}for(let r=e;r>=1;r--){let n=t.slice(r);if(n.length===0)return r;let o=n[0];if(/\s/.test(o)||o==="&"||n.startsWith(":::"))return r}return Math.max(1,e)}function Pn(t,e,r){!t.nodes.has(r.id)&&t.nodes.set(r.id,r),On(e,r.id);}function On(t,e){if(t.length>0){let r=t[t.length-1];r.nodeIds.includes(e)||r.nodeIds.push(e);}}function _o(t){return t==="-.->"||t==="-.-"?"dotted":t==="==>"||t==="==="?"thick":"solid"}var lt={x:1,y:0},st={x:1,y:2},dt={x:0,y:1},ct={x:2,y:1},kt={x:2,y:0},Ct={x:0,y:0},$t={x:2,y:2},Et={x:0,y:2},Gt={x:1,y:1};function le(t,e){return t.x===e.x&&t.y===e.y}function _e(t,e){return t.x===e.x&&t.y===e.y}function Ce(t,e){return {x:t.x+e.x,y:t.y+e.y}}function Je(t){return `${t.x},${t.y}`}var Nn={name:"",styles:{}};function To(t){return t>=768&&t<=879||t>=6832&&t<=6911||t>=7616&&t<=7679||t>=8400&&t<=8447||t>=65056&&t<=65071}function Io(t){return t>=4352&&t<=4447||t>=11904&&t<=42191||t>=44032&&t<=55203||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65135||t>=65280&&t<=65376||t>=65504&&t<=65510||t>=127744&&t<=129791||t>=129280&&t<=129535}function de(t){let e=t.codePointAt(0);return e==null||e===0||e<32||e>=127&&e<160||To(e)?0:Io(e)?2:1}function mt(t){let e=0;for(let r of t)e+=de(r);return e}function Se(t,e){if(e<=0)return "";let r=0,n="";for(let o of t){let i=de(o);if(r+i>e)break;n+=o,r+=i;}return n}function wt(t,e){let r=[];for(let n=0;n<=t;n++){let o=[];for(let i=0;i<=e;i++)o.push(" ");r.push(o);}return r}function Qt(t){let[e,r]=St(t);return wt(e,r)}function St(t){return [t.length-1,(t[0]?.length??1)-1]}function Xt(t,e,r){let[n,o]=St(t),i=Math.max(e,n),c=Math.max(r,o),s=wt(i,c);for(let l=0;l<s.length;l++)for(let d=0;d<s[0].length;d++)l<t.length&&d<t[0].length&&(s[l][d]=t[l][d]);return t.length=0,t.push(...s),t}var Po=new Set(["\u2500","\u2502","\u250C","\u2510","\u2514","\u2518","\u251C","\u2524","\u252C","\u2534","\u253C","\u2574","\u2575","\u2576","\u2577"]);function Xn(t){return Po.has(t)}var Do={"\u2500":{"\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u2534"},"\u2502":{"\u2500":"\u253C","\u250C":"\u251C","\u2510":"\u2524","\u2514":"\u251C","\u2518":"\u2524","\u251C":"\u251C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u253C"},"\u250C":{"\u2500":"\u252C","\u2502":"\u251C","\u2510":"\u252C","\u2514":"\u251C","\u2518":"\u253C","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u252C","\u2534":"\u253C"},"\u2510":{"\u2500":"\u252C","\u2502":"\u2524","\u250C":"\u252C","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u252C","\u2534":"\u253C"},"\u2514":{"\u2500":"\u2534","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2518":"\u2534","\u251C":"\u251C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u2534"},"\u2518":{"\u2500":"\u2534","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u2534","\u251C":"\u253C","\u2524":"\u2524","\u252C":"\u253C","\u2534":"\u2534"},"\u251C":{"\u2500":"\u253C","\u2502":"\u251C","\u250C":"\u251C","\u2510":"\u253C","\u2514":"\u251C","\u2518":"\u253C","\u2524":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u2524":{"\u2500":"\u253C","\u2502":"\u2524","\u250C":"\u253C","\u2510":"\u2524","\u2514":"\u253C","\u2518":"\u2524","\u251C":"\u253C","\u252C":"\u253C","\u2534":"\u253C"},"\u252C":{"\u2500":"\u252C","\u2502":"\u253C","\u250C":"\u252C","\u2510":"\u252C","\u2514":"\u253C","\u2518":"\u253C","\u251C":"\u253C","\u2524":"\u253C","\u2534":"\u253C"},"\u2534":{"\u2500":"\u2534","\u2502":"\u253C","\u250C":"\u253C","\u2510":"\u253C","\u2514":"\u2534","\u2518":"\u2534","\u251C":"\u253C","\u2524":"\u253C","\u252C":"\u253C"}};function Ro(t,e){return Do[t]?.[e]??t}function Yt(t,e,r,...n){let[o,i]=St(t);for(let s of n){let[l,d]=St(s);o=Math.max(o,l+e.x),i=Math.max(i,d+e.y);}let c=wt(o,i);for(let s=0;s<=o;s++)for(let l=0;l<=i;l++)s<t.length&&l<t[0].length&&(c[s][l]=t[s][l]);for(let s of n)for(let l=0;l<s.length;l++)for(let d=0;d<s[0].length;d++){let m=s[l][d];if(m!==" "){let g=l+e.x,a=d+e.y,h=c[g][a];!r&&Xn(m)&&Xn(h)?c[g][a]=Ro(h,m):c[g][a]=m;}}return c}function Bn(t){return t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u2524"||t==="\u2510"||t==="\u2518"}function Gn(t){return t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u250C"||t==="\u2514"}function Yn(t){return t==="\u2502"||t==="\u253C"||t==="\u251C"||t==="\u2524"||t==="\u2534"||t==="\u2514"||t==="\u2518"}function Fn(t){return t==="\u2502"||t==="\u253C"||t==="\u251C"||t==="\u2524"||t==="\u252C"||t==="\u250C"||t==="\u2510"}function Wn(t,e){let[r,n]=St(t),o=1,i=2,c=4,s=8,l=o|i|c|s;function d(m){return m===l?null:m===(o|i)?"\u2500":m===(c|s)?"\u2502":m===(c|i)?"\u2514":m===(c|o)?"\u2518":m===(s|i)?"\u250C":m===(s|o)?"\u2510":m===(c|o|i)?"\u2534":m===(s|o|i)?"\u252C":m===(c|s|o)?"\u2524":m===(c|s|i)?"\u251C":null}for(let m=0;m<=r;m++)for(let g=0;g<=n;g++){if(t[m][g]!=="\u253C")continue;let a=m>0?t[m-1][g]:" ",h=m<r?t[m+1][g]:" ",p=g>0?t[m][g-1]:" ",x=g<n?t[m][g+1]:" ",u=(Gn(a)?1:0)+(Bn(h)?1:0),f=(Fn(p)?1:0)+(Yn(x)?1:0);if(e&&e.size>0){let b=`${m},${g}`,y=e.get(b)??0;if(y!==0){let M=Gn(a),A=Bn(h),w=Fn(p),$=Yn(x),k=(M?o:0)|(A?i:0)|(w?c:0)|($?s:0),P=f>u,X=P?c|s:o|i,N=k&X|y;N===l&&(P?(y&o)===0?N&=~o:(y&i)===0&&(N&=~i):(y&c)===0?N&=~c:(y&s)===0&&(N&=~s));let Y=d(N);if(Y){t[m][g]=Y;continue}}}t[m][g]=f>u?"\u2502":"\u2500";}}function Ft(t){let[e,r]=St(t),n=[];for(let o=0;o<=r;o++){let i="";for(let c=0;c<=e;c++){let s=t[c][o];i+=s,de(s)===2&&(c+=1);}n.push(i);}return n.join(`
`)}var Oo={"\u25B2":"\u25BC","\u25BC":"\u25B2","\u25E4":"\u25E3","\u25E3":"\u25E4","\u25E5":"\u25E2","\u25E2":"\u25E5","^":"v",v:"^","\u250C":"\u2514","\u2514":"\u250C","\u2510":"\u2518","\u2518":"\u2510","\u252C":"\u2534","\u2534":"\u252C","\u2575":"\u2577","\u2577":"\u2575"};function Hn(t){for(let e of t)e.reverse();for(let e of t)for(let r=0;r<e.length;r++){let n=Oo[e[r]];n&&(e[r]=n);}return t}function bt(t,e,r){Xt(t,e.x+mt(r),e.y);let n=e.x;for(let o of r)t[n][e.y]=o,n+=de(o);}function Un(t,e,r){let n=0,o=0;for(let i of e.values())n+=i;for(let i of r.values())o+=i;Xt(t,n-1,o-1);}function jn(t,e){let r=new Map,n=0;for(let[s,l]of t.nodes){let d={name:s,displayLabel:l.label,index:n,gridCoord:null,drawingCoord:null,drawing:null,drawn:false,styleClassName:"",styleClass:Nn};r.set(s,d),n++;}let o=[...r.values()],i=[];for(let s of t.edges){let l=r.get(s.source),d=r.get(s.target);!l||!d||i.push({from:l,to:d,text:s.label??"",path:[],labelLine:[],startDir:{x:0,y:0},endDir:{x:0,y:0}});}let c=[];for(let s of t.subgraphs)zn(s,null,r,c);No(t.subgraphs,c,r);for(let[s,l]of t.classAssignments){let d=r.get(s),m=t.classDefs.get(l);d&&m&&(d.styleClassName=l,d.styleClass={name:l,styles:m});}return {nodes:o,edges:i,canvas:wt(0,0),grid:new Map,columnWidth:new Map,rowHeight:new Map,subgraphs:c,config:e,offsetX:0,offsetY:0}}function zn(t,e,r,n){let o={name:t.label,nodes:[],parent:e,children:[],minX:0,minY:0,maxX:0,maxY:0};for(let i of t.nodeIds){let c=r.get(i);c&&o.nodes.push(c);}n.push(o);for(let i of t.children){let c=zn(i,o,r,n);o.children.push(c);for(let s of c.nodes)o.nodes.includes(s)||o.nodes.push(s);}return o}function No(t,e,r,n){let o=new Map;Bo(t,e,o);let i=new Map;function c(s){let l=o.get(s);if(l){for(let d of s.children)c(d);for(let d of s.nodeIds)i.has(d)||i.set(d,l);}}for(let s of t)c(s);for(let s of e)s.nodes=s.nodes.filter(l=>{let d;for(let[g,a]of r)if(a===l){d=g;break}if(!d)return  false;let m=i.get(d);return m?Xo(s,m):true});}function Xo(t,e){let r=e;for(;r!==null;){if(r===t)return  true;r=r.parent;}return  false}function Bo(t,e,r){let n=[];function o(i){for(let c of i)n.push(c),o(c.children);}o(t);for(let i=0;i<n.length&&i<e.length;i++)r.set(n[i],e[i]);}var Ze=class{idxs=[];priorities=[];costs=[];poppedIdx=-1;poppedPriority=0;poppedCost=0;get length(){return this.idxs.length}clear(){this.idxs.length=0,this.priorities.length=0,this.costs.length=0,this.poppedIdx=-1,this.poppedPriority=0,this.poppedCost=0;}push(e,r,n){this.idxs.push(e),this.priorities.push(r),this.costs.push(n),this.bubbleUp(this.idxs.length-1);}pop(){if(this.idxs.length===0)return  false;this.poppedIdx=this.idxs[0],this.poppedPriority=this.priorities[0],this.poppedCost=this.costs[0];let e=this.idxs.pop(),r=this.priorities.pop(),n=this.costs.pop();return this.idxs.length>0&&(this.idxs[0]=e,this.priorities[0]=r,this.costs[0]=n,this.sinkDown(0)),true}bubbleUp(e){for(;e>0;){let r=e-1>>1;if(this.priorities[e]<this.priorities[r])[this.idxs[e],this.idxs[r]]=[this.idxs[r],this.idxs[e]],[this.priorities[e],this.priorities[r]]=[this.priorities[r],this.priorities[e]],[this.costs[e],this.costs[r]]=[this.costs[r],this.costs[e]],e=r;else break}}sinkDown(e){let r=this.idxs.length;for(;;){let n=e,o=2*e+1,i=2*e+2;if(o<r&&this.priorities[o]<this.priorities[n]&&(n=o),i<r&&this.priorities[i]<this.priorities[n]&&(n=i),n!==e)[this.idxs[e],this.idxs[n]]=[this.idxs[n],this.idxs[e]],[this.priorities[e],this.priorities[n]]=[this.priorities[n],this.priorities[e]],[this.costs[e],this.costs[n]]=[this.costs[n],this.costs[e]],e=n;else break}}};function Vn(t,e){let r=t*e;return {stride:t,height:e,blocked:new Uint8Array(r),stamp:0,costStamp:new Uint32Array(r),costSoFar:new Float64Array(r),cameFrom:new Int32Array(r),heap:new Ze}}function oe(t,e){return e.x+e.y*t}function Te(t,e){let r=e/t|0;return {x:e-r*t,y:r}}function Bt(t,e){if(t.length<=2)return t.length;let r=0,n=t[1]-t[0];for(let o=2;o<t.length;o++){let i=t[o]-t[o-1];i!==n&&(r++,n=i);}return 2+r}function Kn(t,e){if(t.length<=2)return t;let r=[t[0]],n=t[1]-t[0];for(let o=2;o<t.length;o++){let i=t[o]-t[o-1];i!==n&&(r.push(t[o-1]),n=i);}return r.push(t[t.length-1]),r}function qn(t,e,r,n){let o=globalThis.__bm_getPath;if(typeof o=="function")return o(t.stride,e,r,n.maxX,n.maxY,t.blocked);let{stride:i}=t,c=n.maxX,s=n.maxY;if(c<0||s<0)return null;let l=r/i|0,d=r-l*i;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let m=t.stamp;for(t.heap.clear(),t.costStamp[e]=m,t.costSoFar[e]=0,t.cameFrom[e]=-1,t.heap.push(e,0,0);t.heap.pop();){let g=t.heap.poppedIdx,a=t.heap.poppedCost;if(t.costStamp[g]!==m||a!==t.costSoFar[g])continue;if(g===r){let u=[],f=g;for(;f!==-1;)u.push(f),f=t.cameFrom[f];return u.reverse(),u}let h=t.costSoFar[g],p=g/i|0,x=g-p*i;if(x<c){let u=g+1;if(!t.blocked[u]||u===r){let f=h+1;if(t.costStamp[u]!==m||f<t.costSoFar[u]){t.costStamp[u]=m,t.costSoFar[u]=f,t.cameFrom[u]=g;let b=x+1>=d?x+1-d:d-(x+1),y=p>=l?p-l:l-p,M=b===0||y===0?b+y:b+y+1;t.heap.push(u,f+M,f);}}}if(x>0){let u=g-1;if(!t.blocked[u]||u===r){let f=h+1;if(t.costStamp[u]!==m||f<t.costSoFar[u]){t.costStamp[u]=m,t.costSoFar[u]=f,t.cameFrom[u]=g;let b=x-1>=d?x-1-d:d-(x-1),y=p>=l?p-l:l-p,M=b===0||y===0?b+y:b+y+1;t.heap.push(u,f+M,f);}}}if(p<s){let u=g+i;if(!t.blocked[u]||u===r){let f=h+1;if(t.costStamp[u]!==m||f<t.costSoFar[u]){t.costStamp[u]=m,t.costSoFar[u]=f,t.cameFrom[u]=g;let b=x>=d?x-d:d-x,y=p+1>=l?p+1-l:l-(p+1),M=b===0||y===0?b+y:b+y+1;t.heap.push(u,f+M,f);}}}if(p>0){let u=g-i;if(!t.blocked[u]||u===r){let f=h+1;if(t.costStamp[u]!==m||f<t.costSoFar[u]){t.costStamp[u]=m,t.costSoFar[u]=f,t.cameFrom[u]=g;let b=x>=d?x-d:d-x,y=p-1>=l?p-1-l:l-(p-1),M=b===0||y===0?b+y:b+y+1;t.heap.push(u,f+M,f);}}}}return null}var te=1,ee=2,ne=4,re=8;function Jn(t,e,r,n,o){let i=globalThis.__bm_getPathStrict;if(typeof i=="function")return i(t.stride,e,r,n.maxX,n.maxY,t.blocked,o);let c=t.stride,s=n.maxX,l=n.maxY;if(s<0||l<0)return null;let d=r/c|0,m=r-d*c;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let g=t.stamp,a=t.heap,h=t.blocked,p=t.costStamp,x=t.costSoFar,u=t.cameFrom;a.clear(),p[e]=g,x[e]=0,u[e]=-1,a.push(e,0,0);let f=o.usedPoints,b=o.segmentUsage,y=b.segmentUsed,M=b.usedAsMiddle;b.segmentPair;b.segmentPairMulti;let $=b.startSource,k=b.startSourceMulti,P=b.endTarget,X=b.endTargetMulti,N=o.routeFromIdx,Y=o.routeToIdx,q=o.edgeFromId,_=o.edgeToId,F=te|ee,I=ne|re;for(;a.pop();){let S=a.poppedIdx,v=a.poppedCost;if(p[S]!==g||v!==x[S])continue;if(S===r){let D=[],T=S;for(;T!==-1;)D.push(T),T=u[T];return D.reverse(),D}let V=x[S],z=S/c|0,L=S-z*c;if(L<s){let D=S+1;if(!h[D]||D===r){let T=true;if(f){let G=f[S];if(G!==0){let W=G|ee;(W&F)===F&&(W&I)===I&&(T=false);}if(T){let W=f[D];if(W!==0){let K=W|te;(K&F)===F&&(K&I)===I&&(T=false);}}}if(T){let G=S*2;if(y[G]&&(T=false,!M[G])){let W=S===N,K=D===Y,B=$[G],O=P[G],C=k[G]!==0,E=X[G]!==0;W&&K?T=!C&&(B===0||B===q)&&(!E&&(O===0||O===_)):W?T=!E&&O===0&&!C&&B===q:K&&(T=!C&&B===0&&!E&&O===_);}}if(T){let G=V+1;if(p[D]!==g||G<x[D]){p[D]=g,x[D]=G,u[D]=S;let W=L+1,K=W>=m?W-m:m-W,B=z>=d?z-d:d-z,O=K===0||B===0?K+B:K+B+1;a.push(D,G+O,G);}}}}if(L>0){let D=S-1;if(!h[D]||D===r){let T=true;if(f){let G=f[S];if(G!==0){let W=G|te;(W&F)===F&&(W&I)===I&&(T=false);}if(T){let W=f[D];if(W!==0){let K=W|ee;(K&F)===F&&(K&I)===I&&(T=false);}}}if(T){let G=D*2;if(y[G]&&(T=false,!M[G])){let W=S===N,K=D===Y,B=$[G],O=P[G],C=k[G]!==0,E=X[G]!==0;W&&K?T=!C&&(B===0||B===q)&&(!E&&(O===0||O===_)):W?T=!E&&O===0&&!C&&B===q:K&&(T=!C&&B===0&&!E&&O===_);}}if(T){let G=V+1;if(p[D]!==g||G<x[D]){p[D]=g,x[D]=G,u[D]=S;let W=L-1,K=W>=m?W-m:m-W,B=z>=d?z-d:d-z,O=K===0||B===0?K+B:K+B+1;a.push(D,G+O,G);}}}}if(z<l){let D=S+c;if(!h[D]||D===r){let T=true;if(f){let G=f[S];if(G!==0){let W=G|re;(W&F)===F&&(W&I)===I&&(T=false);}if(T){let W=f[D];if(W!==0){let K=W|ne;(K&F)===F&&(K&I)===I&&(T=false);}}}if(T){let G=S*2+1;if(y[G]&&(T=false,!M[G])){let W=S===N,K=D===Y,B=$[G],O=P[G],C=k[G]!==0,E=X[G]!==0;W&&K?T=!C&&(B===0||B===q)&&(!E&&(O===0||O===_)):W?T=!E&&O===0&&!C&&B===q:K&&(T=!C&&B===0&&!E&&O===_);}}if(T){let G=V+1;if(p[D]!==g||G<x[D]){p[D]=g,x[D]=G,u[D]=S;let W=z+1,K=L>=m?L-m:m-L,B=W>=d?W-d:d-W,O=K===0||B===0?K+B:K+B+1;a.push(D,G+O,G);}}}}if(z>0){let D=S-c;if(!h[D]||D===r){let T=true;if(f){let G=f[S];if(G!==0){let W=G|ne;(W&F)===F&&(W&I)===I&&(T=false);}if(T){let W=f[D];if(W!==0){let K=W|re;(K&F)===F&&(K&I)===I&&(T=false);}}}if(T){let G=D*2+1;if(y[G]&&(T=false,!M[G])){let W=S===N,K=D===Y,B=$[G],O=P[G],C=k[G]!==0,E=X[G]!==0;W&&K?T=!C&&(B===0||B===q)&&(!E&&(O===0||O===_)):W?T=!E&&O===0&&!C&&B===q:K&&(T=!C&&B===0&&!E&&O===_);}}if(T){let G=V+1;if(p[D]!==g||G<x[D]){p[D]=g,x[D]=G,u[D]=S;let W=z-1,K=L>=m?L-m:m-L,B=W>=d?W-d:d-W,O=K===0||B===0?K+B:K+B+1;a.push(D,G+O,G);}}}}}return null}var Go=1;function Zn(t,e,r,n,o){let i=globalThis.__bm_getPathRelaxed;if(typeof i=="function")return i(t.stride,e,r,n.maxX,n.maxY,t.blocked,o);let c=t.stride,s=n.maxX,l=n.maxY;if(s<0||l<0)return null;let d=r/c|0,m=r-d*c;t.stamp=t.stamp+1>>>0,t.stamp===0&&(t.stamp=1);let g=t.stamp,a=t.heap,h=t.blocked,p=t.costStamp,x=t.costSoFar,u=t.cameFrom;a.clear(),p[e]=g,x[e]=0,u[e]=-1,a.push(e,0,0);let f=o.usedPoints,b=o.segmentUsage,y=b.segmentUsed,M=b.usedAsMiddle,A=b.segmentPair,w=b.segmentPairMulti,$=b.startSource,k=b.startSourceMulti,P=b.endTarget,X=b.endTargetMulti,N=o.routeFromIdx,Y=o.routeToIdx,q=o.edgeFromId,_=o.edgeToId,F=o.relaxedAllowEndSegmentReuse===true,I=q>65535||_>65535?0:q<<16|_;function S(T){return I!==0&&w[T]===0&&A[T]===I}let v=te|ee,V=ne|re,z=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];function L(T,G){if(T===0)return 0;let W=T|G;return (W&v)===v&&(W&V)===V?Go:0}function D(T,G,W){if(!y[T]||S(T))return  true;if(M[T]||W&&!F)return  false;let K=$[T],B=P[T],O=k[T]!==0,C=X[T]!==0;return G&&W?!O&&(K===0||K===q)&&(!C&&(B===0||B===_)):G?!C&&B===0&&!O&&K===q:W?!O&&K===0&&!C&&B===_:false}for(;a.pop();){let T=a.poppedIdx,G=a.poppedCost;if(p[T]!==g||G!==x[T])continue;if(T===r){let O=[],C=T;for(;C!==-1;)O.push(C),C=u[C];return O.reverse(),{path:O,cost:x[T]}}let W=x[T],K=T/c|0,B=T-K*c;if(B<s){let O=T+1;if(!h[O]||O===r){let C=0,E=true,R=T*2;if(f&&(C+=L(f[T],ee),C+=L(f[O],te),O!==r)){let H=f[O];if(H!==0){let J=Y-O,et=J===1||J===-1||J===c||J===-c,rt=(H|te)&15,U=z[rt];S(R)&&U<=2||(T!==N&&!et?E=false:T===N?U>=3&&(E=false):U>=4&&(E=false));}}if(E&&D(R,T===N,O===Y)){let H=W+1+C;if(p[O]!==g||H<x[O]){p[O]=g,x[O]=H,u[O]=T;let J=B+1,et=J>=m?J-m:m-J,rt=K>=d?K-d:d-K,U=et===0||rt===0?et+rt:et+rt+1;a.push(O,H+U,H);}}}}if(B>0){let O=T-1;if(!h[O]||O===r){let C=0,E=true,R=O*2;if(f&&(C+=L(f[T],te),C+=L(f[O],ee),O!==r)){let H=f[O];if(H!==0){let J=Y-O,et=J===1||J===-1||J===c||J===-c,rt=(H|ee)&15,U=z[rt];S(R)&&U<=2||(T!==N&&!et?E=false:T===N?U>=3&&(E=false):U>=4&&(E=false));}}if(E&&D(R,T===N,O===Y)){let H=W+1+C;if(p[O]!==g||H<x[O]){p[O]=g,x[O]=H,u[O]=T;let J=B-1,et=J>=m?J-m:m-J,rt=K>=d?K-d:d-K,U=et===0||rt===0?et+rt:et+rt+1;a.push(O,H+U,H);}}}}if(K<l){let O=T+c;if(!h[O]||O===r){let C=0,E=true,R=T*2+1;if(f&&(C+=L(f[T],re),C+=L(f[O],ne),O!==r)){let H=f[O];if(H!==0){let J=Y-O,et=J===1||J===-1||J===c||J===-c,rt=(H|ne)&15,U=z[rt];S(R)&&U<=2||(T!==N&&!et?E=false:T===N?U>=3&&(E=false):U>=4&&(E=false));}}if(E&&D(R,T===N,O===Y)){let H=W+1+C;if(p[O]!==g||H<x[O]){p[O]=g,x[O]=H,u[O]=T;let J=K+1,et=B>=m?B-m:m-B,rt=J>=d?J-d:d-J,U=et===0||rt===0?et+rt:et+rt+1;a.push(O,H+U,H);}}}}if(K>0){let O=T-c;if(!h[O]||O===r){let C=0,E=true,R=O*2+1;if(f&&(C+=L(f[T],ne),C+=L(f[O],re),O!==r)){let H=f[O];if(H!==0){let J=Y-O,et=J===1||J===-1||J===c||J===-c,rt=(H|re)&15,U=z[rt];S(R)&&U<=2||(T!==N&&!et?E=false:T===N?U>=3&&(E=false):U>=4&&(E=false));}}if(E&&D(R,T===N,O===Y)){let H=W+1+C;if(p[O]!==g||H<x[O]){p[O]=g,x[O]=H,u[O]=T;let J=K-1,et=B>=m?B-m:m-B,rt=J>=d?J-d:d-J,U=et===0||rt===0?et+rt:et+rt+1;a.push(O,H+U,H);}}}}}return null}function Qe(t){if(t.length<=2)return t;let e=new Set,r=t[0],n=t[1];for(let o=2;o<t.length;o++){let i=t[o],c=n.x-r.x,s=n.y-r.y,l=i.x-n.x,d=i.y-n.y;c===l&&s===d&&e.add(o-1),r=n,n=i;}return t.filter((o,i)=>!e.has(i))}var _t=[12,24,48],It=[12,24,48,96,192,384],Pe=It[It.length-1];function Ie(t){return t===lt?st:t===st?lt:t===dt?ct:t===ct?dt:t===kt?Et:t===Ct?$t:t===$t?Ct:t===Et?kt:Gt}function j(t,e){return t.x===e.x&&t.y===e.y}function Lt(t,e){return t.x===e.x?t.y<e.y?st:lt:t.y===e.y?t.x<e.x?ct:dt:t.x<e.x?t.y<e.y?$t:kt:t.y<e.y?Et:Ct}function Yo(t){return t==="LR"?[ct,st,st,ct]:[st,ct,ct,st]}function Fo(t,e,r){if(t.from===t.to)return Yo(e);let n=Lt(t.from.gridCoord,t.to.gridCoord),o,i,c,s,l=e==="LR"?j(n,dt)||j(n,Ct)||j(n,Et):j(n,lt)||j(n,Ct)||j(n,kt);if(j(n,$t)?e==="LR"?(o=st,i=dt,c=ct,s=lt):(o=ct,i=lt,c=st,s=dt):j(n,kt)?e==="LR"?(o=lt,i=dt,c=ct,s=st):(o=ct,i=st,c=lt,s=dt):j(n,Et)?e==="LR"?(o=st,i=st,c=dt,s=lt):(o=dt,i=lt,c=st,s=ct):j(n,Ct)?e==="LR"?(o=st,i=st,c=dt,s=st):(o=ct,i=ct,c=lt,s=ct):l?e==="LR"&&j(n,dt)?(o=st,i=st,c=dt,s=ct):e==="TD"&&j(n,lt)?(o=ct,i=ct,c=lt,s=st):(o=n,i=Ie(n),c=n,s=Ie(n)):(o=n,i=Ie(n),c=n,s=Ie(n)),r==="relaxed"){let h=t.from.gridCoord,p=t.to.gridCoord;if(h&&p){let f=function(A){return j(A,dt)?ct:j(A,ct)?dt:j(A,Ct)?kt:j(A,kt)?Ct:j(A,Et)?$t:j(A,$t)?Et:A},b=function(A){return j(A,lt)?st:j(A,st)?lt:j(A,Ct)?Et:j(A,kt)?$t:j(A,Et)?Ct:j(A,$t)?kt:A},y=function(A){let w=A,$=Math.sign(w.x-1),k=Math.sign(w.y-1);return (x<0&&$===1||x>0&&$===-1)&&(w=f(w)),(u<0&&k===1||u>0&&k===-1)&&(w=b(w)),w},M=function(A){let w=A,$=Math.sign(w.x-1),k=Math.sign(w.y-1);return (x<0&&$===-1||x>0&&$===1)&&(w=f(w)),(u<0&&k===-1||u>0&&k===1)&&(w=b(w)),w};let x=p.x-h.x,u=p.y-h.y;o=y(o),c=y(c),i=M(i),s=M(s);}}return [o,i,c,s]}function or(t){let e=t*2;return {segmentUsed:new Uint8Array(e),usedAsMiddle:new Uint8Array(e),segmentPair:new Uint32Array(e),segmentPairMulti:new Uint8Array(e),startSource:new Uint32Array(e),startSourceMulti:new Uint8Array(e),endTarget:new Uint32Array(e),endTargetMulti:new Uint8Array(e),usedCount:0}}var tn=1,en=2,nn=4,rn=8;function ir(t,e){let r=e-t,n=r===1||r===-1;return (t<e?t:e)*2+(n?0:1)}function Qn(t,e,r){if(r.length<2)return;let n=e.from.index+1,o=e.to.index+1,i=n>65535||o>65535?0:n<<16|o;for(let c=1;c<r.length;c++){let s=r[c-1],l=r[c],d=ir(s,l),m=c===1,g=c===r.length-1;if(t.segmentUsed[d]||(t.segmentUsed[d]=1,t.usedCount++),i!==0){let a=t.segmentPair[d];a===0?t.segmentPair[d]=i:a!==i&&(t.segmentPairMulti[d]=1);}if(m){let a=t.startSource[d];a===0?t.startSource[d]=n:a!==n&&(t.startSourceMulti[d]=1);}if(g){let a=t.endTarget[d];a===0?t.endTarget[d]=o:a!==o&&(t.endTargetMulti[d]=1);}!m&&!g&&(t.usedAsMiddle[d]=1);}}function sr(t,e,r){let n=e-t;return n===1?{fromBit:en,toBit:tn}:n===-1?{fromBit:tn,toBit:en}:n===r?{fromBit:rn,toBit:nn}:n===-r?{fromBit:nn,toBit:rn}:null}function tr(t,e,r){if(r.length<2)return;let n=e.stride;for(let o=1;o<r.length;o++){let i=r[o-1],c=r[o],s=sr(i,c,n);s&&(e.blocked[i]||(t[i]=t[i]|s.fromBit),e.blocked[c]||(t[c]=t[c]|s.toBit));}}function er(t,e){let r=t|e,n=(r&tn)!==0&&(r&en)!==0,o=(r&nn)!==0&&(r&rn)!==0;return n&&o}function Wo(t,e,r,n){if(!e)return  true;let o=sr(r,n,t.stride);if(!o)return  true;if(!t.blocked[r]){let i=e[r];if(i!==0&&er(i,o.fromBit))return  false}if(!t.blocked[n]){let i=e[n];if(i!==0&&er(i,o.toBit))return  false}return  true}function Ho(t,e,r,n,o,i,c,s){if(t.usedAsMiddle[s])return  false;let l=i===n,d=c===o,m=t.startSource[s],g=t.endTarget[s],a=t.startSourceMulti[s]!==0,h=t.endTargetMulti[s]!==0;return l&&d?!a&&(m===0||m===e)&&(!h&&(g===0||g===r)):l?!h&&g===0&&!a&&m===e:d?!a&&m===0&&!h&&g===r:false}function sn(t,e,r,n,o,i,c,s=false){e.__bm_used_unconstrained_fallback=false;let l=e.from===e.to,d=t.config.routing,[m,g,a,h]=Fo(e,t.config.graphDirection,d);function p(U){let Z=[];for(let Q of U)Z.some(tt=>j(tt,Q))||Z.push(Q);return Z}function x(U,Z){let Q=[];for(let tt of U)for(let it of Z){let nt=Ce(e.from.gridCoord,tt),ot=Ce(e.to.gridCoord,it);le(nt,ot)||Q.push({startDir:tt,endDir:it,routeFrom:nt,routeTo:ot,routeFromIdx:oe(r.stride,nt),routeToIdx:oe(r.stride,ot)});}return Q}function u(U){return j(U,lt)||j(U,st)||j(U,dt)||j(U,ct)?0:d==="relaxed"?10:100}function f(U){return U.x===0||U.y===0?200:0}let b=6;function y(U,Z){if(d!=="relaxed"||!t.portUsage||!t.config.useAscii)return 0;let Q=Z.x+Z.y*3,tt=U.index*9+Q;return (t.portUsage[tt]??0)*b}function M(U,Z){return Bt(Z,r.stride)+u(U.startDir)+u(U.endDir)+f(U.routeFrom)+f(U.routeTo)}function A(U){if(!e.from.gridCoord||!e.to.gridCoord||U.length<8)return 0;let Z=r.stride,Q=Number.POSITIVE_INFINITY,tt=Number.NEGATIVE_INFINITY,it=Number.POSITIVE_INFINITY,nt=Number.NEGATIVE_INFINITY;for(let $n of U){let Ae=$n%Z,Le=$n/Z|0;Ae<Q&&(Q=Ae),Ae>tt&&(tt=Ae),Le<it&&(it=Le),Le>nt&&(nt=Le);}let ot=e.from.gridCoord,ft=e.to.gridCoord,xt=Math.min(ot.x,ft.x),Tt=Math.max(ot.x,ft.x)+2,At=Math.min(ot.y,ft.y),pt=Math.max(ot.y,ft.y)+2,Ut=2,xe=Math.max(0,xt-Q-Ut),Ot=Math.max(0,tt-Tt-Ut),Pt=Math.max(0,At-it-Ut),be=Math.max(0,nt-pt-Ut),jt=xe+Ot+Pt+be,ze=Math.abs(ft.x-ot.x),kn=Math.abs(ft.y-ot.y)>=ze+2,En=kn?8:12,po=kn?10:4;return jt<=En?0:(jt-En)*po}let w=(()=>{let U=on(t,e.from),Z=on(t,e.to);if(!U||!Z)return null;let Q=0;Z.minX>U.maxX?Q=Z.minX-U.maxX:Z.maxX<U.minX&&(Q=Z.maxX-U.minX);let tt=0;if(Z.minY>U.maxY?tt=Z.minY-U.maxY:Z.maxY<U.minY&&(tt=Z.maxY-U.minY),Q===0&&tt===0){let it=Math.floor((U.minX+U.maxX)/2),nt=Math.floor((U.minY+U.maxY)/2),ot=Math.floor((Z.minX+Z.maxX)/2),ft=Math.floor((Z.minY+Z.maxY)/2);return {dx:ot-it,dy:ft-nt}}return {dx:Q,dy:tt}})();function $(U){if(!w)return 0;let Z=w.dx,Q=w.dy;if(Z===0&&Q===0)return 0;let tt=Z===0?0:Z>0?1:-1,it=Q===0?0:Q>0?1:-1,nt=Math.sign(U.startDir.x-1),ot=Math.sign(U.startDir.y-1),ft=Math.sign(U.endDir.x-1),xt=Math.sign(U.endDir.y-1),Tt=180,At=0;return tt!==0&&nt!==0&&nt===-tt&&(At+=Tt),it!==0&&ot!==0&&ot===-it&&(At+=Tt),tt!==0&&ft!==0&&ft===tt&&(At+=Tt),it!==0&&xt!==0&&xt===it&&(At+=Tt),At}function k(U,Z){return Z.cost+Bt(Z.path,r.stride)+A(Z.path)+$(U)+u(U.startDir)+u(U.endDir)+f(U.routeFrom)+f(U.routeTo)+y(e.from,U.startDir)+y(e.to,U.endDir)}let P=p([m,a]),X=p([g,h]),N=[];function Y(U,Z){if(N.some(it=>j(it.startDir,U)&&j(it.endDir,Z)))return;let Q=Ce(e.from.gridCoord,U),tt=Ce(e.to.gridCoord,Z);le(Q,tt)||N.push({startDir:U,endDir:Z,routeFrom:Q,routeTo:tt,routeFromIdx:oe(r.stride,Q),routeToIdx:oe(r.stride,tt)});}if(Y(m,g),Y(a,h),d==="relaxed"&&P.length>1&&X.length>1)for(let U of P)for(let Z of X)Y(U,Z);function q(U){return j(U,lt)?{x:0,y:-1}:j(U,st)?{x:0,y:1}:j(U,dt)?{x:-1,y:0}:j(U,ct)?{x:1,y:0}:null}function _(U,Z){let Q=U[U.length-1];if(Q.x===Z.x){let tt=Z.y>Q.y?1:-1;for(let it=Q.y+tt;it!==Z.y+tt;it+=tt)U.push({x:Q.x,y:it});return}if(Q.y===Z.y){let tt=Z.x>Q.x?1:-1;for(let it=Q.x+tt;it!==Z.x+tt;it+=tt)U.push({x:it,y:Q.y});return}throw new Error(`appendStraightLine expects straight line, got from=(${Q.x},${Q.y}) to=(${Z.x},${Z.y})`)}function F(U,Z){if(Z.length<4)return  false;let Q=[];for(let tt=0;tt<Z.length;tt++){let it=Z[tt];if(it.x<0||it.y<0||it.x>=r.stride||it.y>=r.height||(Q.push(oe(r.stride,it)),!(le(it,U.routeFrom)||le(it,U.routeTo))&&r.blocked[Q[Q.length-1]]))return  false}for(let tt=1;tt<Q.length;tt++){let it=Q[tt-1],nt=Q[tt];if(!Wo(r,c,it,nt))return  false;if(i){let ot=ir(it,nt);if(i.segmentUsed[ot]&&!Ho(i,e.from.index+1,e.to.index+1,U.routeFromIdx,U.routeToIdx,it,nt,ot))return  false}}return  true}function I(U,Z){let Q=q(U.startDir),tt=q(U.endDir);if(!Q||!tt||Z<1)return null;let it={x:U.routeFrom.x+Q.x*Z,y:U.routeFrom.y+Q.y*Z},nt={x:U.routeTo.x+tt.x*Z,y:U.routeTo.y+tt.y*Z},ot=[{x:it.x,y:nt.y},{x:nt.x,y:it.y}];for(let ft of ot){let xt=[U.routeFrom];_(xt,it),_(xt,ft),_(xt,nt),_(xt,U.routeTo);let Tt=xt.filter((At,pt)=>pt===0||!le(At,xt[pt-1]));if(F(U,Tt)&&Qe(Tt).length>=4)return Tt}return null}if(l){let U=N.length>0?N:L;for(let Z of U)for(let Q=1;Q<=12;Q++){let tt=I(Z,Q);if(!tt)continue;e.startDir=Z.startDir,e.endDir=Z.endDir,e.path=Qe(tt);let it=tt.map(nt=>oe(r.stride,nt));if(i&&Qn(i,e,it),c&&tr(c,r,it),d==="relaxed"&&t.portUsage){let nt=e.startDir.x+e.startDir.y*3,ot=e.endDir.x+e.endDir.y*3;t.portUsage[e.from.index*9+nt]=(t.portUsage[e.from.index*9+nt]??0)+1,t.portUsage[e.to.index*9+ot]=(t.portUsage[e.to.index*9+ot]??0)+1;}return}}let S=d==="relaxed"&&t.config.useAscii,v=[kt,Ct,$t,Et],V=p([m,a,ct,dt,st,lt,...S?[kt,Ct,$t,Et]:[]]),z=p([g,h,ct,dt,st,lt,...S?[kt,Ct,$t,Et]:[]]),L=x(V,X),D=x(V,z),T=p([...V,...v]),G=p([...z,...v]),W=x(V,G),K=x(T,G);function B(U){return {maxX:Math.min(r.stride-1,n+U),maxY:Math.min(r.height-1,o+U)}}function O(U,Z=It){for(let Q of Z){let tt=B(Q),it=null;for(let nt of U){let ot=qn(r,nt.routeFromIdx,nt.routeToIdx,tt);if(!ot||l&&Bt(ot,r.stride)<4)continue;let ft=M(nt,ot);(!it||ft<it.cost)&&(it={candidate:nt,pathIdx:ot,cost:ft});}if(it)return it}return null}function C(U,Z){if(!i||i.usedCount===0)return null;let Q={segmentUsage:i,usedPoints:c,routeFromIdx:0,routeToIdx:0,edgeFromId:e.from.index+1,edgeToId:e.to.index+1};for(let tt of Z){let it=B(tt),nt=null;for(let ot of U){Q.routeFromIdx=ot.routeFromIdx,Q.routeToIdx=ot.routeToIdx;let ft=Jn(r,ot.routeFromIdx,ot.routeToIdx,it,Q);if(!ft||l&&Bt(ft,r.stride)<4)continue;let xt=M(ot,ft);(!nt||xt<nt.cost)&&(nt={candidate:ot,pathIdx:ft,cost:xt});}if(nt)return nt}return null}function E(U,Z,Q){if(!i)return null;let tt={segmentUsage:i,usedPoints:c,routeFromIdx:0,routeToIdx:0,edgeFromId:e.from.index+1,edgeToId:e.to.index+1,relaxedAllowEndSegmentReuse:Q};for(let it of Z){let nt=B(it),ot=null;for(let ft of U){tt.routeFromIdx=ft.routeFromIdx,tt.routeToIdx=ft.routeToIdx;let xt=Zn(r,ft.routeFromIdx,ft.routeToIdx,nt,tt);if(!xt||l&&Bt(xt.path,r.stride)<4)continue;let Tt=k(ft,xt);(!ot||Tt<ot.cost)&&(ot={candidate:ft,pathIdx:xt.path,cost:Tt});}if(ot)return ot}return null}let R=null;if(d==="relaxed"){let U=function(nt,ot){if(!nt)return ot;if(!ot)return nt;if(ot.cost<nt.cost)return ot;if(ot.cost>nt.cost)return nt;let ft=Bt(nt.pathIdx,r.stride);return Bt(ot.pathIdx,r.stride)<ft?ot:nt},Z=function(nt){function ot(pt){if(t.config.useAscii)return  false;let Ut=Te(r.stride,pt.candidate.routeFromIdx),xe=Te(r.stride,pt.candidate.routeToIdx),Ot=Math.abs(Ut.x-xe.x)+Math.abs(Ut.y-xe.y)+1,Pt=pt.pathIdx.length-Ot,be=pt.pathIdx.length>=28,jt=Bt(pt.pathIdx,r.stride)>=8,ze=Pt>=12;return be||jt||ze}let ft=E(N,_t,nt);if(ft){let pt=ft;if(Bt(pt.pathIdx,r.stride)-2>4){let Ot=x(V,[pt.candidate.endDir]),Pt=E(Ot,_t,nt);pt=U(pt,Pt);}if(c&&pt.pathIdx.length>=4){let Ot=false;for(let Pt=1;Pt<pt.pathIdx.length-1;Pt++){let be=pt.pathIdx[Pt],jt=c[be]??0;if(jt!==0&&(jt&jt-1)!==0){Ot=true;break}}if(Ot){let Pt=E(N,[Pe],nt);pt=U(pt,Pt);}}if(ot(pt)){let Ot=E(D,_t,nt);pt=U(pt,Ot);let Pt=E(D,It,nt);pt=U(pt,Pt);}return pt}let xt=E(L,_t,nt),Tt=xt?ot(xt)?E(D,_t,nt):null:E(D,_t,nt),At=U(xt,Tt);if(At&&ot(At)){let pt=E(D,It,nt);At=U(At,pt);}return At=At??E(N,It,nt)??E(L,It,nt)??E(D,It,nt),At},Q=function(nt,ot){return U(nt,ot)};let tt=Z(false),it=Z(true);if(R=Q(tt,it),!R){let nt=function(ot){let ft=E(W,_t,ot)??E(K,_t,ot);return ft=ft??E(W,It,ot)??E(K,It,ot),ft};R=nt(false)??nt(true);}}else !i||i.usedCount===0?R=O(N,_t):(R=C(N,_t)??C(L,_t)??C(D,_t),R=R??C(N,It)??C(L,It),R=R??C(D,It));if(!R&&d==="relaxed"&&s&&(e.__bm_used_unconstrained_fallback=true,R=O(N,_t)??O(L,_t)??O(D,_t)??O(W,_t)??O(K,It)),!R){e.startDir=m,e.endDir=g,e.path=[];return}if(e.startDir=R.candidate.startDir,e.endDir=R.candidate.endDir,e.path=Kn(R.pathIdx,r.stride).map(U=>Te(r.stride,U)),i&&Qn(i,e,R.pathIdx),c&&tr(c,r,R.pathIdx),d==="relaxed"&&t.portUsage){let U=e.startDir.x+e.startDir.y*3,Z=e.endDir.x+e.endDir.y*3;t.portUsage[e.from.index*9+U]=(t.portUsage[e.from.index*9+U]??0)+1,t.portUsage[e.to.index*9+Z]=(t.portUsage[e.to.index*9+Z]??0)+1;}}function ar(t,e){if(e.text.length===0||e.path.length<2)return;let r=mt(e.text),n=Ko(t),o=zo(t),i=e.path[0],c=null,s=[i,e.path[1]],l=0,d=false,m=null,g=-1;for(let M=1;M<e.path.length;M++){let A=e.path[M],w=[i,A],$=nr(t,w);d||($>=r?(s=w,d=true):$>l&&(l=$,s=w));let k=cr(t,e,w,e.text),P=k?n.some(N=>Vo(N,k)):false,X=k?o.some(N=>jo(k,N)):false;if(!P&&!X&&($>g&&(g=$,m=w),$>=r)){c=w;break}i=A;}c===null&&(c=m??s);let a=Math.min(c[0].x,c[1].x),h=Math.max(c[0].x,c[1].x),x=a+Math.floor((h-a)/2);if(t.config.routing==="relaxed"&&!t.config.useAscii){let M=new Set;for(let A of t.nodes)A.gridCoord&&(M.add(A.gridCoord.x),M.add(A.gridCoord.x+1),M.add(A.gridCoord.x+2));if(M.has(x)){let A=h-a;for(let w=1;w<=A;w++){let $=x-w;if($>=a&&$<=h&&!M.has($)){x=$;break}let k=x+w;if(k>=a&&k<=h&&!M.has(k)){x=k;break}}}}let f=t.columnWidth.get(x)??0,b=r+2,y=nr(t,c);if(y<b){let M=b-y;t.columnWidth.set(x,f+M);}e.labelLine=[c[0],c[1]];}function nr(t,e){let r=0,n=Math.min(e[0].x,e[1].x),o=Math.max(e[0].x,e[1].x);for(let i=n;i<=o;i++)r+=t.columnWidth.get(i)??0;return r}function rr(t,e,r){let n=t.offsetX;for(let d=0;d<r.x;d++)n+=t.columnWidth.get(d)??0;let o=t.offsetY;for(let d=0;d<r.y;d++)o+=t.rowHeight.get(d)??0;let i=t.columnWidth.get(r.x)??0,c=t.rowHeight.get(r.y)??0,s=Math.floor(i/2),l=Math.floor(c/2);if(e.path.length>=2){let d=e.path[0],m=e.path[1],g=e.path[e.path.length-1],a=e.path[e.path.length-2];if(r.x===d.x&&r.y===d.y||r.x===m.x&&r.y===m.y){let x=d.x===m.x,u=d.y===m.y;x&&e.startPortOffsetX!=null&&(s=e.startPortOffsetX),u&&e.startPortOffsetY!=null&&(l=e.startPortOffsetY);}if(r.x===g.x&&r.y===g.y||r.x===a.x&&r.y===a.y){let x=g.x===a.x,u=g.y===a.y;x&&e.endPortOffsetX!=null&&(s=e.endPortOffsetX),u&&e.endPortOffsetY!=null&&(l=e.endPortOffsetY);}}return s<0&&(s=0),l<0&&(l=0),i>0&&s>i-1&&(s=i-1),c>0&&l>c-1&&(l=c-1),{x:n+s,y:o+l}}function Uo(t,e){let r=t.offsetX;for(let o=0;o<e.x;o++)r+=t.columnWidth.get(o)??0;let n=t.offsetY;for(let o=0;o<e.y;o++)n+=t.rowHeight.get(o)??0;return {x:r,y:n}}function on(t,e){if(!e.gridCoord)return null;let r=e.gridCoord,n=0;for(let c=0;c<2;c++)n+=t.columnWidth.get(r.x+c)??0;let o=0;for(let c=0;c<2;c++)o+=t.rowHeight.get(r.y+c)??0;let i=Uo(t,r);return {minX:i.x,minY:i.y,maxX:i.x+n,maxY:i.y+o}}function jo(t,e){return t.y<e.minY||t.y>e.maxY?false:!(t.endX<e.minX||e.maxX<t.startX)}function zo(t){let e=[];for(let r of t.nodes){let n=on(t,r);n&&e.push(n);}return e}function cr(t,e,r,n){let o=mt(n);if(o<=0)return null;let i=rr(t,e,r[0]),c=rr(t,e,r[1]),s=Math.min(i.x,c.x),l=Math.max(i.x,c.x),d=Math.min(i.y,c.y),m=Math.max(i.y,c.y),g=s+Math.floor((l-s)/2),a=d+Math.floor((m-d)/2),h=g-Math.floor(o/2);return {y:a,startX:h,endX:h+o-1}}function Vo(t,e){return t.y!==e.y?false:!(t.endX<e.startX||e.endX<t.startX)}function Ko(t){let e=[];for(let r of t.edges){if(r.text.length===0||r.labelLine.length<2)continue;let n=cr(t,r,[r.labelLine[0],r.labelLine[1]],r.text);n&&e.push(n);}return e}function Dt(t,e,r){let n=0;if(t.columnStartX&&r.x>=0&&r.x<t.columnStartX.length)n=t.columnStartX[r.x]??0;else for(let d=0;d<r.x;d++)n+=t.columnWidth.get(d)??0;let o=0;if(t.rowStartY&&r.y>=0&&r.y<t.rowStartY.length)o=t.rowStartY[r.y]??0;else for(let d=0;d<r.y;d++)o+=t.rowHeight.get(d)??0;let i=t.columnWidth.get(r.x)??0,c=t.rowHeight.get(r.y)??0,s=Math.floor(i/2),l=Math.floor(c/2);if(e.path.length>=2){let d=e.path[0],m=e.path[1],g=e.path[e.path.length-1],a=e.path[e.path.length-2];if(r.x===d.x&&r.y===d.y||r.x===m.x&&r.y===m.y){let x=d.x===m.x,u=d.y===m.y;x&&e.startPortOffsetX!=null&&(s=e.startPortOffsetX),u&&e.startPortOffsetY!=null&&(l=e.startPortOffsetY);}if(r.x===g.x&&r.y===g.y||r.x===a.x&&r.y===a.y){let x=g.x===a.x,u=g.y===a.y;x&&e.endPortOffsetX!=null&&(s=e.endPortOffsetX),u&&e.endPortOffsetY!=null&&(l=e.endPortOffsetY);}}return s<0&&(s=0),l<0&&(l=0),i>0&&s>i-1&&(s=i-1),c>0&&l>c-1&&(l=c-1),{x:n+s+t.offsetX,y:o+l+t.offsetY}}function ln(t,e,r){return r.map(n=>Dt(t,e,n))}function ur(t,e){let r=t.gridCoord,n=e.config.useAscii,o=0;for(let h=0;h<2;h++)o+=e.columnWidth.get(r.x+h)??0;let i=0;for(let h=0;h<2;h++)i+=e.rowHeight.get(r.y+h)??0;let c={x:0,y:0},s={x:o,y:i},l=wt(Math.max(c.x,s.x),Math.max(c.y,s.y));if(n){for(let h=c.x+1;h<s.x;h++)l[h][c.y]="-";for(let h=c.x+1;h<s.x;h++)l[h][s.y]="-";for(let h=c.y+1;h<s.y;h++)l[c.x][h]="|";for(let h=c.y+1;h<s.y;h++)l[s.x][h]="|";l[c.x][c.y]="+",l[s.x][c.y]="+",l[c.x][s.y]="+",l[s.x][s.y]="+";}else {for(let h=c.x+1;h<s.x;h++)l[h][c.y]="\u2500";for(let h=c.x+1;h<s.x;h++)l[h][s.y]="\u2500";for(let h=c.y+1;h<s.y;h++)l[c.x][h]="\u2502";for(let h=c.y+1;h<s.y;h++)l[s.x][h]="\u2502";l[c.x][c.y]="\u250C",l[s.x][c.y]="\u2510",l[c.x][s.y]="\u2514",l[s.x][s.y]="\u2518";}let d=t.displayLabel,m=c.y+Math.floor(i/2),g=mt(d),a=c.x+Math.floor(o/2)-Math.ceil(g/2)+1;return bt(l,{x:a,y:m},d),l}function De(t,e,r=1){let n=0;for(let y of t)for(let M of y)n=Math.max(n,mt(M));let i=n+2*r+2,c=0;for(let y of t)c+=Math.max(y.length,1);let s=t.length-1,l=c+s+2,d=e?"-":"\u2500",m=e?"|":"\u2502",g=e?"+":"\u250C",a=e?"+":"\u2510",h=e?"+":"\u2514",p=e?"+":"\u2518",x=e?"+":"\u251C",u=e?"+":"\u2524",f=wt(i-1,l-1);f[0][0]=g;for(let y=1;y<i-1;y++)f[y][0]=d;f[i-1][0]=a,f[0][l-1]=h;for(let y=1;y<i-1;y++)f[y][l-1]=d;f[i-1][l-1]=p;for(let y=1;y<l-1;y++)f[0][y]=m,f[i-1][y]=m;let b=1;for(let y=0;y<t.length;y++){let M=t[y],A=M.length>0?M:[""];for(let w of A){let $=1+r;bt(f,{x:$,y:b},w),b++;}if(y<t.length-1){f[0][b]=x;for(let w=1;w<i-1;w++)f[w][b]=d;f[i-1][b]=u,b++;}}return f}function qo(t,e,r,n,o,i){let[c,s]=St(t),l=Math.max(e.x,r.x),d=Math.max(e.y,r.y);(l>c||d>s)&&Xt(t,l,d);let m=Lt(e,r),g=[],a=i?"-":"\u2500",h=i?"|":"\u2502",p=i?"\\":"\u2572",x=i?"/":"\u2571";if(j(m,lt))for(let u=e.y-n;u>=r.y-o;u--)g.push({x:e.x,y:u}),t[e.x][u]=h;else if(j(m,st))for(let u=e.y+n;u<=r.y+o;u++)g.push({x:e.x,y:u}),t[e.x][u]=h;else if(j(m,dt))for(let u=e.x-n;u>=r.x-o;u--)g.push({x:u,y:e.y}),t[u][e.y]=a;else if(j(m,ct))for(let u=e.x+n;u<=r.x+o;u++)g.push({x:u,y:e.y}),t[u][e.y]=a;else if(j(m,Ct))for(let u=e.x,f=e.y-n;u>=r.x-o&&f>=r.y-o;u--,f--)g.push({x:u,y:f}),t[u][f]=p;else if(j(m,kt))for(let u=e.x,f=e.y-n;u<=r.x+o&&f>=r.y-o;u++,f--)g.push({x:u,y:f}),t[u][f]=x;else if(j(m,Et))for(let u=e.x,f=e.y+n;u>=r.x-o&&f<=r.y+o;u--,f++)g.push({x:u,y:f}),t[u][f]=x;else if(j(m,$t))for(let u=e.x,f=e.y+n;u<=r.x+o&&f<=r.y+o;u++,f++)g.push({x:u,y:f}),t[u][f]=p;return g}function Jo(t,e){if(e.path.length<2){let d=Qt(t.canvas);return [d,d,d,d,d]}let[r,n,o]=Zo(t,e,e.path),i=Qo(t,e),c=ti(t,e,n[n.length-1],o[o.length-1]),s=ei(t,e,e.path),l=wt(0,0);return [r,i,c,s,l]}function hr(t,e){let c=new Map;if(e.path.length<3)return c;function s(d){return j(d,lt)?8:j(d,st)?4:j(d,dt)?2:j(d,ct)?1:0}function l(d){return j(d,lt)?4:j(d,st)?8:j(d,dt)?1:j(d,ct)?2:0}for(let d=1;d<e.path.length-1;d++){let m=e.path[d-1],g=e.path[d],a=e.path[d+1],h=Lt(m,g),p=Lt(g,a);if(j(h,p)||j(h,Gt)||j(p,Gt))continue;let x=Dt(t,e,g),u=`${x.x},${x.y}`,f=s(h)|l(p);f!==0&&c.set(u,(c.get(u)??0)|f);}return c}function mr(t,e){let r=[],n=new Set;function o(a){let h=`${a.x},${a.y}`;n.has(h)||(n.add(h),r.push(a));}function i(a){let h=`${a.x},${a.y}`;if(!n.has(h)){n.add(h),r.push(a);return}for(let p=0;p<r.length;p++){let x=r[p];if(x.x===a.x&&x.y===a.y){r.splice(p,1);break}}r.push(a);}if(e.path.length<2)return r;if(!t.config.useAscii){let a=Dt(t,e,e.path[0]),h=Lt(e.path[0],e.path[1]),p=dn(e,h,a);if((j(h,dt)||j(h,ct))&&p.y===a.y){let x=Math.min(p.x,a.x),u=Math.max(p.x,a.x);for(let f=x;f<=u;f++)o({x:f,y:a.y});}else if((j(h,lt)||j(h,st))&&p.x===a.x){let x=Math.min(p.y,a.y),u=Math.max(p.y,a.y);for(let f=x;f<=u;f++)o({x:a.x,y:f});}o(p);}let c=1,s=-1,l=null,d=null,m=null;function g(a,h,p){let x=a,u=a;if(j(p,lt)){let f=a.y-c,b=h.y-s;f>=b&&(x={x:a.x,y:f},u={x:a.x,y:b});}else if(j(p,st)){let f=a.y+c,b=h.y+s;f<=b&&(x={x:a.x,y:f},u={x:a.x,y:b});}else if(j(p,dt)){let f=a.x-c,b=h.x-s;f>=b&&(x={x:f,y:a.y},u={x:b,y:a.y});}else if(j(p,ct)){let f=a.x+c,b=h.x+s;f<=b&&(x={x:f,y:a.y},u={x:b,y:a.y});}else if(j(p,Ct)){let f=a.x,b=a.y-c,y=h.x-s,M=h.y-s;f>=y&&b>=M&&(x={x:f,y:b},u={x:y,y:M});}else if(j(p,kt)){let f=a.x,b=a.y-c,y=h.x+s,M=h.y-s;f<=y&&b>=M&&(x={x:f,y:b},u={x:y,y:M});}else if(j(p,Et)){let f=a.x,b=a.y+c,y=h.x-s,M=h.y+s;f>=y&&b<=M&&(x={x:f,y:b},u={x:y,y:M});}else if(j(p,$t)){let f=a.x,b=a.y+c,y=h.x+s,M=h.y+s;f<=y&&b<=M&&(x={x:f,y:b},u={x:y,y:M});}return [x,u]}for(let a=1;a<e.path.length;a++){let h=e.path[a-1],p=e.path[a],x=Dt(t,e,h),u=Dt(t,e,p);if(_e(x,u))continue;let f=Lt(h,p),[b,y]=g(x,u,f);if(l=b,d=y,m=f,j(f,lt))for(let M=x.y-c;M>=u.y-s;M--)o({x:x.x,y:M});else if(j(f,st))for(let M=x.y+c;M<=u.y+s;M++)o({x:x.x,y:M});else if(j(f,dt))for(let M=x.x-c;M>=u.x-s;M--)o({x:M,y:x.y});else if(j(f,ct))for(let M=x.x+c;M<=u.x+s;M++)o({x:M,y:x.y});else if(j(f,Ct))for(let M=x.x,A=x.y-c;M>=u.x-s&&A>=u.y-s;M--,A--)o({x:M,y:A});else if(j(f,kt))for(let M=x.x,A=x.y-c;M<=u.x+s&&A>=u.y-s;M++,A--)o({x:M,y:A});else if(j(f,Et))for(let M=x.x,A=x.y+c;M>=u.x-s&&A<=u.y+s;M--,A++)o({x:M,y:A});else if(j(f,$t))for(let M=x.x,A=x.y+c;M<=u.x+s&&A<=u.y+s;M++,A++)o({x:M,y:A});if(a<e.path.length-1){let M=Lt(p,e.path[a+1]);!j(f,M)&&!j(f,Gt)&&!j(M,Gt)&&o(Dt(t,e,p));}}{let a=e.path[e.path.length-1],h=e.path[e.path.length-2],p=m??Lt(h,a),x=d??Dt(t,e,a),u=l??x,f=Lt(u,x);(_e(u,x)||j(f,Gt))&&(f=p);let b=fn(e,f,x);if((j(f,dt)||j(f,ct))&&b.y===x.y){let y=Math.min(b.x,x.x)+1,M=Math.max(b.x,x.x)-1;for(let A=y;A<=M;A++)o({x:A,y:x.y});}else if((j(f,lt)||j(f,st))&&b.x===x.x){let y=Math.min(b.y,x.y)+1,M=Math.max(b.y,x.y)-1;for(let A=y;A<=M;A++)o({x:x.x,y:A});}i(b);}return r}function Zo(t,e,r){let n=Qt(t.canvas),o=r[0],i=[],c=[];for(let s=1;s<r.length;s++){let l=r[s],d=Dt(t,e,o),m=Dt(t,e,l);if(_e(d,m)){o=l;continue}let g=Lt(o,l),a=qo(n,d,m,1,-1,t.config.useAscii);a.length===0&&a.push(d),i.push(a),c.push(g),o=l;}return [n,i,c]}function Qo(t,e){let r=Qt(t.canvas);if(t.config.useAscii||e.path.length<2)return r;let n=Lt(e.path[0],e.path[1]),o=Dt(t,e,e.path[0]),i=dn(e,n,o);return pr(r,o,i,n,t.config.useAscii),j(n,lt)?r[i.x][i.y]="\u2534":j(n,st)?r[i.x][i.y]="\u252C":j(n,dt)?r[i.x][i.y]="\u2524":j(n,ct)&&(r[i.x][i.y]="\u251C"),r}function ti(t,e,r,n){let o=Qt(t.canvas);if(r.length===0)return o;let i=r[0],c=r[r.length-1],s=Lt(i,c);(r.length===1||j(s,Gt))&&(s=n);let l;t.config.useAscii?j(s,lt)?l="^":j(s,st)?l="v":j(s,dt)?l="<":j(s,ct)?l=">":j(n,lt)?l="^":j(n,st)?l="v":j(n,dt)?l="<":j(n,ct)?l=">":l="*":j(s,lt)?l="\u25B2":j(s,st)?l="\u25BC":j(s,dt)?l="\u25C4":j(s,ct)?l="\u25BA":j(s,kt)?l="\u25E5":j(s,Ct)?l="\u25E4":j(s,$t)?l="\u25E2":j(s,Et)?l="\u25E3":j(n,lt)?l="\u25B2":j(n,st)?l="\u25BC":j(n,dt)?l="\u25C4":j(n,ct)?l="\u25BA":j(n,kt)?l="\u25E5":j(n,Ct)?l="\u25E4":j(n,$t)?l="\u25E2":j(n,Et)?l="\u25E3":l="\u25CF";let d=fn(e,s,c);return pr(o,c,d,s,t.config.useAscii),o[d.x][d.y]=l,o}function dn(t,e,r){let n=t.from.drawingCoord,o=t.from.drawing;if(!n||!o)return r;let[i,c]=St(o),s=n.x,l=n.x+i,d=n.y,m=n.y+c;return j(e,dt)?{x:s,y:Kt(r.y,d,m)}:j(e,ct)?{x:l,y:Kt(r.y,d,m)}:j(e,lt)?{x:Kt(r.x,s,l),y:d}:j(e,st)?{x:Kt(r.x,s,l),y:m}:r}function fn(t,e,r){let n=t.to.drawingCoord,o=t.to.drawing;if(!n||!o)return r;let[i,c]=St(o),s=n.x,l=n.x+i,d=n.y,m=n.y+c;return j(e,dt)?{x:l+1,y:Kt(r.y,d,m)}:j(e,ct)?{x:s-1,y:Kt(r.y,d,m)}:j(e,lt)?{x:Kt(r.x,s,l),y:m+1}:j(e,st)?{x:Kt(r.x,s,l),y:d-1}:r}function Kt(t,e,r){return t<e?e:t>r?r:t}function pr(t,e,r,n,o){let i=Math.max(e.x,r.x),c=Math.max(e.y,r.y);i>=0&&c>=0&&Xt(t,i,c);let[s,l]=St(t),d=o?"-":"\u2500",m=o?"|":"\u2502",g=(x,u,f)=>{x<0||u<0||x>s||u>l||(t[x][u]=f);},a=(x,u)=>o?"+":x==="left"&&u==="down"?"\u2510":x==="left"&&u==="up"?"\u2518":x==="right"&&u==="down"?"\u250C":x==="right"&&u==="up"?"\u2514":"+",h=(x,u,f)=>{let b=Math.min(u,f),y=Math.max(u,f);for(let M=b;M<=y;M++)g(M,x,d);},p=(x,u,f)=>{let b=Math.min(u,f),y=Math.max(u,f);for(let M=b;M<=y;M++)g(x,M,m);};if(j(n,dt)||j(n,ct)){if(e.y===r.y){h(e.y,e.x,r.x);return}let x={x:e.x,y:r.y};p(e.x,e.y,x.y),h(x.y,x.x,r.x);let u=e.y<x.y?"up":"down",f=r.x<x.x?"left":"right";g(x.x,x.y,a(f,u));return}if(j(n,lt)||j(n,st)){if(e.x===r.x){p(e.x,e.y,r.y);return}if(e.y===r.y){let b=j(n,st)?r.y-1:r.y+1,y={x:e.x,y:b},M={x:r.x,y:b};p(e.x,e.y,y.y),h(b,e.x,r.x),p(r.x,M.y,r.y);let A=e.y<y.y?"up":"down",w=r.x<y.x?"left":"right";g(y.x,y.y,a(w,A));let $=r.y<M.y?"up":"down",k=e.x<M.x?"left":"right";g(M.x,M.y,a(k,$));return}let x={x:r.x,y:e.y};h(e.y,e.x,x.x),p(x.x,x.y,r.y);let u=e.x<x.x?"left":"right",f=r.y<x.y?"up":"down";g(x.x,x.y,a(u,f));}}function ei(t,e,r){let n=Qt(t.canvas);for(let o=1;o<r.length-1;o++){let i=r[o],c=Dt(t,e,i),s=Lt(r[o-1],i),l=Lt(i,r[o+1]),d;t.config.useAscii?d="+":j(s,ct)&&j(l,st)||j(s,lt)&&j(l,dt)?d="\u2510":j(s,ct)&&j(l,lt)||j(s,st)&&j(l,dt)?d="\u2518":j(s,dt)&&j(l,st)||j(s,lt)&&j(l,ct)?d="\u250C":j(s,dt)&&j(l,lt)||j(s,st)&&j(l,ct)?d="\u2514":d="+";let[m,g]=St(n);(c.x>m||c.y>g)&&Xt(n,Math.max(c.x,m),Math.max(c.y,g)),n[c.x][c.y]=d;}return n}function ni(t,e,r){let n=Qt(t.canvas);if(e.text.length===0)return n;let o=ln(t,e,e.labelLine),i=[],c=xr(t,e);c&&i.push(c);let s=br(t,e);return s&&i.push(s),gr(n,o,e.text,i,r,t.config.useAscii),n}function lr(t){return t==="\u25B2"||t==="\u25BC"||t==="\u25C4"||t==="\u25BA"||t==="\u25E5"||t==="\u25E4"||t==="\u25E2"||t==="\u25E3"||t==="\u25CF"}function ri(t){return t==="^"||t==="v"||t==="<"||t===">"||t==="*"}function dr(t){return t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2574"||t==="\u2575"||t==="\u2576"||t==="\u2577"}function oi(t){return t==="+"}function fe(t,e){return e?t==="|"||t==="+":t==="\u2502"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2577"||t==="\u2575"}function ue(t,e){return e?t==="-"||t==="+":t==="\u2500"||t==="\u253C"||t==="\u252C"||t==="\u2534"||t==="\u251C"||t==="\u2524"||t==="\u250C"||t==="\u2510"||t==="\u2514"||t==="\u2518"||t==="\u2574"||t==="\u2576"}function ii(t,e,r,n){let[o,i]=St(t);if(e<0||r<0||e>o||r>i)return  false;let c=t[e][r],s=e>0?t[e-1][r]:" ",l=e<o?t[e+1][r]:" ",d=r>0?t[e][r-1]:" ",m=r<i?t[e][r+1]:" ",g=fe(d,n)&&fe(m,n),a=ue(s,n)&&ue(l,n);return !!((c===" "||ue(c,n))&&g||(c===" "||fe(c,n))&&a)}function si(t,e,r,n){let[o,i]=St(t);if(e<0||r<0||e>o||r>i)return  false;let c=t[e][r];if(n){if(ri(c)||oi(c))return  true}else if(lr(c)||dr(c))return  true;if(ii(t,e,r,n)||!n&&c!==" "&&!fe(c,n)&&!ue(c,n))return  true;if(!n){let s=e>0?t[e-1][r]:" ",l=e<o?t[e+1][r]:" ",d=g=>g!==" "&&!lr(g)&&!dr(g)&&!fe(g,n)&&!ue(g,n);if((c===" "||fe(c,n)||ue(c,n))&&(d(s)||d(l)))return  true}return  false}function an(t,e,r,n){for(let o of n)if(o.y===t&&o.x>=e&&o.x<=r)return  true;return  false}function fr(t,e,r,n,o){for(let i=r;i<=n;i++)if(si(t,i,e,o))return  true;return  false}function cn(t){let{desiredStartX:e,minStartX:r,maxStartX:n,isValid:o}=t;if(o(e))return e;let i=Math.max(0,n-r);for(let c=1;c<=i;c++){let s=e-c;if(s>=r&&o(s))return s;let l=e+c;if(l<=n&&o(l))return l}return e}function gr(t,e,r,n=[],o,i=false,c={}){if(e.length<2)return null;let s=Math.min(e[0].x,e[1].x),l=Math.max(e[0].x,e[1].x),d=Math.min(e[0].y,e[1].y),m=Math.max(e[0].y,e[1].y),g=s+Math.floor((l-s)/2),a=d+Math.floor((m-d)/2),h=mt(r),p=g-Math.floor(h/2);if(o){let[u,f]=St(o),b=0,y=Math.max(b,u-h+1);if(p<b&&(p=b),p>y&&(p=y),c.verticalOnlyStack){let P=p+h-1,X=Y=>!(an(Y,p,P,n)||fr(o,Y,p,P,i));if(X(a))return bt(t,{x:p,y:a},r),{startX:p,y:a,width:h};let N=Math.max(a,f-a);for(let Y=1;Y<=N;Y++){let q=a-Y;if(q>=0&&X(q))return bt(t,{x:p,y:q},r),{startX:p,y:q,width:h};let _=a+Y;if(_<=f&&X(_))return bt(t,{x:p,y:_},r),{startX:p,y:_,width:h}}return i?(bt(t,{x:p,y:a},r),{startX:p,y:a,width:h}):null}let M=e[0].y===e[1].y,A=s,w=l-h+1,$=M&&w>=A?Math.max(b,A):b,k=M&&w>=A?Math.min(y,w):y;if(k>=$){p<$&&(p=$),p>k&&(p=k);let P=N=>{let Y=N+h-1;return !(an(a,N,Y,n)||fr(o,a,N,Y,i))},X=p;if(p=cn({desiredStartX:X,minStartX:$,maxStartX:k,isValid:P}),!i){if(!P(p)&&M&&w>=A){let Y=Math.max(0,u-h+1);if(Y>=0){let q=Math.min(Math.max(X,0),Y),_=cn({desiredStartX:q,minStartX:0,maxStartX:Y,isValid:P});P(_)&&(p=_);}}if(!P(p))return null}}return bt(t,{x:p,y:a},r),{startX:p,y:a,width:h}}if(e[0].y===e[1].y){let u=s,f=l-h+1;if(f>=u){p<u&&(p=u),p>f&&(p=f);for(let b of n){if(b.y!==a)continue;let y=p+h-1;if(!(b.x>=p&&b.x<=y))continue;let A=b.x-h,w=b.x+1,$=[];A>=u&&A<=f&&$.push(A),w>=u&&w<=f&&$.push(w),$.length!==0&&($.sort((k,P)=>Math.abs(k-p)-Math.abs(P-p)),p=$[0]);}p=cn({desiredStartX:p,minStartX:u,maxStartX:f,isValid:b=>{let y=b+h-1;return !an(a,b,y,n)}});}}return bt(t,{x:p,y:a},r),{startX:p,y:a,width:h}}function ai(t,e,r,n){let[,o]=St(t),i=e.startX+Math.floor((e.width-1)/2),c=e.y,s=r.y-c;if(s===0)return;let l=n?"|":"\u2502",d=s>0?c+1:c-1;if(d<0||d>o)return;let m=t[i][d];(m===""||m===" ")&&(t[i][d]=l);}function xr(t,e){if(e.path.length<2)return null;let r=e.path[e.path.length-1],n=e.path[e.path.length-2],o=Lt(n,r),i=Dt(t,e,r),c=i;return j(o,lt)&&(c={x:i.x,y:i.y+1}),j(o,st)&&(c={x:i.x,y:i.y-1}),j(o,dt)&&(c={x:i.x+1,y:i.y}),j(o,ct)&&(c={x:i.x-1,y:i.y}),fn(e,o,c)}function br(t,e){if(e.path.length<2)return null;let r=Lt(e.path[0],e.path[1]),n=Dt(t,e,e.path[0]);return dn(e,r,n)}function ci(t,e){let r=t.maxX-t.minX,n=t.maxY-t.minY;if(r<=0||n<=0)return wt(0,0);let o={x:0,y:0},i={x:r,y:n},c=wt(r,n);if(e.config.useAscii){for(let s=o.x+1;s<i.x;s++)c[s][o.y]="-";for(let s=o.x+1;s<i.x;s++)c[s][i.y]="-";for(let s=o.y+1;s<i.y;s++)c[o.x][s]="|";for(let s=o.y+1;s<i.y;s++)c[i.x][s]="|";c[o.x][o.y]="+",c[i.x][o.y]="+",c[o.x][i.y]="+",c[i.x][i.y]="+";}else {for(let s=o.x+1;s<i.x;s++)c[s][o.y]="\u2500";for(let s=o.x+1;s<i.x;s++)c[s][i.y]="\u2500";for(let s=o.y+1;s<i.y;s++)c[o.x][s]="\u2502";for(let s=o.y+1;s<i.y;s++)c[i.x][s]="\u2502";c[o.x][o.y]="\u250C",c[i.x][o.y]="\u2510",c[o.x][i.y]="\u2514",c[i.x][i.y]="\u2518";}return c}function li(t,e){let r=t.maxX-t.minX,n=t.maxY-t.minY;if(r<=0||n<=0)return [wt(0,0),{x:0,y:0}];let o=wt(r,n),i=1,c=Math.floor(r/2)-Math.floor(mt(t.name)/2);return c<1&&(c=1),bt(o,{x:c,y:i},t.name),[o,{x:t.minX,y:t.minY}]}function di(t){function e(n){return n.parent===null?0:1+e(n.parent)}let r=[...t];return r.sort((n,o)=>e(n)-e(o)),r}function fi(t){let e=new Map,r=new Map;for(let n of t){if(n.text.length===0)continue;let o=`${n.from.name}\u2192${n.to.name}`,i=e.get(o);i?i.push(n):e.set(o,[n]);}for(let n of e.values()){let o=`${n[0].from.name}\u2192${n[0].to.name}`;if(!(n.length<=1))for(let i=0;i<n.length;i++)r.set(n[i],{key:o,rank:i,size:n.length});}return r}function ui(t,e,r){let n=new Map;if(e.size===0)return n;let o=new Map;for(let s of t.edges){let l=e.get(s);if(!l)continue;let d=ln(t,s,s.labelLine),m=o.get(l.key);m?m.push({edge:s,stack:l,baseLine:d}):o.set(l.key,[{edge:s,stack:l,baseLine:d}]);}let[i,c]=St(r);for(let s of o.values()){if(s.length===0)continue;let l=0;for(let u of s)if(u.baseLine.length>=2){let f=Math.min(u.baseLine[0].y,u.baseLine[1].y),b=Math.max(u.baseLine[0].y,u.baseLine[1].y);l+=f+Math.floor((b-f)/2);}let d=Math.round(l/s.length),m=[];for(let u of s){if(u.baseLine.length<2)continue;let f=Math.min(u.baseLine[0].x,u.baseLine[1].x),b=Math.max(u.baseLine[0].x,u.baseLine[1].x);m.push(f+Math.floor((b-f)/2));}let g=[...m].sort((u,f)=>u-f),a=g.length>0?g[Math.floor(g.length/2)]:0;a<0&&(a=0);let h=s.reduce((u,f)=>Math.max(u,mt(f.edge.text)),1),p=a-Math.floor(h/2),x=Math.max(0,i-h+1);p<0&&(p=0),p>x&&(p=x);for(let u of s){let f=u.baseLine;if(f.length<2){n.set(u.edge,f);continue}let b=(u.stack.size-1)/2,y=Math.round((u.stack.rank-b)*2),M=d+y;M<0&&(M=0),M>c&&(M=c);let A=mt(u.edge.text),w=p+Math.floor(A/2);w<0&&(w=0),w>i&&(w=i),n.set(u.edge,[{x:w,y:M},{x:w,y:M}]);}}return n}function yr(t){let e=t.config.useAscii,r=di(t.subgraphs);for(let g of r){let a=ci(g,t),h={x:g.minX,y:g.minY};t.canvas=Yt(t.canvas,h,e,a);}for(let g of t.nodes)!g.drawn&&g.drawingCoord&&g.drawing&&(t.canvas=Yt(t.canvas,g.drawingCoord,e,g.drawing),g.drawn=true);let n=[],o=[],i=[],c=[];for(let g of t.edges){let[a,h,p,x,u]=Jo(t,g);n.push(a),o.push(x),i.push(p),c.push(h);}let s={x:0,y:0};t.canvas=Yt(t.canvas,s,e,...n),t.canvas=Yt(t.canvas,s,e,...o),t.canvas=Yt(t.canvas,s,e,...i),t.canvas=Yt(t.canvas,s,e,...c);let l=t.config.routing==="relaxed"&&!t.config.useAscii,d=l?fi(t.edges):new Map,m=l?ui(t,d,t.canvas):new Map;if(l)for(let g of t.edges){if(g.text.length===0)continue;let a=ln(t,g,g.labelLine),h=m.get(g)??a,p=[],x=d.has(g),u=xr(t,g);u&&p.push(u);let f=br(t,g);f&&p.push(f);let b=gr(t.canvas,h,g.text,p,t.canvas,e,{verticalOnlyStack:x});if(x&&b&&a.length>=2){Math.min(a[0].x,a[1].x);Math.max(a[0].x,a[1].x);let A=Math.min(a[0].y,a[1].y),w=Math.max(a[0].y,a[1].y),$={y:A+Math.floor((w-A)/2)};ai(t.canvas,b,$,e);}}else {let g=[],a=t.canvas;for(let h of t.edges)g.push(ni(t,h,a));t.canvas=Yt(t.canvas,s,e,...g);}for(let g of t.subgraphs){if(g.nodes.length===0)continue;let[a,h]=li(g);t.canvas=Yt(t.canvas,h,e,a);}return t.canvas}function hi(t,e,r){let n=e,o=0;if(t.columnStartX&&n.x>=0&&n.x<t.columnStartX.length)o=t.columnStartX[n.x]??0;else for(let l=0;l<n.x;l++)o+=t.columnWidth.get(l)??0;let i=0;if(t.rowStartY&&n.y>=0&&n.y<t.rowStartY.length)i=t.rowStartY[n.y]??0;else for(let l=0;l<n.y;l++)i+=t.rowHeight.get(l)??0;let c=t.columnWidth.get(n.x)??0,s=t.rowHeight.get(n.y)??0;return {x:o+Math.floor(c/2)+t.offsetX,y:i+Math.floor(s/2)+t.offsetY}}function qt(t,e,r,n=4){if(t.grid.has(Je(r)))return t.config.graphDirection==="LR"?qt(t,e,{x:r.x,y:r.y+n},n):t.config.routing==="relaxed"&&!t.config.useAscii?qt(t,e,{x:r.x,y:r.y+n},n):qt(t,e,{x:r.x+n,y:r.y},n);for(let o=0;o<3;o++)for(let i=0;i<3;i++){let c={x:r.x+o,y:r.y+i};t.grid.set(Je(c),e);}return e.gridCoord=r,r}function mi(t,e){let r=e.gridCoord,n=t.config.boxBorderPadding,o=[1,2*n+mt(e.displayLabel),1],i=[1,1+2*n,1];for(let c=0;c<o.length;c++){let s=r.x+c,l=t.columnWidth.get(s)??0;t.columnWidth.set(s,Math.max(l,o[c]));}for(let c=0;c<i.length;c++){let s=r.y+c,l=t.rowHeight.get(s)??0;t.rowHeight.set(s,Math.max(l,i[c]));}if(r.x>0){let c=t.columnWidth.get(r.x-1)??0;t.columnWidth.set(r.x-1,Math.max(c,t.config.paddingX));}if(r.y>0){let c=t.config.paddingY;pi(t,e)&&(c+=4);let s=t.rowHeight.get(r.y-1)??0;t.rowHeight.set(r.y-1,Math.max(s,c));}}function un(t,e){if(e.length===0)return;function r(o){t.columnWidth.has(o.x)||t.columnWidth.set(o.x,Math.floor(t.config.paddingX/2)),t.rowHeight.has(o.y)||t.rowHeight.set(o.y,Math.floor(t.config.paddingY/2));}let n=e[0];r(n);for(let o=1;o<e.length;o++){let i=e[o];if(n.x===i.x){let c=i.y>n.y?1:-1;for(let s=n.y;s!==i.y;s+=c)r({x:n.x,y:s}),r({x:n.x,y:s+c});}else if(n.y===i.y){let c=i.x>n.x?1:-1;for(let s=n.x;s!==i.x;s+=c)r({x:s,y:n.y}),r({x:s+c,y:n.y});}else r(i);n=i;}}function Re(t,e){return t.subgraphs.some(r=>r.nodes.includes(e))}function hn(t,e){for(let r of t.subgraphs)if(r.nodes.includes(e))return r;return null}function pi(t,e){let r=hn(t,e);if(!r)return  false;let n=false;for(let o of t.edges)if(o.to===e&&hn(t,o.from)!==r){n=true;break}if(!n)return  false;for(let o of r.nodes){if(o===e||!o.gridCoord)continue;let i=false;for(let c of t.edges)if(c.to===o&&hn(t,c.from)!==r){i=true;break}if(i&&o.gridCoord.y<e.gridCoord.y)return  false}return  true}function wr(t,e){if(e.nodes.length===0)return;let r=1e6,n=1e6,o=-1e6,i=-1e6;for(let l of e.children)wr(t,l),l.nodes.length>0&&(r=Math.min(r,l.minX),n=Math.min(n,l.minY),o=Math.max(o,l.maxX),i=Math.max(i,l.maxY));for(let l of e.nodes){if(!l.drawingCoord||!l.drawing)continue;let d=l.drawingCoord.x,m=l.drawingCoord.y,g=d+l.drawing.length-1,a=m+l.drawing[0].length-1;r=Math.min(r,d),n=Math.min(n,m),o=Math.max(o,g),i=Math.max(i,a);}let c=2,s=2;e.minX=r-c,e.minY=n-c-s,e.maxX=o+c,e.maxY=i+c;}function gi(t){let r=t.subgraphs.filter(n=>n.parent===null&&n.nodes.length>0);for(let n=0;n<r.length;n++)for(let o=n+1;o<r.length;o++){let i=r[n],c=r[o];i.minX<c.maxX&&i.maxX>c.minX&&(i.maxY>=c.minY-1&&i.minY<c.minY?c.minY=i.maxY+1+1:c.maxY>=i.minY-1&&c.minY<i.minY&&(i.minY=c.maxY+1+1)),i.minY<c.maxY&&i.maxY>c.minY&&(i.maxX>=c.minX-1&&i.minX<c.minX?c.minX=i.maxX+1+1:c.maxX>=i.minX-1&&c.minX<i.minX&&(i.minX=c.maxX+1+1));}}function xi(t){for(let e of t.subgraphs)wr(t,e);gi(t);}function bi(t){if(t.subgraphs.length===0)return;let e=0,r=0;for(let i of t.subgraphs)e=Math.min(e,i.minX),r=Math.min(r,i.minY);let n=-e,o=-r;if(!(n===0&&o===0)){t.offsetX=n,t.offsetY=o;for(let i of t.subgraphs)i.minX+=n,i.minY+=o,i.maxX+=n,i.maxY+=o;for(let i of t.nodes)i.drawingCoord&&(i.drawingCoord.x+=n,i.drawingCoord.y+=o);}}function Mr(t){let e=[0,1,2,3,4];for(let r of e)if(yi(t),Ci(t,r))return}function yi(t){t.grid=new Map,t.columnWidth=new Map,t.rowHeight=new Map,t.canvas=wt(0,0),t.offsetX=0,t.offsetY=0,t.columnStartX=void 0,t.rowStartY=void 0,t.portUsage=t.config.routing==="relaxed"?new Uint16Array(t.nodes.length*9):void 0;for(let e of t.nodes)e.gridCoord=null,e.drawingCoord=null,e.drawing=null,e.drawn=false;for(let e of t.edges)e.path=[],e.labelLine=[],e.startDir={x:0,y:0},e.endDir={x:0,y:0},e.startPortOffsetX=void 0,e.startPortOffsetY=void 0,e.endPortOffsetX=void 0,e.endPortOffsetY=void 0;for(let e of t.subgraphs)e.minX=0,e.minY=0,e.maxX=0,e.maxY=0;}function wi(t){if(t.config.routing!=="relaxed")return 4;let r=t.nodes.length;if(r===0)return 4;let n=1,o=new Map;for(let s of t.edges){let l=s.from.index*r+s.to.index,d=(o.get(l)??0)+1;o.set(l,d),d>n&&(n=d);}let i=0,c=new Uint16Array(r);for(let s of t.edges){let l=(c[s.from.index]??0)+1;c[s.from.index]=l,l>i&&(i=l);}return n>=5||i>=8?8:n>=3||i>=4?6:4}function Mi(t){let e=0;for(let s of t.columnWidth.keys())e=Math.max(e,s);let r=0;for(let s of t.rowHeight.keys())r=Math.max(r,s);let n=new Int32Array(e+2),o=0;for(let s=0;s<n.length;s++)n[s]=o,o+=t.columnWidth.get(s)??0;let i=new Int32Array(r+2),c=0;for(let s=0;s<i.length;s++)i[s]=c,c+=t.rowHeight.get(s)??0;t.columnStartX=n,t.rowStartY=i;}function Ci(t,e){let r=t.config.graphDirection,n=wi(t),o=new Array(Math.max(100,(t.nodes.length+2)*n+16)).fill(0),i=[];if(t.config.routing==="strict"){let S=new Set;for(let v of t.nodes){S.has(v.name)||i.push(v),S.add(v.name);for(let V of mn(t,v))S.add(V.name);}}else {let S=new Set;for(let v of t.edges)S.add(v.to.name);i=t.nodes.filter(v=>!S.has(v.name)),i.length===0&&t.nodes.length>0&&(i=[t.nodes[0]]);}let c=false,s=false;for(let S of i)Re(t,S)?mn(t,S).length>0&&(s=true):c=true;let l=r==="LR"&&c&&s,d,m=[];l?(d=i.filter(S=>!Re(t,S)),m=i.filter(S=>Re(t,S))):d=i;for(let S of d){let v=r==="LR"?{x:0+e,y:o[0]+e}:{x:o[0]+e,y:0+e};qt(t,t.nodes[S.index],v,n),o[0]=o[0]+n;}if(l&&m.length>0){let S=n;for(let v of m){let V=r==="LR"?{x:S+e,y:o[S]+e}:{x:o[S]+e,y:S+e};qt(t,t.nodes[v.index],V,n),o[S]=o[S]+n;}}let g=true;for(;g;){g=false;for(let z of t.nodes){let L=z.gridCoord;if(!L)continue;let T=(r==="LR"?L.x-e:L.y-e)+n,G=o[T]??0;for(let W of mn(t,z)){if(W.gridCoord!==null)continue;if(r!=="LR"&&t.config.routing==="relaxed"&&!t.config.useAscii&&t.edges.some(O=>O.from===W&&O.to===z)){let O=T+n,C={x:L.x,y:O+e};qt(t,t.nodes[W.index],C,n);let E=L.x-e,R=o[O]??0;o[O]=Math.max(R,E+n),g=true;continue}let K=r==="LR"?{x:T+e,y:G+e}:{x:G+e,y:T+e};qt(t,t.nodes[W.index],K,n),o[T]=G+n,G=o[T],g=true;}}if(g)continue;let S=t.nodes.find(z=>z.gridCoord===null);if(!S)break;let v=l&&Re(t,S)?n:0,V=r==="LR"?{x:v+e,y:o[v]+e}:{x:o[v]+e,y:v+e};qt(t,t.nodes[S.index],V,n),o[v]=o[v]+n,g=true;}if(t.nodes.some(S=>S.gridCoord===null))return  false;let a=0,h=0;for(let S of t.nodes)S.gridCoord&&(a=Math.max(a,S.gridCoord.x+2),h=Math.max(h,S.gridCoord.y+2));let p=a+Pe+1,x=h+Pe+1,u=Vn(p,x);for(let S of t.nodes)if(S.gridCoord)for(let v=0;v<3;v++)for(let V=0;V<3;V++){let z=S.gridCoord.x+v,L=S.gridCoord.y+V;u.blocked[z+L*p]=1;}let f=or(u.blocked.length),b=new Uint8Array(u.blocked.length);for(let S of t.nodes)mi(t,S);function y(){let S=new Map;for(let B of t.nodes)S.set(B.name,0);for(let B of t.edges)S.set(B.to.name,(S.get(B.to.name)??0)+1);let v=new Map;for(let B of t.edges){let O=v.get(B.from.name);O?O.push(B):v.set(B.from.name,[B]);}let V=[];for(let B of t.nodes)(S.get(B.name)??0)===0&&V.push(B);V.length===0&&t.nodes.length>0&&V.push(t.nodes[0]);let z=new Set,L=new Set,D=[],T=B=>{z.has(B.name)||(z.add(B.name),D.push(B));};for(let B of V)T(B);let G=0;for(;;){for(;G<D.length;){let O=D[G++],C=v.get(O.name)??[];for(let E of C)z.has(E.to.name)||(L.add(E),T(E.to));}if(z.size>=t.nodes.length)break;let B=t.nodes.find(O=>!z.has(O.name));if(!B)break;T(B);}let W=[],K=[];for(let B of t.edges)L.has(B)?W.push(B):K.push(B);return W.concat(K)}let M=t.config.routing==="relaxed"&&!t.config.useAscii?y():t.edges;function A(S){return `${S.from.name}\u2192${S.to.name}`}function w(S,v){v.path=S.path.map(V=>({x:V.x,y:V.y})),v.startDir={x:S.startDir.x,y:S.startDir.y},v.endDir={x:S.endDir.x,y:S.endDir.y},v.startPortOffsetX=void 0,v.startPortOffsetY=void 0,v.endPortOffsetX=void 0,v.endPortOffsetY=void 0;}let $=t.config.routing==="relaxed"&&!t.config.useAscii,k=new Map;if($)for(let S of M){let v=A(S),V=k.get(v);V?V.push(S):k.set(v,[S]);}let P=new Map,X=e>=4;for(let S of M){if($){let v=A(S);if((k.get(v)??[]).length>=2){let z=P.get(v);if(!z){sn(t,S,u,a,h,f,b,X),S.path.length>=2&&P.set(v,S),un(t,S.path);continue}if(z.path.length>=2){w(z,S),un(t,S.path);continue}}}sn(t,S,u,a,h,f,b,X),un(t,S.path);}if(t.edges.some(S=>S.path.length<2))return  false;if(!t.config.useAscii&&t.config.routing==="relaxed"){let S=function(z,L,D){if(z.x===1&&z.y===0)return "up";if(z.x===1&&z.y===2)return "down";if(z.x===0&&z.y===1)return "left";if(z.x===2&&z.y===1)return "right";if(!L||!D)return null;let T=D.x-L.x,G=D.y-L.y,W=Math.abs(T)>=Math.abs(G);return z.x===2&&z.y===0?W?"right":"up":z.x===0&&z.y===0?W?"left":"up":z.x===2&&z.y===2?W?"right":"down":z.x===0&&z.y===2?W?"left":"down":null},v=function(z,L){if(z<=0)return [];if(L<=0)return [];if(z===1)return [Math.floor(L/2)];let D=[];for(let T=0;T<z;T++)D.push(Math.floor(T*(L-1)/(z-1)));return D};let V=t.nodes.map(()=>({up:[],down:[],left:[],right:[]}));for(let z=0;z<t.edges.length;z++){let L=t.edges[z];if(L.path.length<2)continue;let D=S(L.startDir,L.from.gridCoord,L.to.gridCoord),T=S(L.endDir,L.to.gridCoord,L.from.gridCoord);if(D){let G=L.to.gridCoord,W=D==="left"||D==="right"?G?.y??0:G?.x??0;V[L.from.index][D].push({edge:L,kind:"start",otherSort:W,edgeOrder:z});}if(T){let G=L.from.gridCoord,W=T==="left"||T==="right"?G?.y??0:G?.x??0;V[L.to.index][T].push({edge:L,kind:"end",otherSort:W,edgeOrder:z});}}for(let z of t.nodes){let B=function(et){if(et<=3)return 0;let rt=Math.floor((et-3+1)/2);return Math.min(4,rt)};if(!z.gridCoord)continue;let L=V[z.index],D=t.config.boxBorderPadding,T=2*D+mt(z.displayLabel),G=1+2*D,W=Math.max(L.up.length,L.down.length),K=Math.max(L.left.length,L.right.length),O=Math.max(T,W+B(W)),C=Math.max(G,K+B(K)),E=z.gridCoord.x+1,R=z.gridCoord.y+1,H=t.columnWidth.get(E)??0;O>H&&t.columnWidth.set(E,O);let J=t.rowHeight.get(R)??0;C>J&&t.rowHeight.set(R,C);}for(let z of t.nodes){let K=function(B,O){if(B.length===0)return;B.sort((R,H)=>R.otherSort-H.otherSort||R.edgeOrder-H.edgeOrder);let C=O==="left"||O==="right"?W:G,E=v(B.length,C);for(let R=0;R<B.length;R++){let H=B[R],J=E[R];if(B.length===1&&C>=2){let et=O==="left"||O==="up"?-1:1;H.kind==="start"&&(et=-et);let rt=J+et;rt<0?J=0:rt>C-1?J=C-1:J=rt;}O==="left"||O==="right"?H.kind==="start"?H.edge.startPortOffsetY=J:H.edge.endPortOffsetY=J:H.kind==="start"?H.edge.startPortOffsetX=J:H.edge.endPortOffsetX=J;}};if(!z.gridCoord)continue;let L=V[z.index],D=z.gridCoord.x+1,T=z.gridCoord.y+1,G=t.columnWidth.get(D)??0,W=t.rowHeight.get(T)??0;K(L.left,"left"),K(L.right,"right"),K(L.up,"up"),K(L.down,"down");}}for(let S of t.edges)ar(t,S);Mi(t);for(let S of t.nodes)S.drawingCoord=hi(t,S.gridCoord),S.drawing=ur(S,t);return Un(t.canvas,t.columnWidth,t.rowHeight),xi(t),bi(t),true}function Si(t,e){return t.edges.filter(r=>r.from.name===e.name)}function mn(t,e){return Si(t,e).map(r=>r.to)}function Oe(t){let e={actors:[],messages:[],blocks:[],notes:[]},r=new Set,n=[];for(let o=1;o<t.length;o++){let i=t[o],c=i.match(/^(participant|actor)\s+(\S+?)(?:\s+as\s+(.+))?$/);if(c){let a=c[1],h=c[2],p=c[3]?.trim()??h;r.has(h)||(r.add(h),e.actors.push({id:h,label:p,type:a}));continue}let s=i.match(/^Note\s+(left of|right of|over)\s+([^:]+):\s*(.+)$/i);if(s){let a=s[1].toLowerCase(),h=s[2].trim(),p=s[3].trim(),x=h.split(",").map(f=>f.trim());for(let f of x)ve(e,r,f);let u="over";a==="left of"?u="left":a==="right of"&&(u="right"),e.notes.push({actorIds:x,text:p,position:u,afterIndex:e.messages.length-1});continue}let l=i.match(/^(loop|alt|opt|par|critical|break|rect)\s*(.*)$/);if(l){let a=l[1],h=l[2]?.trim()??"";n.push({type:a,label:h,startIndex:e.messages.length,dividers:[]});continue}let d=i.match(/^(else|and)\s*(.*)$/);if(d&&n.length>0){let a=d[2]?.trim()??"";n[n.length-1].dividers.push({index:e.messages.length,label:a});continue}if(i==="end"&&n.length>0){let a=n.pop();e.blocks.push({type:a.type,label:a.label,startIndex:a.startIndex,endIndex:Math.max(e.messages.length-1,a.startIndex),dividers:a.dividers});continue}let m=i.match(/^(\S+?)\s*(--?>?>|--?[)x]|--?>>|--?>)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(m){let a=m[1],h=m[2],p=m[3],x=m[4],u=m[5].trim();ve(e,r,a),ve(e,r,x);let f=h.startsWith("--")?"dashed":"solid",b=h.includes(">>")||h.includes("x")?"filled":"open",y={from:a,to:x,label:u,lineStyle:f,arrowHead:b};p==="+"&&(y.activate=true),p==="-"&&(y.deactivate=true),e.messages.push(y);continue}let g=i.match(/^(\S+?)\s*(->>|-->>|-\)|--\)|-x|--x|->|-->)\s*([+-]?)(\S+?)\s*:\s*(.+)$/);if(g){let a=g[1],h=g[2],p=g[3],x=g[4],u=g[5].trim();ve(e,r,a),ve(e,r,x);let f=h.startsWith("--")?"dashed":"solid",b=h.includes(">>")||h.includes("x")?"filled":"open",y={from:a,to:x,label:u,lineStyle:f,arrowHead:b};p==="+"&&(y.activate=true),p==="-"&&(y.deactivate=true),e.messages.push(y);continue}}return e}function ve(t,e,r){e.has(r)||(e.add(r),t.actors.push({id:r,label:r,type:"participant"}));}function Cr(t,e){let r=t.split(`
`).map(L=>L.trim()).filter(L=>L.length>0&&!L.startsWith("%%")),n=Oe(r);if(n.actors.length===0)return "";let o=e.useAscii,i=o?"-":"\u2500",c=o?"|":"\u2502",s=o?"+":"\u250C",l=o?"+":"\u2510",d=o?"+":"\u2514",m=o?"+":"\u2518",g=o?"+":"\u252C",a=o?"+":"\u2534",h=o?"+":"\u251C",p=o?"+":"\u2524",x=new Map;n.actors.forEach((L,D)=>x.set(L.id,D));let u=1,b=n.actors.map(L=>mt(L.label)+2*u+2).map(L=>Math.ceil(L/2)),y=3,M=new Array(Math.max(n.actors.length-1,0)).fill(0);for(let L of n.messages){let D=x.get(L.from),T=x.get(L.to);if(D===T)continue;let G=Math.min(D,T),W=Math.max(D,T),K=mt(L.label)+4,B=W-G,O=Math.ceil(K/B);for(let C=G;C<W;C++)M[C]=Math.max(M[C],O);}let A=[b[0]];for(let L=1;L<n.actors.length;L++){let D=Math.max(b[L-1]+b[L]+2,M[L-1]+2,10);A[L]=A[L-1]+D;}let w=[],$=[],k=new Map,P=new Map,X=new Map,N=[],Y=y;for(let L=0;L<n.messages.length;L++){for(let G=0;G<n.blocks.length;G++)n.blocks[G].startIndex===L&&(Y+=2,k.set(G,Y-1));for(let G=0;G<n.blocks.length;G++)for(let W=0;W<n.blocks[G].dividers.length;W++)n.blocks[G].dividers[W].index===L&&(Y+=1,X.set(`${G}:${W}`,Y),Y+=1);Y+=1;let D=n.messages[L];D.from===D.to?($[L]=Y+1,w[L]=Y,Y+=3):($[L]=Y,w[L]=Y+1,Y+=2);for(let G=0;G<n.notes.length;G++)if(n.notes[G].afterIndex===L){Y+=1;let W=n.notes[G],K=W.text.split("\\n"),B=Math.max(...K.map(R=>mt(R)))+4,O=K.length+2,C=x.get(W.actorIds[0])??0,E;if(W.position==="left")E=A[C]-B-1;else if(W.position==="right")E=A[C]+2;else if(W.actorIds.length>=2){let R=x.get(W.actorIds[1])??C;E=Math.floor((A[C]+A[R])/2)-Math.floor(B/2);}else E=A[C]-Math.floor(B/2);E=Math.max(0,E),N.push({x:E,y:Y,width:B,height:O,lines:K}),Y+=O;}for(let G=0;G<n.blocks.length;G++)n.blocks[G].endIndex===L&&(Y+=1,P.set(G,Y),Y+=1);}Y+=1;let q=Y,_=q+y,F=A[A.length-1]??0,I=b[b.length-1]??0,S=F+I+2;for(let L=0;L<n.messages.length;L++){let D=n.messages[L];if(D.from===D.to){let T=x.get(D.from),G=A[T]+6+2+mt(D.label);S=Math.max(S,G+1);}}for(let L of N)S=Math.max(S,L.x+L.width+1);let v=wt(S,_-1);function V(L,D,T){let G=mt(T)+2*u+2,W=L-Math.floor(G/2);v[W][D]=s;for(let B=1;B<G-1;B++)v[W+B][D]=i;v[W+G-1][D]=l,v[W][D+1]=c,v[W+G-1][D+1]=c;let K=W+1+u;bt(v,{x:K,y:D+1},T),v[W][D+2]=d;for(let B=1;B<G-1;B++)v[W+B][D+2]=i;v[W+G-1][D+2]=m;}for(let L=0;L<n.actors.length;L++){let D=A[L];for(let T=y;T<=q;T++)v[D][T]=c;}for(let L=0;L<n.actors.length;L++){let D=n.actors[L];V(A[L],0,D.label),V(A[L],q,D.label),o||(v[A[L]][y-1]=g,v[A[L]][q]=a);}for(let L=0;L<n.messages.length;L++){let D=n.messages[L],T=x.get(D.from),G=x.get(D.to),W=A[T],K=A[G],B=T===G,O=D.lineStyle==="dashed",C=D.arrowHead==="filled",E=O?o?".":"\u254C":i;if(B){let R=w[L],H=Math.max(4,4);v[W][R]=h;for(let rt=W+1;rt<W+H;rt++)v[rt][R]=E;v[W+H][R]=o?"+":"\u2510",v[W+H][R+1]=c;let J=W+H+2;bt(v,{x:J,y:R+1},D.label);let et=C?o?"<":"\u25C0":o?"<":"\u25C1";v[W][R+2]=et;for(let rt=W+1;rt<W+H;rt++)v[rt][R+2]=E;v[W+H][R+2]=o?"+":"\u2518";}else {let R=$[L],H=w[L],J=W<K,rt=Math.floor((W+K)/2)-Math.floor(mt(D.label)/2);if(bt(v,{x:Math.max(0,rt),y:R},D.label),J){for(let Z=W+1;Z<K;Z++)v[Z][H]=E;let U=C?o?">":"\u25B6":o?">":"\u25B7";v[K][H]=U;}else {for(let Z=K+1;Z<W;Z++)v[Z][H]=E;let U=C?o?"<":"\u25C0":o?"<":"\u25C1";v[K][H]=U;}}}for(let L=0;L<n.blocks.length;L++){let D=n.blocks[L],T=k.get(L),G=P.get(L);if(T===void 0||G===void 0)continue;let W=S,K=0;for(let E=D.startIndex;E<=D.endIndex&&!(E>=n.messages.length);E++){let R=n.messages[E],H=x.get(R.from)??0,J=x.get(R.to)??0;W=Math.min(W,A[Math.min(H,J)]),K=Math.max(K,A[Math.max(H,J)]);}let B=Math.max(0,W-4),O=Math.min(S-1,K+4);v[B][T]=s;for(let E=B+1;E<O;E++)v[E][T]=i;v[O][T]=l;let C=D.label?`${D.type} [${D.label}]`:D.type;bt(v,{x:B+1,y:T},Se(C,O-(B+1))),v[B][G]=d;for(let E=B+1;E<O;E++)v[E][G]=i;v[O][G]=m;for(let E=T+1;E<G;E++)v[B][E]=c,v[O][E]=c;for(let E=0;E<D.dividers.length;E++){let R=X.get(`${L}:${E}`);if(R===void 0)continue;let H=z();v[B][R]=h;for(let et=B+1;et<O;et++)v[et][R]=H;v[O][R]=p;let J=D.dividers[E].label;if(J){let et=`[${J}]`;bt(v,{x:B+1,y:R},Se(et,O-(B+1)));}}}for(let L of N){Xt(v,L.x+L.width,L.y+L.height),v[L.x][L.y]=s;for(let T=1;T<L.width-1;T++)v[L.x+T][L.y]=i;v[L.x+L.width-1][L.y]=l;for(let T=0;T<L.lines.length;T++){let G=L.y+1+T;v[L.x][G]=c,v[L.x+L.width-1][G]=c,bt(v,{x:L.x+2,y:G},L.lines[T]);}let D=L.y+L.height-1;v[L.x][D]=d;for(let T=1;T<L.width-1;T++)v[L.x+T][D]=i;v[L.x+L.width-1][D]=m;}return Ft(v);function z(){return o?"-":"\u254C"}}function Ne(t){let e={classes:[],relationships:[],namespaces:[]},r=new Map,n=null,o=null,i=0;for(let c=1;c<t.length;c++){let s=t[c];if(o&&i>0){if(s==="}"){i--,i===0&&(o=null);continue}let p=s.match(/^<<(\w+)>>$/);if(p){o.annotation=p[1];continue}let x=Sr(s);x&&(x.isMethod?o.methods.push(x.member):o.attributes.push(x.member));continue}let l=s.match(/^namespace\s+(\S+)\s*\{$/);if(l){n={name:l[1],classIds:[]};continue}if(s==="}"&&n){e.namespaces.push(n),n=null;continue}let d=s.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*\{$/);if(d){let p=d[1],x=d[2],u=he(r,p);x&&(u.label=`${p}<${x}>`),o=u,i=1,n&&n.classIds.push(p);continue}let m=s.match(/^class\s+(\S+?)(?:\s*~(\w+)~)?\s*$/);if(m){let p=m[1],x=m[2],u=he(r,p);x&&(u.label=`${p}<${x}>`),n&&n.classIds.push(p);continue}let g=s.match(/^class\s+(\S+?)\s*\{\s*<<(\w+)>>\s*\}$/);if(g){let p=he(r,g[1]);p.annotation=g[2];continue}let a=s.match(/^(\S+?)\s*:\s*(.+)$/);if(a){let p=a[2];if(!p.match(/<\|--|--|\*--|o--|-->|\.\.>|\.\.\|>/)){let x=he(r,a[1]),u=Sr(p);u&&(u.isMethod?x.methods.push(u.member):x.attributes.push(u.member));continue}}let h=vi(s);if(h){he(r,h.from),he(r,h.to),e.relationships.push(h);continue}}return e.classes=[...r.values()],e}function he(t,e){let r=t.get(e);return r||(r={id:e,label:e,attributes:[],methods:[]},t.set(e,r)),r}function Sr(t){let e=t.trim().replace(/;$/,"");if(!e)return null;let r="",n=e;/^[+\-#~]/.test(n)&&(r=n[0],n=n.slice(1).trim());let o=n.match(/^(.+?)\(([^)]*)\)(?:\s*(.+))?$/);if(o){let m=o[1].trim(),g=o[3]?.trim(),a=m.endsWith("$")||n.includes("$"),h=m.endsWith("*")||n.includes("*");return {member:{visibility:r,name:m.replace(/[$*]$/,""),type:g||void 0,isStatic:a,isAbstract:h},isMethod:true}}let i=n.split(/\s+/),c,s;i.length>=2?(s=i[0],c=i.slice(1).join(" ")):c=i[0]??n;let l=c.endsWith("$"),d=c.endsWith("*");return {member:{visibility:r,name:c.replace(/[$*]$/,""),type:s||void 0,isStatic:l,isAbstract:d},isMethod:false}}function vi(t){let e=t.match(/^(\S+?)\s+(?:"([^"]*?)"\s+)?(<\|--|<\|\.\.|\*--|o--|-->|--\*|--o|--|>\s*|\.\.>|\.\.\|>|--)\s+(?:"([^"]*?)"\s+)?(\S+?)(?:\s*:\s*(.+))?$/);if(!e)return null;let r=e[1],n=e[2]||void 0,o=e[3].trim(),i=e[4]||void 0,c=e[5],s=e[6]?.trim()||void 0,l=ki(o);return l?{from:r,to:c,type:l.type,markerAt:l.markerAt,label:s,fromCardinality:n,toCardinality:i}:null}function ki(t){switch(t){case "<|--":return {type:"inheritance",markerAt:"from"};case "<|..":return {type:"realization",markerAt:"from"};case "*--":return {type:"composition",markerAt:"from"};case "--*":return {type:"composition",markerAt:"to"};case "o--":return {type:"aggregation",markerAt:"from"};case "--o":return {type:"aggregation",markerAt:"to"};case "-->":return {type:"association",markerAt:"to"};case "..>":return {type:"dependency",markerAt:"to"};case "..|>":return {type:"realization",markerAt:"to"};case "--":return {type:"association",markerAt:"to"};default:return null}}function vr(t){let e=t.visibility||"",r=t.type?`: ${t.type}`:"";return `${e}${t.name}${r}`}function Ei(t){let e=[];t.annotation&&e.push(`<<${t.annotation}>>`),e.push(t.label);let r=t.attributes.map(vr),n=t.methods.map(vr);return r.length===0&&n.length===0?[e]:n.length===0?[e,r]:[e,r,n]}function $i(t,e){return {type:t,markerAt:e,dashed:t==="dependency"||t==="realization"}}function me(t,e,r){switch(t){case "inheritance":case "realization":return r==="down"?e?"^":"\u25B3":r==="up"?e?"v":"\u25BD":r==="left"?e?">":"\u25C1":e?"<":"\u25B7";case "composition":return e?"*":"\u25C6";case "aggregation":return e?"o":"\u25C7";case "association":case "dependency":return r==="down"?e?"v":"\u25BC":r==="up"?e?"^":"\u25B2":r==="left"?e?"<":"\u25C0":e?">":"\u25B6"}}function kr(t,e){let r=t.split(`
`).map(I=>I.trim()).filter(I=>I.length>0&&!I.startsWith("%%")),n=Ne(r);if(n.classes.length===0)return "";let o=e.useAscii,i=n.relationships.reduce((I,S)=>Math.max(I,S.label?mt(` ${S.label} `):0),0),c=Math.max(4,Math.ceil(i/2)+1),s=3,l=new Map,d=new Map,m=new Map;for(let I of n.classes){let S=Ei(I);l.set(I.id,S);let v=0;for(let D of S)for(let T of D)v=Math.max(v,mt(T));let V=v+4,z=0;for(let D of S)z+=Math.max(D.length,1);let L=z+(S.length-1)+2;d.set(I.id,V),m.set(I.id,L);}let g=new Map;for(let I of n.classes)g.set(I.id,I);let a=new Map,h=new Map;for(let I of n.relationships){let S=I.type==="inheritance"||I.type==="realization",v=S&&I.markerAt==="to"?I.to:I.from,V=S&&I.markerAt==="to"?I.from:I.to;a.has(V)||a.set(V,new Set),a.get(V).add(v),h.has(v)||h.set(v,new Set),h.get(v).add(V);}let p=new Map,u=n.classes.filter(I=>!a.has(I.id)||a.get(I.id).size===0).map(I=>I.id);for(let I of u)p.set(I,0);let f=n.classes.length-1,b=0;for(;b<u.length;){let I=u[b++],S=h.get(I);if(S)for(let v of S){let V=(p.get(I)??0)+1;V>f||(!p.has(v)||p.get(v)<V)&&(p.set(v,V),u.push(v));}}for(let I of n.classes)p.has(I.id)||p.set(I.id,0);let y=Math.max(...p.values(),0),M=Array.from({length:y+1},()=>[]);for(let I of n.classes)M[p.get(I.id)].push(I.id);let A=new Map,w=0;for(let I=0;I<=y;I++){let S=M[I];if(S.length===0)continue;let v=0,V=0;for(let z of S){let L=g.get(z),D=d.get(z),T=m.get(z);A.set(z,{cls:L,sections:l.get(z),x:v,y:w,width:D,height:T}),v+=D+c,V=Math.max(V,T);}w+=V+s;}let $=0;for(let I of n.relationships){if(!I.label)continue;let S=A.get(I.from),v=A.get(I.to);if(!S||!v)continue;let V=S.x+Math.floor(S.width/2),z=v.x+Math.floor(v.width/2),L=Math.floor((V+z)/2),D=` ${I.label} `,T=L-Math.floor(mt(D)/2);$=Math.min($,T);}let k=$<0?-$:0;if(k>0)for(let I of A.values())I.x+=k;let P=0,X=0;for(let I of A.values())P=Math.max(P,I.x+I.width),X=Math.max(X,I.y+I.height);P+=4,X+=2;let N=wt(P-1,X-1);for(let I of A.values()){let S=De(I.sections,o);for(let v=0;v<S.length;v++)for(let V=0;V<S[0].length;V++){let z=S[v][V];if(z!==" "){let L=I.x+v,D=I.y+V;L<P&&D<X&&(N[L][D]=z);}}}let Y=o?"-":"\u2500",q=o?"|":"\u2502",_=o?".":"\u254C",F=o?":":"\u250A";for(let I of n.relationships){let S=A.get(I.from),v=A.get(I.to);if(!S||!v)continue;let V=$i(I.type,I.markerAt),z=V.dashed?_:Y,L=V.dashed?F:q,D=S.x+Math.floor(S.width/2),T=S.y+S.height-1,G=v.x+Math.floor(v.width/2),W=v.y;if(T<W){let K=T+Math.floor((W-T)/2);for(let B=T+1;B<=K;B++)B<X&&(N[D][B]=L);if(D!==G){let B=Math.min(D,G),O=Math.max(D,G);for(let C=B;C<=O;C++)C<P&&K<X&&(N[C][K]=z);!o&&K<X&&(D<G?(N[D][K]="\u2514",N[G][K]="\u2510"):(N[D][K]="\u2518",N[G][K]="\u250C"));}for(let B=K+1;B<W;B++)B<X&&(N[G][B]=L);if(V.markerAt==="to"){let B=me(V.type,o,"down"),O=W-1;if(O>=0&&O<X)for(let C=0;C<B.length;C++){let E=G-Math.floor(B.length/2)+C;E>=0&&E<P&&(N[E][O]=B[C]);}}if(V.markerAt==="from"){let B=me(V.type,o,"down"),O=T+1;if(O<X)for(let C=0;C<B.length;C++){let E=D-Math.floor(B.length/2)+C;E>=0&&E<P&&(N[E][O]=B[C]);}}}else if(v.y+v.height-1<S.y){let K=S.y,B=v.y+v.height-1,O=B+Math.floor((K-B)/2);for(let C=K-1;C>=O;C--)C>=0&&C<X&&(N[D][C]=L);if(D!==G){let C=Math.min(D,G),E=Math.max(D,G);for(let R=C;R<=E;R++)R<P&&O>=0&&O<X&&(N[R][O]=z);!o&&O>=0&&O<X&&(D<G?(N[D][O]="\u250C",N[G][O]="\u2518"):(N[D][O]="\u2510",N[G][O]="\u2514"));}for(let C=O-1;C>B;C--)C>=0&&C<X&&(N[G][C]=L);if(V.markerAt==="from"){let C=me(V.type,o,"up"),E=K-1;if(E>=0&&E<X)for(let R=0;R<C.length;R++){let H=D-Math.floor(C.length/2)+R;H>=0&&H<P&&(N[H][E]=C[R]);}}if(V.markerAt==="to"){let E=V.type==="inheritance"||V.type==="realization"?"down":"up",R=me(V.type,o,E),H=B+1;if(H<X)for(let J=0;J<R.length;J++){let et=G-Math.floor(R.length/2)+J;et>=0&&et<P&&(N[et][H]=R[J]);}}}else {let K=Math.max(T,v.y+v.height-1)+2;Xt(N,P,K+1);for(let C=T+1;C<=K;C++)N[D][C]=L;let B=Math.min(D,G),O=Math.max(D,G);for(let C=B;C<=O;C++)N[C][K]=z;for(let C=K-1;C>=v.y+v.height;C--)N[G][C]=L;if(V.markerAt==="from"){let C=me(V.type,o,"down"),E=T+1;if(E<X)for(let R=0;R<C.length;R++){let H=D-Math.floor(C.length/2)+R;H>=0&&H<P&&(N[H][E]=C[R]);}}if(V.markerAt==="to"){let C=me(V.type,o,"up"),E=v.y+v.height;if(E<X)for(let R=0;R<C.length;R++){let H=G-Math.floor(C.length/2)+R;H>=0&&H<P&&(N[H][E]=C[R]);}}}if(I.label){let K=` ${I.label} `,B=Math.floor((D+G)/2),O;if(T<W)O=Math.floor((T+1+W-1)/2);else if(v.y+v.height-1<S.y){let E=v.y+v.height-1;O=Math.floor((E+1+S.y-1)/2);}else O=Math.max(T,v.y+v.height-1)+2;let C=B-Math.floor(mt(K)/2);O>=0&&O<X&&bt(N,{x:Math.max(0,C),y:O},K);}}return Ft(N)}function Xe(t){let e={entities:[],relationships:[]},r=new Map,n=null;for(let o=1;o<t.length;o++){let i=t[o];if(n){if(i==="}"){n=null;continue}let l=Ai(i);l&&n.attributes.push(l);continue}let c=i.match(/^(\S+)\s*\{$/);if(c){let l=c[1];n=pn(r,l);continue}let s=Li(i);if(s){pn(r,s.entity1),pn(r,s.entity2),e.relationships.push(s);continue}}return e.entities=[...r.values()],e}function pn(t,e){let r=t.get(e);return r||(r={id:e,label:e,attributes:[]},t.set(e,r)),r}function Ai(t){let e=t.match(/^(\S+)\s+(\S+)(?:\s+(.+))?$/);if(!e)return null;let r=e[1],n=e[2],o=e[3]?.trim()??"",i=[],c,s=o.match(/"([^"]*)"/);s&&(c=s[1]);let l=o.replace(/"[^"]*"/,"").trim();for(let d of l.split(/\s+/)){let m=d.toUpperCase();(m==="PK"||m==="FK"||m==="UK")&&i.push(m);}return {type:r,name:n,keys:i,comment:c}}function Li(t){let e=t.match(/^(\S+)\s+([|o}{]+(?:--|\.\.)[|o}{]+)\s+(\S+)\s*:\s*(.+)$/);if(!e)return null;let r=e[1],n=e[2],o=e[3],i=e[4].trim(),c=n.match(/^([|o}{]+)(--|\.\.?)([|o}{]+)$/);if(!c)return null;let s=c[1],l=c[2],d=c[3],m=Er(s),g=Er(d),a=l==="--";return !m||!g?null:{entity1:r,entity2:o,cardinality1:m,cardinality2:g,label:i,identifying:a}}function Er(t){let e=t.split("").sort().join("");return e==="||"?"one":e==="o|"?"zero-one":e==="|}"||e==="{|"?"many":e==="{o"||e==="o{"?"zero-many":null}function _i(t){return `${t.keys.length>0?t.keys.join(",")+" ":"   "}${t.type} ${t.name}`}function Ti(t){let e=[t.label],r=t.attributes.map(_i);return r.length===0?[e]:[e,r]}function Be(t,e){if(e)switch(t){case "one":return "||";case "zero-one":return "o|";case "many":return "}|";case "zero-many":return "o{"}else switch(t){case "one":return "\u2551";case "zero-one":return "o\u2551";case "many":return "\u255F";case "zero-many":return "o\u255F"}}function $r(t,e){let r=t.split(`
`).map(k=>k.trim()).filter(k=>k.length>0&&!k.startsWith("%%")),n=Xe(r);if(n.entities.length===0)return "";let o=e.useAscii,i=n.relationships.reduce((k,P)=>Math.max(k,mt(P.label)),0),c=Math.max(6,i),s=4,l=new Map,d=new Map,m=new Map;for(let k of n.entities){let P=Ti(k);l.set(k.id,P);let X=0;for(let _ of P)for(let F of _)X=Math.max(X,mt(F));let N=X+4,Y=0;for(let _ of P)Y+=Math.max(_.length,1);let q=Y+(P.length-1)+2;d.set(k.id,N),m.set(k.id,q);}let g=Math.max(2,Math.ceil(Math.sqrt(n.entities.length))),a=new Map,h=0,p=0,x=0,u=0;for(let k of n.entities){let P=d.get(k.id),X=m.get(k.id);u>=g&&(p+=x+s,h=0,x=0,u=0),a.set(k.id,{entity:k,sections:l.get(k.id),x:h,y:p,width:P,height:X}),h+=P+c,x=Math.max(x,X),u++;}let f=0,b=0;for(let k of a.values())f=Math.max(f,k.x+k.width),b=Math.max(b,k.y+k.height);f+=4,b+=2;let y=wt(f-1,b-1);for(let k of a.values()){let P=De(k.sections,o);for(let X=0;X<P.length;X++)for(let N=0;N<P[0].length;N++){let Y=P[X][N];if(Y!==" "){let q=k.x+X,_=k.y+N;q<f&&_<b&&(y[q][_]=Y);}}}let M=o?"-":"\u2500",A=o?"|":"\u2502",w=o?".":"\u254C",$=o?":":"\u250A";for(let k of n.relationships){let P=a.get(k.entity1),X=a.get(k.entity2);if(!P||!X)continue;let N=k.identifying?M:w,Y=k.identifying?A:$,q=P.x+Math.floor(P.width/2),_=P.y+Math.floor(P.height/2),F=X.x+Math.floor(X.width/2),I=X.y+Math.floor(X.height/2);if(Math.abs(_-I)<Math.max(P.height,X.height)){let[v,V]=q<F?[P,X]:[X,P],[z,L]=q<F?[k.cardinality1,k.cardinality2]:[k.cardinality2,k.cardinality1],D=v.x+v.width,T=V.x-1,G=v.y+Math.floor(v.height/2);for(let B=D;B<=T;B++)B<f&&(y[B][G]=N);let W=Be(z,o);for(let B=0;B<W.length;B++){let O=D+B;O<f&&(y[O][G]=W[B]);}let K=Be(L,o);for(let B=0;B<K.length;B++){let O=T-K.length+1+B;O>=0&&O<f&&(y[O][G]=K[B]);}if(k.label){let B=Math.floor((D+T)/2),O=Math.max(D,B-Math.floor(mt(k.label)/2)),C=G-1;if(C>=0){let E=Math.max(0,T-O+1),R=Se(k.label,E);bt(y,{x:O,y:C},R);}}}else {let[v,V]=_<I?[P,X]:[X,P],[z,L]=_<I?[k.cardinality1,k.cardinality2]:[k.cardinality2,k.cardinality1],D=v.y+v.height,T=V.y-1,G=v.x+Math.floor(v.width/2);for(let C=D;C<=T;C++)C<b&&(y[G][C]=Y);let W=V.x+Math.floor(V.width/2);if(G!==W){let C=Math.floor((D+T)/2),E=Math.min(G,W),R=Math.max(G,W);for(let H=E;H<=R;H++)H<f&&C<b&&(y[H][C]=N);for(let H=C+1;H<=T;H++)H<b&&(y[W][H]=Y);}let K=Be(z,o);if(D<b)for(let C=0;C<K.length;C++){let E=G-Math.floor(K.length/2)+C;E>=0&&E<f&&(y[E][D]=K[C]);}let B=G!==W?W:G,O=Be(L,o);if(T>=0&&T<b)for(let C=0;C<O.length;C++){let E=B-Math.floor(O.length/2)+C;E>=0&&E<f&&(y[E][T]=O[C]);}if(k.label){let C=Math.floor((D+T)/2),E=G+2;C>=0&&bt(y,{x:E,y:C},k.label);}}}return Ft(y)}function Tr(t){let e=t.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(e)?"sequence":/^classdiagram\s*$/.test(e)?"class":/^erdiagram\s*$/.test(e)?"er":"flowchart"}function Ir(t){let e=t.useAscii??false,r=t.routing??(e?"strict":"relaxed");return {useAscii:e,paddingX:t.paddingX??5,paddingY:t.paddingY??5,boxBorderPadding:t.boxBorderPadding??1,graphDirection:"TD",routing:r}}function Pr(t,e){let r=Me(t);r.direction==="LR"||r.direction==="RL"?e.graphDirection="LR":e.graphDirection="TD";let n=jn(r,e);Mr(n),yr(n);let o=r.direction==="BT";if(o&&Hn(n.canvas),!n.config.useAscii){let i=new Map;for(let c of n.edges)for(let[s,l]of hr(n,c))i.set(s,l);Wn(n.canvas,i);}return {graph:n,flippedVertically:o}}function Pi(t){let e=t.nodes.filter(n=>n.drawingCoord&&n.drawing).map(n=>{let[o,i]=St(n.drawing);return {id:n.name,label:n.displayLabel,box:{x:n.drawingCoord.x,y:n.drawingCoord.y,width:o+1,height:i+1}}}),r=t.edges.map(n=>({from:n.from.name,to:n.to.name,label:n.text,path:mr(t,n)}));return {nodes:e,edges:r}}function Di(t,e){return {nodes:t.nodes.map(r=>({...r,box:{...r.box,y:e-(r.box.y+r.box.height-1)}})),edges:t.edges.map(r=>({...r,path:r.path.map(n=>({x:n.x,y:e-n.y}))}))}}function Ge(t,e={}){let r=Ir(e);switch(Tr(t)){case "sequence":return Cr(t,r);case "class":return kr(t,r);case "er":return $r(t,r);default:{let{graph:o}=Pr(t,r);return Ft(o.canvas)}}}function gn(t,e={}){let r=Ir(e);switch(Tr(t)){case "sequence":case "class":case "er":return {text:Ge(t,e),meta:{nodes:[],edges:[]}};default:{let{graph:o,flippedVertically:i}=Pr(t,r),c=Ft(o.canvas),s=Pi(o);if(!i)return {text:c,meta:s};let[,l]=St(o.canvas);return {text:c,meta:Di(s,l)}}}}var $e=Ve(Ye());function yt(t,e,r){let n=r>=600?.58:r>=500?.55:.52;return t.length*e*n}function Fe(t,e){return t.length*e*.6}var at={nodeLabel:13,edgeLabel:11,groupHeader:12},ut={nodeLabel:500,edgeLabel:400,groupHeader:600},Rr=8,pe={horizontal:16,vertical:10,diamondExtra:24},gt={outerBox:1,innerBox:.75,connector:.75},vt="0.35em",ge={width:8,height:4.8};function Wt(t,e,r,n){return {x:t-r/2,y:e-n/2}}function ke(t,e,r,n,o){let i=t.x-e,c=t.y-r;if(Math.abs(i)<.5&&Math.abs(c)<.5)return t;let s=1/(Math.abs(i)/n+Math.abs(c)/o);return {x:e+s*i,y:r+s*c}}function Ee(t,e,r,n){let o=t.x-e,i=t.y-r,c=Math.sqrt(o*o+i*i);if(c<.5)return t;let s=n/c;return {x:e+s*o,y:r+s*i}}function Jt(t,e=true){if(t.length<2)return t;let r=[t[0]];for(let n=1;n<t.length;n++){let o=r[r.length-1],i=t[n],c=Math.abs(i.x-o.x),s=Math.abs(i.y-o.y);if(c<1||s<1){r.push(i);continue}e?r.push({x:o.x,y:i.y}):r.push({x:i.x,y:o.y}),r.push(i);}return Oi(r)}function Oi(t){if(t.length<3)return t;let e=[t[0]];for(let r=1;r<t.length-1;r++){let n=e[e.length-1],o=t[r],i=t[r+1],c=Math.abs(n.x-o.x)<1&&Math.abs(o.x-i.x)<1,s=Math.abs(n.y-o.y)<1&&Math.abs(o.y-i.y)<1;c||s||e.push(o);}return e.push(t[t.length-1]),e}function ie(t,e,r){if(t.length<2)return t;let n=t.map(o=>({...o}));if(r){let o=n.length-1;if(t.length===2){let i=n[0],c=n[o],s=Math.abs(c.x-i.x);if(Math.abs(c.y-i.y)>=s){let m=c.y>i.y?r.cy-r.hh:r.cy+r.hh;n[o]={x:c.x,y:m};}else {let m=c.x>i.x?r.cx-r.hw:r.cx+r.hw;n[o]={x:m,y:c.y};}}else {let i=n[o-1],c=n[o],s=Math.abs(c.x-i.x),l=Math.abs(c.y-i.y),d=l<1&&s>=1,m=s<1&&l>=1,g=!d&&!m&&l<s,a=!d&&!m&&s<l;if(d){let p=c.x>i.x?r.cx-r.hw:r.cx+r.hw;n[o]={x:p,y:r.cy},n[o-1]={...i,y:r.cy};}else if(m){let p=c.y>i.y?r.cy-r.hh:r.cy+r.hh;n[o]={x:r.cx,y:p},n[o-1]={...i,x:r.cx};}else if(g){let p=c.x>i.x?r.cx-r.hw:r.cx+r.hw;i.y>=r.cy-r.hh&&i.y<=r.cy+r.hh?n[o]={x:p,y:i.y}:(n[o]={x:p,y:r.cy},n[o-1]={...i,y:r.cy});}else if(a){let p=c.y>i.y?r.cy-r.hh:r.cy+r.hh;i.x>=r.cx-r.hw&&i.x<=r.cx+r.hw?n[o]={x:i.x,y:p}:(n[o]={x:r.cx,y:p},n[o-1]={...i,x:r.cx});}}}if(e&&t.length>=3){let o=n[0],i=n[1],c=Math.abs(i.x-o.x),s=Math.abs(i.y-o.y),l=s<1&&c>=1,d=c<1&&s>=1,m=!l&&!d&&s<c,g=!l&&!d&&c<s;if(l){let h=i.x>o.x?e.cx+e.hw:e.cx-e.hw;n[0]={x:h,y:e.cy},n[1]={...n[1],y:e.cy};}else if(d){let h=i.y>o.y?e.cy+e.hh:e.cy-e.hh;n[0]={x:e.cx,y:h},n[1]={...n[1],x:e.cx};}else if(m){let h=i.x>o.x?e.cx+e.hw:e.cx-e.hw;i.y>=e.cy-e.hh&&i.y<=e.cy+e.hh?n[0]={x:h,y:i.y}:(n[0]={x:h,y:e.cy},n[1]={...n[1],y:e.cy});}else if(g){let h=i.y>o.y?e.cy+e.hh:e.cy-e.hh;i.x>=e.cx-e.hw&&i.x<=e.cx+e.hw?n[0]={x:i.x,y:h}:(n[0]={x:e.cx,y:h},n[1]={...n[1],x:e.cx});}}return n}function Or(t){let e=Array.from(t.nodes.keys());if(e.length===0)return [];let r=new Map,n=new Map;for(let m of e)r.set(m,m),n.set(m,0);function o(m){return r.get(m)!==m&&r.set(m,o(r.get(m))),r.get(m)}function i(m,g){let a=o(m),h=o(g);if(a===h)return;let p=n.get(a),x=n.get(h);p<x?r.set(a,h):p>x?r.set(h,a):(r.set(h,a),n.set(a,p+1));}for(let m of t.edges)r.has(m.source)&&r.has(m.target)&&i(m.source,m.target);function c(m){let g=[...m.nodeIds];for(let a of m.children)s(a,g);if(r.has(m.id)&&g.length>0)for(let a of g)r.has(a)&&i(m.id,a);if(g.length>1){let a=g[0];for(let h=1;h<g.length;h++)r.has(a)&&r.has(g[h])&&i(a,g[h]);}for(let a of m.children)c(a);}function s(m,g){g.push(...m.nodeIds);for(let a of m.children)s(a,g);}for(let m of t.subgraphs)c(m);let l=new Map;for(let m of e){let g=o(m);l.has(g)||l.set(g,new Set),l.get(g).add(m);}let d=[];for(let[m,g]of l){let a={nodeIds:g,subgraphIds:new Set,edgeIndices:new Set};for(let h=0;h<t.edges.length;h++){let p=t.edges[h];g.has(p.source)&&g.has(p.target)&&a.edgeIndices.add(h);}d.push(a);}return Nr(t.subgraphs,d),d.sort((m,g)=>{let a=Math.min(...Array.from(m.nodeIds).map(p=>p.charCodeAt(0))),h=Math.min(...Array.from(g.nodeIds).map(p=>p.charCodeAt(0)));return a-h}),d}function Nr(t,e){for(let r of t){let n=Xr(r);if(n.size>0){let o=n.values().next().value;for(let i of e)if(i.nodeIds.has(o)){i.subgraphIds.add(r.id),Br(r,i.subgraphIds);break}}Nr(r.children,e);}}function Xr(t){let e=new Set(t.nodeIds);for(let r of t.children)for(let n of Xr(r))e.add(n);return e}function Br(t,e){for(let r of t.children)e.add(r.id),Br(r,e);}function Gr(t,e,r){if(t.length===0)return {width:0,height:0,nodes:[],edges:[],groups:[]};if(t.length===1)return t[0];let n=e==="TD"||e==="TB"||e==="BT",o={width:0,height:0,nodes:[],edges:[],groups:[]},i=0;for(let c=0;c<t.length;c++){let s=t[c];if(n){for(let l of s.nodes)o.nodes.push({...l,x:l.x+i});for(let l of s.edges)o.edges.push({...l,points:l.points.map(d=>({x:d.x+i,y:d.y})),labelPosition:l.labelPosition?{x:l.labelPosition.x+i,y:l.labelPosition.y}:void 0});for(let l of s.groups)o.groups.push(Yr(l,i));o.width=i+s.width,o.height=Math.max(o.height,s.height),i+=s.width+r;}else {for(let l of s.nodes)o.nodes.push({...l,y:l.y+i});for(let l of s.edges)o.edges.push({...l,points:l.points.map(d=>({x:d.x,y:d.y+i})),labelPosition:l.labelPosition?{x:l.labelPosition.x,y:l.labelPosition.y+i}:void 0});for(let l of s.groups)o.groups.push(Fr(l,i));o.width=Math.max(o.width,s.width),o.height=i+s.height,i+=s.height+r;}}return o}function Yr(t,e){return {...t,x:t.x+e,children:t.children.map(r=>Yr(r,e))}}function Fr(t,e){return {...t,y:t.y+e,children:t.children.map(r=>Fr(r,e))}}var We=new Set(["circle","doublecircle","state-start","state-end"]),He=new Set(["diamond","circle","doublecircle","state-start","state-end"]),Ni={font:"Inter",padding:40,nodeSpacing:24,layerSpacing:40};function Xi(t,e,r){let n=new $e.default.graphlib.Graph({directed:true,compound:true});n.setGraph({rankdir:zr(t.direction),acyclicer:"greedy",nodesep:r.nodeSpacing,ranksep:r.layerSpacing,marginx:16,marginy:12}),n.setDefaultEdgeLabel(()=>({}));let o=new Set;o.add(t.id),wn(t,o);for(let a of t.nodeIds){let h=e.nodes.get(a);if(h){let p=bn(a,h.label,h.shape);n.setNode(a,{label:h.label,width:p.width,height:p.height});}}for(let a of t.children)yn(n,a,e);let i=new Set;for(let a=0;a<e.edges.length;a++){let h=e.edges[a];if(o.has(h.source)&&o.has(h.target)){i.add(a);let p={_index:a};h.label&&(p.label=h.label,p.width=yt(h.label,at.edgeLabel,ut.edgeLabel)+8,p.height=at.edgeLabel+6,p.labelpos="c"),n.setEdge(h.source,h.target,p);}}$e.default.layout(n);let c=t.direction==="TD"||t.direction==="TB"||t.direction==="BT",s=new Set;for(let a of t.children)Cn(a,s);let l=[];for(let a of n.nodes()){if(s.has(a))continue;let h=e.nodes.get(a);if(!h)continue;let p=n.node(a);if(!p)continue;let x=Wt(p.x,p.y,p.width,p.height);l.push({id:a,label:h.label,shape:h.shape,x:x.x,y:x.y,width:p.width,height:p.height,inlineStyle:Kr(e,a)});}let d=n.edges().map(a=>{let h=n.edge(a),p=e.edges[h._index],x=h.points??[];if(x.length>0){let $=e.nodes.get(a.v)?.shape;if($==="diamond"){let P=n.node(a.v);x[0]=ke(x[0],P.x,P.y,P.width/2,P.height/2);}else if($&&We.has($)){let P=n.node(a.v);x[0]=Ee(x[0],P.x,P.y,Math.min(P.width,P.height)/2);}let k=e.nodes.get(a.w)?.shape;if(k==="diamond"){let P=n.node(a.w),X=x.length-1;x[X]=ke(x[X],P.x,P.y,P.width/2,P.height/2);}else if(k&&We.has(k)){let P=n.node(a.w),X=x.length-1;x[X]=Ee(x[X],P.x,P.y,Math.min(P.width,P.height)/2);}}let u=Jt(x,c),f=e.nodes.get(a.v)?.shape,b=e.nodes.get(a.w)?.shape,y=f&&!He.has(f)||!f?(()=>{let $=n.node(a.v);return $?{cx:$.x,cy:$.y,hw:$.width/2,hh:$.height/2}:null})():null,M=b&&!He.has(b)||!b?(()=>{let $=n.node(a.w);return $?{cx:$.x,cy:$.y,hw:$.width/2,hh:$.height/2}:null})():null,A=ie(u,y,M),w;return p.label&&h.x!=null&&h.y!=null&&(w={x:h.x,y:h.y}),{source:p.source,target:p.target,label:p.label,style:p.style,hasArrowStart:p.hasArrowStart,hasArrowEnd:p.hasArrowEnd,points:A,labelPosition:w}}),m=t.children.map(a=>Mn(n,a)),g=n.graph();return {id:t.id,label:t.label,width:g.width??200,height:g.height??100,nodes:l,edges:d,groups:m,nodeIds:o,internalEdgeIndices:i}}async function Hr(t,e={}){let r={...Ni,...e},n=Or(t);if(n.length>1){let o=[];for(let s of n){let l=Bi(t,s),d=await Wr(l,r);o.push(d);}let c=(r.componentSpacing??r.nodeSpacing)-2*r.padding;return Gr(o,t.direction,c)}return Wr(t,r)}function Bi(t,e){let r=new Set,n=jr(t.subgraphs,e.subgraphIds);for(let c of n)Ur(c,r);let o=new Map(Array.from(t.nodes.entries()).filter(([c])=>e.nodeIds.has(c)&&!r.has(c))),i=t.edges.filter((c,s)=>e.edgeIndices.has(s));return {direction:t.direction,nodes:o,edges:i,subgraphs:n,classDefs:t.classDefs,classAssignments:t.classAssignments,nodeStyles:t.nodeStyles}}function Ur(t,e){e.add(t.id);for(let r of t.children)Ur(r,e);}function jr(t,e){return t.filter(r=>e.has(r.id)).map(r=>({...r,children:jr(r.children,e)}))}async function Wr(t,e){let r=new Map;for(let d of t.subgraphs)d.direction&&d.direction!==t.direction&&r.set(d.id,Xi(d,t,e));let n=new $e.default.graphlib.Graph({directed:true,compound:true});n.setGraph({rankdir:zr(t.direction),acyclicer:"greedy",nodesep:e.nodeSpacing,ranksep:e.layerSpacing,marginx:e.padding,marginy:e.padding}),n.setDefaultEdgeLabel(()=>({}));let o=new Set;for(let d of t.subgraphs)o.add(d.id),wn(d,o);for(let[d,m]of t.nodes)if(!o.has(d)){let g=bn(d,m.label,m.shape);n.setNode(d,{label:m.label,width:g.width,height:g.height});}for(let d of t.subgraphs)if(r.has(d.id)){let m=r.get(d.id);n.setNode(d.id,{width:m.width,height:m.height});}else yn(n,d,t);let i=new Map,c=new Map;for(let d of t.subgraphs)r.has(d.id)||Vr(d,i,c);for(let[d,m]of r)for(let g of m.nodeIds)i.set(g,d),c.set(g,d);let s=new Set;for(let d of r.values())for(let m of d.internalEdgeIndices)s.add(m);let l=new Set;for(let d=0;d<t.edges.length;d++){if(s.has(d))continue;let m=t.edges[d],g=c.get(m.source)??m.source,a=i.get(m.target)??m.target,h={_index:d};m.label&&(h.label=m.label,h.width=yt(m.label,at.edgeLabel,ut.edgeLabel)+8,h.height=at.edgeLabel+6,h.labelpos="c"),l.has(a)||(h.weight=2,l.add(a)),n.setEdge(g,a,h);}try{$e.default.layout(n);}catch(d){let m=d instanceof Error?d.message:String(d);throw new Error(`Dagre layout failed: ${m}`)}return Gi(n,t,e.padding,r)}function zr(t){switch(t){case "LR":return "LR";case "RL":return "RL";case "BT":return "BT";default:return "TB"}}function bn(t,e,r){let o=yt(e,at.nodeLabel,ut.nodeLabel)+pe.horizontal*2,i=at.nodeLabel+pe.vertical*2;if(r==="diamond"){let c=Math.max(o,i)+pe.diamondExtra;o=c,i=c;}if(r==="circle"||r==="doublecircle"){let c=Math.ceil(Math.sqrt(o*o+i*i))+8;o=r==="doublecircle"?c+12:c,i=o;}return r==="hexagon"&&(o+=pe.horizontal),(r==="trapezoid"||r==="trapezoid-alt")&&(o+=pe.horizontal),r==="asymmetric"&&(o+=12),r==="cylinder"&&(i+=14),(r==="state-start"||r==="state-end")&&(o=28,i=28),o=Math.max(o,60),i=Math.max(i,36),{width:o,height:i}}function yn(t,e,r,n){t.setNode(e.id,{label:e.label}),n&&t.setParent(e.id,n);for(let o of e.nodeIds){let i=r.nodes.get(o);if(i){let c=bn(o,i.label,i.shape);t.setNode(o,{label:i.label,width:c.width,height:c.height}),t.setParent(o,e.id);}}for(let o of e.children)yn(t,o,r,e.id);}function Vr(t,e,r){for(let c of t.children)Vr(c,e,r);let n=[...t.nodeIds,...t.children.map(c=>c.id)];if(n.length===0){e.set(t.id,t.id),r.set(t.id,t.id);return}let o=n[0],i=n[n.length-1];e.set(t.id,e.get(o)??o),r.set(t.id,r.get(i)??i);}function Kr(t,e){let r=t.classAssignments.get(e),n=r?t.classDefs.get(r):void 0,o=t.nodeStyles.get(e);if(!(!n&&!o))return {...n,...o}}function wn(t,e){for(let r of t.nodeIds)e.add(r);for(let r of t.children)wn(r,e);}function Gi(t,e,r,n){let o=[],i=[],c=new Set;for(let f of e.subgraphs)Cn(f,c);let s=new Set;if(n)for(let f of n.values())for(let b of f.nodeIds)s.add(b);for(let f of t.nodes()){if(c.has(f))continue;let b=e.nodes.get(f);if(!b)continue;let y=t.node(f);if(!y)continue;let M=Wt(y.x,y.y,y.width,y.height);o.push({id:f,label:b.label,shape:b.shape,x:M.x,y:M.y,width:y.width,height:y.height,inlineStyle:Kr(e,f)});}for(let f of e.subgraphs)i.push(Mn(t,f));let l=e.direction==="TD"||e.direction==="TB"||e.direction==="BT",d=t.edges().map(f=>{let b=t.edge(f),y=e.edges[b._index],M=b.points??[];if(M.length>0){let Y=e.nodes.get(f.v)?.shape;if(Y==="diamond"){let _=t.node(f.v);M[0]=ke(M[0],_.x,_.y,_.width/2,_.height/2);}else if(Y&&We.has(Y)){let _=t.node(f.v);M[0]=Ee(M[0],_.x,_.y,Math.min(_.width,_.height)/2);}let q=e.nodes.get(f.w)?.shape;if(q==="diamond"){let _=t.node(f.w),F=M.length-1;M[F]=ke(M[F],_.x,_.y,_.width/2,_.height/2);}else if(q&&We.has(q)){let _=t.node(f.w),F=M.length-1;M[F]=Ee(M[F],_.x,_.y,Math.min(_.width,_.height)/2);}}let A=Jt(M,l),w=e.nodes.get(f.v)?.shape,$=e.nodes.get(f.w)?.shape,k=w&&!He.has(w)||!w?(()=>{let Y=t.node(f.v);return Y?{cx:Y.x,cy:Y.y,hw:Y.width/2,hh:Y.height/2}:null})():null,P=$&&!He.has($)||!$?(()=>{let Y=t.node(f.w);return Y?{cx:Y.x,cy:Y.y,hw:Y.width/2,hh:Y.height/2}:null})():null,X=ie(A,k,P),N;return y.label&&b.x!=null&&b.y!=null&&(N={x:b.x,y:b.y}),{source:y.source,target:y.target,label:y.label,style:y.style,hasArrowStart:y.hasArrowStart,hasArrowEnd:y.hasArrowEnd,points:X,labelPosition:N}});if(n&&n.size>0){let f=new Map;for(let b of o)f.set(b.id,{cx:b.x+b.width/2,cy:b.y+b.height/2});for(let[b,y]of n){let M=t.node(b);if(!M)continue;let A=Wt(M.x,M.y,M.width,M.height);for(let $ of y.nodes){let k={...$,x:$.x+A.x,y:$.y+A.y};o.push(k),f.set(k.id,{cx:k.x+k.width/2,cy:k.y+k.height/2});}for(let $ of y.edges)d.push({...$,points:$.points.map(k=>({x:k.x+A.x,y:k.y+A.y})),labelPosition:$.labelPosition?{x:$.labelPosition.x+A.x,y:$.labelPosition.y+A.y}:void 0});let w=Zr(i,b);w&&y.groups.length>0&&(w.children=y.groups.map($=>Qr($,A.x,A.y)));}for(let b of d){if(s.has(b.source)&&s.has(b.target))continue;let y=false;if(s.has(b.source)){let M=f.get(b.source);M&&b.points.length>0&&(b.points[0]={x:M.cx,y:M.cy},y=true);}if(s.has(b.target)){let M=f.get(b.target);M&&b.points.length>0&&(b.points[b.points.length-1]={x:M.cx,y:M.cy},y=true);}y&&(b.points=Jt(b.points,l));}}let m=at.groupHeader+16;Yi(i,m);let g=Jr(i),a=[...o.map(f=>f.y),...g.map(f=>f.y)],h=a.length>0?Math.min(...a):r,p=t.graph().width??800,x=t.graph().height??600;if(h<r){let f=r-h;for(let b of o)b.y+=f;for(let b of d){for(let y of b.points)y.y+=f;b.labelPosition&&(b.labelPosition.y+=f);}for(let b of g)b.y+=f;x+=f;}let u=Math.max(...o.map(f=>f.y+f.height),...g.map(f=>f.y+f.height),...d.flatMap(f=>f.points.map(b=>b.y)));return u+r>x&&(x=u+r),{width:p,height:x,nodes:o,edges:d,groups:i}}function Mn(t,e){let r=t.node(e.id),n=r?Wt(r.x,r.y,r.width,r.height):{x:0,y:0};return {id:e.id,label:e.label,x:n.x,y:n.y,width:r?.width??0,height:r?.height??0,children:e.children.map(o=>Mn(t,o))}}function Yi(t,e){for(let r of t)qr(r,e);}function qr(t,e){for(let r of t.children)qr(r,e);if(t.children.length>0){let r=t.y,n=t.y+t.height;for(let o of t.children)r=Math.min(r,o.y),n=Math.max(n,o.y+o.height);t.height=n-r,t.y=r;}if(t.label){let r=e+Rr;t.y-=r,t.height+=r;}}function Jr(t){let e=[];for(let r of t)e.push(r),e.push(...Jr(r.children));return e}function Zr(t,e){for(let r of t){if(r.id===e)return r;let n=Zr(r.children,e);if(n)return n}}function Qr(t,e,r){return {...t,x:t.x+e,y:t.y+r,children:t.children.map(n=>Qr(n,e,r))}}function Cn(t,e){e.add(t.id);for(let r of t.children)Cn(r,e);}function eo(t,e,r="Inter",n=false){let o=[];o.push(Vt(t.width,t.height,e,n)),o.push(zt(r,false)),o.push("<defs>"),o.push(Fi()),o.push("</defs>");for(let i of t.groups)o.push(no(i));for(let i of t.edges)o.push(Wi(i));for(let i of t.edges)i.label&&o.push(Ui(i));for(let i of t.nodes)o.push(zi(i));for(let i of t.nodes)o.push(cs(i));return o.push("</svg>"),o.join(`
`)}function Fi(){let t=ge.width,e=ge.height;return `  <marker id="arrowhead" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto">
    <polygon points="0 0, ${t} ${e/2}, 0 ${e}" fill="var(--_arrow)" />
  </marker>
  <marker id="arrowhead-start" markerWidth="${t}" markerHeight="${e}" refX="0" refY="${e/2}" orient="auto-start-reverse">
    <polygon points="${t} 0, 0 ${e/2}, ${t} ${e}" fill="var(--_arrow)" />
  </marker>`}function no(t,e){let r=at.groupHeader+16,n=[];n.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" rx="0" ry="0" fill="var(--_group-fill)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),n.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${r}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),n.push(`<text x="${t.x+12}" y="${t.y+r/2}" dy="${vt}" font-size="${at.groupHeader}" font-weight="${ut.groupHeader}" fill="var(--_text-sec)">${se(t.label)}</text>`);for(let o of t.children)n.push(no(o));return n.join(`
`)}function Wi(t){if(t.points.length<2)return "";let e=Hi(t.points),r=t.style==="dotted"?' stroke-dasharray="4 4"':"",n=t.style==="thick"?gt.connector*2:gt.connector,o="";return t.hasArrowEnd&&(o+=' marker-end="url(#arrowhead)"'),t.hasArrowStart&&(o+=' marker-start="url(#arrowhead-start)"'),`<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${n}"${r}${o} />`}function Hi(t){return t.map(e=>`${e.x},${e.y}`).join(" ")}function Ui(t,e){let r=t.labelPosition??ji(t.points),n=t.label,o=yt(n,at.edgeLabel,ut.edgeLabel),i=8,c=o+i*2,s=at.edgeLabel+i*2;return `<rect x="${r.x-c/2}" y="${r.y-s/2}" width="${c}" height="${s}" rx="4" ry="4" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${r.x}" y="${r.y}" text-anchor="middle" dy="${vt}" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${se(n)}</text>`}function ji(t){if(t.length===0)return {x:0,y:0};if(t.length===1)return t[0];let e=0;for(let n=1;n<t.length;n++)e+=to(t[n-1],t[n]);let r=e/2;for(let n=1;n<t.length;n++){let o=to(t[n-1],t[n]);if(r<=o){let i=r/o;return {x:t[n-1].x+i*(t[n].x-t[n-1].x),y:t[n-1].y+i*(t[n].y-t[n-1].y)}}r-=o;}return t[t.length-1]}function to(t,e){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}function zi(t){let{x:e,y:r,width:n,height:o,shape:i,inlineStyle:c}=t,s=se(c?.fill??"var(--_node-fill)"),l=se(c?.stroke??"var(--_node-stroke)"),d=se(c?.["stroke-width"]??String(gt.innerBox));switch(i){case "diamond":return Zi(e,r,n,o,s,l,d);case "rounded":return Ki(e,r,n,o,s,l,d);case "stadium":return qi(e,r,n,o,s,l,d);case "circle":return Ji(e,r,n,o,s,l,d);case "subroutine":return Qi(e,r,n,o,s,l,d);case "doublecircle":return ts(e,r,n,o,s,l,d);case "hexagon":return es(e,r,n,o,s,l,d);case "cylinder":return ns(e,r,n,o,s,l,d);case "asymmetric":return rs(e,r,n,o,s,l,d);case "trapezoid":return os(e,r,n,o,s,l,d);case "trapezoid-alt":return is(e,r,n,o,s,l,d);case "state-start":return ss(e,r,n,o);case "state-end":return as(e,r,n,o);default:return Vi(e,r,n,o,s,l,d)}}function Vi(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="0" ry="0" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Ki(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="6" ry="6" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function qi(t,e,r,n,o,i,c){let s=n/2;return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="${s}" ry="${s}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Ji(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,d=Math.min(r,n)/2;return `<circle cx="${s}" cy="${l}" r="${d}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Zi(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,d=r/2,m=n/2;return `<polygon points="${[`${s},${l-m}`,`${s+d},${l}`,`${s},${l+m}`,`${s-d},${l}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function Qi(t,e,r,n,o,i,c){return `<rect x="${t}" y="${e}" width="${r}" height="${n}" rx="0" ry="0" fill="${o}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+8}" y1="${e}" x2="${t+8}" y2="${e+n}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+r-8}" y1="${e}" x2="${t+r-8}" y2="${e+n}" stroke="${i}" stroke-width="${c}" />`}function ts(t,e,r,n,o,i,c){let s=t+r/2,l=e+n/2,d=Math.min(r,n)/2,m=d-5;return `<circle cx="${s}" cy="${l}" r="${d}" fill="${o}" stroke="${i}" stroke-width="${c}" />
<circle cx="${s}" cy="${l}" r="${m}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function es(t,e,r,n,o,i,c){let s=n/4;return `<polygon points="${[`${t+s},${e}`,`${t+r-s},${e}`,`${t+r},${e+n/2}`,`${t+r-s},${e+n}`,`${t+s},${e+n}`,`${t},${e+n/2}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function ns(t,e,r,n,o,i,c){let l=t+r/2,d=e+7,m=n-14;return `<rect x="${t}" y="${d}" width="${r}" height="${m}" fill="${o}" stroke="none" />
<line x1="${t}" y1="${d}" x2="${t}" y2="${d+m}" stroke="${i}" stroke-width="${c}" />
<line x1="${t+r}" y1="${d}" x2="${t+r}" y2="${d+m}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${e+n-7}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />
<ellipse cx="${l}" cy="${d}" rx="${r/2}" ry="7" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function rs(t,e,r,n,o,i,c){return `<polygon points="${[`${t+12},${e}`,`${t+r},${e}`,`${t+r},${e+n}`,`${t+12},${e+n}`,`${t},${e+n/2}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function os(t,e,r,n,o,i,c){let s=r*.15;return `<polygon points="${[`${t+s},${e}`,`${t+r-s},${e}`,`${t+r},${e+n}`,`${t},${e+n}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function is(t,e,r,n,o,i,c){let s=r*.15;return `<polygon points="${[`${t},${e}`,`${t+r},${e}`,`${t+r-s},${e+n}`,`${t+s},${e+n}`].join(" ")}" fill="${o}" stroke="${i}" stroke-width="${c}" />`}function ss(t,e,r,n){let o=t+r/2,i=e+n/2,c=Math.min(r,n)/2-2;return `<circle cx="${o}" cy="${i}" r="${c}" fill="var(--_text)" stroke="none" />`}function as(t,e,r,n){let o=t+r/2,i=e+n/2,c=Math.min(r,n)/2-2,s=c-4;return `<circle cx="${o}" cy="${i}" r="${c}" fill="none" stroke="var(--_text)" stroke-width="${gt.innerBox*2}" />
<circle cx="${o}" cy="${i}" r="${s}" fill="var(--_text)" stroke="none" />`}function cs(t,e){if((t.shape==="state-start"||t.shape==="state-end")&&!t.label)return "";let r=t.x+t.width/2,n=t.y+t.height/2,o=se(t.inlineStyle?.color??"var(--_text)");return `<text x="${r}" y="${n}" text-anchor="middle" dy="${vt}" font-size="${at.nodeLabel}" font-weight="${ut.nodeLabel}" fill="${o}">${se(t.label)}</text>`}function se(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var ht={padding:30,actorGap:140,actorHeight:40,actorPadX:16,headerGap:20,messageRowHeight:40,selfMessageHeight:30,activationWidth:10,blockPadX:10,blockPadTop:40,blockPadBottom:8,blockHeaderExtra:28,dividerExtra:24,noteWidth:120,notePadding:8,noteGap:10};function ro(t,e={}){if(t.actors.length===0)return {width:0,height:0,actors:[],lifelines:[],messages:[],activations:[],blocks:[],notes:[]};let r=t.actors.map(w=>{let $=yt(w.label,at.nodeLabel,ut.nodeLabel);return Math.max($+ht.actorPadX*2,80)}),n=[],o=ht.padding+r[0]/2;for(let w=0;w<t.actors.length;w++){if(w>0){let $=Math.max(ht.actorGap,(r[w-1]+r[w])/2+40);o+=$;}n.push(o);}let i=new Map;for(let w=0;w<t.actors.length;w++)i.set(t.actors[w].id,w);let c=ht.padding,s=t.actors.map((w,$)=>({id:w.id,label:w.label,type:w.type,x:n[$],y:c,width:r[$],height:ht.actorHeight})),l=c+ht.actorHeight+ht.headerGap,d=[],m=new Map;for(let w of t.blocks){let $=m.get(w.startIndex)??0;m.set(w.startIndex,Math.max($,ht.blockHeaderExtra));for(let k of w.dividers){let P=m.get(k.index)??0;m.set(k.index,Math.max(P,ht.dividerExtra));}}let g=new Map,a=[];for(let w=0;w<t.messages.length;w++){let $=t.messages[w],k=i.get($.from)??0,P=i.get($.to)??0,X=$.from===$.to,N=m.get(w)??0;N>0&&(l+=N);let Y=n[k],q=n[P];if(d.push({from:$.from,to:$.to,label:$.label,lineStyle:$.lineStyle,arrowHead:$.arrowHead,x1:Y,x2:q,y:l,isSelf:X}),$.activate&&(g.has($.to)||g.set($.to,[]),g.get($.to).push(l)),$.deactivate){let _=g.get($.from);if(_&&_.length>0){let F=_.pop(),I=i.get($.from)??0;a.push({actorId:$.from,x:n[I]-ht.activationWidth/2,topY:F,bottomY:l,width:ht.activationWidth});}}l+=X?ht.selfMessageHeight+ht.messageRowHeight:ht.messageRowHeight;}for(let[w,$]of g)for(let k of $){let P=i.get(w)??0;a.push({actorId:w,x:n[P]-ht.activationWidth/2,topY:k,bottomY:l-ht.messageRowHeight/2,width:ht.activationWidth});}let h=t.blocks.map(w=>{let $=d[w.startIndex],k=d[w.endIndex],P=($?.y??l)-ht.blockPadTop,X=(k?.y??l)+ht.blockPadBottom+12,N=new Set;for(let S=w.startIndex;S<=w.endIndex;S++){let v=t.messages[S];v&&(N.add(i.get(v.from)??0),N.add(i.get(v.to)??0));}if(N.size===0)for(let S=0;S<t.actors.length;S++)N.add(S);let Y=Math.min(...N),q=Math.max(...N),_=n[Y]-r[Y]/2-ht.blockPadX,F=n[q]+r[q]/2+ht.blockPadX,I=w.dividers.map(S=>{let v=d[S.index],V=v?.y??l,z=28;if(S.label&&v?.label){let L=`[${S.label}]`,D=yt(L,at.edgeLabel,ut.edgeLabel),T=_+8,G=T+D,W=yt(v.label,at.edgeLabel,ut.edgeLabel),K=v.isSelf?v.x1+36:(v.x1+v.x2)/2-W/2,B=K+W;G>K&&T<B&&(z=36);}return {y:V-z,label:S.label}});return {type:w.type,label:w.label,x:_,y:P,width:F-_,height:X-P,dividers:I}}),p=t.notes.map(w=>{let $=Math.max(ht.noteWidth,yt(w.text,at.edgeLabel,ut.edgeLabel)+ht.notePadding*2),k=at.edgeLabel+ht.notePadding*2,X=(d[w.afterIndex]?.y??c+ht.actorHeight)+4,N=i.get(w.actorIds[0]??"")??0,Y;if(w.position==="left")Y=n[N]-r[N]/2-$-ht.noteGap;else if(w.position==="right")Y=n[N]+r[N]/2+ht.noteGap;else if(w.actorIds.length>1){let q=i.get(w.actorIds[w.actorIds.length-1]??"")??N;Y=(n[N]+n[q])/2-$/2;}else Y=n[N]-$/2;return {text:w.text,x:Y,y:X,width:$,height:k}}),x=l+ht.padding,u=ht.padding,f=0;for(let w of s)u=Math.min(u,w.x-w.width/2),f=Math.max(f,w.x+w.width/2);for(let w of h)u=Math.min(u,w.x),f=Math.max(f,w.x+w.width);for(let w of p)u=Math.min(u,w.x),f=Math.max(f,w.x+w.width);let b=u<ht.padding?ht.padding-u:0;if(b>0){for(let w of s)w.x+=b;for(let w of d)w.x1+=b,w.x2+=b;for(let w of a)w.x+=b;for(let w of h)w.x+=b;for(let w of p)w.x+=b;for(let w=0;w<n.length;w++)n[w]+=b;}let y=t.actors.map((w,$)=>({actorId:w.id,x:n[$],topY:c+ht.actorHeight,bottomY:x-ht.padding})),M=f+b+ht.padding,A=x;return {width:Math.max(M,200),height:Math.max(A,100),actors:s,lifelines:y,messages:d,activations:a,blocks:h,notes:p}}function oo(t,e,r="Inter",n=false){let o=[];o.push(Vt(t.width,t.height,e,n)),o.push(zt(r,false)),o.push("<defs>"),o.push(ls()),o.push("</defs>");for(let i of t.blocks)o.push(ms(i));for(let i of t.lifelines)o.push(fs(i));for(let i of t.activations)o.push(us(i));for(let i of t.messages)o.push(hs(i));for(let i of t.notes)o.push(ps(i));for(let i of t.actors)o.push(ds(i));return o.push("</svg>"),o.join(`
`)}function ls(){let t=ge.width,e=ge.height;return `  <marker id="seq-arrow" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto-start-reverse">
    <polygon points="0 0, ${t} ${e/2}, 0 ${e}" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="${t}" markerHeight="${e}" refX="${t}" refY="${e/2}" orient="auto-start-reverse">
    <polyline points="0 0, ${t} ${e/2}, 0 ${e}" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>`}function ds(t){let{x:e,y:r,width:n,height:o,label:i,type:c}=t;if(c==="actor"){let l=o/24*.9,d=e-12*l,m=r+(o-24*l)/2,g=gt.outerBox/l,a="var(--_line)";return `<g transform="translate(${d},${m}) scale(${l})">
  <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" fill="none" stroke="${a}" stroke-width="${g}" />
  <path d="M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z" fill="none" stroke="${a}" stroke-width="${g}" />
  <path d="M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563" fill="none" stroke="${a}" stroke-width="${g}" />
</g>
<text x="${e}" y="${r+o+14}" text-anchor="middle" font-size="${at.nodeLabel}" font-weight="${ut.nodeLabel}" fill="var(--_text)">${ae(i)}</text>`}return `<rect x="${e-n/2}" y="${r}" width="${n}" height="${o}" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />
<text x="${e}" y="${r+o/2}" text-anchor="middle" dy="${vt}" font-size="${at.nodeLabel}" font-weight="${ut.nodeLabel}" fill="var(--_text)">${ae(i)}</text>`}function fs(t){return `<line x1="${t.x}" y1="${t.topY}" x2="${t.x}" y2="${t.bottomY}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`}function us(t){return `<rect x="${t.x}" y="${t.topY}" width="${t.width}" height="${t.bottomY-t.topY}" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${gt.innerBox}" />`}function hs(t){let e=[],r=t.lineStyle==="dashed"?' stroke-dasharray="6 4"':"",n=t.arrowHead==="filled"?"seq-arrow":"seq-arrow-open";if(t.isSelf)e.push(`<polyline points="${t.x1},${t.y} ${t.x1+30},${t.y} ${t.x1+30},${t.y+20} ${t.x2},${t.y+20}" fill="none" stroke="var(--_line)" stroke-width="${gt.connector}"${r} marker-end="url(#${n})" />`),e.push(`<text x="${t.x1+30+6}" y="${t.y+20/2}" dy="${vt}" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${ae(t.label)}</text>`);else {e.push(`<line x1="${t.x1}" y1="${t.y}" x2="${t.x2}" y2="${t.y}" stroke="var(--_line)" stroke-width="${gt.connector}"${r} marker-end="url(#${n})" />`);let o=(t.x1+t.x2)/2;e.push(`<text x="${o}" y="${t.y-6}" text-anchor="middle" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${ae(t.label)}</text>`);}return e.join(`
`)}function ms(t){let e=[];e.push(`<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`);let r=`${t.type}${t.label?` [${t.label}]`:""}`,n=yt(r,at.edgeLabel,ut.groupHeader)+16,o=18;e.push(`<rect x="${t.x}" y="${t.y}" width="${n}" height="${o}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),e.push(`<text x="${t.x+6}" y="${t.y+o/2}" dy="${vt}" font-size="${at.edgeLabel}" font-weight="${ut.groupHeader}" fill="var(--_text-sec)">${ae(r)}</text>`);for(let i of t.dividers)e.push(`<line x1="${t.x}" y1="${i.y}" x2="${t.x+t.width}" y2="${i.y}" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />`),i.label&&e.push(`<text x="${t.x+8}" y="${i.y+14}" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">[${ae(i.label)}]</text>`);return e.join(`
`)}function ps(t){return `<rect x="${t.x}" y="${t.y}" width="${t.width}" height="${t.height}" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${gt.innerBox}" />
<polygon points="${t.x+t.width-6},${t.y} ${t.x+t.width},${t.y+6} ${t.x+t.width-6},${t.y+6}" fill="var(--_inner-stroke)" />
<text x="${t.x+t.width/2}" y="${t.y+t.height/2}" text-anchor="middle" dy="${vt}" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${ae(t.text)}</text>`}function ae(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Sn=Ve(Ye());var Mt={padding:40,boxPadX:8,headerBaseHeight:32,annotationHeight:16,memberRowHeight:20,sectionPadY:8,emptySectionHeight:8,minWidth:120,memberFontSize:11,nodeSpacing:40,layerSpacing:60};async function so(t,e={}){if(t.classes.length===0)return {width:0,height:0,classes:[],relationships:[]};let r=new Map;for(let s of t.classes){let l=s.annotation?Mt.headerBaseHeight+Mt.annotationHeight:Mt.headerBaseHeight,d=s.attributes.length>0?s.attributes.length*Mt.memberRowHeight+Mt.sectionPadY:Mt.emptySectionHeight,m=s.methods.length>0?s.methods.length*Mt.memberRowHeight+Mt.sectionPadY:Mt.emptySectionHeight,g=yt(s.label,at.nodeLabel,ut.nodeLabel),a=io(s.attributes),h=io(s.methods),p=Math.max(Mt.minWidth,g+Mt.boxPadX*2,a+Mt.boxPadX*2,h+Mt.boxPadX*2),x=l+d+m;r.set(s.id,{width:p,height:x,headerHeight:l,attrHeight:d,methodHeight:m});}let n=new Sn.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"TB",acyclicer:"greedy",nodesep:Mt.nodeSpacing,ranksep:Mt.layerSpacing,marginx:Mt.padding,marginy:Mt.padding}),n.setDefaultEdgeLabel(()=>({}));for(let s of t.classes){let l=r.get(s.id);n.setNode(s.id,{width:l.width,height:l.height});}for(let s=0;s<t.relationships.length;s++){let l=t.relationships[s],d={_index:s};l.label&&(d.label=l.label,d.width=yt(l.label,at.edgeLabel,ut.edgeLabel)+8,d.height=at.edgeLabel+6,d.labelpos="c"),n.setEdge(l.from,l.to,d);}try{Sn.default.layout(n);}catch(s){let l=s instanceof Error?s.message:String(s);throw new Error(`Dagre layout failed (class diagram): ${l}`)}let o=new Map;for(let s of t.classes)o.set(s.id,s);let i=t.classes.map(s=>{let l=n.node(s.id),d=r.get(s.id),m=Wt(l.x,l.y,l.width,l.height);return {id:s.id,label:s.label,annotation:s.annotation,attributes:s.attributes,methods:s.methods,x:m.x,y:m.y,width:l.width??d.width,height:l.height??d.height,headerHeight:d.headerHeight,attrHeight:d.attrHeight,methodHeight:d.methodHeight}}),c=n.edges().map(s=>{let l=n.edge(s),d=t.relationships[l._index],m=l.points??[],g=Jt(m,true),a=n.node(s.v),h=n.node(s.w),p=ie(g,a?{cx:a.x,cy:a.y,hw:a.width/2,hh:a.height/2}:null,h?{cx:h.x,cy:h.y,hw:h.width/2,hh:h.height/2}:null),x;return d.label&&l.x!=null&&l.y!=null&&(x={x:l.x,y:l.y}),{from:d.from,to:d.to,type:d.type,markerAt:d.markerAt,label:d.label,fromCardinality:d.fromCardinality,toCardinality:d.toCardinality,points:p,labelPosition:x}});return {width:n.graph().width??600,height:n.graph().height??400,classes:i,relationships:c}}function io(t){if(t.length===0)return 0;let e=0;for(let r of t){let n=gs(r),o=Fe(n,Mt.memberFontSize);o>e&&(e=o);}return e}function gs(t){let e=t.visibility?`${t.visibility} `:"",r=t.type?`: ${t.type}`:"";return `${e}${t.name}${r}`}var Ue={memberSize:11,memberWeight:400,annotationSize:10,annotationWeight:500};function lo(t,e,r="Inter",n=false){let o=[];o.push(Vt(t.width,t.height,e,n)),o.push(zt(r,true)),o.push("<defs>"),o.push(xs()),o.push("</defs>");for(let i of t.relationships)o.push(ys(i));for(let i of t.classes)o.push(bs(i));for(let i of t.relationships)o.push(Cs(i));return o.push("</svg>"),o.join(`
`)}function xs(){return `  <marker id="cls-inherit" markerWidth="12" markerHeight="10" refX="12" refY="5" orient="auto-start-reverse">
    <polygon points="0 0, 12 5, 0 10" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-composition" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--_arrow)" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
  <marker id="cls-aggregation" markerWidth="12" markerHeight="10" refX="0" refY="5" orient="auto-start-reverse">
    <polygon points="6 0, 12 5, 6 10, 0 5" fill="var(--bg)" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>
  <marker id="cls-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto-start-reverse">
    <polyline points="0 0, 8 3, 0 6" fill="none" stroke="var(--_arrow)" stroke-width="1.5" />
  </marker>`}function bs(t){let{x:e,y:r,width:n,height:o,headerHeight:i,attrHeight:c,methodHeight:s}=t,l=[];l.push(`<rect x="${e}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),l.push(`<rect x="${e}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`);let d=r+i/2;if(t.annotation){let h=r+12;l.push(`<text x="${e+n/2}" y="${h}" text-anchor="middle" dy="${vt}" font-size="${Ue.annotationSize}" font-weight="${Ue.annotationWeight}" font-style="italic" fill="var(--_text-muted)">&lt;&lt;${Zt(t.annotation)}&gt;&gt;</text>`),d=r+i/2+6;}l.push(`<text x="${e+n/2}" y="${d}" text-anchor="middle" dy="${vt}" font-size="${at.nodeLabel}" font-weight="700" fill="var(--_text)">${Zt(t.label)}</text>`);let m=r+i;l.push(`<line x1="${e}" y1="${m}" x2="${e+n}" y2="${m}" stroke="var(--_node-stroke)" stroke-width="${gt.innerBox}" />`);let g=20;for(let h=0;h<t.attributes.length;h++){let p=t.attributes[h],x=m+4+h*g+g/2;l.push(ao(p,e+Mt.boxPadX,x));}let a=m+c;l.push(`<line x1="${e}" y1="${a}" x2="${e+n}" y2="${a}" stroke="var(--_node-stroke)" stroke-width="${gt.innerBox}" />`);for(let h=0;h<t.methods.length;h++){let p=t.methods[h],x=a+4+h*g+g/2;l.push(ao(p,e+Mt.boxPadX,x));}return l.join(`
`)}function ao(t,e,r){let n=t.isAbstract?' font-style="italic"':"",o=t.isStatic?' text-decoration="underline"':"",i=[];return t.visibility&&i.push(`<tspan fill="var(--_text-faint)">${Zt(t.visibility)} </tspan>`),i.push(`<tspan fill="var(--_text-sec)">${Zt(t.name)}</tspan>`),t.type&&(i.push('<tspan fill="var(--_text-faint)">: </tspan>'),i.push(`<tspan fill="var(--_text-muted)">${Zt(t.type)}</tspan>`)),`<text x="${e}" y="${r}" class="mono" dy="${vt}" font-size="${Ue.memberSize}" font-weight="${Ue.memberWeight}"${n}${o}>${i.join("")}</text>`}function ys(t){if(t.points.length<2)return "";let e=t.points.map(i=>`${i.x},${i.y}`).join(" "),n=t.type==="dependency"||t.type==="realization"?' stroke-dasharray="6 4"':"",o=ws(t.type,t.markerAt);return `<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${gt.connector}"${n}${o} />`}function ws(t,e){let r=Ms(t);return r?e==="from"?` marker-start="url(#${r})"`:` marker-end="url(#${r})"`:""}function Ms(t){switch(t){case "inheritance":case "realization":return "cls-inherit";case "composition":return "cls-composition";case "aggregation":return "cls-aggregation";case "association":case "dependency":return "cls-arrow";default:return null}}function Cs(t){if(!t.label&&!t.fromCardinality&&!t.toCardinality||t.points.length<2)return "";let e=[];if(t.label){let r=t.labelPosition??Ss(t.points);e.push(`<text x="${r.x}" y="${r.y-8}" text-anchor="middle" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${Zt(t.label)}</text>`);}if(t.fromCardinality){let r=t.points[0],n=t.points[1],o=co(r,n);e.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${Zt(t.fromCardinality)}</text>`);}if(t.toCardinality){let r=t.points[t.points.length-1],n=t.points[t.points.length-2],o=co(r,n);e.push(`<text x="${r.x+o.x}" y="${r.y+o.y}" text-anchor="middle" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${Zt(t.toCardinality)}</text>`);}return e.join(`
`)}function Ss(t){if(t.length===0)return {x:0,y:0};let e=Math.floor(t.length/2);return t[e]}function co(t,e){let r=e.x-t.x,n=e.y-t.y;return Math.abs(r)>Math.abs(n)?{x:r>0?14:-14,y:-10}:{x:-14,y:n>0?14:-14}}function Zt(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var vn=Ve(Ye());var Rt={padding:40,boxPadX:12,headerHeight:32,rowHeight:22,minWidth:140,attrFontSize:11,nodeSpacing:50,layerSpacing:70};async function fo(t,e={}){if(t.entities.length===0)return {width:0,height:0,entities:[],relationships:[]};let r=new Map;for(let s of t.entities){let l=yt(s.label,at.nodeLabel,ut.nodeLabel),d=0;for(let a of s.attributes){let h=`${a.type}  ${a.name}${a.keys.length>0?"  "+a.keys.join(","):""}`,p=Fe(h,Rt.attrFontSize);p>d&&(d=p);}let m=Math.max(Rt.minWidth,l+Rt.boxPadX*2,d+Rt.boxPadX*2),g=Rt.headerHeight+Math.max(s.attributes.length,1)*Rt.rowHeight;r.set(s.id,{width:m,height:g});}let n=new vn.default.graphlib.Graph({directed:true});n.setGraph({rankdir:"LR",acyclicer:"greedy",nodesep:Rt.nodeSpacing,ranksep:Rt.layerSpacing,marginx:Rt.padding,marginy:Rt.padding}),n.setDefaultEdgeLabel(()=>({}));for(let s of t.entities){let l=r.get(s.id);n.setNode(s.id,{width:l.width,height:l.height});}for(let s=0;s<t.relationships.length;s++){let l=t.relationships[s];n.setEdge(l.entity1,l.entity2,{_index:s,label:l.label,width:yt(l.label,at.edgeLabel,ut.edgeLabel)+8,height:at.edgeLabel+6,labelpos:"c"});}try{vn.default.layout(n);}catch(s){let l=s instanceof Error?s.message:String(s);throw new Error(`Dagre layout failed (ER diagram): ${l}`)}let o=new Map;for(let s of t.entities)o.set(s.id,s);let i=t.entities.map(s=>{let l=n.node(s.id),d=Wt(l.x,l.y,l.width,l.height);return {id:s.id,label:s.label,attributes:s.attributes,x:d.x,y:d.y,width:l.width??r.get(s.id).width,height:l.height??r.get(s.id).height,headerHeight:Rt.headerHeight,rowHeight:Rt.rowHeight}}),c=n.edges().map(s=>{let l=n.edge(s),d=t.relationships[l._index],m=l.points??[],g=Jt(m,false),a=n.node(s.v),h=n.node(s.w),p=ie(g,a?{cx:a.x,cy:a.y,hw:a.width/2,hh:a.height/2}:null,h?{cx:h.x,cy:h.y,hw:h.width/2,hh:h.height/2}:null);return {entity1:d.entity1,entity2:d.entity2,cardinality1:d.cardinality1,cardinality2:d.cardinality2,label:d.label,identifying:d.identifying,points:p}});return {width:n.graph().width??600,height:n.graph().height??400,entities:i,relationships:c}}var Ht={attrSize:11,attrWeight:400,keySize:9,keyWeight:600};function ho(t,e,r="Inter",n=false){let o=[];o.push(Vt(t.width,t.height,e,n)),o.push(zt(r,true)),o.push("<defs>"),o.push("</defs>");for(let i of t.relationships)o.push(Es(i));for(let i of t.entities)o.push(vs(i));for(let i of t.relationships)o.push(As(i));for(let i of t.relationships)o.push($s(i));return o.push("</svg>"),o.join(`
`)}function vs(t){let{x:e,y:r,width:n,height:o,headerHeight:i,rowHeight:c,label:s,attributes:l}=t,d=[];d.push(`<rect x="${e}" y="${r}" width="${n}" height="${o}" rx="0" ry="0" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),d.push(`<rect x="${e}" y="${r}" width="${n}" height="${i}" rx="0" ry="0" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="${gt.outerBox}" />`),d.push(`<text x="${e+n/2}" y="${r+i/2}" text-anchor="middle" dy="${vt}" font-size="${at.nodeLabel}" font-weight="700" fill="var(--_text)">${je(s)}</text>`);let m=r+i;d.push(`<line x1="${e}" y1="${m}" x2="${e+n}" y2="${m}" stroke="var(--_node-stroke)" stroke-width="${gt.innerBox}" />`);for(let g=0;g<l.length;g++){let a=l[g],h=m+g*c+c/2;d.push(ks(a,e,h,n));}return l.length===0&&d.push(`<text x="${e+n/2}" y="${m+c/2}" text-anchor="middle" dy="${vt}" font-size="${Ht.attrSize}" fill="var(--_text-faint)" font-style="italic">(no attributes)</text>`),d.join(`
`)}function ks(t,e,r,n){let o=[],i=0;if(t.keys.length>0){let l=t.keys.join(",");i=yt(l,Ht.keySize,Ht.keyWeight)+8,o.push(`<rect x="${e+6}" y="${r-7}" width="${i}" height="14" rx="2" ry="2" fill="var(--_key-badge)" />`),o.push(`<text x="${e+6+i/2}" y="${r}" text-anchor="middle" dy="${vt}" font-size="${Ht.keySize}" font-weight="${Ht.keyWeight}" fill="var(--_text-sec)">${t.keys.join(",")}</text>`);}let c=e+8+(i>0?i+6:0);o.push(`<text x="${c}" y="${r}" class="mono" dy="${vt}" font-size="${Ht.attrSize}" font-weight="${Ht.attrWeight}"><tspan fill="var(--_text-muted)">${je(t.type)}</tspan></text>`);let s=e+n-8;return o.push(`<text x="${s}" y="${r}" class="mono" text-anchor="end" dy="${vt}" font-size="${Ht.attrSize}" font-weight="${Ht.attrWeight}"><tspan fill="var(--_text-sec)">${je(t.name)}</tspan></text>`),o.join(`
`)}function Es(t){if(t.points.length<2)return "";let e=t.points.map(n=>`${n.x},${n.y}`).join(" "),r=t.identifying?"":' stroke-dasharray="6 4"';return `<polyline points="${e}" fill="none" stroke="var(--_line)" stroke-width="${gt.connector}"${r} />`}function $s(t){if(!t.label||t.points.length<2)return "";let e=Ls(t.points),n=yt(t.label,at.edgeLabel,ut.edgeLabel)+8,o=at.edgeLabel+6;return `<rect x="${e.x-n/2}" y="${e.y-o/2}" width="${n}" height="${o}" rx="2" ry="2" fill="var(--bg)" stroke="var(--_inner-stroke)" stroke-width="0.5" />
<text x="${e.x}" y="${e.y}" text-anchor="middle" dy="${vt}" font-size="${at.edgeLabel}" font-weight="${ut.edgeLabel}" fill="var(--_text-muted)">${je(t.label)}</text>`}function As(t){if(t.points.length<2)return "";let e=[],r=t.points[0],n=t.points[1];e.push(uo(r,n,t.cardinality1));let o=t.points[t.points.length-1],i=t.points[t.points.length-2];return e.push(uo(o,i,t.cardinality2)),e.join(`
`)}function uo(t,e,r){let n=[],o=gt.connector+.25,i=t.x-e.x,c=t.y-e.y,s=Math.sqrt(i*i+c*c);if(s===0)return "";let l=i/s,d=c/s,m=-d,g=l,a=t.x-l*4,h=t.y-d*4,p=t.x-l*16,x=t.y-d*16,u=r==="one"||r==="zero-one",f=r==="many"||r==="zero-many",b=r==="zero-one"||r==="zero-many";if(u){n.push(`<line x1="${a+m*6}" y1="${h+g*6}" x2="${a-m*6}" y2="${h-g*6}" stroke="var(--_line)" stroke-width="${o}" />`);let M=a-l*4,A=h-d*4;n.push(`<line x1="${M+m*6}" y1="${A+g*6}" x2="${M-m*6}" y2="${A-g*6}" stroke="var(--_line)" stroke-width="${o}" />`);}if(f){let M=a,A=h;n.push(`<line x1="${M+m*7}" y1="${A+g*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),n.push(`<line x1="${M}" y1="${A}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`),n.push(`<line x1="${M-m*7}" y1="${A-g*7}" x2="${p}" y2="${x}" stroke="var(--_line)" stroke-width="${o}" />`);}if(b){let y=f?20:12,M=t.x-l*y,A=t.y-d*y;n.push(`<circle cx="${M}" cy="${A}" r="4" fill="var(--bg)" stroke="var(--_line)" stroke-width="${o}" />`);}return n.join(`
`)}function Ls(t){if(t.length===0)return {x:0,y:0};if(t.length===1)return t[0];let e=0;for(let o=1;o<t.length;o++){let i=t[o].x-t[o-1].x,c=t[o].y-t[o-1].y;e+=Math.sqrt(i*i+c*c);}if(e===0)return t[0];let r=e/2,n=0;for(let o=1;o<t.length;o++){let i=t[o].x-t[o-1].x,c=t[o].y-t[o-1].y,s=Math.sqrt(i*i+c*c);if(n+s>=r){let l=s>0?(r-n)/s:0;return {x:t[o-1].x+i*l,y:t[o-1].y+c*l}}n+=s;}return t[t.length-1]}function je(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function _s(t){let e=t.trim().split(/[\n;]/)[0]?.trim().toLowerCase()??"";return /^sequencediagram\s*$/.test(e)?"sequence":/^classdiagram\s*$/.test(e)?"class":/^erdiagram\s*$/.test(e)?"er":"flowchart"}function Ts(t){return {bg:t.bg??ce.bg,fg:t.fg??ce.fg,line:t.line,accent:t.accent,muted:t.muted,surface:t.surface,border:t.border}}async function mo(t,e={}){let r=Ts(e),n=e.font??"Inter",o=e.transparent??false,i=_s(t),c=t.split(/[\n;]/).map(s=>s.trim()).filter(s=>s.length>0&&!s.startsWith("%%"));switch(i){case "sequence":{let s=Oe(c),l=ro(s,e);return oo(l,r,n,o)}case "class":{let s=Ne(c),l=await so(s,e);return lo(l,r,n,o)}case "er":{let s=Xe(c),l=await fo(s,e);return ho(l,r,n,o)}default:{let s=Me(t),l=await Hr(s,e);return eo(l,r,n,o)}}}typeof window<"u"&&(window.__mermaid={renderMermaid:mo,renderMermaidAscii:Ge,renderMermaidAsciiWithMeta:gn,THEMES:Ke,DEFAULTS:ce,fromShikiTheme:qe});exports.DEFAULTS=ce;exports.THEMES=Ke;exports.fromShikiTheme=qe;exports.renderMermaid=mo;exports.renderMermaidAscii=Ge;exports.renderMermaidAsciiWithMeta=gn;return exports;})({});//# sourceMappingURL=beautiful-mermaid.browser.global.js.map
//# sourceMappingURL=beautiful-mermaid.browser.global.js.map