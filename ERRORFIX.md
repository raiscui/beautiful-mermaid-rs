# ERRORFIX

> æœ¬æ¬¡ä»»åŠ¡æ˜¯åˆå§‹åŒ–/å¤åˆ»ï¼Œä¸æ˜¯å…¸å‹ bugfixã€‚
> ä½†å¦‚æœè¿‡ç¨‹ä¸­é‡åˆ°å…³é”®é”™è¯¯ä¸ä¿®å¤ç»éªŒï¼Œä¹Ÿä¼šåœ¨è¿™é‡Œè¿½åŠ ã€‚

## 2026-01-30 21:00 - CLI è¾“å‡ºæœ«å°¾å‡ºç° `%`ï¼ˆzsh æç¤ºç¬¦ç²˜è¿ï¼‰

- ç°è±¡ï¼š
  - æ‰§è¡Œ `printf 'graph LR\nA --> B\n' | cargo run --quiet -- --ascii` æ—¶ï¼Œè¾“å‡ºæœ€åä¸€è¡Œåé¢ç´§è·Ÿä¸€ä¸ª `%`ã€‚
- åŸå› ï¼š
  - `src/main.rs` ä½¿ç”¨ `print!` è¾“å‡ºæ¸²æŸ“ç»“æœï¼Œæœ«å°¾æ²¡æœ‰è¡¥ `\n`ã€‚
  - åœ¨ zsh ä¸‹ï¼Œç¨‹åºè¾“å‡ºä¸ä»¥æ¢è¡Œç»“å°¾æ—¶ï¼Œshell çš„æç¤ºç¬¦ï¼ˆé€šå¸¸æ˜¯ `%`ï¼‰ä¼šç›´æ¥è´´åœ¨æœ€åä¸€è¡Œåé¢ï¼Œé€ æˆâ€œçœ‹èµ·æ¥åƒå¤šäº†ä¸ª %â€ã€‚
  - å¦å¤–ï¼Œ`print!/println!` åœ¨ stdout é‡åˆ° BrokenPipeï¼ˆä¸‹æ¸¸æå‰å…³é—­ï¼‰æ—¶ä¼š panicï¼Œä¸ç¬¦åˆ CLI å¸¸è§è¡Œä¸ºã€‚
- ä¿®å¤ï¼š
  - `src/main.rs` ç»Ÿä¸€èµ° `write_stdout_with_trailing_newline`ï¼š
    - è¾“å‡ºåè¡¥é½æœ«å°¾æ¢è¡Œã€‚
    - æ•è· `BrokenPipe` å¹¶ 0 é€€å‡ºï¼Œé¿å… panicã€‚
- éªŒè¯ï¼š
  - `cargo test` å…¨é€šè¿‡ã€‚
  - è¾“å‡ºæœ«å°¾æ£€æŸ¥ï¼šæ¸²æŸ“ç»“æœä»¥ `\n` ç»“å°¾ï¼Œzsh æç¤ºç¬¦ä¸å†ç²˜è¿ã€‚
  - `| head -n 1` ç­‰ä¸‹æ¸¸æå‰å…³é—­åœºæ™¯ä¸å†å‡ºç° Broken pipe panicã€‚

## 2026-02-01 00:41 - `beautiful-mermaid-rs --help/--version` ä¸ç”Ÿæ•ˆï¼Œä¸”ç©º stdin è§¦å‘ QuickJS å¼‚å¸¸

- ç°è±¡ï¼š
  - æ‰§è¡Œ `beautiful-mermaid-rs --help` / `beautiful-mermaid-rs --version` æ²¡æœ‰è¾“å‡ºå¸®åŠ©æˆ–ç‰ˆæœ¬ã€‚
  - åè€ŒæŠ¥é”™ï¼š`æ¸²æŸ“ SVG å¤±è´¥: JS å¼•æ“é”™è¯¯: Exception generated by QuickJS`ã€‚
  - åœ¨â€œç›´æ¥è¿è¡Œä½†æ²¡æœ‰è¾“å…¥ stdinâ€çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šé‡åˆ°ç±»ä¼¼æŠ¥é”™ï¼Œä½“éªŒåƒâ€œç¨‹åºåäº†â€ã€‚
- åŸå› ï¼š
  - `src/main.rs` å…ˆ `read_to_string(stdin)` å†è§£æå‚æ•°ã€‚
  - éäº¤äº’ç¯å¢ƒä¸‹ stdin å¸¸å¸¸ç«‹åˆ» EOFï¼Œå¯¼è‡´è¯»åˆ°ç©ºå­—ç¬¦ä¸²ï¼Œç„¶åè¿›å…¥æ¸²æŸ“è·¯å¾„è§¦å‘ JS å¼‚å¸¸ã€‚
  - åŒæ—¶ CLI æ²¡æœ‰ `--help/--version`ï¼Œæ— æ³•è‡ªå‘ç°ç”¨æ³•ã€‚
- ä¿®å¤ï¼š
  - `src/main.rs` æŠŠâ€œå‚æ•°è§£æâ€å‰ç½®ï¼Œä¼˜å…ˆå¤„ç† `--help/-h` ä¸ `--version/-V`ï¼ˆä¸ä¾èµ– stdinï¼‰ã€‚
  - stdin ä¸ºç©ºæ—¶è¿”å›æ˜ç¡®æç¤ºï¼Œå¹¶ç”¨ exit code `2` è¡¨ç¤ºâ€œç”¨æ³•é”™è¯¯â€ã€‚
  - å¢åŠ å‚æ•°æ ¡éªŒï¼šæœªçŸ¥å‚æ•°ã€`--use-ascii` æœªé… `--ascii` ç›´æ¥æŠ¥é”™ï¼ˆé¿å… silent ignoreï¼‰ã€‚
- éªŒè¯ï¼š
  - `cargo test` é€šè¿‡ã€‚
  - `beautiful-mermaid-rs --help/--version` æ­£å¸¸è¾“å‡ºã€‚
  - `printf 'graph LR\nA --> B\n' | beautiful-mermaid-rs | head -n 1` èƒ½è¾“å‡º `<svg ...` ä¸” pipe åœºæ™¯æ—  panicã€‚

## 2026-02-01 20:55 - Flowchart/State ä½¿ç”¨ä¸­æ–‡/Unicode èŠ‚ç‚¹ ID æ—¶æ¸²æŸ“å‡º `-Infinity`

- ç°è±¡ï¼š
  - `printf 'graph TD\nå¼€å§‹ --> ç»“æŸ\n' | beautiful-mermaid-rs` è¾“å‡ºçš„ SVG å‡ºç°ï¼š
    - `viewBox="0 0 -Infinity -Infinity"`
    - `width="-Infinity" height="-Infinity"`
  - `printf 'graph TD\nå¼€å§‹ --> ç»“æŸ\n' | beautiful-mermaid-rs --ascii` åªè¾“å‡ºç©ºç™½
- åŸå› ï¼š
  - ä¸Šæ¸¸ TS ç‰ˆ `beautiful-mermaid` çš„ `src/parser.ts` ä½¿ç”¨ `\\w` / `[\\w-]` åŒ¹é… Flowchart/State çš„èŠ‚ç‚¹ IDï¼Œä¸­æ–‡æ— æ³•åŒ¹é…ï¼Œè§£æç»“æœä¸ºç©ºå›¾ã€‚
  - ç©ºå›¾è¿›å…¥ dagre/layout åï¼Œå›¾å°ºå¯¸è¢«è®¡ç®—ä¸º `-Infinity`ï¼Œæœ€ç»ˆæ±¡æŸ“ SVGã€‚
- ä¿®å¤ï¼š
  - åœ¨ä¸Šæ¸¸ TS é¡¹ç›®ä¿®å¤ parserï¼šæŠŠ ID åŒ¹é…æ”¹ä¸º Unicode å±æ€§ç±»ï¼ˆ`\\p{L}\\p{N}` + `u` flagï¼‰ï¼Œå¹¶é‡å»º `dist/beautiful-mermaid.browser.global.js`
  - æœ¬ä»“åº“åŒæ­¥æ›´æ–° vendor bundleï¼š`vendor/beautiful-mermaid/beautiful-mermaid.browser.global.js`
  - å¢åŠ  Rust å›å½’æµ‹è¯•ï¼š`tests/unicode_id_smoke.rs`
- éªŒè¯ï¼š
  - `cargo test` é€šè¿‡
  - SVG ä¸å†åŒ…å« `-Infinity`ï¼Œä¸”åŒ…å«ä¸­æ–‡èŠ‚ç‚¹æ–‡æœ¬ `å¼€å§‹/ç»“æŸ`

## 2026-02-01 22:12 - ASCII/Unicode è¾“å‡ºåœ¨ä¸­æ–‡å®½å­—ç¬¦åœºæ™¯ä¸‹è¾¹æ¡†é”™ä½

- ç°è±¡ï¼š
  - `printf 'graph TD\nå¼€å§‹ --> ç»“æŸ\n' | beautiful-mermaid-rs --ascii` ä¸­ï¼Œä¸­æ–‡åœ¨ç»ˆç«¯é‡Œå  2 åˆ—ï¼Œå¯¼è‡´æŸäº›è¡Œâ€œæ˜¾ç¤ºæ›´é•¿â€ï¼Œè¾¹æ¡†çœ‹èµ·æ¥è¢«é¡¶å‡ºå»ã€‚
- åŸå› ï¼š
  - Rust ä¾§æ¸²æŸ“é€»è¾‘æ¥è‡ªä¸Šæ¸¸ TS çš„ browser bundleï¼ˆ`vendor/beautiful-mermaid/beautiful-mermaid.browser.global.js`ï¼‰ã€‚
  - ä¸Šæ¸¸ ASCII æ¸²æŸ“å™¨æœ€åˆæŒ‰ `string.length` å½“ä½œåˆ—å®½ï¼Œä¸”è¾“å‡ºé˜¶æ®µé€ cell æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰å¤„ç†å®½å­—ç¬¦çš„ 2 åˆ—å ç”¨ã€‚
- ä¿®å¤ï¼š
  - åœ¨ä¸Šæ¸¸ TS ä¿®å¤â€œæ˜¾ç¤ºå®½åº¦â€æ¨¡å‹ï¼ˆç®€åŒ–ç‰ˆ wcwidthï¼‰ä¸è¾“å‡ºè·³åˆ—é€»è¾‘ã€‚
  - æœ¬ä»“åº“ç”¨ `scripts/sync-vendor-bundle.sh` åŒæ­¥æœ€æ–° bundle åˆ° `vendor/beautiful-mermaid/`ã€‚
- éªŒè¯ï¼š
  - `cargo test` âœ…
  - `graph TD\nå¼€å§‹ --> ç»“æŸ\n` çš„ ASCII/Unicode è¾“å‡ºè¾¹æ¡†å¯¹é½ âœ…
  - Rust å›å½’æµ‹è¯• `tests/unicode_id_smoke.rs`ï¼šé¢å¤–æ–­è¨€æ¯ä¸€è¡Œâ€œç»ˆç«¯æ˜¾ç¤ºå®½åº¦â€ä¸€è‡´ âœ…

## 2026-02-02 16:25 - åŒæ­¥ vendor bundle å golden tests å¤±è´¥ï¼ˆå‚è€ƒè¾“å‡ºè¿‡æœŸï¼‰

- ç°è±¡ï¼š
  - æ‰§è¡Œ `make install`ï¼ˆå†…éƒ¨ä¼šè·‘ `make sync-vendor-verify`ï¼‰æ—¶å¤±è´¥ï¼ŒæŠ¥é”™é›†ä¸­åœ¨ï¼š
    - `tests/ascii_testdata.rs`: `ascii_testdata_matches_reference` / `unicode_testdata_matches_reference`
  - å¤±è´¥æ–‡ä»¶ï¼ˆç¤ºä¾‹ï¼‰ï¼š
    - `tests/testdata/ascii/ampersand_lhs_and_rhs.txt`
    - `tests/testdata/ascii/preserve_order_of_definition.txt`
    - `tests/testdata/ascii/self_reference_with_edge.txt`
    - ä»¥åŠå¯¹åº”çš„ `tests/testdata/unicode/*.txt`
- åŸå› ï¼š
  - è¿™æ¬¡åŒæ­¥äº†æ›´æ–°åçš„ä¸Šæ¸¸ TS bundleï¼ˆ`vendor/beautiful-mermaid/beautiful-mermaid.browser.global.js`ï¼‰ã€‚
  - ä¸Šæ¸¸åœ¨â€œè‡ªç¯/å¤šè¾¹åˆå¹¶â€åœºæ™¯çš„å¸ƒå±€/èµ°çº¿ç­–ç•¥å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¼è‡´ ASCII/Unicode æ¸²æŸ“è¾“å‡ºæ”¹å˜ã€‚
  - æœ¬ä»“åº“çš„ golden æ–‡ä»¶ä»ç„¶æ˜¯æ—§è¾“å‡ºï¼Œå› æ­¤å¯¹æ¯”å¤±è´¥ã€‚
- ä¿®å¤ï¼š
  - æ›´æ–°ä¸Šè¿° golden æ–‡ä»¶é‡Œçš„æœŸæœ›è¾“å‡ºï¼Œä½¿å…¶ä¸æœ€æ–° vendor bundle å¯¹é½ã€‚
- éªŒè¯ï¼š
  - `cargo test` å…¨é€šè¿‡ âœ…
  - `make install` ç«¯åˆ°ç«¯é€šè¿‡ï¼ˆtsup build â†’ sync vendor â†’ cargo test â†’ release build â†’ installï¼‰âœ…

## 2026-02-02 21:24 - ä¸Šæ¸¸ TS bundle å†æ¬¡å˜æ›´å¯¼è‡´ golden å¤±è´¥ï¼ˆå¹¶æ”¹è‰¯ä¸ºå¯ä¸€é”®æ›´æ–°ï¼‰

- ç°è±¡ï¼š
  - ä½ å†æ¬¡æ‰§è¡Œ `make install`ï¼ˆå†…éƒ¨ä¼šè·‘ `sync-vendor-verify`ï¼‰åå¤±è´¥ã€‚
  - è¿™æ¬¡åŒæ­¥åˆ°çš„æ–° vendor bundle sha256 ä¸º `18ac06ce...`ï¼ˆäº§ç‰©ä½“ç§¯ä¹Ÿæœ‰å¢é•¿ï¼‰ã€‚
  - mismatch çš„ç”¨ä¾‹åŒ…å«ï¼ˆASCII/Unicode æˆå¯¹å˜åŒ–ï¼‰ï¼š
    - `ampersand_lhs_and_rhs`
    - `cls_all_relationships`
    - `er_identifying`
    - `preserve_order_of_definition`
    - `self_reference_with_edge`
- åŸå› ï¼š
  - golden çš„æœ¬è´¨æ˜¯â€œé”å®šå½“å‰è¾“å‡ºâ€ï¼Œæ‰€ä»¥ä¸€æ—¦ä¸Šæ¸¸ bundle æ›´æ–°ä¸”å¸ƒå±€/èµ°çº¿/label æ’ç‰ˆæœ‰å˜åŒ–ï¼Œå°±ä¼šè§¦å‘å¯¹æ¯”å¤±è´¥ã€‚
- ä¿®å¤ï¼š
  - æ›´æ–°ä¸Šè¿° `tests/testdata/{ascii,unicode}/*.txt` çš„æœŸæœ›è¾“å‡ºï¼Œä½¿å…¶ä¸æœ€æ–° vendor bundle å¯¹é½ã€‚
  - æ”¹è‰¯ `tests/ascii_testdata.rs`ï¼š
    - å¢åŠ  `UPDATE_GOLDEN=1` æ¨¡å¼ï¼Œé‡åˆ° mismatch è‡ªåŠ¨å†™å› golden æ–‡ä»¶ï¼Œé¿å…ä¸‹æ¬¡å†æ‰‹å·¥é€ä¸ªæ”¹ã€‚
    - å†™å›åä¼š panic æç¤ºâ€œé‡æ–°è¿è¡Œæµ‹è¯•ç¡®è®¤ç¨³å®šâ€ï¼Œé˜²æ­¢ silent æ›´æ–°æ©ç›–é—®é¢˜ã€‚
- éªŒè¯ï¼š
  - `cargo test` å…¨é€šè¿‡ âœ…
  - `make install` ç«¯åˆ°ç«¯é€šè¿‡ï¼ˆtsup build â†’ sync vendor â†’ cargo test â†’ release build â†’ installï¼‰âœ…
- é¢å¤–è§‚å¯Ÿï¼ˆæ½œåœ¨é£é™©ï¼‰ï¼š
  - `preserve_order_of_definition` è¿™ç±»åŒ…å«è‡ªç¯/å¾ªç¯è¾¹çš„æ¡ˆä¾‹åœ¨å½“å‰ bundle ä¸‹æ¸²æŸ“å˜æ…¢ï¼Œå¯¼è‡´ golden tests æ•´ä½“è€—æ—¶ä¸Šå‡ï¼ˆæœ¬æœºè§‚æµ‹ 70-100s çº§åˆ«ï¼‰ã€‚

## 2026-02-06 16:12 - ä¸Šæ¸¸ TS bundle æ›´æ–°å Unicode golden è¿‡æœŸï¼ˆ`make install` å¤±è´¥ï¼‰

- ç°è±¡ï¼š
  - æ‰§è¡Œ `make install`ï¼ˆå†…éƒ¨ä¼šè·‘ `sync-vendor-verify`ï¼‰æ—¶å¤±è´¥ã€‚
  - æŠ¥é”™ä¸º `tests/ascii_testdata.rs` çš„ `unicode_testdata_matches_reference` è¾“å‡ºä¸ä¸€è‡´ã€‚
  - é¦–ä¸ªæš´éœ²çš„ mismatch æ–‡ä»¶ä¸ºï¼š
    - `tests/testdata/unicode/ampersand_lhs_and_rhs.txt`
- åŸå› ï¼š
  - `sync-vendor-verify` é‡å»ºå¹¶åŒæ­¥äº†ä¸Šæ¸¸ TS bundleï¼ˆæœ¬æ¬¡ sha256 ä¸º `b48b9228...`ï¼‰ã€‚
  - ä¸Šæ¸¸åœ¨ç›¸å…³ç”¨ä¾‹çš„å¸ƒå±€/èµ°çº¿ç»†èŠ‚ä¸Šæœ‰å˜åŒ–, å¯¼è‡´ Unicode æ¸²æŸ“è¾“å‡ºå˜åŒ–ã€‚
  - golden å‚è€ƒè¾“å‡ºä»æ˜¯æ—§ç‰ˆæœ¬, å› æ­¤å¯¹æ¯”å¤±è´¥ã€‚
- ä¿®å¤ï¼š
  - ä½¿ç”¨ä»“åº“å†…ç½®çš„ `UPDATE_GOLDEN=1` æ¨¡å¼è‡ªåŠ¨æ›´æ–° Unicode golden:
    - `UPDATE_GOLDEN=1 cargo test --test ascii_testdata unicode_testdata_matches_reference`
  - å®é™…æ›´æ–°äº† 2 ä¸ªæ–‡ä»¶ï¼ˆä¹‹å‰åªçœ‹åˆ° 1 ä¸ªæ˜¯å› ä¸ºæ–­è¨€é‡åˆ°ç¬¬ä¸€ä¸ª mismatch ä¼šæå‰é€€å‡ºï¼‰ï¼š
    - `tests/testdata/unicode/ampersand_lhs_and_rhs.txt`
    - `tests/testdata/unicode/preserve_order_of_definition.txt`
- éªŒè¯ï¼š
  - `cargo test` å…¨é€šè¿‡ âœ…
  - `make install` ç«¯åˆ°ç«¯é€šè¿‡ âœ…

## 2026-02-06 19:33 - Unicodeï¼ˆé»˜è®¤ relaxedï¼‰æ¸²æŸ“è¿‡æ…¢ï¼šè¡¥é½ native `__bm_getPathRelaxed`

- ç°è±¡ï¼š
  - Unicode golden testsï¼ˆ`unicode_testdata_matches_reference`ï¼‰åœ¨ QuickJS ç¯å¢ƒä¸‹è€—æ—¶éå¸¸é•¿ï¼ˆæœ¬æœºè§‚æµ‹ 70-100sï¼‰ã€‚
- åŸå› ï¼š
  - Rust ä¾§ä»…æ³¨å…¥ `__bm_getPath` / `__bm_getPathStrict`ã€‚
  - ä½† Unicode é»˜è®¤èµ° TS çš„ relaxed è·¯ç”±ï¼ˆ`getPathRelaxed()`ï¼‰ï¼Œä¹‹å‰æ²¡æœ‰ native fast pathã€‚
  - ç»“æœï¼šrelaxed A* çƒ­å¾ªç¯ä»åœ¨ QuickJS è§£é‡Šæ‰§è¡Œ â†’ ææ…¢ã€‚
- ä¿®å¤ï¼š
  - Rustï¼šå®ç° native relaxed A*ï¼ˆæ­¥é•¿ + crossing penalty + segment reuse hard ruleï¼‰ï¼Œå¹¶æ³¨å…¥ `globalThis.__bm_getPathRelaxed(...)`ã€‚
  - TSï¼š`getPathRelaxed()` æ£€æµ‹åˆ° `__bm_getPathRelaxed` æ—¶ä¼˜å…ˆèµ° nativeã€‚
  - åŒæ­¥ vendorï¼šæ›´æ–° `vendor/beautiful-mermaid/beautiful-mermaid.browser.global.js`ã€‚
- éªŒè¯ï¼š
  - `scripts/sync-vendor-bundle.sh` å…¨é€šè¿‡ï¼ˆå« `cargo test`ï¼‰ã€‚
  - Unicode golden tests è€—æ—¶é™åˆ° ~3.6sï¼ˆæœ¬æœºè§‚æµ‹ï¼‰ã€‚

## 2026-02-06 20:56 - Flowchart Unicode relaxed çº¿è·¯å¼ºæ­§ä¹‰: `task.start` æ˜“è¯¯è¯»ä¸ºæŒ‡å‘ â€œğŸ” è§„æ ¼å®¡é˜…è€…â€

- é—®é¢˜ï¼š
  - è¾“å…¥æ˜¯ flowchart LR, å…ˆå£°æ˜èŠ‚ç‚¹(å« emoji/ä¸­æ–‡ label), å†å†™è¾¹ã€‚
  - æ—§è¾“å‡ºä¸­ `task.start -> ralph#1 (coordinator)` çš„çº¿è·¯ä¼šè¢«è¿«ç»•è¡Œå¹¶ä¸å…¶å®ƒè¾¹è´´åˆ, è‚‰çœ¼çœ‹èµ·æ¥åƒæŒ‡å‘ â€œğŸ” è§„æ ¼å®¡é˜…è€…â€ã€‚
- æ ¹å› ï¼š
  - relaxed æ¨¡å¼çš„ grid å¸ƒå±€é‡Œ, rootNodes è¯†åˆ«ä¾èµ– node insertion order çš„â€œé¦–æ¬¡å‡ºç°â€æ¨æ–­ã€‚
  - å½“ Mermaid å…ˆå£°æ˜èŠ‚ç‚¹å†è¿è¾¹æ—¶, å¾ˆå¤šâ€œå…¶å®æœ‰å…¥è¾¹â€çš„èŠ‚ç‚¹ä¼šè¢«è¯¯åˆ¤ä¸º root å¹¶å †åˆ°åŒä¸€åˆ—, è¿›è€Œå¼ºè¿«è¾¹èµ°éå¸¸ä¸è‡ªç„¶çš„ç»•è·¯ã€‚
- ä¿®å¤ï¼š
  - relaxed: rootNodes æ”¹ä¸ºâ€œæ— å…¥è¾¹èŠ‚ç‚¹â€(ä¿æŒ insertion order ç¨³å®š), å¹¶å¯¹â€œå…¨å›¾æˆç¯å¯¼è‡´ rootNodes ä¸ºç©ºâ€åšç¡®å®šæ€§å…œåº•ã€‚
  - strict: ä¿æŒæ—§ root æ¨æ–­, å¹¶æ’¤å› strict çš„ corner port å…œåº•, ç»§ç»­ä¾èµ– layoutMargin é‡è¯•æ¥è·å¾—æ›´å¤š free cell(é¿å… strict è¾“å‡ºæ¼‚ç§»)ã€‚
  - Rust: åŒæ­¥ vendor bundle, å¹¶æ›´æ–°å—å½±å“çš„ Unicode golden:
    - `tests/testdata/unicode/preserve_order_of_definition.txt`
- éªŒè¯ï¼š
  - TS: `bun test` å…¨é€šè¿‡(559 tests)ã€‚
  - Rust: `cargo test` å…¨é€šè¿‡ã€‚
  - å¤ç°å‘½ä»¤è¾“å‡ºå·²å˜ä¸ºâ€œç›´è¿ä¸”æ— æ­§ä¹‰â€, ç¬¬ä¸€è¡ŒåŒ…å«:
    - `task.start â”œâ”€â”€â”€â”€â–º ralph#1 (coordinator)`

- éƒ¨ç½²(é¿å…ä½ æœ¬æœº PATH ä»æŒ‡å‘æ—§äºŒè¿›åˆ¶)ï¼š
  - å·²æ‰§è¡Œ `make install INSTALL_DIR=/Users/cuiluming/local_doc/l_dev/tool` æ›´æ–°å·²å®‰è£…çš„ `beautiful-mermaid-rs`ã€‚

## 2026-02-06 23:15 - Flowchart TD ä¸‹ç«¯å£é”™ä½: label æ‰©å®½åˆ—å¯¼è‡´ edge stroke è¿›å…¥ node interior

- ç°è±¡ï¼š
  - `flowchart TD` + Unicode(relaxed) è¾“å‡ºé‡Œ, â€œğŸ” è§„æ ¼å®¡é˜…è€…â€ å³ä¾§å‡ºçº¿ä¸è´´è¾¹ã€‚
  - è§†è§‰ä¸Šå‡ºç° box å†…éƒ¨ç«–çº¿ `â”‚`/junction, åƒçº¿ä» box é‡Œé¢é•¿å‡ºæ¥ã€‚
- åŸå› ï¼š
  - `determineLabelLine()` ä¼šæŠŠ `columnWidth[middleX]` æ‰©å®½åˆ° `lenLabel + 2`ã€‚
  - `columnWidth` æ˜¯å…¨å±€åˆ—å®½, å½“ `middleX` è½åœ¨ node çš„ 3x3 block åˆ—(å°¤å…¶æ˜¯ node é¡¶ç‚¹åˆ—)æ—¶,
    - node box ä¼šå›  â€œcell centerâ€ çš„åæ ‡è¯­ä¹‰å‘ç”Ÿå¹³ç§»,
    - ä½† edge port ä»æŒ‰ grid è¾¹ç•Œå–ç‚¹,
    - äºæ˜¯ç«¯å£ä¸ box è¾¹æ¡†é”™ä½, edge stroke ä¼šè¿›å…¥ node interiorã€‚
- ä¿®å¤ï¼š
  - relaxed + Unicode æ—¶:
    - è‹¥ `middleX` å‘½ä¸­ä»»æ„ node block åˆ—, åˆ™åœ¨è¯¥ labelLine è¦†ç›–çš„ `[minX..maxX]` é‡Œé€‰æ‹©â€œæœ€è¿‘çš„é node block åˆ—â€æ¥æ‰©å®½,
    - é¿å…æ‰©å®½ node åˆ—, ä»è€Œé¿å…ç«¯å£è½å…¥ box interiorã€‚
  - æ–°å¢ TS å›å½’æµ‹è¯•(ä½¿ç”¨ meta æ–­è¨€ edge stroke ä¸å¾—å‘½ä¸­ node interior)æ¥é”æ­»è¯¥è¡Œä¸ºã€‚
  - Rust åŒæ­¥æœ€æ–° vendor bundle åˆ° `vendor/beautiful-mermaid/beautiful-mermaid.browser.global.js`(sha256: `28c11372...`)ã€‚
- éªŒè¯ï¼š
  - Rust: `cargo test` å…¨é€šè¿‡ âœ…
  - å¤ç°å‘½ä»¤:
    - `printf 'flowchart TD ...' | beautiful-mermaid-rs --ascii`
    - reviewer å³ä¾§å‡ºçº¿è´´è¾¹, ä¸å†å‡ºç° box å†…éƒ¨ç«–çº¿ âœ…
